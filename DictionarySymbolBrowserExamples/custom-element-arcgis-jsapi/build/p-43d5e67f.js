function n(n,t){return n?t?4:3:t?3:2}function t(t,e,o,c,l){if(!e||!e.lengths.length)return null;const f="upperLeft"===(null==l?void 0:l.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const s=t.coords,i=[],b=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:m,coords:N}=e,h=n(o,c);let p=0;for(const n of m){const t=r(b,N,p,n,o,c,f);t&&i.push(t),p+=n*h}if(i.sort(((n,t)=>{let r=f*n[2]-f*t[2];return 0===r&&o&&(r=n[4]-t[4]),r})),i.length){let n=6*i[0][2];s[0]=i[0][0]/n,s[1]=i[0][1]/n,o&&(n=6*i[0][4],s[2]=0!==n?i[0][3]/n:0),(s[0]<b[0]||s[0]>b[1]||s[1]<b[2]||s[1]>b[3]||o&&(s[2]<b[4]||s[2]>b[5]))&&(s.length=0)}if(!s.length){const n=e.lengths[0]?u(N,0,m[0],o,c):null;if(!n)return null;s[0]=n[0],s[1]=n[1],o&&n.length>2&&(s[2]=n[2])}return t}function r(t,r,u,e,o,c,l=1){const f=n(o,c);let s=u,i=u+f,b=0,m=0,N=0,h=0,p=0;for(let n=0,u=e-1;n<u;n++,s+=f,i+=f){const n=r[s],u=r[s+1],e=r[s+2],c=r[i],l=r[i+1],f=r[i+2];let a=n*l-c*u;h+=a,b+=(n+c)*a,m+=(u+l)*a,o&&(a=n*f-c*e,N+=(e+f)*a,p+=a),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),u<t[2]&&(t[2]=u),u>t[3]&&(t[3]=u),o&&(e<t[4]&&(t[4]=e),e>t[5]&&(t[5]=e))}if(h*l>0&&(h*=-1),p*l>0&&(p*=-1),!h)return null;const a=[b,m,.5*h];return o&&(a[3]=N,a[4]=.5*p),a}function u(t,r,u,f,s){const i=n(f,s);let b=r,m=r+i,N=0,h=0,p=0,a=0;for(let n=0,r=u-1;n<r;n++,b+=i,m+=i){const n=t[b],r=t[b+1],u=t[b+2],s=t[m],i=t[m+1],d=t[m+2],M=f?o(n,r,u,s,i,d):e(n,r,s,i);if(M)if(N+=M,f){const t=l(n,r,u,s,i,d);h+=M*t[0],p+=M*t[1],a+=M*t[2]}else{const t=c(n,r,s,i);h+=M*t[0],p+=M*t[1]}}return N>0?f?[h/N,p/N,a/N]:[h/N,p/N]:u>0?f?[t[r],t[r+1],t[r+2]]:[t[r],t[r+1]]:null}function e(n,t,r,u){const e=r-n,o=u-t;return Math.sqrt(e*e+o*o)}function o(n,t,r,u,e,o){const c=u-n,l=e-t,f=o-r;return Math.sqrt(c*c+l*l+f*f)}function c(n,t,r,u){return[n+.5*(r-n),t+.5*(u-t)]}function l(n,t,r,u,e,o){return[n+.5*(u-n),t+.5*(e-t),r+.5*(o-r)]}export{t}