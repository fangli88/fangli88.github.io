import"./p-476cf7c4.js";import{U as e,b as r,O as n,m as t,Z as o}from"./p-ab028778.js";import{t as s}from"./p-abda1e64.js";import{a as i,p as a,i as c}from"./p-4561de0e.js";import{n as u}from"./p-920b2088.js";const l=i(-.5,-.5,-.5,.5,.5,.5),f=i(-.5,-.5,0,.5,.5,1),y=i(-.5,-.5,0,.5,.5,.5);function m(e){switch(e){case"sphere":case"cube":case"diamond":return l;case"cylinder":case"cone":case"inverted-cone":return f;case"tetrahedron":return y;default:return}}let p=b();function b(){return new u(50)}function d(){p=b()}function h(e,r){if("icon"===e.type)return j(e,r);if("object"===e.type)return v(e,r);throw new t("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object")}async function w(e,r){if("icon"===e.type)return function(e,r){return j(e,r).then((r=>{if(null==e.size)return r;const n=r[0]/r[1];return n>1?[e.size,e.size/n]:[e.size*n,e.size]}))}(e,r);if("object"===e.type)return async function(e,r){return function(e,{isPrimitive:r,width:n,depth:t,height:o}){const i=r?10:1;if(null==n&&null==o&&null==t)return[i*e[0],i*e[1],i*e[2]];const a=s(n,t,o);let c;for(let r=0;r<3;r++){const n=a[r];if(null!=n){c=n/e[r];break}}for(let r=0;r<3;r++)null==a[r]&&(a[r]=e[r]*c);return a}(await v(e,r),e)}(e,r);throw new t("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object")}async function j(e,n){if(e.resource.href)return(s=e.resource.href,o(s,{responseType:"image"}).then((e=>e.data))).then((e=>[e.width,e.height]));var s;if(e.resource.primitive)return r(n)?[n,n]:[256,256];throw new t("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource")}function v(o,s){return async function(o,s){if(!o.isPrimitive){const r=o.resource.href,n=p.get(r);if(void 0!==n)return e(n);const t=await import("./p-474b65fe.js").then((function(e){return e.o})),s=await t.fetch(r,{disableTextures:!0});return p.put(r,s.referenceBoundingBox),s.referenceBoundingBox}let i=null;if(o.resource&&o.resource.primitive&&(i=c(m(o.resource.primitive)),r(s)))for(let e=0;e<i.length;e++)i[e]*=s;return i?e(i):n(new t("symbol:invalid-resource","The symbol does not have a valid resource"))}(o,s).then((e=>a(e)))}export{d as clearBoundingBoxCache,j as computeIconLayerResourceSize,h as computeLayerResourceSize,w as computeLayerSize,v as computeObjectLayerResourceSize}