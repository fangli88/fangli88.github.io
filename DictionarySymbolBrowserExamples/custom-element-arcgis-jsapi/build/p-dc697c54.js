import{M as e,k as t,Z as s,a1 as n,an as r,ao as o,m as l,O as a,ap as i,aq as c,a2 as u,ar as m,as as y,at as f,au as b}from"./p-ab028778.js";function p(t,s){return t&&(s=s||e.location.hostname)?null!=s.match(d)||null!=s.match(w)?t.replace("static.arcgis.com","staticdev.arcgis.com"):null!=s.match(g)||null!=s.match($)?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t}const d=/^devext.arcgis.com$/,g=/^qaext.arcgis.com$/,w=/^[\w-]*\.mapsdevext.arcgis.com$/,$=/^[\w-]*\.mapsqa.arcgis.com$/,S=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,d,g,/^jsapps.esri.com$/,w,$],N=()=>!!t("enable-feature:force-wosr"),h={};function v(e,t,s){return e.styleUrl?function(e,t){return x(e,t).then((t=>({data:t.data,baseUrl:r(e),styleUrl:e})))}(e.styleUrl,s):e.styleName?function(e,t,s){const n=t.portal||i.getDefault();let r;const a=`${n.url} - ${n.user&&n.user.username} - ${e}`;return h[a]||(h[a]=function(e,t,s){return t.load(s).then((()=>{const n=new o({disableExtraQuery:!0,query:`owner:${E} AND type:${U} AND typekeywords:"${e}"`});return t.queryItems(n,s)})).then((({results:t})=>{let n=null;const r=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t)if(e.typeKeywords.some((e=>e.toLowerCase()===r))&&e.type===U&&e.owner===E){n=e;break}if(!n)throw new l("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(s)}))}(e,n,s).then((e=>(r=e,e.fetchData()))).then((t=>({data:t,baseUrl:r.itemUrl,styleName:e})))),h[a]}(e.styleName,t,s):a(new l("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function j(t,s,n,o,i){const d=t.data,g={portal:n.portal,url:u(t.baseUrl),origin:"portal-item"},w=d.items.find((e=>e.name===s));if(!w)return a(new l("symbolstyleutils:symbol-name-not-found",`The symbol name '${s}' could not be found`,{symbolName:s}));let $=m(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!N())for(const t of e.formatInfos)if("gltf"===t.type)return t.href;return e.webRef}(w,o),g),h=w.thumbnail&&w.thumbnail.href;const v=w.thumbnail&&w.thumbnail.imageData;var j;j=j||e.location.hostname,S.some((e=>{var t;return null!=(null==(t=j)?void 0:t.match(e))}))&&($=p($),h=p(h));const E={portal:n.portal,url:u(r($)),origin:"portal-item"};return x($,i).then((e=>{const r="cimRef"===o?q(e.data):e.data,l=c(r,E);if(l&&y(l)){if(h){const e=m(h,g);l.thumbnail=new f({url:e})}else v&&(l.thumbnail=new f({url:`data:image/png;base64,${v}`}));t.styleUrl?l.styleOrigin=new b({portal:n.portal,styleUrl:t.styleUrl,name:s}):t.styleName&&(l.styleOrigin=new b({portal:n.portal,styleName:t.styleName,name:s}))}return l}))}function q(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function x(e,t){const r={responseType:"json",query:{f:"json"},...t};return s(n(e),r)}const E="esri_en",U="Style",_=Object.freeze({__proto__:null,fetchStyle:v,fetchSymbolFromStyle:j,resolveWebStyleSymbol:function(e,t,s,n){return e.name?e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,s){const n="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json".replace(/\{SymbolName\}/gi,e.name);return x(n,s).then((e=>{const s=q(e.data);return c(s,{portal:t.portal,url:u(r(n)),origin:"portal-item"})}))}(e,t,n):v(e,t,n).then((r=>j(r,e.name,t,s,n))):a(new l("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))},styleNameFromItem:function(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}});export{v as g,_ as s,p as t}