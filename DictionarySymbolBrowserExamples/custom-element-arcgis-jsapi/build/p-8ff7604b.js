import{D as t,E as e,K as s,L as i,bT as n,bL as r,s as o,m as u,bH as l}from"./p-ab028778.js";import{b as a,a as c}from"./p-1cce98ff.js";import{g as p}from"./p-2500de92.js";let d=class extends i{constructor(){super(...arguments),this.type=null}};t([e({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0),d=t([s("esri.layers.support.FeatureReduction")],d);var h,y=d;let f=h=class extends i{constructor(){super(...arguments),this.statisticType=null,this.onStatisticField=null,this.onStatisticValueExpression=null}clone(){return new h({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})}};t([e({type:String,json:{write:!0}})],f.prototype,"statisticType",void 0),t([e({type:String,json:{write:!0}})],f.prototype,"onStatisticField",void 0),t([e({type:String,json:{write:!0}})],f.prototype,"onStatisticValueExpression",void 0),f=h=t([s("esri.layers.support.OutStatistic")],f);var w,v=f;let b=w=class extends i{constructor(){super(...arguments),this.name=null}clone(){return new w({name:this.name,outStatistic:this.outStatistic.clone()})}};t([e({type:String,json:{write:!0}})],b.prototype,"name",void 0),t([e({type:v,json:{write:!0}})],b.prototype,"outStatistic",void 0),b=w=t([s("esri.layers.support.AggregateField")],b);var g,j=b;let S=g=class extends i{constructor(t){super(t),this.type="cluster",this.clusterRadius=n("80px"),this.clusterMinSize=n("12px"),this.clusterMaxSize=n("50px"),this.popupEnabled=!0,this.popupTemplate=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}clone(){return new g({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:o(this.labelingInfo),labelsVisible:this.labelsVisible,fields:o(this.fields),popupEnabled:this.popupEnabled,popupTemplate:o(this.popupTemplate)})}};t([e({type:["cluster"],readOnly:!0,json:{write:!0}})],S.prototype,"type",void 0),t([e({type:Number,cast:t=>"auto"===t?t:n(t),json:{write:!0}})],S.prototype,"clusterRadius",void 0),t([e({type:Number,cast:n,json:{write:!0}})],S.prototype,"clusterMinSize",void 0),t([e({type:Number,cast:n,json:{write:!0}})],S.prototype,"clusterMaxSize",void 0),t([e(a)],S.prototype,"popupEnabled",void 0),t([e({type:r,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],S.prototype,"popupTemplate",void 0),t([e({type:[p],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],S.prototype,"labelingInfo",void 0),t([e(c)],S.prototype,"labelsVisible",void 0),t([e({type:[j],json:{write:!0}})],S.prototype,"fields",void 0),S=g=t([s("esri.layers.support.FeatureReductionCluster")],S);var m,x=S;let I=m=class extends y{constructor(t){super(t),this.type="selection"}clone(){return new m}};t([e({type:["selection"]})],I.prototype,"type",void 0),I=m=t([s("esri.layers.support.FeatureReductionSelection")],I);var R=I;const F={key:"type",base:y,typeMap:{selection:R}};function E(t,e){const s=(e=e.layerDefinition||e).featureReduction;if(s)switch(s.type){case"selection":return R.fromJSON(s);case"cluster":return x.fromJSON(s)}return null}function M(t,e,s,i){const n=function(t,e,s){return t?"selection"!==t.type?(s.messages&&s.messages.push(new u("featureReduction:unsupported",`FeatureReduction of type '${t.declaredClass}' are not supported in scenes.`,{featureReduction:t,context:s})),null):t.write({},s):null}(t,0,i);n&&l(s,n,e)}const T=/\[([^\[\]]+)\]/gi;function z(t,e,s){return t?t.map((t=>{const i=new p;if(i.read(t,s),i.labelExpression){const t=e.fields||e.layerDefinition&&e.layerDefinition.fields||this.fields;i.labelExpression=i.labelExpression.replace(T,((e,s)=>`[${function(t,e){if(!e)return t;const s=t.toLowerCase();for(let t=0;t<e.length;t++){const i=e[t].name;if(i.toLowerCase()===s)return i}return t}(s,t)}]`))}return i})):null}export{R as a,M as c,x as d,y as p,z as r,F as s,E as u}