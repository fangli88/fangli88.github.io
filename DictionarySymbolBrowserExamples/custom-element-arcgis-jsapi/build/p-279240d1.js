import{D as t,E as s,K as i,ae as o}from"./p-ab028778.js";import{u as e}from"./p-73b795c3.js";let h=class extends o{constructor(t){super(t),this._handles=new e,this.root=null}initialize(){this._handles.add(this.rootCollectionNames.map((t=>this.watch("root."+t,(()=>this.updateCollections()),!0)))),this.updateCollections()}destroy(){this.root=null,this.refresh(),this._handles.destroy(),this._handles=null}updateCollections(){this._collections=this.rootCollectionNames.map((t=>this.get("root."+t))).filter((t=>null!=t)),this.refresh()}refresh(){const t=this._handles;t.remove("collections");const s=new Array;let i=0;for(const t of this._collections)i=this._processCollection(s,i,t);this.splice(i,this.length);for(const i of s)t.add(i.on("after-changes",(()=>this.refresh())),"collections")}_createNewInstance(t){return new o(t)}_processCollection(t,s,i){return i?(t.push(i),i.forEach((i=>{if(i){if(!this.itemFilterFunction||this.itemFilterFunction(i)){const t=this.indexOf(i,s);t>=0?t!==s&&this.reorder(i,s):this.add(i,s),++s}this.getChildrenFunction&&(s=this._processCollection(t,s,this.getChildrenFunction(i)))}})),s):s}};t([s()],h.prototype,"rootCollectionNames",void 0),t([s()],h.prototype,"root",void 0),t([s()],h.prototype,"getChildrenFunction",void 0),t([s()],h.prototype,"itemFilterFunction",void 0),h=t([i("esri.core.CollectionFlattener")],h);var n=h;export{n as l}