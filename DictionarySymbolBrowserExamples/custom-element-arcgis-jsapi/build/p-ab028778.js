import{r as t,c as e,h as i}from"./p-476cf7c4.js";function s(t,e,i,s){var r,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(o=(n<3?r(o):n>3?r(e,i,o):r(e,i))||o);return n>3&&o&&Object.defineProperty(e,i,o),o}const r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;var n,o;let l;var a,u;function h(t){return"function"==typeof l[t]?l[t]=l[t](r):l[t]}function c(t,e){if(t.forEach)t.forEach(e);else for(let i=0;i<t.length;i++)e(t[i],i,t)}function f(t,e,i){if(t.slice)return t.slice(e,i);void 0===e?e=0:(e<0&&(e+=t.length),e=Math.min(t.length,Math.max(0,e))),void 0===i?i=t.length:(i<0&&(i+=t.length),i=Math.min(t.length,Math.max(0,i)));const s=Math.max(0,i-e),r=new t.constructor(s);for(let i=0;i<s;i++)r[i]=t[e+i];return r}function d(t){return t instanceof ArrayBuffer||t&&t.constructor&&"ArrayBuffer"===t.constructor.name}function p(t){return t instanceof Uint8Array||t&&t.constructor&&"Uint8Array"===t.constructor.name}function y(t){return t instanceof Uint16Array||t&&t.constructor&&"Uint16Array"===t.constructor.name}function m(t){return t instanceof Uint32Array||t&&t.constructor&&"Uint32Array"===t.constructor.name}function v(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(void 0===t[i]?delete t[i]:t[i]instanceof Object&&v(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&void 0===t[i]&&delete t[i];return t}function w(t){if(!t||"object"!=typeof t||"function"==typeof t)return t;if(function(t){return t instanceof Int8Array||t&&t.constructor&&"Int8Array"===t.constructor.name}(t)||p(t)||function(t){return t instanceof Uint8ClampedArray||t&&t.constructor&&"Uint8ClampedArray"===t.constructor.name}(t)||function(t){return t instanceof Int16Array||t&&t.constructor&&"Int16Array"===t.constructor.name}(t)||y(t)||function(t){return t instanceof Int32Array||t&&t.constructor&&"Int32Array"===t.constructor.name}(t)||m(t)||function(t){return t instanceof Float32Array||t&&t.constructor&&"Float32Array"===t.constructor.name}(t)||function(t){return t instanceof Float64Array||t&&t.constructor&&"Float64Array"===t.constructor.name}(t))return f(t);if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;return t.forEach(((t,i)=>{e.set(i,w(t))})),e}if(t instanceof Set){const e=new Set;return t.forEach((t=>{e.add(w(t))})),e}let e;const i=t;return e="function"==typeof i.clone?i.clone():"function"==typeof i.map&&"function"==typeof i.forEach?i.map(w):"function"==typeof i.notifyChange&&"function"==typeof i.watch?i.clone():S({},t,w),e}function b(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof(t||{}).getTime&&"function"==typeof(e||{}).getTime&&t.getTime()===e.getTime()||!1}function g(t={},...e){for(const i of e)S(t,i);return t}function S(t,e,i){let s,r;const n={};for(s in e){r=e[s];const o=!(s in n)||n[s]!==r;(!(s in t)||t[s]!==r&&o)&&(t[s]=i?i(r):r)}return t}function M(t){return null!=t}function x(t){return null==t}function k(t){return void 0===t}function C(t,e){return M(t)?e(t):null}function I(t){return t}function O(t,e){return M(t)?t:"function"==typeof e?e():e}function j(t){return M(t)&&t.remove(),null}function P(){return null}function A(t,e){const i=new Array;for(const s of t)i.push(N(s,null,e));return i}function T(t,e){for(const i of t)N(i,null,e)}function N(t,e,i){return M(t)?i(t):e}function R(t,e){return M(t)?e(t):null}function _(t,...e){let i=t,s=0;for(;s<e.length&&i;)i=i[e[s++]];return i}function E(t){return t}function D(t,e,i=!1){return L(t,e,i)}function $(t,e){if(null!=e)return e[t]||F(t.split("."),!1,e)}function z(t,e,i){const s=t.split("."),r=s.pop(),n=F(s,!0,i);n&&r&&(n[r]=e)}function F(t,e,i){let s=i;for(const i of t){if(null==s)return;if(!(i in s)){if(!e)return;s[i]={}}s=s[i]}return s}function L(t,e,i){return e?Object.keys(e).reduce((function(t,s){let r=t[s],n=e[s];return r===n?t:void 0===r?(t[s]=w(n),t):(Array.isArray(n)||Array.isArray(t)?(r=t[s]=r?Array.isArray(r)?r.concat():[r]:[],n&&(Array.isArray(n)||(n=[n]),i?n.forEach((t=>{-1===r.indexOf(t)&&r.push(t)})):t[s]=n.concat())):n&&"object"==typeof n?t[s]=L(r,n,i):t.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(t[s]=n),t)}),t||{}):t}l=null!=(n=r.dojoConfig)&&n.has||null!=(o=r.esriConfig)&&o.has?{...null==(a=r.dojoConfig)?void 0:a.has,...null==(u=r.esriConfig)?void 0:u.has}:{},h.add=(t,e,i,s)=>((s||void 0===l[t])&&(l[t]=e),i&&h(t)),h.cache=l,h.add("esri-deprecation-warnings",!0),h.add("esri-featurelayer-webgl",!0),h.add("esri-featurelayer-webgl-labeling",!0),(()=>{h.add("host-webworker",void 0!==r.WorkerGlobalScope&&self instanceof r.WorkerGlobalScope);const t="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(h.add("host-browser",t),h.add("host-node","object"==typeof r.process&&r.process.versions&&r.process.versions.node&&r.process.versions.v8),h.add("dom",t),h("host-browser")){const t=navigator,e=t.userAgent,i=t.appVersion,s=parseFloat(i);if(h.add("wp",parseFloat(e.split("Windows Phone")[1])||void 0),h.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0),h.add("khtml",i.indexOf("Konqueror")>=0?s:void 0),h.add("edge",parseFloat(e.split("Edge/")[1])||void 0),h.add("opr",parseFloat(e.split("OPR/")[1])||void 0),h.add("webkit",!h("wp")&&!h("edge")&&parseFloat(e.split("WebKit/")[1])||void 0),h.add("chrome",!h("edge")&&!h("opr")&&parseFloat(e.split("Chrome/")[1])||void 0),h.add("android",!h("wp")&&parseFloat(e.split("Android ")[1])||void 0),h.add("safari",!(i.indexOf("Safari")>=0)||h("wp")||h("chrome")||h("android")||h("edge")||h("opr")?void 0:parseFloat(i.split("Version/")[1])),h.add("mac",i.indexOf("Macintosh")>=0),h.add("quirks","BackCompat"===document.compatMode),!h("wp")&&e.match(/(iPhone|iPod|iPad)/)){const t=RegExp.$1.replace(/P/,"p"),i=e.match(/OS ([\d_]+)/)?RegExp.$1:"1",s=parseFloat(i.replace(/_/,".").replace(/_/g,""));h.add(t,s),h.add("ios",s)}h.add("trident",parseFloat(i.split("Trident/")[1])||void 0),h.add("svg","undefined"!=typeof SVGAngle),h("webkit")||(e.indexOf("Opera")>=0&&h.add("opera",s>=9.8&&parseFloat(e.split("Version/")[1])||s),!(e.indexOf("Gecko")>=0)||h("wp")||h("khtml")||h("trident")||h("edge")||h.add("mozilla",s),h("mozilla")&&h.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0))}})(),(()=>{if(r.navigator){const t=navigator.userAgent,e=t.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),i=t.match(/iPhone/i);e&&h.add("esri-mobile",e),i&&h.add("esri-iPhone",i),h.add("esri-geolocation",!!navigator.geolocation)}h.add("esri-canvas-svg-support",!h("trident")),h.add("esri-secure-context",(()=>"isSecureContext"in r?r.isSecureContext:r.location&&r.location.origin?0===r.location.origin.indexOf("https:"):void 0)),h.add("esri-wasm","WebAssembly"in r),h.add("esri-shared-array-buffer",(()=>"SharedArrayBuffer"in r&&!(!1===r.crossOriginIsolated))),h.add("esri-atomics","Atomics"in r),h.add("esri-workers","Worker"in r),h.add("esri-text-decoder","TextDecoder"in r),h.add("esri-text-encoder","TextEncoder"in r),h.add("featurelayer-advanced-symbols",!1),h.add("featurelayer-pbf",!0),h.add("featurelayer-pbf-statistics",!1),h.add("feature-layers-workers",!0),h.add("mapview-transitions-duration",200),h("host-webworker")||h("host-browser")&&(h.add("csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),h.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{h.add("esri-image-decode",!0,!0,!0)})).catch((()=>{h.add("esri-image-decode",!1,!0,!0)}))}return!1})),h.add("esri-url-encodes-apostrophe",(()=>{const t=r.document.createElement("a");return t.href="?'",t.href.indexOf("?%27")>-1})),h.add("vectortilelayer-max-buffers",(()=>h("ff")?160:Number.POSITIVE_INFINITY)))})();const U=/\{([^\}]+)\}/g;function V(t){return null==t?"":t}function G(t,e){return t.replace(U,"object"==typeof e?(t,i)=>V($(i,e)):(t,i)=>V(e(i)))}function q(t,e){return t.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(t=>e&&-1!==e.indexOf(t)?t:`\\${t}`))}function B(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}const H={apiKey:void 0,applicationUrl:r.location&&r.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};r.esriConfig&&(D(H,r.esriConfig,!0),delete H.has),H.assetsPath||(H.assetsPath="./assets"),H.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(H,"baseUrl",{set(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath")}}),H.request.corsEnabledServers=[],H.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0};const J={info:0,warn:1,error:2,none:3};class W{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,W._loggers[this.module]=this;const e=this.module.lastIndexOf(".");-1!==e&&(this._parent=W.getLogger(this.module.slice(0,e)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}static get test(){return{resetLoggers(t={}){const e=W._loggers;return W._loggers=t,e},set throttlingDisabled(t){W._throttlingDisabled=t}}}static getLogger(t){let e=W._loggers[t];return e||(e=new W({module:t})),e}_log(t,e,...i){if(this._matchLevel(t)){if("always"!==e&&!W._throttlingDisabled){const s=this._argsToKey(i),r=this._loggedMessages[t].get(s);if("once"===e&&null!=r||"oncePerTick"===e&&r&&r>=W._tickCounter)return;this._loggedMessages[t].set(s,W._tickCounter),W._scheduleTickCounterIncrement()}for(const e of H.log.interceptors)if(e(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}}_parentWithMember(t,e){let i=this;for(;M(i);){const e=i[t];if(M(e))return e;i=i.parent}return e}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,e,...i){console[t](`[${e}]`,...i)}_matchLevel(t){return J[this._parentWithMember("level",H.log.level?H.log.level:"warn")]<=J[t]}_argsToKey(...t){return B(JSON.stringify(t,((t,e)=>"object"!=typeof e||Array.isArray(e)?e:"[Object]")))}static _scheduleTickCounterIncrement(){W._tickCounterScheduled||(W._tickCounterScheduled=!0,Promise.resolve().then((()=>{W._tickCounter++,W._tickCounterScheduled=!1})))}}W._loggers={},W._tickCounter=0,W._tickCounterScheduled=!1,W._throttlingDisabled=!1;const Y=W.getLogger("esri.core.Accessor");function X(t){return null==t?t:new Date(t)}function Q(t){return null==t?t:!!t}function K(t){return null==t?t:t.toString()}function Z(t){return null==t?t:(t=parseFloat(t),isNaN(t)?0:t)}function tt(t){return null==t?t:Math.round(parseFloat(t))}function et(t){return t&&t.constructor&&void 0!==t.constructor.__accessorMetadata__}function it(t,e){return null!=e&&t&&!(e instanceof t)}function st(t){return t&&"isCollection"in t}function rt(t){return t&&t.Type?"function"==typeof t.Type?t.Type:t.Type.base:null}function nt(t,e){return!!et(e)&&(Y.error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+lt(t)+"'"),!0)}function ot(t,e){return null==e?e:st(t)?function(t,e){if(!e||!e.constructor||!st(e.constructor))return nt(t,e)?e:new t(e);const i=rt(t.prototype.itemType),s=rt(e.constructor.prototype.itemType);return i?s?i===s?e:i.prototype.isPrototypeOf(s.prototype)?new t(e):(nt(t,e),e):new t(e):e}(t,e):it(t,e)?nt(t,e)?e:new t(e):e}function lt(t){return t&&t.prototype&&t.prototype.declaredClass||"unknown"}function at(t){switch(t){case Number:return Z;case mt:return tt;case Boolean:return Q;case String:return K;case Date:return X;default:return ot.bind(null,t)}}function ut(t,e){const i=at(t);return 1===arguments.length?i:i(e)}function ht(t,e,i){return 1===arguments.length?ht.bind(null,t):e?Array.isArray(e)?e.map((e=>t(e,i))):[t(e,i)]:e}function ct(t,e,i){return 0!==e&&Array.isArray(i)?i.map((i=>ct(t,e-1,i))):t(i)}function ft(t,e,i){if(2===arguments.length)return ft.bind(null,t,e);if(!i)return i;let s=e,r=i=ct(t,e,i);for(;s>0&&Array.isArray(r);)s--,r=r[0];if(void 0!==r)for(let t=0;t<s;t++)i=[i];return i}function dt(t){return!!Array.isArray(t)&&!t.some((e=>{const i=typeof e;return!("string"===i||"number"===i||"function"===i&&t.length>1)}))}function pt(t,e){if(2===arguments.length)return pt(t).call(null,e);const i=new Set,s=t.filter((t=>"function"!=typeof t)),r=t.filter((t=>"function"==typeof t));for(const e of t)"string"!=typeof e&&"number"!=typeof e||i.add(e);let n=null,o=null;return(t,e)=>{if(null==t)return t;const l=typeof t,a="string"===l||"number"===l;return a&&(i.has(t)||r.some((t=>"string"===l&&t===String||"number"===l&&t===Number)))||"object"===l&&r.some((e=>!it(t,e)))?t:(a&&s.length?(n||(n=s.map((t=>"string"==typeof t?`'${t}'`:`${t}`)).join(", ")),Y.error("Accessor#set",`'${t}' is not a valid value for this property, only the following values are valid: ${n}`)):"object"==typeof t&&r.length?(o||(o=r.map((t=>lt(t))).join(", ")),Y.error("Accessor#set",`'${t}' is not a valid value for this property, value must be one of ${o}`)):Y.error("Accessor#set",`'${t}' is not a valid value for this property`),e&&(e.valid=!1),null)}}function yt(t,e){if(2===arguments.length)return yt(t).call(null,e);const i={},s=[],r=[];for(const e in t.typeMap){const n=t.typeMap[e];i[e]=ut(n),s.push(lt(n)),r.push(e)}const n=()=>`'${s.join("', '")}'`,o=()=>`'${r.join("', '")}'`,l="string"==typeof t.key?e=>e[t.key]:t.key;return e=>{if(t.base&&!it(t.base,e))return e;if(null==e)return e;const s=l(e)||t.defaultKeyValue,r=i[s];if(!r)return Y.error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!it(t.typeMap[s],e))return e;if("string"==typeof t.key&&!et(e)){const i={};for(const s in e)s!==t.key&&(i[s]=e[s]);return r(i)}return r(e)}}class mt{}const vt={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function wt(t){switch(t.type){case"native":return ut(t.value);case"array":return ht(wt(t.value));case"one-of":return function(t){let e=null;return(i,s)=>gt(i,t)?i:(null==e&&(e=bt(t)),Y.error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),s&&(s.valid=!1),null)}(t);default:return null}}function bt(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case mt:return"integer";case Date:return"date";default:return lt(t.value)}case"array":return`array of ${bt(t.value)}`;case"one-of":{const e=t.values.map((t=>bt(t)));return`one of ${e.slice(0,e.length-1)} or ${e[e.length-1]}`}}return"unknown"}function gt(t,e){if(null==t)return!0;switch(e.type){case"native":switch(e.value){case Number:case mt:return"number"==typeof t;case Boolean:return"boolean"==typeof t;case String:return"string"==typeof t}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((t=>!gt(t,e.value)));case"one-of":return e.values.some((e=>gt(t,e)))}}function St(t){return function(t){return{remove:()=>{t&&(t(),t=void 0)}}}((()=>t.forEach((t=>M(t)&&t.remove()))))}function Mt(t){return t?t.__accessor__?t.__accessor__:t.propertyInvalidated?t:null:null}function xt(t,e,i){return kt(t,e,i?{policy:i,path:""}:null)}function kt(t,e,i){return e?Object.keys(e).reduce((function(t,s){let r=null,n="merge";if(i&&(r=i.path?`${i.path}.${s}`:s,n=i.policy(r)),"replace"===n)return t[s]=e[s],t;if(void 0===t[s])return t[s]=w(e[s]),t;let o=t[s],l=e[s];if(o===l)return t;if(Array.isArray(l)||Array.isArray(t))o=t[s]=o?Array.isArray(o)?o.concat():[o]:[],l&&(Array.isArray(l)||(l=[l]),l.forEach((t=>{-1===o.indexOf(t)&&o.push(t)})));else if(l&&"object"==typeof l)if(i){const e=i.path;i.path=r,t[s]=kt(o,l,i),i.path=e}else t[s]=kt(o,l,null);else t.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(t[s]=l);return t}),t||{}):t}function Ct(t){return Array.isArray(t)?t:t.split(".")}function It(t){return t.indexOf(",")>-1?t.split(",").map((t=>t.trim())):[t.trim()]}function Ot(t,e,i,s){const r=function(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...It(i));return e}return It(t)}(e);return 1!==r.length?St(r.map((e=>s(t,e,i)))):s(t,r[0],i)}function jt(t){let e=!1;return()=>{e||(e=!0,t())}}function Pt(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const s=Mt(e);return function(t,e){return null!=t&&t.metadatas&&null!=t.metadatas[e]}(s,i)?s.get(i):e[i]}function At(t,e,i){if(null==t)return t;const s=Pt(e[i],t);return!s&&i<e.length-1?void 0:i===e.length-1?s:At(s,e,i+1)}function Tt(t,e,i=0){return"string"==typeof e&&-1===e.indexOf(".")?Pt(e,t):At(t,Ct(e),i)}function Nt(t,e){return Tt(t,e)}function Rt(t,e){return void 0!==Tt(e,t)}class _t{constructor(t){this.autoDestroy=!1,this.properties=t}}function Et(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){const i=Object.create(e.properties),s=e.autoDestroy;for(const t in i)i[t]=w(i[t]);e=new _t(i),e.autoDestroy=s,Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e=new _t({}),Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Dt(t,e){const i=function(t){return Et(t).properties}(t);let s=i[e];return s||(s=i[e]={}),s}const $t=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function zt(t){return $t.test(t)?"replace":"merge"}function Ft(t,e,i){if(t&&e)if("object"==typeof e)for(const i of Object.getOwnPropertyNames(e))Ft(t,i,e[i]);else{if(-1!==e.indexOf(".")){const s=e.split("."),r=s.splice(s.length-1,1)[0];return void Ft(Nt(t,s),r,i)}t[e]=i}}W.getLogger("esri.core.accessorSupport.set");const Lt=W.getLogger("esri.core.accessorSupport.decorators.property");function Ut(t={}){return(e,i,s)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Dt(e,i);s&&(s.get||s.set?(r.get=s.get||r.get,r.set=s.set||r.set):"value"in s&&("value"in t&&Lt.warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),r.value=t.value=s.value)),null!=t.readOnly&&(r.readOnly=t.readOnly);const{aliasOf:n}=t;if(n){const t="string"==typeof n?n:n.source,e="string"==typeof n?null:!0===n.overridable;let s;r.dependsOn=[t],r.get=function(){let e=Nt(this,t);if("function"==typeof e){s||(s=t.split(".").slice(0,-1).join("."));const i=Nt(this,s);i&&(e=e.bind(i))}return e},r.readOnly||(r.set=e?function(t){void 0!==t?this._override(i,t):this._clearOverride(i)}:function(e){Ft(this,t,e)})}const o=t.type,l=t.types;r.cast||(o?r.cast=function(t){let e=0,i=t;if(function(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}(t))return wt(t);for(;Array.isArray(i)&&1===i.length&&"string"!=typeof i[0]&&"number"!=typeof i[0];)i=i[0],e++;const s=i;return dt(s)?0===e?pt(s):ft(pt(s),e):1===e?function(t,e){return 1===arguments.length?ht(ut.bind(null,t)):ht(ut.bind(null,t),e)}(s):e>1?function(t,e,i){return 2===arguments.length?ft(ut.bind(null,t),e):ft(ut.bind(null,t),e,i)}(s,e):t.from?t.from:ut(t)}(o):l&&(r.cast=Array.isArray(l)?ht(yt(l[0])):yt(l))),t.range&&(r.cast=Gt(r.cast,t.range)),function(t,e){xt(t,e,zt)}(r,t)}}function Vt(t,e,i){const s=Dt(t,i);s.json||(s.json={});let r=s.json;return void 0!==e&&(r.origins||(r.origins={}),r.origins[e]||(r.origins[e]={}),r=r.origins[e]),r}function Gt(t,e){return i=>{let s=+t(i);return null!=e.step&&(s=Math.round(s/e.step)*e.step),null!=e.min&&(s=Math.max(e.min,s)),null!=e.max&&(s=Math.min(e.max,s)),s}}class qt{constructor(t,e,i){var s;this.name=t,this.details=i,this.message=void 0,this instanceof qt&&(this.message=e&&(s=i,e.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(t,e){if(""===e)return"$";const i=$(e,s),r=null==i?"":i;if(void 0===r)throw new Error(`could not find key "${e}" in template`);return r.toString()})))||"")}toString(){return"["+this.name+"]: "+this.message}}class Bt extends qt{constructor(t,e,i){if(super(t,e,i),!(this instanceof Bt))return new Bt(t,e,i)}}function Ht(t){return!!t&&t.prototype&&t.prototype.declaredClass&&0===t.prototype.declaredClass.indexOf("esri.core.Collection")}Bt.prototype.type="warning";const Jt=W.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function Wt(t,e,i){var s,r;t&&(!i&&!e.read||null!=(s=e.read)&&s.reader||!1===(null==(r=e.read)?void 0:r.enabled)||function(t){return"types"in t?ee(t.types):te(t.type)}(t)&&z("read.reader",Yt(t),e))}function Yt(t){var e;const i=null!=(e=t.ndimArray)?e:0;if(i>1)return function(t){var e;const i=Xt(t),s=Qt.bind(null,i),r=null!=(e=t.ndimArray)?e:0;return(t,e,i)=>{if(null==t)return t;t=s(t,i,r);let n=r,o=t;for(;n>0&&Array.isArray(o);)n--,o=o[0];if(void 0!==o)for(let e=0;e<n;e++)t=[t];return t}}(t);if(1===i)return Kt(t);if("type"in t&&Zt(t.type)){var s,r;const e=null==(s=t.type.prototype)||null==(r=s.itemType)?void 0:r.Type,i=Kt("function"==typeof e?{type:e}:{types:e});return(e,s,r)=>{const n=i(e,s,r);return n?new t.type(n):n}}return Xt(t)}function Xt(t){return"type"in t?function(t){return t.prototype.read?(e,i,s)=>{if(null==e)return e;const r=typeof e;if("object"!==r)return void Jt.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${r}'`);const n=new t;return n.read(e,s),n}:t.fromJSON}(t.type):function(t){var e;let i=null;const s=null!=(e=t.errorContext)?e:"type";return(e,r,n)=>{if(null==e)return e;const o=typeof e;if("object"!==o)return void Jt.error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);i||(i=function(t){const e={};for(const r in t.typeMap){var i,s;const n=t.typeMap[r],o=Et(n.prototype);if("function"==typeof t.key)continue;const l=o.properties[t.key];if(!l)continue;null!=(i=l.json)&&i.type&&Array.isArray(l.json.type)&&1===l.json.type.length&&"string"==typeof l.json.type[0]&&(e[l.json.type[0]]=n);const a=null==(s=l.json)?void 0:s.write;if(!a||!a.writer){e[r]=n;continue}const u=a.target,h="string"==typeof u?u:t.key,c={};a.writer(r,c,h),c[h]&&(e[c[h]]=n)}return e}(t));const l=t.key;if("string"!=typeof l)return;const a=e[l],u=a?i[a]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!u){const t=`Type '${a||"unknown"}' is not supported`;return n&&n.messages&&e&&n.messages.push(new Bt(`${s}:unsupported`,t,{definition:e,context:n})),void Jt.error(t)}const h=new u;return h.read(e,n),h}}(t.types)}function Qt(t,e,i,s){return 0!==s&&Array.isArray(e)?e.map((e=>Qt(t,e,i,s-1))):t(e,void 0,i)}function Kt(t){const e=Xt(t);return(t,i,s)=>{if(null==t)return t;if(Array.isArray(t)){const i=[];for(const r of t){const t=e(r,void 0,s);void 0!==t&&i.push(t)}return i}const r=e(t,void 0,s);return void 0!==r?[r]:void 0}}function Zt(t){if(!Ht(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&("function"==typeof e.Type?te(e.Type):ee(e.Type))}function te(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||Zt(t))}function ee(t){for(const e in t.typeMap)if(!te(t.typeMap[e]))return!1;return!0}function ie(t){t.name&&(t.read&&"object"==typeof t.read?void 0===t.read.source&&(t.read.source=t.name):t.read={source:t.name},t.write&&"object"==typeof t.write?void 0===t.write.target&&(t.write.target=t.name):t.write={target:t.name})}function se(t){"boolean"==typeof t.read?t.read={enabled:t.read}:"function"==typeof t.read?t.read={enabled:!0,reader:t.read}:t.read&&"object"==typeof t.read&&void 0===t.read.enabled&&(t.read.enabled=!0)}function re(t){"boolean"==typeof t.write?t.write={enabled:t.write}:"function"==typeof t.write?t.write={enabled:!0,writer:t.write}:t.write&&"object"==typeof t.write&&void 0===t.write.enabled&&(t.write.enabled=!0)}function ne(t,e){var i;if(!e.write||e.write.writer||!1===e.write.enabled&&!e.write.overridePolicy)return;const s=null!=(i=null==t?void 0:t.ndimArray)?i:0;var r;e.write.writer=t&&(1===s||"type"in t&&Ht(t.type))?ue:s>1?(r=s,function(t,e,i,s){let n;if(null===t)n=null;else{n=he(t,s,r);let e=r,i=n;for(;e>0&&Array.isArray(i);)e--,i=i[0];if(void 0!==i)for(let t=0;t<e;t++)n=[n]}z(i,n,e)}):oe}function oe(t,e,i,s){z(i,le(t,s),e)}function le(t,e){return t&&"function"==typeof t.write?t.write({},e):t&&"function"==typeof t.toJSON?t.toJSON():"number"==typeof t?ae(t):t}function ae(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function ue(t,e,i,s){let r;null===t?r=null:t&&"function"==typeof t.map?(r=t.map((t=>le(t,s))),"function"==typeof r.toArray&&(r=r.toArray())):r=[le(t,s)],z(i,r,e)}function he(t,e,i){return 0!==i&&Array.isArray(t)?t.map((t=>he(t,e,i-1))):le(t,e)}function ce(t,e){return de(t,"read",e)}function fe(t,e){return de(t,"write",e)}function de(t,e,i){let s=t&&t.json;if(t&&t.json&&t.json.origins&&i){const r=t.json.origins[i.origin];r&&("any"===e||e in r)&&(s=r)}return s}const pe=[{processPrototypePropertyMetadata(t,e){(function(t){if(t.json||(t.json={}),se(t.json),re(t.json),ie(t.json),t.json.origins)for(const e in t.json.origins)se(t.json.origins[e]),re(t.json.origins[e]),ie(t.json.origins[e]);return!0})(e)&&(function(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const t in i)if(e[t]){const s=e[t];i[t].forEach((t=>{e[t]=s})),delete e[t]}}}(e),function(t){const e=function(t){return t.type?function(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!dt(i);)i=i[0],e++;return{type:i,ndimArray:e}}(t):function(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}(t)}(t);if(t.json.origins)for(const i in t.json.origins){const s=t.json.origins[i];Wt(e,s,!1),ne(e,s)}Wt(e,t.json,!0),ne(e,t.json)}(e))}}],ye=new Set,me=new Set;function ve(t){return e=>{e.prototype.declaredClass=t,function(t,e){for(const i of pe)if(i.processPrototypePropertyMetadata)for(const s in t)i.processPrototypePropertyMetadata(s,t[s],t,e)}(Et(e.prototype).properties,t),function(t){const e=t.prototype,i=e.declaredClass,s=Et(e).properties;!function(t,e){for(const i of pe)if(i.processClassPropertyMetadata)for(const s in t)i.processClassPropertyMetadata(s,t[s],t,e)}(s,i);const r={};for(const t of Object.getOwnPropertyNames(s)){const e=s[t];r[t]={enumerable:!0,configurable:!0,get:we(t,e),set(i){const s=this.__accessor__;if(void 0!==s){if(!Object.isFrozen(this)){if(s.initialized&&e.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${t}' of ${this.declaredClass}`);if(2===s.lifecycle&&e.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${t}' of ${this.declaredClass}`);s.set(t,i)}}else Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:i})}}}Object.defineProperties(t.prototype,r)}(e);const i=[],s=[];let r=e.prototype;for(;r;)r.hasOwnProperty("initialize")&&!ye.has(r.initialize)&&(ye.add(r.initialize),i.push(r.initialize)),r.hasOwnProperty("destroy")&&!me.has(r.destroy)&&(me.add(r.destroy),s.push(r.destroy)),r=Object.getPrototypeOf(r);ye.clear(),me.clear();class n extends e{constructor(...t){if(super(...t),this.constructor===n&&"function"==typeof this.postscript){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let t=i.length-1;t>=0;t--)i[t].call(this)}}),s.length){let t=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!t){t=!0;for(let t=0;t<s.length;t++)s[t].call(this)}}})}this.postscript(...t)}}}return n.__accessorMetadata__=Et(e.prototype),n.prototype.declaredClass=t,n}}function we(t,e){return null==e.get?function(){return this.__accessor__.getterStatic(t)}:function(){return this.__accessor__.getterComputed(t)}}function be(t,e,i){let s,r;return void 0===e?(r=t,s=[void 0]):"string"!=typeof e?(r=t,s=[void 0],i=e):(r=e,s=Array.isArray(t)?t:[t]),(t,e)=>{const n=t.constructor.prototype;s.forEach((s=>{const o=Vt(t,s,r);o.write&&"object"!=typeof o.write&&(o.write={}),i&&z("write.target",i,o),z("write.writer",n[e],o)}))}}class ge extends qt{constructor(t,e,i){if(super(t,e,i),!(this instanceof ge))return new ge(t,e,i)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,e)=>{if(e&&"object"==typeof e&&"function"==typeof e.toJSON)return e;try{return w(e)}catch(t){return"[object]"}})))}}catch(t){throw W.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new ge(t.name,t.message,t.details)}}ge.prototype.type="error";const Se=W.getLogger("esri.core.urlUtils"),Me=H.request,xe="esri/config: esriConfig.request.proxyUrl is not set.",ke=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Ce=/^\s*http:/i,Ie=/^\s*https:/i,Oe=/^\s*file:/i,je=/:\d+$/,Pe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Ae=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),Te=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class Ne{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=this.uri.match(Ae);this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=this.authority.match(Te),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null)}toString(){return this.uri}}const Re=new Ne(H.applicationUrl),_e={},Ee=(()=>{const t=Re.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${Re.scheme}://${Re.host}${null!=Re.port?`:${Re.port}`:""}${e}`})();function De(t){const e={path:null,query:null},i=new Ne(t),s=t.indexOf("?");return null===i.query?e.path=t:(e.path=t.substring(0,s),e.query=$e(i.query)),i.fragment&&(e.hash=i.fragment,null===i.query&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function $e(t){const e=t.split("&"),i={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let s,r;e<0?(s=decodeURIComponent(t),r=""):(s=decodeURIComponent(t.slice(0,e)),r=decodeURIComponent(t.slice(e+1)));let n=i[s];"string"==typeof n&&(n=i[s]=[n]),Array.isArray(n)?n.push(r):i[s]=r}return i}function ze(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}function Fe(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i])))).join("&"):Object.keys(t).map((i=>{const s=t[i];if(null==s)return"";const r=encodeURIComponent(i)+"=",n=e&&e[i];return n?r+encodeURIComponent(n(s)):Array.isArray(s)?s.map((t=>ze(t)?r+encodeURIComponent(JSON.stringify(t)):r+encodeURIComponent(t))).join("&"):ze(s)?r+encodeURIComponent(JSON.stringify(s)):r+encodeURIComponent(s)})).filter((t=>t)).join("&"):""}function Le(t=!1){let e,i=Me.proxyUrl;if("string"==typeof t){e=Ie.test(s=t)||"https"===Re.scheme&&ui(s);const r=Be(t);r&&(i=r.proxyUrl)}else e=!!t;var s;if(!i)throw Se.warn(xe),new ge("urlutils:proxy-not-set",xe);return e&&fi()&&(i=ci(i)),De(i)}function Ue(t){const e=Be(t);let i,s;if(e){const t=Ge(e.proxyUrl);i=t.path,s=t.query?$e(t.query):null}if(i){const e=De(t);t=i+"?"+e.path;const r=Fe({...s,...e.query});r&&(t=`${t}?${r}`)}return t}const Ve={path:"",query:""};function Ge(t){const e=t.indexOf("?");return-1!==e?(Ve.path=t.slice(0,e),Ve.query=t.slice(e+1)):(Ve.path=t,Ve.query=null),Ve}function qe(t){return(t=di(t=function(t){return t&&"/"===t[t.length-1]?t:`${t}/`}(t=Ge(t).path),!0)).toLowerCase()}function Be(t){const e=Me.proxyRules,i=qe(t);for(let t=0;t<e.length;t++)if(0===i.indexOf(e[t].urlPrefix))return e[t]}function He(t,e){return t=Je(t),e=Je(e),di(t)===di(e)}function Je(t){const e=(t=Ze(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function We(t,e,i=!1){const s=wi(t),r=wi(e);return!(!i&&s.scheme!==r.scheme)&&null!=s.host&&null!=r.host&&s.host.toLowerCase()===r.host.toLowerCase()&&s.port===r.port}function Ye(t){if("string"==typeof t){if(!ii(t))return!0;t=wi(t)}if(We(t,Re))return!0;const e=Me.trustedServers||[];for(let i=0;i<e.length;i++){const s=Xe(e[i]);for(let e=0;e<s.length;e++)if(We(t,s[e]))return!0}return!1}function Xe(t){return _e[t]||(_e[t]=hi(t)||ui(t)?[new Ne(Qe(t))]:[new Ne(`http://${t}`),new Ne(`https://${t}`)]),_e[t]}function Qe(t,e=Ee,i){return ui(t)?i&&i.preserveProtocolRelative?t:"http"===Re.scheme&&Re.authority===ei(t).slice(2)?`http:${t}`:`https:${t}`:hi(t)?t:ti("/"===t[0]?function(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return-1===i?t:t.slice(0,i)}(e):e,t)}function Ke(t,e=Ee,i){if(!ii(t))return t;const s=Ze(t),r=s.toLowerCase(),n=Ze(e).toLowerCase().replace(/\/+$/,""),o=i?Ze(i).toLowerCase().replace(/\/+$/,""):null;if(o&&0!==n.indexOf(o))return t;const l=(t,e,i)=>-1===(i=t.indexOf(e,i))?t.length:i;let a=l(r,"/",r.indexOf("//")+2),u=-1;for(;r.slice(0,a+1)===n.slice(0,a)+"/"&&(u=a+1,a!==r.length);)a=l(r,"/",a+1);if(-1===u)return t;if(o&&u<o.length)return t;t=s.slice(u);const h=n.slice(u-1).replace(/[^/]+/g,"").length;if(h>0)for(let e=0;e<h;e++)t=`../${t}`;else t=`./${t}`;return t}function Ze(t){return function(t){const e=Me.httpsDomains;if(!function(t){return Ce.test(t)||"http"===Re.scheme&&ui(t)}(t))return t;const i=t.indexOf("/",7);let s;if(s=-1===i?t:t.slice(0,i),s=s.toLowerCase().slice(7),je.test(s)){if(!s.endsWith(":80"))return t;s=s.slice(0,-3),t=t.replace(":80","")}return"http"!==Re.scheme||s!==Re.authority||Pe.test(t)?((fi()&&s===Re.authority||e&&e.some((t=>s===t||s.endsWith(`.${t}`)))||fi()&&!Be(t))&&(t=ci(t)),t):t}(t=function(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(t=function(t){if(/^https?:\/\//i.test(t)){const e=Ge(t);t=(t=e.path.replace(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}(t=Qe(t=t.trim()))))}function ti(...t){const e=t.filter(M);if(!e||!e.length)return;const i=[];if(ii(e[0])){const t=e[0],s=t.indexOf("//");-1!==s&&(i.push(t.slice(0,s+1)),Oe.test(e[0])&&(i[0]+="/"),e[0]=t.slice(s+2))}else"/"===e[0][0]&&i.push("");const s=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<s.length;t++){const e=s[t];".."===e&&i.length>0&&".."!==i[i.length-1]?i.pop():(!e&&t===s.length-1||e&&("."!==e||0===i.length))&&i.push(e)}return i.join("/")}function ei(t,e=!1){if(si(t)||ri(t))return null;let i=t.indexOf("://");if(-1===i&&ui(t))i=2;else{if(-1===i)return null;i+=3}const s=t.indexOf("/",i);return-1!==s&&(t=t.slice(0,s)),e&&(t=di(t,!0)),t}function ii(t){return ui(t)||hi(t)}function si(t){return null!=t&&"blob:"===t.slice(0,5)}function ri(t){return"data:"===t.slice(0,5)}function ni(t){const e=li(t);if(!e||!e.isBase64)return null;const i=atob(e.data),s=new Uint8Array(i.length);for(let t=0;t<i.length;t++)s[t]=i.charCodeAt(t);return s.buffer}const oi=/^data:(.*?)(;base64)?,(.*)$/;function li(t){const e=t.match(oi);if(!e)return null;const[,i,s,r]=e;return{mediaType:i,isBase64:!!s,data:r}}function ai(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function ui(t){return null!=t&&void 0!==t&&"/"===t[0]&&"/"===t[1]}function hi(t){return ke.test(t)}function ci(t){return ui(t)?`https:${t}`:t.replace(Ce,"https:")}function fi(){return"https"===Re.scheme}function di(t,e=!1){return ui(t)?t.slice(2):(t=t.replace(ke,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function pi(t){let e=0;if(ii(t)){const i=t.indexOf("//");-1!==i&&(e=i+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function yi(t,e){if(!t)return"";const i=De(t).path.replace(/\/+$/,""),s=i.substring(i.lastIndexOf("/")+1);if(null==e||!e.length)return s;const r=new RegExp(`.(${e.join("|")})$`,"ig");return s.replace(r,"")}function mi(t){return t.replace(/\/+$/,"")}function vi(t,e,i){if(!(e&&i&&t&&ii(t)))return t;const s=t.indexOf("//"),r=t.indexOf("/",s+2),n=t.indexOf(":",s+2),o=Math.min(r<0?t.length:r,n<0?t.length:n);return t.slice(s+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,s+2)}${i}${t.slice(o)}`}function wi(t){return"string"==typeof t?new Ne(Qe(t)):(t.scheme||(t.scheme=Re.scheme),t)}function bi(t,e){const i=De(t),s=Object.keys(i.query||{});return s.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${s.join(", ")}.`),i.path}function gi(t,e,i){const s=De(t),r=s.query||{};return r[e]=String(i),`${s.path}?${Fe(r)}`}function Si(t,e){const i=De(t),s=i.query||{};for(const t in e)s[t]=e[t];const r=Fe(s);return r?`${i.path}?${r}`:i.path}function Mi(t){if(x(t))return null;const e=t.match(xi);return e?e[1]:null}const xi=/.*?\.([^\/]*)$/;function ki(t){return Ci[function(t){return t instanceof Blob?t.type:function(t){const e=Mi(t);return ji[e]||Ii}(t.url)}(t)]||Oi}const Ci={},Ii="text/plain",Oi=Ci[Ii],ji={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const t in ji)Ci[ji[t]]=t;var Pi=function(t){return{setTimeout:(e,i)=>{const s=t.setTimeout(e,i);return{remove:()=>t.clearTimeout(s)}}}}(r);function Ai(t){return t&&("function"==typeof t.on||"function"==typeof t.addEventListener)}function Ti(t,e,i){if(!Ai(t))throw new TypeError("target is not a Evented or EventTarget object");if("on"in t)return t.on(e,i);if(Array.isArray(e)){const s=e.slice();for(const e of s)t.addEventListener(e,i);return{remove(){for(const e of s)t.removeEventListener(e,i)}}}return t.addEventListener(e,i),{remove(){t.removeEventListener(e,i)}}}function Ni(t,e,i){if(!Ai(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const s=Ti(t,e,(e=>{s.remove(),i.call(t,e)}));return{remove(){s.remove()}}}const Ri={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function _i({key:t}){return Ri[t]||t}function Ei(t){return Promise.all(t)}function Di(t){return new Promise(((e,i)=>{try{t(e,i)}catch(t){Promise.resolve().then((()=>i(t)))}}))}function $i(t="Aborted"){return new ge("AbortError",t)}function zi(){return new AbortController}function Fi(t){if(Ui(t))throw $i()}function Li(t){return M(t)?"aborted"in t?t:t.signal:t}function Ui(t){const e=Li(t);return M(e)&&e.aborted}function Vi(t){if(Ji(t))throw t}function Gi(t){if(!Ji(t))throw t}function qi(t,e){const i=Li(t);if(!x(i)){if(!i.aborted)return Ni(i,"abort",(()=>e()));e()}}function Bi(t,e){const i=Li(t);if(!x(i))return Fi(i),Ni(i,"abort",(()=>e($i())))}function Hi(t,e){return x(Li(e))?t:Di(((i,s)=>{let r=qi(e,(()=>s($i())));const n=()=>r=j(r);t.then(n,n),t.then(i,s)}))}function Ji(t){return t&&"AbortError"===t.name}function Wi(t){return t.catch((t=>{if(!Ji(t))throw t}))}function Yi(){let t=null;const e=Di(((e,i)=>{t={promise:void 0,resolve:e,reject:i}}));return t.promise=e,t}function Xi(t,e){if(!t)return;if("function"!=typeof t.forEach){const e=Object.keys(t);return Xi(e.map((e=>t[e]))).then((t=>{const i={};return e.forEach(((e,s)=>i[e]=t[s])),i}))}const i=t,s=ts;return Hi(Di((t=>{const e=[];let r=i.length;0===r&&t(e),i.forEach((i=>{const n={promise:i||s(i)};e.push(n),n.promise.then((t=>{n.value=t})).catch((t=>{n.error=t})).then((()=>{--r,0===r&&t(e)}))}))})),e)}function Qi(t){return t&&"function"==typeof t.then}function Ki(t){return t&&t.length?Di(((e,i)=>{for(const s of t)s.then(e,i)})):ts()}function Zi(t){return Promise.reject(t)}function ts(t){return Promise.resolve(t)}function es(t,e,i){const s=zi();return qi(i,(()=>s.abort())),Di(((i,r)=>{let n=setTimeout((()=>{n=0,i(e)}),t);qi(s,(()=>{n&&(clearTimeout(n),r($i()))}))}))}function is(t){return t&&"function"==typeof t.then}function ss(t){return t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then?t:ts(t)}function rs(t,e=-1){let i,s,r,n,o=null;const l=(...a)=>{if(i){s=a,n&&n.reject($i()),n=Yi();const t=n.promise;if(o){const t=o;o=null,t.abort()}return t}if(r=n||Yi(),n=null,e>0){const s=zi();i=ss(t(...a,s.signal));const r=i;es(e).then((()=>{i===r&&(n?s.abort():o=s)}))}else i=1,i=ss(t(...a));const u=()=>{const t=s;s=r=i=o=null,null!=t&&l(...t)},h=i,c=r;return h.then(u,u),h.then(c.resolve,c.reject),c.promise};return l}function ns(){let t,e;const i=Di(((i,s)=>{t=i,e=s})),s=e=>{t(e)};return s.resolve=e=>t(e),s.reject=t=>e(t),s.timeout=(t,e)=>Pi.setTimeout((()=>s.reject(e)),t),s.promise=i,s}W.getLogger("esri");const os=new Set;function ls(t,e,i={}){if(h("esri-deprecation-warnings")){const{moduleName:s}=i;as(t,"Property: "+(s?s+"::":"")+e,i)}}function as(t,e,i={}){if(h("esri-deprecation-warnings")){const{replacement:s,version:r,see:n,warnOnce:o}=i;let l=e;s&&(l+=`\n\t🛠️ Replacement: ${s}`),r&&(l+=`\n\t⚙️ Version: ${r}`),n&&(l+=`\n\t🔗 See ${n} for more details.`),function(t,e,i=!1){i&&os.has(e)||(i&&os.add(e),t.warn(`🛑 DEPRECATED - ${e}`))}(t,l,o)}}const us=7;function hs(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"user":return 6}}function cs(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"user"}}function fs(t){return cs(t)}class ds{constructor(t,e,i,s=1,r=0){if(this.ctor=t,this.acquireFunction=e,this.releaseFunction=i,this.allocationSize=s,this._pool=new Array(r),this._initialSize=r,this.ctor)for(let t=0;t<r;t++)this._pool[t]=new this.ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...t){let e;const i=this.ctor;if(ds.test.disabled)e=new i;else{if(0===this._pool.length){const t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new i}e=this._pool.pop()}return this.acquireFunction?this.acquireFunction(e,...t):function(t){return t&&t.acquire&&"function"==typeof t.acquire}(e)&&e.acquire(...t),e}release(t){t&&!ds.test.disabled&&(this.releaseFunction?this.releaseFunction(t):function(t){return t&&t.release&&"function"==typeof t.release}(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let e=t;e<this._pool.length;++e)this._dispose(this._pool[e]);this._pool.length=t}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose()}}ds.test={disabled:!1};let ps=!1;function ys(t){return void 0!==t.flags}class ms{constructor(t,e){this._observers=t,this._observer=e}remove(){this._observers.delete(this._observer)}}class vs{constructor(t,e){this.propertyName=t,this.metadata=e,this.flags=1,this._observers=null,this._accessedProperties=null,this._observationHandles=[],this.flags=1|(e.nonNullable?8:0)|(e.hasOwnProperty("value")?16:0)|(void 0===e.get?32:0)|(void 0===e.dependsOn?64:0)}destroy(){this._accessedProperties&&(this._accessedProperties.clear(),this._accessedProperties=null),this._observers&&(this._observers.clear(),this._observers=null),this._clearObservationHandles()}onPropertyAccessed(t){t!==this&&(null===this._accessedProperties&&(this._accessedProperties=new Set),this._accessedProperties.add(t))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=32;const t=this._accessedProperties;if(null===t)return;const e=this._observationHandles;for(const i of t)e.push(i.observe(this));t.clear()}observe(t){return null===this._observers&&(this._observers=new Set),new ms(this._observers.add(t),t)}notify(){2&~this.flags&&(this.flags|=1),this._notifyObservers()}invalidate(){this.notify()}commit(){this.flags&=-2,this._notifyObservers()}_notifyObservers(){if(null===this._observers)return;const t=this._observers.size,e=new Array(t);let i=t-1;for(const t of this._observers)e[i--]=t;const s=!ps;for(;e.length;){const t=e.pop();if(ys(t)){if(2&~t.flags&&(t.flags|=1),null===t._observers)continue;for(const i of t._observers)e.push(i)}else s&&t.notify()}}_clearObservationHandles(){for(const t of this._observationHandles)t.remove();this._observationHandles.length=0}}class ws{constructor(){this._values=new Map}clone(t){const e=new ws;return this._values.forEach(((i,s)=>{t&&t.has(s)||e.set(s,w(i))})),e}get(t){return this._values.get(t)}originOf(){return 6}keys(){return[...this._values.keys()]}set(t,e){this._values.set(t,e)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}let bs,gs=[];const Ss=W.getLogger("esri.core.Accessor");function Ms(t){void 0!==bs&&bs.onPropertyAccessed(t)}let xs=!1,ks=!1;function Cs(t,e,i){if(xs)return Is(t,e,i);Os(t);const s=e.call(i);return js(),s}function Is(t,e,i){const s=xs;xs=!0,Os(t);let r=null;try{r=e.call(i)}catch(t){ks&&Ss.error(t)}return js(),xs=s,r}function Os(t){bs=t,gs.push(t)}function js(){const t=gs.pop();bs=gs.length>0?gs[gs.length-1]:void 0,void 0!==t&&t.onTrackingEnd()}function Ps(t,e){if(32&e.flags)return;const i=ks;ks=!1,64&e.flags?Is(e,e.metadata.get,t):Ts(t,e),ks=i}const As=[];function Ts(t,e){128&e.flags||(e.flags|=128,Is(e,(()=>{const i=e.metadata.dependsOn||As;for(const e of i)if("string"==typeof e&&-1===e.indexOf("."))Ns(t,e,!1);else{const i=Ct(e);for(let e=0,s=t;e<i.length&&null!=s&&"object"==typeof s;++e)s=Ns(s,i[e],e!==i.length-1)}})),e.flags&=-129)}function Ns(t,e,i){const s="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(s,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const r=Mt(t),n=null==r?void 0:r.properties.get(s);return n&&(Ms(n),Ps(t,n)),i?t[s]:void 0}function Rs(t){return void 0!==t}function _s(t,e,i){return!(void 0===t||null==i&&8&t.flags)}W.getLogger("esri.core.accessorSupport.Properties");const Es=new ds(class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}});class Ds{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=0,this.store=new ws,this._origin=6;const e=this.host.constructor.__accessorMetadata__,i=e.properties;for(const t in i){const e=new vs(t,i[t]);this.properties.set(t,e)}this.metadatas=i,this._autoDestroy=e.autoDestroy}initialize(){this.lifecycle=1}constructed(){this.lifecycle=2}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[e,i]of this.properties){const s=this.internalGet(e);s&&(t=s)&&"function"==typeof t.destroy&&(s.destroy(),8&~i.flags&&this._internalSet(i,null)),i.destroy()}else for(const[t,e]of this.properties)e.destroy();var t}get initialized(){return 0!==this.lifecycle}get(t){return this.properties.get(t).metadata.get?this.getterComputed(t):this.getterStatic(t)}getterStatic(t){const e=this.properties.get(t);if(void 0!==e)return Ms(e),this.store.has(t)?this.store.get(t):e.metadata.value}getterComputed(t){const e=this.properties.get(t);Ms(e);const i=this.store,s=e.flags,r=this.store.get(t);if(4&s)return r;if(i.has(t)&&(1&~s||ps))return r;let n;e.flags|=4;const o=e.metadata.get;64&s?n=Cs(e,o,this.host):(Ts(this.host,e),n=o.call(this.host)),i.set(t,n,1);const l=this.store.get(t);return l===r?e.flags&=-2:e.commit(),e.flags&=-5,l}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.properties.get(t);if(void 0!==e&&16&e.flags)return"defaults"}return cs(e)}has(t){return!!this.properties.has(t)&&this.store.has(t)}keys(){return[...this.properties.keys()]}internalGet(t){const e=this.properties.get(t);if(Rs(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const i=this.properties.get(t);Rs(i)&&this._internalSet(i,e)}getDependsInfo(t,e,i,s){const r=this.properties.get(i);if(!Rs(r))return"";let n=`${s}${e}.${i}: ${Nt(t,i)}\n`;if(!r.metadata.dependsOn||0===r.metadata.dependsOn.length)return n;s+="  ";for(const e of r.metadata.dependsOn){const i=e.split(".");if(1===i.length)n+=`${s}${e}: ${Nt(t,e)}\n`;else{const r=i[i.length-1];--i.length;const o=i.join("."),l=Nt(t,o),a=Mt(l);n+=a?a.getDependsInfo(l,o,r,s):`${s}${e}: undefined\n`}}return n}setAtOrigin(t,e,i){const s=this.properties.get(t);if(Rs(s))return this._setAtOrigin(s,e,i)}isOverridden(t){const e=this.properties.get(t);return void 0!==e&&!!(2&e.flags)}clearOverride(t){const e=this.properties.get(t);void 0!==e&&2&e.flags&&(e.flags&=-3,e.invalidate())}override(t,e){const i=this.properties.get(t);if(!_s(i,0,e))return;const s=i.metadata.cast;if(s){const t=this._cast(s,e),{valid:i,value:r}=t;if(Es.release(t),!i)return;e=r}i.flags|=2,this._internalSet(i,e)}set(t,e){const i=this.properties.get(t);if(!_s(i,0,e))return;const s=i.metadata.cast;if(s){const t=this._cast(s,e),{valid:i,value:r}=t;if(Es.release(t),!i)return;e=r}const r=i.metadata.set;r?r.call(this.host,e):this._internalSet(i,e)}setDefaultOrigin(t){this._origin=hs(t)}getDefaultOrigin(){return cs(this._origin)}propertyInvalidated(t){const e=this.properties.get(t);void 0!==e&&e.invalidate()}propertyCommitted(t){const e=this.properties.get(t);void 0!==e&&e.commit()}_internalSet(t,e){this._setAtOrigin(t,e,0!==this.lifecycle?this._origin:0)}_setAtOrigin(t,e,i){const s=this.store,r=t.propertyName;s.has(r,i)&&b(e,s.get(r))&&2&~t.flags&&i===s.originOf(r)||(ps=!0,t.invalidate(),ps=!1,s.set(r,e,i),t.commit(),Ps(this.host,t))}_cast(t,e){const i=Es.acquire();return i.valid=!0,i.value=e,t&&(i.value=t.call(this.host,e,i)),i}}const $s=Array.prototype.splice;function zs(t){t.length=0}class Fs{constructor(t=50,e=50){this._pool=new ds(Array,void 0,zs,e,t)}acquire(){return this._pool.acquire()}copy(t){const e=this.acquire();return t.unshift(0,0),$s.apply(e,t),t.splice(0,2),e}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return Ls.acquire()}static copy(t){return Ls.copy(t)}static release(t){return Ls.release(t)}static prune(){Ls.prune()}}const Ls=new Fs(100),Us=r.queueMicrotask?r.queueMicrotask:t=>{r.Promise.resolve().then(t)},Vs=[];let Gs=[];function qs(t){Vs.push(t),1===Vs.length&&Us((()=>{for(const t of Gs)t();const t=Vs.slice();Vs.length=0;for(const e of t)e()}))}(qs||(qs={})).before=function(t){return Gs.push(t),{remove(){Gs=Gs.filter((e=>e!==t))}}};var Bs=qs;class Hs{constructor(t,e=29){this.name=t,this._counter=0,this._items=new Array(e)}record(t){this._items[++this._counter%this._items.length]=t}get median(){return this._items.slice().sort()[Math.floor(this._items.length/2)]}get average(){return this._items.reduce(((t,e)=>t+e),0)/this._items.length}get last(){return this._items[this._counter%this._items.length]}}class Js{constructor(t=1){this._seed=t}set seed(t){this._seed=null==t?Math.random()*Js._m:t}getInt(){return this._seed=(Js._a*this._seed+Js._c)%Js._m,this._seed}getFloat(){return this.getInt()/(Js._m-1)}getIntRange(t,e){return Math.round(this.getFloatRange(t,e))}getFloatRange(t,e){const i=e-t,s=this.getInt()/Js._m;return t+Math.floor(s*i)}}function Ws(t,e,i){return t&&e?t.filter(i?function(t){return e.findIndex((function(e){return i(t,e)}))>-1}:function(t){return e.indexOf(t)>-1}):[]}Js._m=2147483647,Js._a=48271,Js._c=0;const Ys=!!Array.prototype.fill;function Xs(t,e){if(Ys)return new Array(t).fill(e);const i=new Array(t);for(let s=0;s<t;s++)i[s]=e;return i}function Qs(t,e){void 0===e&&(e=t,t=0);const i=new Array(e-t);for(let s=t;s<e;s++)i[s-t]=s;return i}class Ks{constructor(){this.last=0}}const Zs=new Ks;function tr(t,e,i,s){s=s||Zs;const r=Math.max(0,s.last-10);for(let n=r;n<i;++n)if(t[n]===e)return s.last=n,n;const n=Math.min(r,i);for(let i=0;i<n;++i)if(t[i]===e)return s.last=i,i;return-1}function er(t,e,i,s){const r=null==i?t.length:i,n=tr(t,e,r,s);if(-1!==n)return t[n]=t[r-1],null==i&&t.pop(),e}const ir=new Set;var sr;!function(t){function e(t,e,i,s){let r=e,n=e;const o=i>>>1,l=t[r-1];for(;n<=o;){n=r<<1,n<i&&s(t[n-1],t[n])<0&&++n;const e=t[n-1];if(s(e,l)<=0)break;t[r-1]=e,r=n}t[r-1]=l}function i(t,e){return t<e?-1:t>e?1:0}t.sort=function(t,s,r,n){void 0===s&&(s=0),void 0===r&&(r=t.length),void 0===n&&(n=i);for(let i=r>>>1;i>s;i--)e(t,i,r,n);const o=s+1;for(let i=r-1;i>s;i--){const r=t[s];t[s]=t[i],t[i]=r,e(t,o,i,n)}},t.iterableSort=function*(t,s,r,n){void 0===s&&(s=0),void 0===r&&(r=t.length),void 0===n&&(n=i);for(let i=r>>>1;i>s;i--)e(t,i,r,n),yield;const o=s+1;for(let i=r-1;i>s;i--){const r=t[s];t[s]=t[i],t[i]=r,e(t,o,i,n),yield}}}(sr||(sr={}));var rr=sr;class nr{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Ks,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>{this.data.length>1.5*this.length&&(this.data.length=Math.floor(1.1*this.length))}))}toArray(){return this.data.slice(0,this.length)}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let e=t;e<this._length;++e)this.data[e]=this._deallocator(this.data[e]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,e=t.length){for(let i=0;i<e;i++)this.data[this._length++]=t[i]}fill(t,e){for(let i=0;i<e;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}*iterableRemoveMany(t){const e=new Array;for(let i=0;i<this.length&&!(i>=this.length);++i)tr(t.data,this.data[i],t.length,t._hint)<0&&e.push(this.data[i]),yield;this.data=e,this._length=this.data.length}remove(t){const e=tr(this.data,t,this.length,this._hint);if(-1!==e)return this.data.splice(e,1),this.length=this.length-1,t}removeUnordered(t){const e=er(this.data,t,this.length,this._hint);return void 0!==e&&(this.length=this.length-1),e}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,e=t.length,i){this.length=function(t,e,i=t.length,s=e.length,r,n){if(0===s||0===i)return i;ir.clear();for(let t=0;t<s;++t)ir.add(e[t]);r=r||Zs;const o=Math.max(0,r.last-10);for(let e=o;e<i;++e)if(ir.has(t[e])&&(n&&n.push(t[e]),ir.delete(t[e]),t[e]=t[i-1],--i,--e,0===ir.size||0===i))return ir.clear(),i;for(let e=0;e<o;++e)if(ir.has(t[e])&&(n&&n.push(t[e]),ir.delete(t[e]),t[e]=t[i-1],--i,--e,0===ir.size||0===i))return ir.clear(),i;return ir.clear(),i}(this.data,t,this.length,e,this._hint,i)}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,e){t>=this.length||e>=this.length||t===e||([this.data[t],this.data[e]]=[this.data[e],this.data[t]])}sort(t){rr.sort(this.data,0,this.length,t)}iterableSort(t){return rr.iterableSort(this.data,0,this.length,t)}some(t,e){for(let i=0;i<this.length;++i)if(t.call(e,this.data[i],i,this.data))return!0;return!1}filterInPlace(t,e){let i=0;for(let s=0;s<this._length;++s){const r=this.data[s];t.call(e,r,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=r,i++)}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this}forAll(t,e){const i=this.length,s=this.data;for(let r=0;r<i;++r)t.call(e,s[r],r,s)}*iterableForEach(){for(let t=0;t<this.length;++t)yield this.data[t]}map(t,e){const i=new Array(this.length);for(let s=0;s<this.length;++s)i[s]=t.call(e,this.data[s],s,this.data);return i}reduce(t,e){let i=e;for(let e=0;e<this.length;++e)i=t(i,this.data[e],e,this.data);return i}}class or{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let lr=-1;const ar={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},ur=["prepare","preRender","render","postRender","update"],hr=[],cr=new nr,fr={frameTasks:cr,rafId:null,requestNextFrame:null,willDispatch:!1,clearFrameTasks:function(t=!1){cr.forAll((t=>{t.removed=!0})),t&&yr()},dispatch:mr,executeFrameTasks:function(t=performance.now()){lr<0&&(lr=t);const e=t-lr,i=1e3/60,s=Math.max(0,e-i);lr=t;const r=performance.now();for(let r=0;r<ur.length;r++){const n=performance.now(),o=ur[r];cr.forAll((n=>{var l;n.paused||n.removed||(0===r&&n.ticks++,n.phases[o]&&(ar.time=t,ar.deltaTime=0===n.ticks?0:e,ar.elapsedFrameTime=performance.now()-t,ar.frameDuration=i-s,null==(l=n.phases[o])||l.call(n,ar)))})),wr[r].record(performance.now()-n)}yr(),br.record(performance.now()-r)}};function dr(t){const e=new or(t);return hr.push(e),fr.willDispatch||(fr.willDispatch=!0,Bs(mr)),e}const pr=new nr;function yr(){cr.forAll((t=>{t.removed&&pr.push(t)})),cr.removeUnorderedMany(pr.data,pr.length),pr.clear()}function mr(){for(;hr.length;){const t=hr.shift();t.isActive&&t.callback()}fr.willDispatch=!1}function vr(t=1,e){const i=ns(),s=()=>{Ui(e)?i.reject($i()):0===t?i():(--t,Bs((()=>s())))};return s(),i.promise}const wr=ur.map((t=>new Hs(t))),br=new Hs("total");class gr{constructor(t){this.notify=t,this._accessedProperties=new Set,this._observationHandles=[]}destroy(){this._accessedProperties.clear(),this.clearObservationHandles()}onPropertyAccessed(t){this._accessedProperties.add(t)}onTrackingEnd(){this._accessedProperties.forEach((t=>{this._observationHandles.push(t.observe(this))})),this._accessedProperties.clear()}clearObservationHandles(){for(const t of this._observationHandles)t.remove();this._observationHandles.length=0}}function Sr(t,e){let i=new gr((function(){if(!i||r)return;const n=s;i.clearObservationHandles(),r=!0,s=Cs(i,t),r=!1,e(n,s)})),s=null,r=!1;return r=!0,s=Cs(i,t),r=!1,{remove:function(){i&&(i.destroy(),i=null,s=null)}}}class Mr{constructor(){this.uid=0,this.target=null,this.path=null,this.oldValue=null,this.callback=null,this.getValue=null,this.removed=!1,this.propertyPath=null}acquire(t,e,i,s,r){this.target=t,this.path=e,this.oldValue=i,this.callback=s,this.getValue=r,this.propertyPath=function(t){return t?"string"==typeof t&&-1===t.indexOf(".")?t:Ct(t):t}(e),this.uid=++Mr.uid,this.removed=!1}release(){this.target=this.path=this.propertyPath=this.callback=this.oldValue=null,this.uid=++Mr.uid,this.removed=!0}}Mr.pool=new class extends ds{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const e=super.acquire(...t);return this._set.delete(e),e}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}(Mr),Mr.uid=0;const xr=new Fs,kr=new Set;let Cr,Ir=xr.acquire();function Or(t){kr.has(t)?Ir.splice(Ir.indexOf(t),1):kr.add(t),Ir.push(t),Cr||(Cr=dr(Ar))}function jr(t){if(t.removed)return;const{callback:e,path:i,oldValue:s,target:r}=t,n=t.getValue();Pr(s,n)&&(t.oldValue=n,e.call(r,n,s,i,r))}function Pr(t,e){return!b(t,e)}function Ar(){let t=10;for(;Cr&&t--;){Cr=null;const t=Ir;Ir=xr.acquire(),kr.clear();const e=xr.acquire();for(const i of t){const t=i.uid;jr(i),t===i.uid&&i.removed&&e.push(i)}for(let t=0;t<Ir.length;t++){const i=Ir[t];i.removed&&(e.push(i),kr.delete(i),Ir.splice(t,1),t-=1)}for(let t=0;t<e.length;t++)Mr.pool.release(e[t]);xr.release(t),xr.release(e),Tr.forEach((t=>t()))}}const Tr=new Set;function Nr(t){if(null==t)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor&&t.constructor.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}class Rr{constructor(...t){if(this.constructor===Rr)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new Ds(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t))}static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:e,declaredClass:i,constructor:s}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const r=this;class n extends r{constructor(...t){super(...t),this.inherited=null,s&&s.apply(this,t)}}Et(n.prototype);for(const e in t){const i=t[e];n.prototype[e]="function"==typeof i?function(...t){const s=this.inherited;let n;this.inherited=function(...t){if(r.prototype[e])return r.prototype[e].apply(this,t)};try{n=i.apply(this,t)}catch(t){throw this.inherited=s,t}return this.inherited=s,n}:t[e]}for(const t in e)Ut(Nr(e[t]))(n.prototype,t);return ve(i)(n)}postscript(t){const e=this.__accessor__,i=e.ctorArgs||t;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize()}initialize(){}destroy(){this.destroyed||(function(t){for(let e=0;e<Ir.length;e++){const i=Ir[e];i.target===t&&(i.removed=!0)}}(this),this.__accessor__.destroy())}get initialized(){return this.__accessor__&&this.__accessor__.initialized||!1}get constructed(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}get(t){return Nt(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}isInstanceOf(t){return function(t,e,i={}){if(h("esri-deprecation-warnings")){const{moduleName:s}=i;as(t,"Function: "+(s?s+"::":"")+e+"()",i)}}(W.getLogger(this.declaredClass),"isInstanceOf",{replacement:"Use instanceof directly",version:"4.16"}),this instanceof t}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,e){return Ft(this,t,e),this}watch(t,e,i){return function(t,e,i,s=!1){return!t.__accessor__||t.__accessor__.destroyed?{remove(){}}:s?function(t,e,i){const s=Ot(t,e,i,((t,e,i)=>{let r=!1;return Sr((()=>Tt(t,e)),((n,o)=>{t.__accessor__.destroyed?s.remove():r||(r=!0,Pr(n,o)&&i.call(t,o,n,e,t),r=!1)}))}));return s}(t,e,i):function(t,e,i){let s=Ot(t,e,i,((t,e,i)=>{let r,n,o=function(t,e){let i=new gr((function(){e(s,r)})),s=null;function r(){return i?(i.clearObservationHandles(),s=Cs(i,t),s):null}return r(),{remove:function(){i&&(i.destroy(),i=null),s=null}}}((()=>Tt(t,e)),((o,l)=>{t.__accessor__.destroyed||r&&r.uid!==n?s.remove():(r||(r=Mr.pool.acquire(t,e,o,i,l),n=r.uid),Or(r))}));return{remove:jt((function(){o.remove(),r&&(r.uid!==n||r.removed||(r.removed=!0,Or(r)),r=null),s=o=null}))}}));return s}(t,e,i)}(this,t,e,i)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_override(t,e){return this.__accessor__.override(t,e)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.propertyInvalidated(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,e){return this.__accessor__.internalSet(t,e),this}}function _r(t,e,i){if(!t||!t.read||!1===t.read.enabled||!t.read.source)return!1;const s=t.read.source;if("string"==typeof s){if(s===e)return!0;if(s.indexOf(".")>-1&&0===s.indexOf(e)&&Rt(s,i))return!0}else for(const t of s){if(t===e)return!0;if(t.indexOf(".")>-1&&0===t.indexOf(e)&&Rt(t,i))return!0}return!1}function Er(t,e,i,s,r){let n=ce(e[i],r);(function(t){return t&&(!t.read||!1!==t.read.enabled&&!t.read.source)})(n)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))n=ce(e[o],r),_r(n,i,s)&&(t[o]=!0)}function Dr(t,e,i,s){const r=de(i.metadatas[e],"any",s),n=r&&r.default;if(void 0===n)return;const o="function"==typeof n?n.call(t,e,s):n;void 0!==o&&i.set(e,o)}const $r={origin:"service"};function zr(t,e,i=$r){if(!e||"object"!=typeof e)return;const s=Mt(t),r=s.metadatas,n={};for(const t of Object.getOwnPropertyNames(e))Er(n,r,t,e,i);s.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(n)){const n=ce(r[o],i).read,l=n&&n.source;let a;a=l&&"string"==typeof l?Tt(e,l):e[o],n&&n.reader&&(a=n.reader.call(t,a,e,i)),void 0!==a&&s.set(o,a)}if(!i||!i.ignoreDefaults)for(const e of Object.getOwnPropertyNames(r))n[e]||Dr(t,e,s,i);s.setDefaultOrigin("user")}function Fr(t,e,i,s=$r){var r;const n={...s,messages:[]};i(n),null==(r=n.messages)||r.forEach((e=>{"warning"!==e.type||t.loaded?s&&s.messages&&s.messages.push(e):t.loadWarnings.push(e)}))}const Lr=W.getLogger("esri.core.accessorSupport.write");function Ur(t,e,i,s,r){var n,o;const l={};return null==(n=e.write)||null==(o=n.writer)||o.call(t,s,l,i,r),l}function Vr(t,e,i,s,r,n){if(!s||!s.write)return!1;const o=t.get(i);if(!r&&s.write.overridePolicy){const e=s.write.overridePolicy.call(t,o,i,n);void 0!==e&&(r=e)}if(r||(r=s.write),!r||!1===r.enabled)return!1;if((null===o&&!r.allowNull||void 0===o)&&r.isRequired){const e=new ge("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return e&&n&&n.messages?n.messages.push(e):e&&!n&&Lr.error(e.name,e.message),!1}return!(void 0===o||null===o&&!r.allowNull||function(t,e,i,s,r){const n=s.default;return void 0!==n&&(null!=s.defaultEquals?s.defaultEquals(r):"function"==typeof n?!!Array.isArray(r)&&function(t,e){if(!t&&!e)return!0;if(!t||!e||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(n.call(t,e,i),r):n===r)}(t,i,n,s,o)||void 0===s.default&&!r.ignoreOrigin&&n&&n.origin&&e.store.originOf(i)<hs(n.origin))}function Gr(t,e,i,s){const r=Mt(t),n=fe(r.metadatas[e],s);return!!n&&Vr(t,r,e,n,i,s)}function qr(t,e,i){if(t&&"function"==typeof t.toJSON&&(!t.toJSON.isDefaultToJSON||!t.write))return xt(e,t.toJSON());const s=Mt(t),r=s.metadatas;for(const n in r){const o=fe(r[n],i);if(!Vr(t,s,n,o,void 0,i))continue;const l=t.get(n),a=Ur(t,o,o.write&&"string"==typeof o.write.target?o.write.target:n,l,i);Object.keys(a).length>0&&(e=xt(e,a),i&&i.resources&&i.resources.pendingOperations&&i.resources.pendingOperations.length&&Ei(i.resources.pendingOperations).then((()=>xt(e,a))),i&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:n,oldOrigin:fs(s.store.originOf(n)),newOrigin:i.origin}))}return e}const Br=t=>{let e=class extends t{constructor(...t){super(...t)}read(t,e){zr(this,t,e)}write(t={},e){return qr(this,t,e)}toJSON(t){return this.write({},t)}static fromJSON(t,e){return Hr.call(this,t,e)}};return e=s([ve("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function Hr(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let Jr,Wr=class extends(Br(Rr)){};Wr=s([ve("esri.core.JSONSupport")],Wr);const Yr={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9367:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(Jr=2e3;Jr<=2045;Jr++)Yr[Jr]=0;for(Jr=2056;Jr<=2065;Jr++)Yr[Jr]=0;for(Jr=2067;Jr<=2135;Jr++)Yr[Jr]=0;for(Jr=2137;Jr<=2154;Jr++)Yr[Jr]=0;for(Jr=2161;Jr<=2170;Jr++)Yr[Jr]=0;for(Jr=2172;Jr<=2193;Jr++)Yr[Jr]=0;for(Jr=2195;Jr<=2198;Jr++)Yr[Jr]=0;for(Jr=2200;Jr<=2203;Jr++)Yr[Jr]=0;for(Jr=2205;Jr<=2217;Jr++)Yr[Jr]=0;for(Jr=2222;Jr<=2224;Jr++)Yr[Jr]=1;for(Jr=2225;Jr<=2250;Jr++)Yr[Jr]=2;for(Jr=2251;Jr<=2253;Jr++)Yr[Jr]=1;for(Jr=2257;Jr<=2264;Jr++)Yr[Jr]=2;for(Jr=2274;Jr<=2279;Jr++)Yr[Jr]=2;for(Jr=2280;Jr<=2282;Jr++)Yr[Jr]=1;for(Jr=2283;Jr<=2289;Jr++)Yr[Jr]=2;for(Jr=2290;Jr<=2292;Jr++)Yr[Jr]=0;for(Jr=2308;Jr<=2313;Jr++)Yr[Jr]=0;for(Jr=2315;Jr<=2491;Jr++)Yr[Jr]=0;for(Jr=2494;Jr<=2866;Jr++)Yr[Jr]=0;for(Jr=2867;Jr<=2869;Jr++)Yr[Jr]=1;for(Jr=2870;Jr<=2888;Jr++)Yr[Jr]=2;for(Jr=2891;Jr<=2895;Jr++)Yr[Jr]=2;for(Jr=2896;Jr<=2898;Jr++)Yr[Jr]=1;for(Jr=2902;Jr<=2908;Jr++)Yr[Jr]=2;for(Jr=2915;Jr<=2920;Jr++)Yr[Jr]=2;for(Jr=2921;Jr<=2923;Jr++)Yr[Jr]=1;for(Jr=2924;Jr<=2930;Jr++)Yr[Jr]=2;for(Jr=2931;Jr<=2962;Jr++)Yr[Jr]=0;for(Jr=2964;Jr<=2968;Jr++)Yr[Jr]=2;for(Jr=2969;Jr<=2973;Jr++)Yr[Jr]=0;for(Jr=2975;Jr<=2991;Jr++)Yr[Jr]=0;for(Jr=2995;Jr<=3051;Jr++)Yr[Jr]=0;for(Jr=3054;Jr<=3079;Jr++)Yr[Jr]=0;for(Jr=3081;Jr<=3088;Jr++)Yr[Jr]=0;for(Jr=3092;Jr<=3101;Jr++)Yr[Jr]=0;for(Jr=3106;Jr<=3138;Jr++)Yr[Jr]=0;for(Jr=3146;Jr<=3151;Jr++)Yr[Jr]=0;for(Jr=3153;Jr<=3166;Jr++)Yr[Jr]=0;for(Jr=3168;Jr<=3172;Jr++)Yr[Jr]=0;for(Jr=3174;Jr<=3203;Jr++)Yr[Jr]=0;for(Jr=3294;Jr<=3358;Jr++)Yr[Jr]=0;for(Jr=3367;Jr<=3403;Jr++)Yr[Jr]=0;for(Jr=3408;Jr<=3416;Jr++)Yr[Jr]=0;for(Jr=3417;Jr<=3438;Jr++)Yr[Jr]=2;for(Jr=3441;Jr<=3446;Jr++)Yr[Jr]=2;for(Jr=3447;Jr<=3450;Jr++)Yr[Jr]=0;for(Jr=3451;Jr<=3459;Jr++)Yr[Jr]=2;for(Jr=3460;Jr<=3478;Jr++)Yr[Jr]=0;for(Jr=3554;Jr<=3559;Jr++)Yr[Jr]=0;for(Jr=3560;Jr<=3570;Jr++)Yr[Jr]=2;for(Jr=3571;Jr<=3581;Jr++)Yr[Jr]=0;for(Jr=3594;Jr<=3597;Jr++)Yr[Jr]=0;for(Jr=3601;Jr<=3604;Jr++)Yr[Jr]=0;for(Jr=3637;Jr<=3639;Jr++)Yr[Jr]=0;for(Jr=3665;Jr<=3667;Jr++)Yr[Jr]=0;for(Jr=3693;Jr<=3695;Jr++)Yr[Jr]=0;for(Jr=3701;Jr<=3727;Jr++)Yr[Jr]=0;for(Jr=3728;Jr<=3739;Jr++)Yr[Jr]=2;for(Jr=3740;Jr<=3751;Jr++)Yr[Jr]=0;for(Jr=3753;Jr<=3760;Jr++)Yr[Jr]=2;for(Jr=3761;Jr<=3773;Jr++)Yr[Jr]=0;for(Jr=3775;Jr<=3777;Jr++)Yr[Jr]=0;for(Jr=3779;Jr<=3781;Jr++)Yr[Jr]=0;for(Jr=3783;Jr<=3785;Jr++)Yr[Jr]=0;for(Jr=3788;Jr<=3791;Jr++)Yr[Jr]=0;for(Jr=3797;Jr<=3802;Jr++)Yr[Jr]=0;for(Jr=3814;Jr<=3816;Jr++)Yr[Jr]=0;for(Jr=3825;Jr<=3829;Jr++)Yr[Jr]=0;for(Jr=3832;Jr<=3841;Jr++)Yr[Jr]=0;for(Jr=3844;Jr<=3852;Jr++)Yr[Jr]=0;for(Jr=3873;Jr<=3885;Jr++)Yr[Jr]=0;for(Jr=3890;Jr<=3893;Jr++)Yr[Jr]=0;for(Jr=3907;Jr<=3912;Jr++)Yr[Jr]=0;for(Jr=3942;Jr<=3950;Jr++)Yr[Jr]=0;for(Jr=3968;Jr<=3970;Jr++)Yr[Jr]=0;for(Jr=3973;Jr<=3976;Jr++)Yr[Jr]=0;for(Jr=3986;Jr<=3989;Jr++)Yr[Jr]=0;for(Jr=3994;Jr<=3997;Jr++)Yr[Jr]=0;for(Jr=4048;Jr<=4051;Jr++)Yr[Jr]=0;for(Jr=4056;Jr<=4063;Jr++)Yr[Jr]=0;for(Jr=4093;Jr<=4096;Jr++)Yr[Jr]=0;for(Jr=4390;Jr<=4398;Jr++)Yr[Jr]=0;for(Jr=4399;Jr<=4413;Jr++)Yr[Jr]=2;for(Jr=4418;Jr<=4433;Jr++)Yr[Jr]=2;for(Jr=4455;Jr<=4457;Jr++)Yr[Jr]=2;for(Jr=4484;Jr<=4489;Jr++)Yr[Jr]=0;for(Jr=4491;Jr<=4554;Jr++)Yr[Jr]=0;for(Jr=4568;Jr<=4589;Jr++)Yr[Jr]=0;for(Jr=4652;Jr<=4656;Jr++)Yr[Jr]=0;for(Jr=4766;Jr<=4800;Jr++)Yr[Jr]=0;for(Jr=5014;Jr<=5016;Jr++)Yr[Jr]=0;for(Jr=5069;Jr<=5072;Jr++)Yr[Jr]=0;for(Jr=5105;Jr<=5130;Jr++)Yr[Jr]=0;for(Jr=5173;Jr<=5188;Jr++)Yr[Jr]=0;for(Jr=5253;Jr<=5259;Jr++)Yr[Jr]=0;for(Jr=5269;Jr<=5275;Jr++)Yr[Jr]=0;for(Jr=5292;Jr<=5311;Jr++)Yr[Jr]=0;for(Jr=5329;Jr<=5331;Jr++)Yr[Jr]=0;for(Jr=5343;Jr<=5349;Jr++)Yr[Jr]=0;for(Jr=5355;Jr<=5357;Jr++)Yr[Jr]=0;for(Jr=5387;Jr<=5389;Jr++)Yr[Jr]=0;for(Jr=5459;Jr<=5463;Jr++)Yr[Jr]=0;for(Jr=5479;Jr<=5482;Jr++)Yr[Jr]=0;for(Jr=5518;Jr<=5520;Jr++)Yr[Jr]=0;for(Jr=5530;Jr<=5539;Jr++)Yr[Jr]=0;for(Jr=5550;Jr<=5552;Jr++)Yr[Jr]=0;for(Jr=5562;Jr<=5583;Jr++)Yr[Jr]=0;for(Jr=5623;Jr<=5625;Jr++)Yr[Jr]=2;for(Jr=5631;Jr<=5639;Jr++)Yr[Jr]=0;for(Jr=5649;Jr<=5653;Jr++)Yr[Jr]=0;for(Jr=5663;Jr<=5680;Jr++)Yr[Jr]=0;for(Jr=5682;Jr<=5685;Jr++)Yr[Jr]=0;for(Jr=5875;Jr<=5877;Jr++)Yr[Jr]=0;for(Jr=5896;Jr<=5899;Jr++)Yr[Jr]=0;for(Jr=5921;Jr<=5940;Jr++)Yr[Jr]=0;for(Jr=6050;Jr<=6125;Jr++)Yr[Jr]=0;for(Jr=6244;Jr<=6275;Jr++)Yr[Jr]=0;for(Jr=6328;Jr<=6348;Jr++)Yr[Jr]=0;for(Jr=6350;Jr<=6356;Jr++)Yr[Jr]=0;for(Jr=6366;Jr<=6372;Jr++)Yr[Jr]=0;for(Jr=6381;Jr<=6387;Jr++)Yr[Jr]=0;for(Jr=6393;Jr<=6404;Jr++)Yr[Jr]=0;for(Jr=6480;Jr<=6483;Jr++)Yr[Jr]=0;for(Jr=6511;Jr<=6514;Jr++)Yr[Jr]=0;for(Jr=6579;Jr<=6581;Jr++)Yr[Jr]=0;for(Jr=6619;Jr<=6624;Jr++)Yr[Jr]=0;for(Jr=6625;Jr<=6627;Jr++)Yr[Jr]=2;for(Jr=6628;Jr<=6632;Jr++)Yr[Jr]=0;for(Jr=6634;Jr<=6637;Jr++)Yr[Jr]=0;for(Jr=6669;Jr<=6692;Jr++)Yr[Jr]=0;for(Jr=6707;Jr<=6709;Jr++)Yr[Jr]=0;for(Jr=6720;Jr<=6723;Jr++)Yr[Jr]=0;for(Jr=6732;Jr<=6738;Jr++)Yr[Jr]=0;for(Jr=6931;Jr<=6933;Jr++)Yr[Jr]=0;for(Jr=6956;Jr<=6959;Jr++)Yr[Jr]=0;for(Jr=7005;Jr<=7007;Jr++)Yr[Jr]=0;for(Jr=7057;Jr<=7070;Jr++)Yr[Jr]=2;for(Jr=7074;Jr<=7082;Jr++)Yr[Jr]=0;for(Jr=7109;Jr<=7118;Jr++)Yr[Jr]=0;for(Jr=7119;Jr<=7127;Jr++)Yr[Jr]=1;for(Jr=7374;Jr<=7376;Jr++)Yr[Jr]=0;for(Jr=7528;Jr<=7586;Jr++)Yr[Jr]=0;for(Jr=7587;Jr<=7645;Jr++)Yr[Jr]=2;for(Jr=7692;Jr<=7696;Jr++)Yr[Jr]=0;for(Jr=7755;Jr<=7787;Jr++)Yr[Jr]=0;for(Jr=7791;Jr<=7795;Jr++)Yr[Jr]=0;for(Jr=7799;Jr<=7801;Jr++)Yr[Jr]=0;for(Jr=7803;Jr<=7805;Jr++)Yr[Jr]=0;for(Jr=7825;Jr<=7831;Jr++)Yr[Jr]=0;for(Jr=7845;Jr<=7859;Jr++)Yr[Jr]=0;for(Jr=8013;Jr<=8032;Jr++)Yr[Jr]=0;for(Jr=8065;Jr<=8068;Jr++)Yr[Jr]=1;for(Jr=8518;Jr<=8529;Jr++)Yr[Jr]=2;for(Jr=8533;Jr<=8536;Jr++)Yr[Jr]=2;for(Jr=8538;Jr<=8540;Jr++)Yr[Jr]=2;for(Jr=8677;Jr<=8679;Jr++)Yr[Jr]=0;for(Jr=8836;Jr<=8840;Jr++)Yr[Jr]=0;for(Jr=8857;Jr<=8859;Jr++)Yr[Jr]=0;for(Jr=8908;Jr<=8910;Jr++)Yr[Jr]=0;for(Jr=9154;Jr<=9159;Jr++)Yr[Jr]=0;for(Jr=9205;Jr<=9218;Jr++)Yr[Jr]=0;for(Jr=9271;Jr<=9273;Jr++)Yr[Jr]=0;for(Jr=9295;Jr<=9297;Jr++)Yr[Jr]=0;for(Jr=20002;Jr<=20032;Jr++)Yr[Jr]=0;for(Jr=20062;Jr<=20092;Jr++)Yr[Jr]=0;for(Jr=20135;Jr<=20138;Jr++)Yr[Jr]=0;for(Jr=20248;Jr<=20258;Jr++)Yr[Jr]=0;for(Jr=20348;Jr<=20358;Jr++)Yr[Jr]=0;for(Jr=20436;Jr<=20440;Jr++)Yr[Jr]=0;for(Jr=20822;Jr<=20824;Jr++)Yr[Jr]=0;for(Jr=20934;Jr<=20936;Jr++)Yr[Jr]=0;for(Jr=21035;Jr<=21037;Jr++)Yr[Jr]=0;for(Jr=21095;Jr<=21097;Jr++)Yr[Jr]=0;for(Jr=21148;Jr<=21150;Jr++)Yr[Jr]=0;for(Jr=21413;Jr<=21423;Jr++)Yr[Jr]=0;for(Jr=21453;Jr<=21463;Jr++)Yr[Jr]=0;for(Jr=21473;Jr<=21483;Jr++)Yr[Jr]=0;for(Jr=21780;Jr<=21782;Jr++)Yr[Jr]=0;for(Jr=21891;Jr<=21894;Jr++)Yr[Jr]=0;for(Jr=21896;Jr<=21899;Jr++)Yr[Jr]=0;for(Jr=22171;Jr<=22177;Jr++)Yr[Jr]=0;for(Jr=22181;Jr<=22187;Jr++)Yr[Jr]=0;for(Jr=22191;Jr<=22197;Jr++)Yr[Jr]=0;for(Jr=22234;Jr<=22236;Jr++)Yr[Jr]=0;for(Jr=22521;Jr<=22525;Jr++)Yr[Jr]=0;for(Jr=22991;Jr<=22994;Jr++)Yr[Jr]=0;for(Jr=23028;Jr<=23038;Jr++)Yr[Jr]=0;for(Jr=23830;Jr<=23853;Jr++)Yr[Jr]=0;for(Jr=23866;Jr<=23872;Jr++)Yr[Jr]=0;for(Jr=23877;Jr<=23884;Jr++)Yr[Jr]=0;for(Jr=23886;Jr<=23894;Jr++)Yr[Jr]=0;for(Jr=23946;Jr<=23948;Jr++)Yr[Jr]=0;for(Jr=24311;Jr<=24313;Jr++)Yr[Jr]=0;for(Jr=24342;Jr<=24347;Jr++)Yr[Jr]=0;for(Jr=24370;Jr<=24374;Jr++)Yr[Jr]=10;for(Jr=24375;Jr<=24381;Jr++)Yr[Jr]=0;for(Jr=24718;Jr<=24721;Jr++)Yr[Jr]=0;for(Jr=24817;Jr<=24821;Jr++)Yr[Jr]=0;for(Jr=24877;Jr<=24882;Jr++)Yr[Jr]=0;for(Jr=24891;Jr<=24893;Jr++)Yr[Jr]=0;for(Jr=25391;Jr<=25395;Jr++)Yr[Jr]=0;for(Jr=25828;Jr<=25838;Jr++)Yr[Jr]=0;for(Jr=26191;Jr<=26195;Jr++)Yr[Jr]=0;for(Jr=26391;Jr<=26393;Jr++)Yr[Jr]=0;for(Jr=26701;Jr<=26722;Jr++)Yr[Jr]=0;for(Jr=26729;Jr<=26799;Jr++)Yr[Jr]=2;for(Jr=26801;Jr<=26803;Jr++)Yr[Jr]=2;for(Jr=26811;Jr<=26813;Jr++)Yr[Jr]=2;for(Jr=26847;Jr<=26870;Jr++)Yr[Jr]=2;for(Jr=26891;Jr<=26899;Jr++)Yr[Jr]=0;for(Jr=26901;Jr<=26923;Jr++)Yr[Jr]=0;for(Jr=26929;Jr<=26946;Jr++)Yr[Jr]=0;for(Jr=26948;Jr<=26998;Jr++)Yr[Jr]=0;for(Jr=27037;Jr<=27040;Jr++)Yr[Jr]=0;for(Jr=27205;Jr<=27232;Jr++)Yr[Jr]=0;for(Jr=27258;Jr<=27260;Jr++)Yr[Jr]=0;for(Jr=27391;Jr<=27398;Jr++)Yr[Jr]=0;for(Jr=27561;Jr<=27564;Jr++)Yr[Jr]=0;for(Jr=27571;Jr<=27574;Jr++)Yr[Jr]=0;for(Jr=27581;Jr<=27584;Jr++)Yr[Jr]=0;for(Jr=27591;Jr<=27594;Jr++)Yr[Jr]=0;for(Jr=28191;Jr<=28193;Jr++)Yr[Jr]=0;for(Jr=28348;Jr<=28358;Jr++)Yr[Jr]=0;for(Jr=28402;Jr<=28432;Jr++)Yr[Jr]=0;for(Jr=28462;Jr<=28492;Jr++)Yr[Jr]=0;for(Jr=29118;Jr<=29122;Jr++)Yr[Jr]=0;for(Jr=29168;Jr<=29172;Jr++)Yr[Jr]=0;for(Jr=29177;Jr<=29185;Jr++)Yr[Jr]=0;for(Jr=29187;Jr<=29195;Jr++)Yr[Jr]=0;for(Jr=29900;Jr<=29903;Jr++)Yr[Jr]=0;for(Jr=30161;Jr<=30179;Jr++)Yr[Jr]=0;for(Jr=30491;Jr<=30494;Jr++)Yr[Jr]=0;for(Jr=30729;Jr<=30732;Jr++)Yr[Jr]=0;for(Jr=31251;Jr<=31259;Jr++)Yr[Jr]=0;for(Jr=31265;Jr<=31268;Jr++)Yr[Jr]=0;for(Jr=31275;Jr<=31279;Jr++)Yr[Jr]=0;for(Jr=31281;Jr<=31297;Jr++)Yr[Jr]=0;for(Jr=31461;Jr<=31469;Jr++)Yr[Jr]=0;for(Jr=31491;Jr<=31495;Jr++)Yr[Jr]=0;for(Jr=31917;Jr<=31922;Jr++)Yr[Jr]=0;for(Jr=31965;Jr<=32e3;Jr++)Yr[Jr]=0;for(Jr=32001;Jr<=32003;Jr++)Yr[Jr]=2;for(Jr=32005;Jr<=32031;Jr++)Yr[Jr]=2;for(Jr=32033;Jr<=32060;Jr++)Yr[Jr]=2;for(Jr=32064;Jr<=32067;Jr++)Yr[Jr]=2;for(Jr=32074;Jr<=32077;Jr++)Yr[Jr]=2;for(Jr=32081;Jr<=32086;Jr++)Yr[Jr]=0;for(Jr=32107;Jr<=32130;Jr++)Yr[Jr]=0;for(Jr=32133;Jr<=32158;Jr++)Yr[Jr]=0;for(Jr=32164;Jr<=32167;Jr++)Yr[Jr]=2;for(Jr=32180;Jr<=32199;Jr++)Yr[Jr]=0;for(Jr=32201;Jr<=32260;Jr++)Yr[Jr]=0;for(Jr=32301;Jr<=32360;Jr++)Yr[Jr]=0;for(Jr=32601;Jr<=32662;Jr++)Yr[Jr]=0;for(Jr=32664;Jr<=32667;Jr++)Yr[Jr]=2;for(Jr=32701;Jr<=32761;Jr++)Yr[Jr]=0;for(Jr=53001;Jr<=53004;Jr++)Yr[Jr]=0;for(Jr=53008;Jr<=53019;Jr++)Yr[Jr]=0;for(Jr=53021;Jr<=53032;Jr++)Yr[Jr]=0;for(Jr=53034;Jr<=53037;Jr++)Yr[Jr]=0;for(Jr=53042;Jr<=53046;Jr++)Yr[Jr]=0;for(Jr=53074;Jr<=53080;Jr++)Yr[Jr]=0;for(Jr=54001;Jr<=54004;Jr++)Yr[Jr]=0;for(Jr=54008;Jr<=54019;Jr++)Yr[Jr]=0;for(Jr=54021;Jr<=54032;Jr++)Yr[Jr]=0;for(Jr=54034;Jr<=54037;Jr++)Yr[Jr]=0;for(Jr=54042;Jr<=54046;Jr++)Yr[Jr]=0;for(Jr=54048;Jr<=54053;Jr++)Yr[Jr]=0;for(Jr=54074;Jr<=54080;Jr++)Yr[Jr]=0;for(Jr=54098;Jr<=54101;Jr++)Yr[Jr]=0;for(Jr=102001;Jr<=102040;Jr++)Yr[Jr]=0;for(Jr=102042;Jr<=102063;Jr++)Yr[Jr]=0;for(Jr=102065;Jr<=102067;Jr++)Yr[Jr]=0;for(Jr=102070;Jr<=102117;Jr++)Yr[Jr]=0;for(Jr=102122;Jr<=102216;Jr++)Yr[Jr]=0;for(Jr=102221;Jr<=102377;Jr++)Yr[Jr]=0;for(Jr=102382;Jr<=102388;Jr++)Yr[Jr]=0;for(Jr=102389;Jr<=102398;Jr++)Yr[Jr]=2;for(Jr=102399;Jr<=102444;Jr++)Yr[Jr]=0;for(Jr=102445;Jr<=102447;Jr++)Yr[Jr]=2;for(Jr=102448;Jr<=102458;Jr++)Yr[Jr]=0;for(Jr=102459;Jr<=102468;Jr++)Yr[Jr]=2;for(Jr=102469;Jr<=102499;Jr++)Yr[Jr]=0;for(Jr=102500;Jr<=102519;Jr++)Yr[Jr]=1;for(Jr=102520;Jr<=102524;Jr++)Yr[Jr]=0;for(Jr=102525;Jr<=102529;Jr++)Yr[Jr]=2;for(Jr=102530;Jr<=102588;Jr++)Yr[Jr]=0;for(Jr=102590;Jr<=102598;Jr++)Yr[Jr]=0;for(Jr=102601;Jr<=102603;Jr++)Yr[Jr]=0;for(Jr=102605;Jr<=102628;Jr++)Yr[Jr]=0;for(Jr=102629;Jr<=102646;Jr++)Yr[Jr]=2;for(Jr=102648;Jr<=102700;Jr++)Yr[Jr]=2;for(Jr=102701;Jr<=102703;Jr++)Yr[Jr]=0;for(Jr=102707;Jr<=102730;Jr++)Yr[Jr]=2;for(Jr=102733;Jr<=102758;Jr++)Yr[Jr]=2;for(Jr=102767;Jr<=102900;Jr++)Yr[Jr]=0;for(Jr=102965;Jr<=102969;Jr++)Yr[Jr]=0;for(Jr=102971;Jr<=102973;Jr++)Yr[Jr]=0;for(Jr=102975;Jr<=102989;Jr++)Yr[Jr]=0;for(Jr=102990;Jr<=102992;Jr++)Yr[Jr]=1;for(Jr=102997;Jr<=103002;Jr++)Yr[Jr]=0;for(Jr=103003;Jr<=103008;Jr++)Yr[Jr]=2;for(Jr=103009;Jr<=103011;Jr++)Yr[Jr]=0;for(Jr=103012;Jr<=103014;Jr++)Yr[Jr]=2;for(Jr=103019;Jr<=103021;Jr++)Yr[Jr]=0;for(Jr=103022;Jr<=103024;Jr++)Yr[Jr]=2;for(Jr=103029;Jr<=103031;Jr++)Yr[Jr]=0;for(Jr=103032;Jr<=103034;Jr++)Yr[Jr]=2;for(Jr=103065;Jr<=103068;Jr++)Yr[Jr]=0;for(Jr=103074;Jr<=103076;Jr++)Yr[Jr]=0;for(Jr=103077;Jr<=103079;Jr++)Yr[Jr]=1;for(Jr=103080;Jr<=103082;Jr++)Yr[Jr]=0;for(Jr=103083;Jr<=103085;Jr++)Yr[Jr]=2;for(Jr=103090;Jr<=103093;Jr++)Yr[Jr]=0;for(Jr=103097;Jr<=103099;Jr++)Yr[Jr]=0;for(Jr=103100;Jr<=103102;Jr++)Yr[Jr]=2;for(Jr=103107;Jr<=103109;Jr++)Yr[Jr]=0;for(Jr=103110;Jr<=103112;Jr++)Yr[Jr]=2;for(Jr=103113;Jr<=103116;Jr++)Yr[Jr]=0;for(Jr=103117;Jr<=103120;Jr++)Yr[Jr]=2;for(Jr=103153;Jr<=103157;Jr++)Yr[Jr]=0;for(Jr=103158;Jr<=103162;Jr++)Yr[Jr]=2;for(Jr=103163;Jr<=103165;Jr++)Yr[Jr]=0;for(Jr=103166;Jr<=103168;Jr++)Yr[Jr]=1;for(Jr=103169;Jr<=103171;Jr++)Yr[Jr]=2;for(Jr=103186;Jr<=103188;Jr++)Yr[Jr]=0;for(Jr=103189;Jr<=103191;Jr++)Yr[Jr]=2;for(Jr=103192;Jr<=103195;Jr++)Yr[Jr]=0;for(Jr=103196;Jr<=103199;Jr++)Yr[Jr]=2;for(Jr=103200;Jr<=103224;Jr++)Yr[Jr]=0;for(Jr=103225;Jr<=103227;Jr++)Yr[Jr]=1;for(Jr=103232;Jr<=103237;Jr++)Yr[Jr]=0;for(Jr=103238;Jr<=103243;Jr++)Yr[Jr]=2;for(Jr=103244;Jr<=103246;Jr++)Yr[Jr]=0;for(Jr=103247;Jr<=103249;Jr++)Yr[Jr]=2;for(Jr=103254;Jr<=103256;Jr++)Yr[Jr]=0;for(Jr=103257;Jr<=103259;Jr++)Yr[Jr]=2;for(Jr=103264;Jr<=103266;Jr++)Yr[Jr]=0;for(Jr=103267;Jr<=103269;Jr++)Yr[Jr]=2;for(Jr=103300;Jr<=103375;Jr++)Yr[Jr]=0;for(Jr=103381;Jr<=103383;Jr++)Yr[Jr]=0;for(Jr=103384;Jr<=103386;Jr++)Yr[Jr]=1;for(Jr=103387;Jr<=103389;Jr++)Yr[Jr]=0;for(Jr=103390;Jr<=103392;Jr++)Yr[Jr]=2;for(Jr=103397;Jr<=103399;Jr++)Yr[Jr]=0;for(Jr=103400;Jr<=103471;Jr++)Yr[Jr]=2;for(Jr=103476;Jr<=103478;Jr++)Yr[Jr]=0;for(Jr=103479;Jr<=103481;Jr++)Yr[Jr]=2;for(Jr=103486;Jr<=103488;Jr++)Yr[Jr]=0;for(Jr=103489;Jr<=103491;Jr++)Yr[Jr]=2;for(Jr=103492;Jr<=103495;Jr++)Yr[Jr]=0;for(Jr=103496;Jr<=103499;Jr++)Yr[Jr]=2;for(Jr=103528;Jr<=103543;Jr++)Yr[Jr]=0;for(Jr=103544;Jr<=103548;Jr++)Yr[Jr]=2;for(Jr=103549;Jr<=103551;Jr++)Yr[Jr]=0;for(Jr=103552;Jr<=103554;Jr++)Yr[Jr]=1;for(Jr=103555;Jr<=103557;Jr++)Yr[Jr]=2;for(Jr=103558;Jr<=103560;Jr++)Yr[Jr]=0;for(Jr=103571;Jr<=103573;Jr++)Yr[Jr]=0;for(Jr=103574;Jr<=103576;Jr++)Yr[Jr]=2;for(Jr=103577;Jr<=103580;Jr++)Yr[Jr]=0;for(Jr=103581;Jr<=103583;Jr++)Yr[Jr]=2;for(Jr=103595;Jr<=103694;Jr++)Yr[Jr]=0;for(Jr=103696;Jr<=103699;Jr++)Yr[Jr]=0;for(Jr=103700;Jr<=103793;Jr++)Yr[Jr]=2;for(Jr=103794;Jr<=103872;Jr++)Yr[Jr]=0;for(Jr=103900;Jr<=103971;Jr++)Yr[Jr]=2;const Xr={102113:!0,102100:!0,3857:!0,3785:!0},Qr={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0},Kr='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',Zr=[-20037508.342788905,20037508.342788905],tn=[-20037508.342787,20037508.342787],en={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Zr,origin:tn,dx:1e-5},102100:{wkTemplate:Kr,valid:Zr,origin:tn,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Zr,origin:tn,dx:1e-5},3857:{wkTemplate:Kr,valid:Zr,origin:tn,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function sn(t,e){return!x(t)&&!x(e)&&(t===e||(null!=t.wkid||null!=e.wkid?t.wkid===e.wkid||ln(t)&&ln(e)||null!=e.latestWkid&&t.wkid===e.latestWkid||null!=t.latestWkid&&e.wkid===t.latestWkid:!(!t.wkt||!e.wkt)&&t.wkt.toUpperCase()===e.wkt.toUpperCase()))}function rn(t){return fn(t)&&t.wkid?en[t.wkid]:null}function nn(t){return!!fn(t)&&(t.wkid?null==Yr[t.wkid]:!!t.wkt&&!!/^\s*GEOGCS/i.test(t.wkt))}function on(t){return fn(t)&&4326===t.wkid}function ln(t){return fn(t)&&null!=t.wkid&&!0===Xr[t.wkid]}function an(t){return 104971===t||104905===t}function un(t){return fn(t)&&null!=t.wkid&&an(t.wkid)}function hn(t){return 104903===t}function cn(t){return fn(t)&&null!=t.wkid&&hn(t.wkid)}function fn(t){return M(t)&&(null!=t.wkid&&t.wkid>=2e3||null!=t.wkt)}const dn={wkid:4326,wkt:G(en[4326].wkTemplate,{Central_Meridian:"0.0"})};var pn;let yn=pn=class extends Wr{constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}static fromJSON(t){if(!t)return null;if(t.wkid){if(102100===t.wkid)return pn.WebMercator;if(4326===t.wkid)return pn.WGS84}const e=new pn;return e.read(t),e}normalizeCtorArgs(t){return t&&"object"==typeof t?t:{["string"==typeof t?"wkt":"wkid"]:t}}get isWGS84(){return on(this)}get isWebMercator(){return ln(this)}get isGeographic(){return nn(this)}get isWrappable(){return function(t){return fn(t)&&null!=t.wkid&&!0===Qr[t.wkid]}(this)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===pn.WGS84)return pn.WGS84;if(this===pn.WebMercator)return pn.WebMercator;const t=new pn;return null!=this.wkid?(t.wkid=this.wkid,null!=this.latestWkid&&(t.latestWkid=this.latestWkid),null!=this.vcsWkid&&(t.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(t.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(t.wkt=this.wkt),this.imageCoordinateSystem&&(t.imageCoordinateSystem=w(this.imageCoordinateSystem)),t}equals(t){if(null==t)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==t.imageCoordinateSystem)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:s}=t.imageCoordinateSystem,r=this.imageCoordinateSystem;return null==e||s?JSON.stringify(r)===JSON.stringify(t.imageCoordinateSystem):i?r.id===e&&r.referenceServiceName===i:r.id===e}return sn(this,t)}toJSON(t){return this.write(void 0,t)}};yn.GCS_NAD_1927=null,yn.WGS84=null,yn.WebMercator=null,s([Ut({dependsOn:["wkid"],autoTracked:!1,readOnly:!0})],yn.prototype,"isWGS84",null),s([Ut({dependsOn:["wkid"],autoTracked:!1,readOnly:!0})],yn.prototype,"isWebMercator",null),s([Ut({dependsOn:["wkid","wkt"],autoTracked:!1,readOnly:!0})],yn.prototype,"isGeographic",null),s([Ut({dependsOn:["wkid"],autoTracked:!1,readOnly:!0})],yn.prototype,"isWrappable",null),s([Ut({type:mt,json:{write:!0}})],yn.prototype,"latestWkid",void 0),s([Ut({type:mt,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkt}}}}}}})],yn.prototype,"wkid",void 0),s([Ut({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkid}}}}}}})],yn.prototype,"wkt",void 0),s([be("wkt"),be("web-scene","wkt")],yn.prototype,"writeWkt",null),s([Ut({type:mt,json:{write:!0}})],yn.prototype,"vcsWkid",void 0),s([Ut({type:mt,json:{write:!0}})],yn.prototype,"latestVcsWkid",void 0),s([Ut()],yn.prototype,"imageCoordinateSystem",void 0),yn=pn=s([ve("esri.geometry.SpatialReference")],yn),yn.prototype.toJSON.isDefaultToJSON=!0,yn.GCS_NAD_1927=new yn({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),yn.WGS84=new yn(dn),yn.WebMercator=new yn({wkid:102100,latestWkid:3857}),Object.freeze&&(Object.freeze(yn.GCS_NAD_1927),Object.freeze(yn.WGS84),Object.freeze(yn.WebMercator));var mn=yn;function vn(t,e,i){let s,r;return void 0===e||Array.isArray(e)?(r=t,i=e,s=[void 0]):(r=e,s=Array.isArray(t)?t:[t]),(t,e)=>{const n=t.constructor.prototype;s.forEach((s=>{const o=Vt(t,s,r);o.read&&"object"!=typeof o.read&&(o.read={}),z("read.reader",n[e],o),i&&(o.read.source=(o.read.source||[]).concat(i))}))}}let wn=class extends Wr{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=mn.WGS84}get cache(){return{}}get extent(){return null}readSpatialReference(t,e){if(t instanceof mn)return t;if(null!=t){const i=new mn;return i.read(t,e),i}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,e){this.cache[t]=e}};s([Ut()],wn.prototype,"type",void 0),s([Ut({readOnly:!0,dependsOn:["spatialReference"],autoTracked:!1})],wn.prototype,"cache",null),s([Ut({readOnly:!0,dependsOn:["spatialReference"],autoTracked:!1})],wn.prototype,"extent",null),s([Ut({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],wn.prototype,"hasM",void 0),s([Ut({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],wn.prototype,"hasZ",void 0),s([Ut({type:mn,json:{write:!0}})],wn.prototype,"spatialReference",void 0),s([vn("spatialReference")],wn.prototype,"readSpatialReference",null),wn=s([ve("esri.geometry.Geometry")],wn);var bn=wn;const gn=Object.prototype.toString;function Sn(t){const e="__accessorMetadata__"in t?ut(t):t;return function(...t){if(t.push(e),"number"==typeof t[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Mn.apply(this,t)}}function Mn(t,e,i,s){Dt(t,e).cast=s}function xn(...t){var e;if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===gn.call(t[0])?Sn(t[0]):1===t.length&&"string"==typeof t[0]?(e=t[0],function(t,i){Dt(t,e).cast=t[i]}):void 0}class kn{constructor(t,e,i,s){this.semiMajorAxis=t,this.flattening=e,this.outerAtmosphereRimWidth=i,this.semiMinorAxis=this.semiMajorAxis*(1-this.flattening),this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=s||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const Cn=new kn(6378137,1/298.257223563,3e5,.006694379990137799),In=new kn(3396190,1/169.8944472236118,23e4),On=new kn(1737400,0,0);function jn(t){return 57.29577951308232*t}function Pn(t){return.017453292519943*t}function An(t){return null!=t.wkid||null!=t.wkt}const Tn=[0,0];function Nn(t,e,i,s,r){const n=t,o=r;if("x"in n&&"x"in o)[o.x,o.y]=e(n.x,n.y,Tn,s);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=e(n.xmin,n.ymin,Tn,s),[o.xmax,o.ymax]=e(n.xmax,n.ymax,Tn,s);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const t="paths"in n?n.paths:n.rings,i=[];let r;for(let n=0;n<t.length;n++){const o=t[n];r=[],i.push(r);for(let t=0;t<o.length;t++)r.push(e(o[t][0],o[t][1],[0,0],s)),o[t].length>2&&r[t].push(o[t][2]),o[t].length>3&&r[t].push(o[t][3])}"paths"in o?o.paths=i:o.rings=i}else if("points"in n&&"points"in o){const t=n.points,i=[];for(let r=0;r<t.length;r++)i[r]=e(t[r][0],t[r][1],[0,0],s),t[r].length>2&&i[r].push(t[r][2]),t[r].length>3&&i[r].push(t[r][3]);o.points=i}return o.spatialReference=i,r}function Rn(t,e){const i=t&&(An(t)?t:t.spatialReference),s=e&&(An(e)?e:e.spatialReference);return(!t||!("type"in t)||"mesh"!==t.type)&&(!e||!("type"in e)||"mesh"!==e.type)&&!(!i||!s)&&(!!sn(s,i)||ln(s)&&on(i)||ln(i)&&on(s))}function _n(t,e){const i=t&&t.spatialReference,s=e&&(An(e)?e:e.spatialReference);return Rn(i,s)?sn(i,s)?w(t):ln(s)?Nn(t,En,mn.WebMercator,!1,w(t)):on(s)?Nn(t,Dn,mn.WGS84,!1,w(t)):null:null}function En(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const s=Pn(e);return i[0]=Pn(t)*Cn.radius,i[1]=Cn.halfSemiMajorAxis*Math.log((1+Math.sin(s))/(1-Math.sin(s))),i}function Dn(t,e,i=[0,0],s=!1){const r=jn(t/Cn.radius);return i[0]=s?r:r-360*Math.floor((r+180)/360),i[1]=jn(Math.PI/2-2*Math.atan(Math.exp(-1*e/Cn.radius))),i}function $n(t,e=!1,i=w(t)){return Nn(t,En,mn.WebMercator,e,i)}function zn(t,e=!1,i=w(t)){return Nn(t,Dn,mn.WGS84,e,i)}var Fn;const Ln=[0,0];function Un(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}const Vn=W.getLogger("esri.geometry.Point");let Gn=Fn=class extends bn{constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}normalizeCtorArgs(t,e,i,s,r){let n;if(Array.isArray(t))n=t,r=e,t=n[0],e=n[1],i=n[2],s=n[3];else if(t&&"object"==typeof t){if(n=t,t=null!=n.x?n.x:n.longitude,e=null!=n.y?n.y:n.latitude,i=n.z,s=n.m,(r=n.spatialReference)&&"esri.geometry.SpatialReference"!==r.declaredClass&&(r=new mn(r)),null!=n.longitude||null!=n.latitude)if(null==n.longitude)Vn.warn(".longitude=","Latitude was defined without longitude");else if(null==n.latitude)Vn.warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&r&&r.isWebMercator){const i=En(n.longitude,n.latitude,Ln);t=i[0],e=i[1]}}else Un(i)?(r=i,i=null):Un(s)&&(r=s,s=null);const o={x:t,y:e};return null==o.x&&null!=o.y?Vn.warn(".y=","Y coordinate was defined without an X coordinate"):null==o.y&&null!=o.x&&Vn.warn(".x=","X coordinate was defined without a Y coordinate"),null!=r&&(o.spatialReference=r),null!=i&&(o.z=i),null!=s&&(o.m=s),o}get hasM(){return void 0!==this.m}set hasM(t){t!==this.hasM&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return void 0!==this.z}set hasZ(t){t!==this.hasZ&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const t=this._get("spatialReference");if(t){if(t.isWebMercator)return Dn(this.x,this.y,Ln)[1];if(t.isGeographic)return this._get("y")}return null}set latitude(t){const e=this._get("spatialReference");e&&(e.isWebMercator?this._set("y",En(this.x,t,Ln)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const t=this._get("spatialReference");if(t){if(t.isWebMercator)return Dn(this._get("x"),this._get("y"),Ln)[0];if(t.isGeographic)return this._get("x")}return null}set longitude(t){const e=this._get("spatialReference");e&&(e.isWebMercator?this._set("x",En(t,this._get("y"),Ln)[0]):e.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return"string"==typeof t?NaN:t}clone(){const t=new Fn;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return Fn.copy(t,this),this}equals(t){if(!t)return!1;const{x:e,y:i,z:s,m:r,spatialReference:n}=this,{z:o,m:l}=t;let{x:a,y:u,spatialReference:h}=t;if(!n.equals(h))if(n.isWebMercator&&h.isWGS84)[a,u]=En(a,u),h=n;else{if(!n.isWGS84||!h.isWebMercator)return!1;[a,u]=Dn(a,u),h=n}return e===a&&i===u&&s===o&&r===l&&n.wkid===h.wkid}offset(t,e,i){return function(t,e,i,s){return t.x=t.x+e,t.y=t.y+i,null!=s&&null!=t.z&&(t.z=t.z+s),t}(this,t,e,i)}normalize(){if(!this.spatialReference)return this;const t=rn(this.spatialReference);if(!t)return this;let e=this.x;const[i,s]=t.valid,r=2*s;let n;return e>s?(n=Math.ceil(Math.abs(e-s)/r),e-=n*r):e<i&&(n=Math.ceil(Math.abs(e-i)/r),e+=n*r),this._set("x",e),this}distance(t){return function(t,e){const i=t.x-e.x,s=t.y-e.y,r=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(i*i+s*s+r*r)}(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write(null,t)}};s([Ut({dependsOn:["x","y","z","m","spatialReference"],autoTracked:!1})],Gn.prototype,"cache",void 0),s([Ut({type:Boolean,dependsOn:["m"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Gn.prototype,"hasM",null),s([Ut({type:Boolean,dependsOn:["z"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Gn.prototype,"hasZ",null),s([Ut({type:Number,dependsOn:["y"],autoTracked:!1})],Gn.prototype,"latitude",null),s([Ut({type:Number,dependsOn:["x"],autoTracked:!1})],Gn.prototype,"longitude",null),s([Ut({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),xn((t=>isNaN(t)?t:Z(t)))],Gn.prototype,"x",void 0),s([be("x")],Gn.prototype,"writeX",null),s([vn("x")],Gn.prototype,"readX",null),s([Ut({type:Number,json:{write:!0}})],Gn.prototype,"y",void 0),s([Ut({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Gn.prototype,"z",void 0),s([Ut({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Gn.prototype,"m",void 0),Gn=Fn=s([ve("esri.geometry.Point")],Gn),Gn.prototype.toJSON.isDefaultToJSON=!0;var qn=Gn;const Bn=[0,0];function Hn(t,e){return Xn(t,e.x,e.y,e.z)}function Jn(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!Wn(t,i))return!1;return!0}function Wn(t,e){return Xn(t,e[0],e[1])}function Yn(t,e){return Xn(t,e[0],e[1],e[2])}function Xn(t,e,i,s){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(null==s||!t.hasZ||s>=t.zmin&&s<=t.zmax)}function Qn(t,e){return function(t,e){if(!t)return!1;if(function(t){return!Array.isArray(t[0][0])}(t))return Kn(!1,t,e);let i=!1;for(let s=0,r=t.length;s<r;s++)i=Kn(i,t[s],e);return i}(t.rings,e)}function Kn(t,e,i){const[s,r]=i;let n=t,o=0;for(let t=0,i=e.length;t<i;t++){o++,o===i&&(o=0);const[l,a]=e[t],[u,h]=e[o];(a<r&&h>=r||h<r&&a>=r)&&l+(r-a)/(h-a)*(u-l)<s&&(n=!n)}return n}function Zn(t,e){return Hn(t,e)}function to(t,e){let i,s,r;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(t.hasZ&&e.hasZ&&e.hasZ)if(t.zmin<=e.zmin){if(r=e.zmin,t.zmax<r)return!1}else if(r=t.zmin,e.zmax<r)return!1;return!0}function eo(t,e){const{points:i,hasZ:s}=e,r=s?Yn:Wn;for(const e of i)if(r(t,e))return!0;return!1}const io=[0,0],so=[0,0],ro=[0,0],no=[0,0],oo=[io,so,ro,no],lo=[[ro,io],[io,so],[so,no],[no,ro]];function ao(t,e){io[0]=t.xmin,io[1]=t.ymax,so[0]=t.xmax,so[1]=t.ymax,ro[0]=t.xmin,ro[1]=t.ymin,no[0]=t.xmax,no[1]=t.ymin;for(const t of oo)if(Qn(e,t))return!0;for(const i of e.rings){if(!i.length)continue;let e=i[0];if(Wn(t,e))return!0;for(let s=1;s<i.length;s++){const r=i[s];if(Wn(t,r)||co(e,r,lo))return!0;e=r}}return!1}function uo(t,e){io[0]=t.xmin,io[1]=t.ymax,so[0]=t.xmax,so[1]=t.ymax,ro[0]=t.xmin,ro[1]=t.ymin,no[0]=t.xmax,no[1]=t.ymin;const i=e.paths;for(const e of i){if(!i.length)continue;let s=e[0];if(Wn(t,s))return!0;for(let i=1;i<e.length;i++){const r=e[i];if(Wn(t,r)||co(s,r,lo))return!0;s=r}}return!1}const ho=[0,0];function co(t,e,i){for(let s=0;s<i.length;s++)if(fo(t,e,i[s][0],i[s][1]))return!0;return!1}function fo(t,e,i,s,r){const[n,o]=t,[l,a]=e,[u,h]=i,[c,f]=s,d=c-u,p=n-u,y=l-n,m=f-h,v=o-h,w=a-o,b=m*y-d*w;if(0===b)return!1;const g=(d*v-m*p)/b,S=(y*v-w*p)/b;return g>=0&&g<=1&&S>=0&&S<=1&&(r&&(r[0]=n+g*(l-n),r[1]=o+g*(a-o)),!0)}function po(t){switch(t){case"esriGeometryEnvelope":case"extent":return to;case"esriGeometryMultipoint":case"multipoint":return eo;case"esriGeometryPoint":case"point":return Zn;case"esriGeometryPolygon":case"polygon":return ao;case"esriGeometryPolyline":case"polyline":return uo;case"mesh":return to}}var yo;function mo(t,e,i){return null==e?i:null==i?e:t(e,i)}let vo=yo=class extends bn{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,s,r){return!(n=t)||"esri.geometry.SpatialReference"!==n.declaredClass&&null==n.wkid?"object"==typeof t?(t.spatialReference=null==t.spatialReference?mn.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:s,spatialReference:null==r?mn.WGS84:r}:{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0};var n}static fromBounds(t,e){return new yo({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}get center(){const t=new qn({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return null!=t.z&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new yo;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,null!=this.zmin&&(t.zmin=this.zmin,t.zmax=this.zmax),null!=this.mmin&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Rn(e,i)&&(t=e.isWebMercator?$n(t):zn(t,!0)),"point"===t.type?Hn(this,t):"extent"===t.type&&function(t,e){const{xmin:i,ymin:s,zmin:r,xmax:n,ymax:o,zmax:l}=e;return t.hasZ&&e.hasZ?Xn(t,i,s,r)&&Xn(t,i,o,r)&&Xn(t,n,o,r)&&Xn(t,n,s,r)&&Xn(t,i,s,l)&&Xn(t,i,o,l)&&Xn(t,n,o,l)&&Xn(t,n,s,l):Xn(t,i,s)&&Xn(t,i,o)&&Xn(t,n,o)&&Xn(t,n,s)}(this,t)}equals(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Rn(e,i)&&(t=e.isWebMercator?$n(t):zn(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,s=this.height*e;if(this.xmin+=i,this.ymin+=s,this.xmax-=i,this.ymax-=s,this.hasZ){const t=(this.zmax-this.zmin)*e;this.zmin+=t,this.zmax-=t}if(this.hasM){const t=(this.mmax-this.mmin)*e;this.mmin+=t,this.mmax-=t}return this}intersects(t){if(x(t))return!1;"mesh"===t.type&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Rn(e,i)&&(t=e.isWebMercator?$n(t):zn(t,!0)),po(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,null!=i&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=mo(Math.min,this.zmin,t.zmin),this.zmax=mo(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=mo(Math.min,this.mmin,t.mmin),this.mmax=mo(Math.max,this.mmax,t.mmax)),this}intersection(t){return this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=mo(Math.max,this.zmin,t.zmin),this.zmax=mo(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=mo(Math.max,this.mmin,t.mmin),this.mmax=mo(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write(null,t)}_shiftCM(t=rn(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const s=e.isWebMercator?zn(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(s.x=this._normalizeX(s.x,t).x),this.spatialReference=new mn(G(e.isWGS84?t.altTemplate:t.wkTemplate,{Central_Meridian:s.x}))}return this}_getCM(t){let e=null;const[i,s]=t.valid,r=this.xmin,n=this.xmax;return r>=i&&r<=s&&n>=i&&n<=s||(e=this.center),e}_normalize(t,e,i){const s=this.spatialReference;if(!s)return this;if(!(i=i||rn(s)))return this;const r=this._getParts(i).map((t=>t.extent));if(r.length<2)return r[0]||this;if(r.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return r;let n=!0,o=!0;return r.forEach((t=>{t.hasZ||(n=!1),t.hasM||(o=!1)})),{rings:r.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(n){const i=(t.zmax-t.zmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}if(o){const i=(t.mmax-t.mmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}return e})),hasZ:n,hasM:o,spatialReference:s}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:r}=this,n=this.width,o=this.xmin,l=this.xmax;let a;t=t||rn(r);const[u,h]=t.valid;a=this._normalizeX(this.xmin,t);const c=a.x,f=a.frameId;a=this._normalizeX(this.xmax,t);const d=a.x,p=a.frameId,y=c===d&&n>0;if(n>2*h){const t=new yo(o<l?c:d,i,h,s,r),n=new yo(u,i,o<l?d:c,s,r),a=new yo(0,i,h,s,r),y=new yo(u,i,0,s,r),m=[],v=[];t.contains(a)&&m.push(f),t.contains(y)&&v.push(f),n.contains(a)&&m.push(p),n.contains(y)&&v.push(p);for(let t=f+1;t<p;t++)m.push(t),v.push(t);e.push({extent:t,frameIds:[f]},{extent:n,frameIds:[p]},{extent:a,frameIds:m},{extent:y,frameIds:v})}else c>d||y?e.push({extent:new yo(c,i,h,s,r),frameIds:[f]},{extent:new yo(u,i,d,s,r),frameIds:[p]}):e.push({extent:new yo(c,i,d,s,r),frameIds:[f]});this.cache._parts=e}const i=this.hasZ,s=this.hasM;if(i||s){const t={};i&&(t.zmin=this.zmin,t.zmax=this.zmax),s&&(t.mmin=this.mmin,t.mmax=this.mmax);for(let i=0;i<e.length;i++)e[i].extent.set(t)}return e}_normalizeX(t,e){const[i,s]=e.valid,r=2*s;let n,o=0;return t>s?(n=Math.ceil(Math.abs(t-s)/r),t-=n*r,o=n):t<i&&(n=Math.ceil(Math.abs(t-i)/r),t+=n*r,o=-n),{x:t,frameId:o}}};s([Ut({dependsOn:["xmin","ymin","zmin","mmin","xmax","ymax","zmax","mmax","spatialReference"],autoTracked:!1})],vo.prototype,"cache",void 0),s([Ut({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],vo.prototype,"center",null),s([Ut({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],vo.prototype,"extent",null),s([Ut({readOnly:!0,dependsOn:["mmin","mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],vo.prototype,"hasM",null),s([Ut({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],vo.prototype,"hasZ",null),s([Ut({readOnly:!0,dependsOn:["ymin","ymax"]})],vo.prototype,"height",null),s([Ut({readOnly:!0,dependsOn:["xmin","xmax"]})],vo.prototype,"width",null),s([Ut({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],vo.prototype,"xmin",void 0),s([Ut({type:Number,json:{write:!0}})],vo.prototype,"ymin",void 0),s([Ut({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],vo.prototype,"mmin",void 0),s([Ut({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],vo.prototype,"zmin",void 0),s([Ut({type:Number,json:{write:!0}})],vo.prototype,"xmax",void 0),s([Ut({type:Number,json:{write:!0}})],vo.prototype,"ymax",void 0),s([Ut({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],vo.prototype,"mmax",void 0),s([Ut({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],vo.prototype,"zmax",void 0),vo=yo=s([ve("esri.geometry.Extent")],vo),vo.prototype.toJSON.isDefaultToJSON=!0;var wo,bo=vo;function go(t,e,i=!1){let{hasM:s,hasZ:r}=t;Array.isArray(e)?4!==e.length||s||r?3===e.length&&i&&!s?(r=!0,s=!1):3===e.length&&s&&r&&(s=!1,r=!1):(s=!0,r=!0):(r=!r&&e.hasZ&&(!s||e.hasM),s=!s&&e.hasM&&(!r||e.hasZ)),t.hasZ=r,t.hasM=s}function So(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}let Mo=wo=class extends bn{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return null;const i={};var s;Array.isArray(t)?(i.points=t,i.spatialReference=e):!(s=t)||"esri.geometry.SpatialReference"!==s.declaredClass&&null==s.wkid?(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM)):i.spatialReference=t;const r=i.points&&i.points[0];return r&&(void 0===i.hasZ&&void 0===i.hasM?(i.hasZ=r.length>2,i.hasM=!1):void 0===i.hasZ?i.hasZ=r.length>3:void 0===i.hasM&&(i.hasM=r.length>3)),i}get extent(){const t=this.points;if(!t.length)return null;const e=new bo,i=this.hasZ,s=this.hasM,r=i?3:2,n=t[0],o=So(Math.min),l=So(Math.max);let a,u,h,c,[f,d]=n,[p,y]=n;for(let e=0,n=t.length;e<n;e++){const n=t[e],[m,v]=n;if(f=o(f,m),d=o(d,v),p=l(p,m),y=l(y,v),i&&n.length>2){const t=n[2];a=o(a,t),h=l(h,t)}if(s&&n.length>r){const t=n[r];u=o(u,t),c=l(c,t)}}return e.xmin=f,e.ymin=d,e.xmax=p,e.ymax=y,e.spatialReference=this.spatialReference,i?(e.zmin=a,e.zmax=h):(e.zmin=null,e.zmax=null),s?(e.mmin=u,e.mmax=c):(e.mmin=null,e.mmax=null),e}writePoints(t,e){e.points=w(this.points)}addPoint(t){return this.clearCache(),go(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this}clone(){const t={points:w(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new wo(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let s=2;return this.hasZ&&(i.z=e[2],s=3),this.hasM&&(i.m=e[s]),new qn(i)}removePoint(t){return this._validateInputs(t)?(this.clearCache(),new qn(this.points.splice(t,1)[0],this.spatialReference)):null}setPoint(t,e){return this._validateInputs(t)?(this.clearCache(),go(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this):this}toJSON(t){return this.write(null,t)}_validateInputs(t){return null!=t&&t>=0&&t<this.points.length}};s([Ut({dependsOn:["points","hasZ","hasM","spatialReference"],autoTracked:!1})],Mo.prototype,"cache",void 0),s([Ut({dependsOn:["cache"],autoTracked:!1})],Mo.prototype,"extent",null),s([Ut({type:[[Number]],json:{write:{isRequired:!0}}})],Mo.prototype,"points",void 0),s([be("points")],Mo.prototype,"writePoints",null),Mo=wo=s([ve("esri.geometry.Multipoint")],Mo),Mo.prototype.toJSON.isDefaultToJSON=!0;var xo=Mo;function ko(t,e){const i=e[0]-t[0],s=e[1]-t[1];if(t.length>2&&e.length>2){const r=t[2]-e[2];return Math.sqrt(i*i+s*s+r*r)}return Math.sqrt(i*i+s*s)}function Co(t,e){return function(t,e){const i=t[0]+.5*(e[0]-t[0]),s=t[1]+.5*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+.5*(e[2]-t[2])]:[i,s]}(t,e)}function Io(t,e,i){const s=t.length;let r=0,n=0,o=0;for(let l=0;l<s;l++){const a=t[l],u=t[(l+1)%s];let h=2;r+=a[0]*u[1]-u[0]*a[1],a.length>2&&u.length>2&&i&&(n+=a[0]*u[2]-u[0]*a[2],h=3),a.length>h&&u.length>h&&e&&(o+=a[0]*u[h]-u[0]*a[h])}return r<=0&&n<=0&&o<=0}function Oo(t,e,i){let s=0,r=0,n=0,o=0,l=0;for(let a=0;a<t.length;a++){const u=t[a],[h,c,f]=u,d=t[(a+1)%t.length],[p,y,m]=d;let v=h*y-p*c;o+=v,s+=(h+p)*v,r+=(c+y)*v,e&&u.length>2&&d.length>2&&(v=h*m-p*f,n+=(f+m)*v,l+=v),h<i[0]&&(i[0]=h),h>i[1]&&(i[1]=h),c<i[2]&&(i[2]=c),c>i[3]&&(i[3]=c),e&&(f<i[4]&&(i[4]=f),f>i[5]&&(i[5]=f))}if(o>0&&(o*=-1),l>0&&(l*=-1),!o)return null;const a=[s,r,.5*o];return e&&(a[3]=n,a[4]=.5*l),a}function jo(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Po(t){return void 0!==t.points}function Ao(t){return void 0!==t.x&&void 0!==t.y}function To(t){return void 0!==t.paths}function No(t){return void 0!==t.rings}function Ro(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}const _o=Ro(Math.min),Eo=Ro(Math.max);function Do(t,e){return To(e)?zo(t,e.paths,!1,!1):No(e)?zo(t,e.rings,!1,!1):Po(e)?Lo(t,e.points,!1,!1,!1,!1):jo(e)?Fo(t,e):(Ao(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function $o(t,e){return To(e)?zo(t,e.paths,!0,!1):No(e)?zo(t,e.rings,!0,!1):Po(e)?Lo(t,e.points,!0,!1,!0,!1):jo(e)?Fo(t,e,0,0,!0,!1):(Ao(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function zo(t,e,i,s){const r=i?3:2;if(!e.length||!e[0].length)return null;let n,o,l,a,[u,h]=e[0][0],[c,f]=e[0][0];for(let t=0;t<e.length;t++){const d=e[t];for(let t=0;t<d.length;t++){const e=d[t],[p,y]=e;if(u=_o(u,p),h=_o(h,y),c=Eo(c,p),f=Eo(f,y),i&&e.length>2){const t=e[2];n=_o(n,t),o=Eo(o,t)}if(s&&e.length>r){const t=e[r];l=_o(n,t),a=Eo(o,t)}}}return i?s?(t[0]=u,t[1]=h,t[2]=n,t[3]=l,t[4]=c,t[5]=f,t[6]=o,t[7]=a,t.length=8,t):(t[0]=u,t[1]=h,t[2]=n,t[3]=c,t[4]=f,t[5]=o,t.length=6,t):s?(t[0]=u,t[1]=h,t[2]=l,t[3]=c,t[4]=f,t[5]=a,t.length=6,t):(t[0]=u,t[1]=h,t[2]=c,t[3]=f,t.length=4,t)}function Fo(t,e,i,s,r,n){const o=e.xmin,l=e.xmax,a=e.ymin,u=e.ymax;let h=e.zmin,c=e.zmax,f=e.mmin,d=e.mmax;return r?(h=h||0,c=c||0,n?(f=f||0,d=d||0,t[0]=o,t[1]=a,t[2]=h,t[3]=f,t[4]=l,t[5]=u,t[6]=c,t[7]=d,t):(t[0]=o,t[1]=a,t[2]=h,t[3]=l,t[4]=u,t[5]=c,t)):n?(f=f||0,d=d||0,t[0]=o,t[1]=a,t[2]=f,t[3]=l,t[4]=u,t[5]=d,t):(t[0]=o,t[1]=a,t[2]=l,t[3]=u,t)}function Lo(t,e,i,s,r,n){const o=i?3:2,l=s&&n,a=i&&r;if(!e.length||!e[0].length)return null;let u,h,c,f,[d,p]=e[0],[y,m]=e[0];for(let t=0;t<e.length;t++){const i=e[t],[s,r]=i;if(d=_o(d,s),p=_o(p,r),y=Eo(y,s),m=Eo(m,r),a&&i.length>2){const t=i[2];u=_o(u,t),h=Eo(h,t)}if(l&&i.length>o){const t=i[o];c=_o(u,t),f=Eo(h,t)}}return r?(u=u||0,h=h||0,n?(c=c||0,f=f||0,t[0]=d,t[1]=p,t[2]=u,t[3]=c,t[4]=y,t[5]=m,t[6]=h,t[7]=f,t):(t[0]=d,t[1]=p,t[2]=u,t[3]=y,t[4]=m,t[5]=h,t)):n?(c=c||0,f=f||0,t[0]=d,t[1]=p,t[2]=c,t[3]=y,t[4]=m,t[5]=f,t):(t[0]=d,t[1]=p,t[2]=y,t[3]=m,t)}const Uo=[];function Vo(t,e,i,s){return{xmin:t,ymin:e,xmax:i,ymax:s}}function Go(t,e,i,s,r,n){return{xmin:t,ymin:e,zmin:i,xmax:s,ymax:r,zmax:n}}function qo(t,e,i,s,r,n){return{xmin:t,ymin:e,mmin:i,xmax:s,ymax:r,mmax:n}}function Bo(t,e,i,s,r,n,o,l){return{xmin:t,ymin:e,zmin:i,mmin:s,xmax:r,ymax:n,zmax:o,mmax:l}}function Ho(t,e=!1,i=!1){return e?i?Bo(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Go(t[0],t[1],t[2],t[3],t[4],t[5]):i?qo(t[0],t[1],t[2],t[3],t[4],t[5]):Vo(t[0],t[1],t[2],t[3])}function Jo(t){return t?void 0!==(e=t).xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?t:function(t){return void 0!==t.x&&void 0!==t.y}(t)?function(t){const{x:e,y:i,z:s,m:r}=t,n=null!=r;return null!=s?n?Bo(e,i,s,r,e,i,s,r):Go(e,i,s,e,i,s):n?qo(e,i,r,e,i,r):Vo(e,i,e,i)}(t):function(t){return void 0!==t.rings}(t)?Wo(t):function(t){return void 0!==t.paths}(t)?Yo(t):function(t){return void 0!==t.points}(t)?function(t){const{hasZ:e,hasM:i,points:s}=t;return Ho(Lo(Uo,s,e,i),e,i)}(t):null:null;var e}function Wo(t){const{hasZ:e,hasM:i,rings:s}=t,r=zo(Uo,s,e,i);return r?Ho(r,e,i):null}function Yo(t){const{hasZ:e,hasM:i,paths:s}=t,r=zo(Uo,s,e,i);return r?Ho(r,e,i):null}var Xo;function Qo(t){return!Array.isArray(t[0])}let Ko=Xo=class extends bn{constructor(...t){super(...t),this.rings=[],this.type="polygon"}static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let s=!1,r=!1;e.map((t=>{t.hasZ&&(s=!0),t.hasM&&(r=!0)}));const n={rings:e.map((function(t){const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(s&&t.hasZ){const i=t.zmin+.5*(t.zmax-t.zmin);for(let t=0;t<e.length;t++)e[t].push(i)}if(r&&t.hasM){const i=t.mmin+.5*(t.mmax-t.mmin);for(let t=0;t<e.length;t++)e[t].push(i)}return e})),spatialReference:i};return s&&(n.hasZ=!0),r&&(n.hasM=!0),new Xo(n)}normalizeCtorArgs(t,e){let i,s,r=null,n=null;return t&&!Array.isArray(t)?(r=t.rings?t.rings:null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,s=t.hasM):r=t,r=r||[],r.length&&r[0]&&null!=r[0][0]&&"number"==typeof r[0][0]&&(r=[r]),n=r[0]&&r[0][0],n&&(void 0===i&&void 0===s?(i=n.length>2,s=!1):void 0===i?i=!s&&n.length>3:void 0===s&&(s=!i&&n.length>3)),{rings:r,spatialReference:e=e||mn.WGS84,hasZ:i,hasM:s}}get centroid(){const t=function(t){return t?function(t,e){if(!t||!t.length)return null;const i=[],s=[],r=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let i=0,n=t.length;i<n;i++){const n=Oo(t[i],e,r);n&&s.push(n)}if(s.sort(((t,i)=>{let s=t[2]-i[2];return 0===s&&e&&(s=t[4]-i[4]),s})),s.length){let t=6*s[0][2];i[0]=s[0][0]/t,i[1]=s[0][1]/t,e&&(t=6*s[0][4],i[2]=0!==t?s[0][3]/t:0),(i[0]<r[0]||i[0]>r[1]||i[1]<r[2]||i[1]>r[3]||e&&(i[2]<r[4]||i[2]>r[5]))&&(i.length=0)}if(!i.length){const s=t[0]&&t[0].length?function(t,e){const i=e?[0,0,0]:[0,0],s=e?[0,0,0]:[0,0];let r=0,n=0,o=0,l=0;for(let a=0,u=t.length;a<u-1;a++){const u=t[a],h=t[a+1];if(u&&h){i[0]=u[0],i[1]=u[1],s[0]=h[0],s[1]=h[1],e&&u.length>2&&h.length>2&&(i[2]=u[2],s[2]=h[2]);const t=ko(i,s);if(t){r+=t;const i=Co(u,h);n+=t*i[0],o+=t*i[1],e&&i.length>2&&(l+=t*i[2])}}}return r>0?e?[n/r,o/r,l/r]:[n/r,o/r]:t.length?t[0]:null}(t[0],e):null;if(!s)return null;i[0]=s[0],i[1]=s[1],e&&s.length>2&&(i[2]=s[2])}return i}(t.rings,t.hasZ):null}(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new qn;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=Wo(this);if(!e)return null;const i=new bo(e);return i.spatialReference=t,i}get isSelfIntersecting(){return function(t){for(let e=0;e<t.length;e++){const i=t[e];for(let s=0;s<i.length-1;s++){const r=i[s],n=i[s+1];for(let i=e+1;i<t.length;i++)for(let e=0;e<t[i].length-1;e++){const s=t[i][e],o=t[i][e+1];if(fo(r,n,s,o,ho)&&!(ho[0]===r[0]&&ho[1]===r[1]||ho[0]===s[0]&&ho[1]===s[1]||ho[0]===n[0]&&ho[1]===n[1]||ho[0]===o[0]&&ho[1]===o[1]))return!0}}const s=i.length;if(!(s<=4))for(let t=0;t<s-3;t++){let e=s-1;0===t&&(e=s-2);const r=i[t],n=i[t+1];for(let s=t+2;s<e;s++){const t=i[s],e=i[s+1];if(fo(r,n,t,e,ho)&&!(ho[0]===r[0]&&ho[1]===r[1]||ho[0]===t[0]&&ho[1]===t[1]||ho[0]===n[0]&&ho[1]===n[1]||ho[0]===e[0]&&ho[1]===e[1]))return!0}}}return!1}(this.rings)}writeRings(t,e){e.rings=w(this.rings)}addRing(t){if(!t)return;this.clearCache();const e=this.rings,i=e.length;if(Qo(t)){const s=[];for(let e=0,i=t.length;e<i;e++)s[e]=t[e].toArray();e[i]=s}else e[i]=t.concat();return this}clone(){const t=new Xo;return t.spatialReference=this.spatialReference,t.rings=w(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}contains(t){return!!t&&(Rn(t,this.spatialReference)&&(t=_n(t,this.spatialReference)),function(t,e){return Bn[1]=e.y,Bn[0]=e.x,Qn(t,Bn)}(this,t))}isClockwise(t){let e;return e=Qo(t)?t.map((t=>this.hasZ?this.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])):t,Io(e,this.hasM,this.hasZ)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],s=this.hasZ,r=this.hasM;return s&&!r?new qn(i[0],i[1],i[2],void 0,this.spatialReference):r&&!s?new qn(i[0],i[1],void 0,i[2],this.spatialReference):s&&r?new qn(i[0],i[1],i[2],i[3],this.spatialReference):new qn(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(this.clearCache(),go(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this):this}removePoint(t,e){return this._validateInputs(t,e)?(this.clearCache(),new qn(this.rings[t].splice(e,1)[0],this.spatialReference)):null}removeRing(t){if(!this._validateInputs(t,null))return null;this.clearCache();const e=this.rings.splice(t,1)[0],i=this.spatialReference;return e.map((t=>new qn(t,i)))}setPoint(t,e,i){return this._validateInputs(t,e)?(this.clearCache(),go(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.rings.length)return!1;if(null!=e){const s=this.rings[t];if(i&&(e<0||e>s.length))return!1;if(!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write(null,t)}};s([Ut({dependsOn:["hasM","hasZ","rings"],autoTracked:!1})],Ko.prototype,"cache",void 0),s([Ut({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],Ko.prototype,"centroid",null),s([Ut({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],Ko.prototype,"extent",null),s([Ut({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],Ko.prototype,"isSelfIntersecting",null),s([Ut({type:[[[Number]]],json:{write:{isRequired:!0}}})],Ko.prototype,"rings",void 0),s([be("rings")],Ko.prototype,"writeRings",null),Ko=Xo=s([ve("esri.geometry.Polygon")],Ko),Ko.prototype.toJSON.isDefaultToJSON=!0;var Zo,tl=Ko;let el=Zo=class extends bn{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let i,s,r=null,n=null;return t&&!Array.isArray(t)?(r=t.paths?t.paths:null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,s=t.hasM):r=t,r=r||[],r.length&&r[0]&&null!=r[0][0]&&"number"==typeof r[0][0]&&(r=[r]),n=r[0]&&r[0][0],n&&(void 0===i&&void 0===s?(i=n.length>2,s=!1):void 0===i?i=!s&&n.length>3:void 0===s&&(s=!i&&n.length>3)),{paths:r,spatialReference:e=e||mn.WGS84,hasZ:i,hasM:s}}get extent(){const{spatialReference:t}=this,e=Yo(this);if(!e)return null;const i=new bo(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=w(this.paths)}addPath(t){if(!t)return;this.clearCache();const e=this.paths,i=e.length;if(function(t){return!Array.isArray(t[0])}(t)){const s=[];for(let e=0,i=t.length;e<i;e++)s[e]=t[e].toArray();e[i]=s}else e[i]=t.concat();return this}clone(){const t=new Zo;return t.spatialReference=this.spatialReference,t.paths=w(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],s=this.hasZ,r=this.hasM;return s&&!r?new qn(i[0],i[1],i[2],void 0,this.spatialReference):r&&!s?new qn(i[0],i[1],void 0,i[2],this.spatialReference):s&&r?new qn(i[0],i[1],i[2],i[3],this.spatialReference):new qn(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(this.clearCache(),go(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this):this}removePath(t){if(!this._validateInputs(t,null))return null;this.clearCache();const e=this.paths.splice(t,1)[0],i=this.spatialReference;return e.map((t=>new qn(t,i)))}removePoint(t,e){return this._validateInputs(t,e)?(this.clearCache(),new qn(this.paths[t].splice(e,1)[0],this.spatialReference)):null}setPoint(t,e,i){return this._validateInputs(t,e)?(this.clearCache(),go(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const s=this.paths[t];if(i&&(e<0||e>s.length))return!1;if(!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write(null,t)}};s([Ut({dependsOn:["hasM","hasZ","paths"],autoTracked:!1})],el.prototype,"cache",void 0),s([Ut({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],el.prototype,"extent",null),s([Ut({type:[[[Number]]],json:{write:{isRequired:!0}}})],el.prototype,"paths",void 0),s([be("paths")],el.prototype,"writePaths",null),el=Zo=s([ve("esri.geometry.Polyline")],el),el.prototype.toJSON.isDefaultToJSON=!0;var il=el;class sl{constructor(t,e={ignoreUnknown:!1}){this.jsonToAPI=t,this.options=e,this.apiValues=[],this.jsonValues=[],this.apiToJSON=this.invertMap(t),this.apiValues=this.getKeysSorted(this.apiToJSON),this.jsonValues=this.getKeysSorted(this.jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,e,i)=>{const s=this.toJSON(t);void 0!==s&&(e[i]=s)},this.write.isJSONMapWriter=!0}toJSON(t){return this.apiToJSON.hasOwnProperty(t)?this.apiToJSON[t]:this.options.ignoreUnknown?void 0:t}fromJSON(t){return this.jsonToAPI.hasOwnProperty(t)?this.jsonToAPI[t]:this.options.ignoreUnknown?void 0:t}invertMap(t){const e={};for(const i in t)e[t[i]]=i;return e}getKeysSorted(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}}function rl(){return function(t){return new sl(t,{ignoreUnknown:!0})}}const nl=rl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),ol=rl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function ll(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function al(t){return void 0!==t.points}function ul(t){return void 0!==t.x&&void 0!==t.y}function hl(t){return void 0!==t.paths}function cl(t){return void 0!==t.rings}function fl(t){return t?t instanceof bn?t:ul(t)?qn.fromJSON(t):hl(t)?il.fromJSON(t):cl(t)?tl.fromJSON(t):al(t)?xo.fromJSON(t):ll(t)?bo.fromJSON(t):null:null}function dl(t){return t?ul(t)?"esriGeometryPoint":hl(t)?"esriGeometryPolyline":cl(t)?"esriGeometryPolygon":ll(t)?"esriGeometryEnvelope":al(t)?"esriGeometryMultipoint":null:null}const pl={esriGeometryPoint:qn,esriGeometryPolyline:il,esriGeometryPolygon:tl,esriGeometryEnvelope:bo,esriGeometryMultipoint:xo};function yl(t){return t&&pl[t]||null}const ml={base:bn,key:"type",typeMap:{extent:bo,multipoint:xo,point:qn,polyline:il,polygon:tl}};let vl;async function wl(){return vl||(vl=(async()=>{const t=await import("./p-df16e524.js").then((function(t){return t.aq}));return await t.arcade.load(),{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),vl}yt(ml);const bl=(t,e,i)=>Sl.create(t,e,i,null,["$feature"]),gl=(t,e,i)=>Sl.create(t,e,i,null,["$feature","$view"]);class Sl{constructor(t,e,i,s,r,n,o,l){this.script=t,this.evaluate=r,this.fields=o,this._syntaxTree=s,this._arcade=e,this._arcadeDictionary=i,this._arcadeFeature=n,this._spatialReference=l,this._referencesGeometry=e.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,e,i,s,r,n){const{arcade:o,Feature:l,Dictionary:a}=await wl(),u=mn.fromJSON(e),h=o.parseScript(t,n),c=r.reduce(((t,e)=>({...t,[e]:null})),{});let f=null;M(s)&&(f=new a(s),f.immutable=!0,c.$config=null);const d=o.scriptUsesGeometryEngine(h)&&o.enableGeometrySupport(),p=o.scriptUsesFeatureSet(h)&&o.enableFeatureSetSupport(),y=o.scriptIsAsync(h)&&o.enableAsyncSupport(),m={vars:c,spatialReference:u,useAsync:!!y},v=new a;v.immutable=!1,v.setField("scale",0);const w=o.compileScript(h,m);return await Ei([d,p,y]),new Sl(t,o,a,h,(t=>("$view"in t&&t.$view&&(v.setField("scale",t.$view.scale),t.$view=v),f&&(t.$config=f),w({vars:t,spatialReference:u}))),new l,i,u)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}repurposeAdapter(t){return this._arcadeFeature.repurposeFromAdapter(t,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(t){return this._arcade.referencesMember(this._syntaxTree,t)}referencesFunction(t){return this._arcade.referencesFunction(this._syntaxTree,t)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(t){return this._arcade.extractFieldLiterals(this._syntaxTree,t)}}function Ml(t,e={ignoreUnknown:!0}){const i=t instanceof sl?t:new sl(t,e),s={type:null!=e&&e.ignoreUnknown?i.apiValues:String,readOnly:null==e?void 0:e.readOnly,json:{type:i.jsonValues,read:(null==e||!e.readOnly)&&{reader:i.read},write:{writer:i.write}}};return void 0!==(null==e?void 0:e.default)&&(s.json.default=e.default),Ut(s)}const xl=new sl({inherited:"inherited",codedValue:"coded-value",range:"range"});let kl=class extends Wr{constructor(t){super(t),this.name=null,this.type=null}};s([Ut({type:String,json:{write:!0}})],kl.prototype,"name",void 0),s([Ml(xl)],kl.prototype,"type",void 0),kl=s([ve("esri.layers.support.Domain")],kl);var Cl,Il=kl;let Ol=Cl=class extends Wr{constructor(t){super(t),this.name=null,this.code=null}clone(){return new Cl({name:this.name,code:this.code})}};s([Ut({type:String,json:{write:!0}})],Ol.prototype,"name",void 0),s([Ut({type:[String,Number],json:{write:!0}})],Ol.prototype,"code",void 0),Ol=Cl=s([ve("esri.layers.support.CodedValue")],Ol);var jl,Pl=Ol;let Al=jl=class extends Il{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some((t=>(String(t.code)===i&&(e=t.name),!!e)))}return e}clone(){return new jl({codedValues:w(this.codedValues),name:this.name})}};s([Ut({type:[Pl],json:{write:!0}})],Al.prototype,"codedValues",void 0),s([Ml({codedValue:"coded-value"})],Al.prototype,"type",void 0),Al=jl=s([ve("esri.layers.support.CodedValueDomain")],Al);var Tl,Nl=Al;let Rl=Tl=class extends Il{constructor(t){super(t),this.type="inherited"}clone(){return new Tl}};s([Ml({inherited:"inherited"})],Rl.prototype,"type",void 0),Rl=Tl=s([ve("esri.layers.support.InheritedDomain")],Rl);var _l,El=Rl;let Dl=_l=class extends Il{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new _l({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};s([Ut({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],Dl.prototype,"maxValue",void 0),s([Ut({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],Dl.prototype,"minValue",void 0),s([Ml({range:"range"})],Dl.prototype,"type",void 0),Dl=_l=s([ve("esri.layers.support.RangeDomain")],Dl);var $l,zl=Dl;!function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}($l||($l={}));const Fl={key:"type",base:Il,typeMap:{range:zl,"coded-value":Nl,inherited:El}};function Ll(t){if(!t||!t.type)return null;switch(t.type){case"range":return zl.fromJSON(t);case"codedValue":return Nl.fromJSON(t);case"inherited":return El.fromJSON(t)}return null}const Ul=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Vl=["field","normalizationField"];function Gl(t,e){if(null!=t&&null!=e)for(const i of Array.isArray(t)?t:[t])if(ql(Ul,i,e),"visualVariables"in i&&i.visualVariables)for(const t of i.visualVariables)ql(Vl,t,e)}function ql(t,e,i){if(t)for(const s of t){const t=$(s,e),r=t&&"function"!=typeof t&&Xl(i,t);r&&z(s,r.name,e)}}function Bl(t,e){if(null!=t&&null!=e)if("startField"in t){const i=Xl(e,t.startField),s=Xl(e,t.endField);t.startField=i&&i.name||null,t.endField=s&&s.name||null}else{const i=Xl(e,t.startTimeField),s=Xl(e,t.endTimeField);t.startTimeField=i&&i.name||null,t.endTimeField=s&&s.name||null}}const Hl=new Set;function Jl(t,e){return t&&e?(Hl.clear(),Wl(Hl,t,e),Array.from(Hl).sort()):[]}function Wl(t,e,i){if(i)if(e&&e.length)if(i.includes("*"))for(const{name:i}of e)t.add(i);else for(const s of i)Yl(t,e,s);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const e of i)t.add(e)}}function Yl(t,e,i){if(e&&e.length){const s=Xl(e,i);s&&t.add(s.name)}else"string"==typeof i&&t.add(i)}function Xl(t,e){if("string"!=typeof e)return null;if(null!=t){e=e.toLowerCase();for(const i of t)if(i&&i.name.toLowerCase()===e)return i}return null}function Ql(t,e){if(!t||!e||"string"!=typeof e)return!1;e=e.toLowerCase();for(const i of t)if(i&&i.name.toLowerCase()===e)return!0;return!1}async function Kl(t,e,i){if(!i)return;const{arcadeUtils:s}=await wl(),r=s.extractFieldNames(i);for(const i of r)Yl(t,e,i)}function Zl({displayField:t,fields:e}){return t||(e&&e.length?ta(e,"name-or-title")||ta(e,"unique-identifier")||ta(e,"type-or-category")||function(t){for(const e of t){if(!e||!e.name)continue;const t=e.name.toLowerCase();if(t.indexOf("name")>-1||t.indexOf("title")>-1)return e.name}return null}(e):null)}function ta(t,e){for(const i of t)if(i&&i.valueType&&i.valueType===e)return i.name;return null}function ea(t){const e=t.defaultValue;return void 0!==e&&ua(t,e)?e:t.nullable?null:void 0}function ia(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function sa(t){return null===t||ia(t)}const ra="isInteger"in Number?Number.isInteger:t=>"number"==typeof t&&isFinite(t)&&Math.floor(t)===t;function na(t){return null===t||ra(t)}function oa(t){return null!=t&&"string"==typeof t}function la(t){return null===t||oa(t)}function aa(){return!0}function ua(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":i=t.nullable?na:ra;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?sa:ia;break;case"string":case"esriFieldTypeString":i=t.nullable?la:oa;break;default:i=aa}return 1===arguments.length?i:i(e)}const ha=new Set(["integer","small-integer","single","double","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);function ca(t){return null!=t&&ha.has(t.type)}function fa(t){return null!=t&&("string"===t.type||"esriFieldTypeString"===t.type)}var da,pa;function ya(t){return null==t||"number"==typeof t&&isNaN(t)?null:t}function ma(t,e){return t.nullable&&null===e?null:ca(t)&&!function(t,e){const i="string"==typeof t?va(t):t;return!!i&&(i.isInteger?ra(e)&&e>=i.min&&e<=i.max:e>=i.min&&e<=i.max)}(t.type,Number(e))?da.OUT_OF_RANGE:ua(t,e)?t.domain?function(t,e){switch(t.type){case"range":{const i="range"in t?t.range[1]:t.maxValue;if(+e<("range"in t?t.range[0]:t.minValue)||+e>i)return $l.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==t.codedValues||t.codedValues.every((t=>null==t||t.code!==e)))return $l.INVALID_CODED_VALUE}return null}(t.domain,e):null:pa.INVALID_TYPE}function va(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return wa;case"esriFieldTypeInteger":case"integer":return ba;case"esriFieldTypeSingle":case"single":return ga;case"esriFieldTypeDouble":case"double":return Sa}}(da||(da={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range",(pa||(pa={})).INVALID_TYPE="type-validation-error::invalid-type";const wa={min:-32768,max:32767,isInteger:!0},ba={min:-2147483648,max:2147483647,isInteger:!0},ga={min:-34e37,max:12e37,isInteger:!1},Sa={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function Ma(t,e,i){switch(t){case $l.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case $l.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case pa.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case da.OUT_OF_RANGE:{const{min:t,max:s}=va(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${t} to ${s}`}}}function xa(t,e){return!function(t,e,i){if(!e||!e.attributes||!t){if(M(i))for(const e of t)i.add(e);return!0}const s=e.attributes;let r=!1;for(const e of t)if(!(e in s)){if(r=!0,!M(i))break;i.add(e)}return r}(t,e,null)}const ka={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,5,10]};function Ca(t,e,i){i<0&&++i,i>1&&--i;const s=6*i;return s<1?t+(e-t)*s:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}const Ia=new Float32Array(1);function Oa(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function ja(t,e,i){return t<e?e:t>i?i:t}function Pa(t,e,i){return Math.min(Math.max(t,e),i)}function Aa(t){return 0==(t&t-1)}const Ta=Math.log2||function(t){return Math.log(t)/Math.LN2};function Na(t,e,i){return t+(e-t)*i}function Ra(t){return t*Math.PI/180}function _a(t){return 180*t/Math.PI}function Ea(t){return Math.acos(ja(t,-1,1))}function Da(t){return Math.asin(ja(t,-1,1))}function $a(t){return ja(tt(t),0,255)}function za(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}Ia[0]=34028234663852886e22;class Fa{constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}static blendColors(t,e,i,s=new Fa){return s.r=Math.round(t.r+(e.r-t.r)*i),s.g=Math.round(t.g+(e.g-t.g)*i),s.b=Math.round(t.b+(e.b-t.b)*i),s.a=t.a+(e.a-t.a)*i,s._sanitize()}static fromRgb(t,e){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const t=i[2].split(/\s*,\s*/),s=i[1];if("rgb"===s&&3===t.length||"rgba"===s&&4===t.length){const i=t[0];if("%"===i.charAt(i.length-1)){const i=t.map((t=>2.56*parseFloat(t)));return 4===t.length&&(i[3]=parseFloat(t[3])),Fa.fromArray(i,e)}return Fa.fromArray(t.map((t=>parseFloat(t))),e)}if("hsl"===s&&3===t.length||"hsla"===s&&4===t.length)return Fa.fromArray(function(t,e,i,s=1){const r=(t%360+360)%360/360,n=i<=.5?i*(e+1):i+e-i*e,o=2*i-n;return[Math.round(256*Ca(o,n,r+1/3)),Math.round(256*Ca(o,n,r)),Math.round(256*Ca(o,n,r-1/3)),s]}(parseFloat(t[0]),parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])),e)}return null}static fromHex(t,e=new Fa){const i=4===t.length?4:8,s=(1<<i)-1;let r=Number("0x"+t.substr(1));return isNaN(r)?null:(["b","g","r"].forEach((t=>{const n=r&s;r>>=i,e[t]=4===i?17*n:n})),e.a=1,e)}static fromArray(t,e=new Fa){return e._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(e.a)&&(e.a=1),e._sanitize()}static fromString(t,e){const i=function(t){var e;return null!=(e=ka[t])?e:null}(t);return i&&Fa.fromArray(i,e)||Fa.fromRgb(t,e)||Fa.fromHex(t,e)}static fromJSON(t){return t&&new Fa([t[0],t[1],t[2],t[3]/255])}static toUnitRGB(t){return M(t)?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return M(t)?[t.r/255,t.g/255,t.b/255,null!=t.a?t.a:1]:null}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(t){if("string"==typeof t)Fa.fromString(t,this);else if(Array.isArray(t))Fa.fromArray(t,this);else{var e,i,s,r;this._set(null!=(e=t.r)?e:0,null!=(i=t.g)?i:0,null!=(s=t.b)?s:0,null!=(r=t.a)?r:1),t instanceof Fa||this._sanitize()}return this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return`#${t.length<2?"0"+t:t}${e.length<2?"0"+e:e}${i.length<2?"0"+i:i}`}toCss(t=!1){const e=this.r+", "+this.g+", "+this.b;return t?`rgba(${e}, ${this.a})`:`rgb(${e})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=0){const e=$a(this.r),i=$a(this.g),s=$a(this.b);return 0===t||1!==this.a?[e,i,s,$a(255*this.a)]:[e,i,s]}clone(){return new Fa(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}_sanitize(){return this.r=Math.round(za(this.r,0,255)),this.g=Math.round(za(this.g,0,255)),this.b=Math.round(za(this.b,0,255)),this.a=za(this.a,0,1),this}_set(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}}Fa.prototype.declaredClass="esri.Color";const La=new sl({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Ua=0,Va=class extends Wr{constructor(t){super(t),this.id="sym"+Ua++,this.type=null}set color(t){this._set("color",t)}readColor(t){return t&&null!=t[0]?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,e){}hash(){return JSON.stringify(this.toJSON())}clone(){}};s([Ut({type:La.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:La.write}}})],Va.prototype,"type",void 0),s([Ut({type:Fa,value:new Fa([0,0,0,1]),json:{write:{allowNull:!0}}})],Va.prototype,"color",null),s([vn("color")],Va.prototype,"readColor",null),Va=s([ve("esri.symbols.Symbol")],Va);var Ga,qa=Va;let Ba=Ga=class extends qa{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){if(t)for(const i in t)e[i]=t[i]}async collectRequiredFields(t,e){if("CIMSymbolReference"===this.data.type){const i=this.data.primitiveOverrides;if(i){const s=i.map((i=>Kl(t,e,i.valueExpressionInfo.expression)));await Ei(s)}}}clone(){return new Ga({data:w(this.data)})}hash(){return B(JSON.stringify(this.data)).toString()}};s([Ut({json:{write:!1}})],Ba.prototype,"color",void 0),s([Ut({json:{write:!0}})],Ba.prototype,"data",void 0),s([vn("data",["symbol"])],Ba.prototype,"readData",null),s([be("data")],Ba.prototype,"writeData",null),s([Ml({CIMSymbolReference:"cim"},{readOnly:!0})],Ba.prototype,"type",void 0),Ba=Ga=s([ve("esri.symbols.CIMSymbol")],Ba);var Ha=Ba;const Ja="4.18",Wa={request:(t,e)=>Promise.resolve().then((function(){return yu})).then((({default:i})=>{const s=t.options||{};return s.responseType="array-buffer",s.signal=null==e?void 0:e.signal,i(t.url,s)})).then((t=>({result:{data:t.data,ssl:t.ssl},transferList:[t.data]})))};let Ya,Xa;function Qa(t){Ya=t}function Ka(t){const e=Ya&&Ya.findCredential(t);return e&&e.token?gi(t,"token",e.token):t}function Za(t,e,i=!1,s){return Di(((r,n)=>{if(Ui(s))return void n(tu());let o=()=>{u(),n(new Error(`Unable to load ${e}`))},l=()=>{const e=t;u(),r(e)},a=()=>{if(!t)return;const e=t;u(),e.src="",n(tu())};const u=()=>{h("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",l)),o=null,l=null,t=null,M(s)&&s.removeEventListener("abort",a),a=null,i&&URL.revokeObjectURL(e)};M(s)&&s.addEventListener("abort",a),h("esri-image-decode")?t.decode().then(l,o):(t.addEventListener("error",o),t.addEventListener("load",l))}))}function tu(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}async function eu(t,e){const i=ri(t),s=si(t);s||i||(t=Ze(t));const n={url:t,requestOptions:{...e}};let o=function(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),i=Me.interceptors;if(i)for(const t of i)if(Array.isArray(t.urls)){if(t.urls.some(e))return t}else if(e(t.urls))return t;return null}(t);if(o){const t=await async function(t,e){if(null!=t.responseData)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,s;try{s=await t.before(e)}catch(t){i=au("request:interceptor",t,e)}if((s instanceof Error||s instanceof ge)&&(i=au("request:interceptor",s,e)),i)throw t.error&&t.error(i),i;return s}}(o,n);if(null!=t)return{data:t,getHeader:lu,requestOptions:n.requestOptions,url:n.url};o.after||o.error||(o=null)}if(t=n.url,"image"===(e=n.requestOptions).responseType){if(h("host-webworker")||h("host-node"))throw au("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n)}else if(i)throw au("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+e.responseType),n);if("head"===e.method){if(e.body)throw au("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(i||s)throw au("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await async function(){h("host-webworker")?Xa||(Xa=await import("./p-1f372482.js")):eu._abortableFetch||(eu._abortableFetch=r.fetch.bind(r))}(),Xa)return Xa.execute(t,e);const l=zi();qi(e,(()=>l.abort()));const a={controller:l,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:o,params:n,redoRequest:!1,useIdentity:iu.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},u=await async function(t){let e,i;await async function(t){const e=t.params.url,i=t.params.requestOptions,s=t.controller.signal,n=i.body;let o=null,l=null,a=null;su&&"HTMLFormElement"in r&&(n instanceof FormData?o=n:n instanceof HTMLFormElement&&(l=n,o=new FormData(l))),"string"==typeof n&&(a=n),t.fetchOptions={cache:i.cacheBust&&!eu._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:"head"===i.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:s},(o||a)&&(t.fetchOptions.body=o||a),"anonymous"===i.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||i.query&&i.query.token||o&&o.get&&o.get("token")||l&&l.elements.token);const u=ei(e,!0);if(u&&!t.hasToken&&H.apiKey&&u.endsWith(".arcgis.com")&&"elevation3d.arcgis.com"!==u&&"js.arcgis.com"!==u&&"jsdev.arcgis.com"!==u&&"jsqa.arcgis.com"!==u&&(i.query||(i.query={}),i.query.token=H.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!hu(e)&&!Ui(s)){let r;"immediate"===i.authMode?(await uu(),r=await Ya.getCredential(e,{signal:s}),t.credential=r):"no-prompt"===i.authMode?(await uu(),r=await Ya.getCredential(e,{prompt:!1,signal:s}).catch((()=>{})),t.credential=r):Ya&&(r=Ya.findCredential(e)),r&&(t.credentialToken=r.token,t.useSSL=!!r.ssl)}}(t);try{do{[e,i]=await cu(t)}while(!await du(t,e,i))}catch(i){const s=au("request:server",i,t.params,e);throw s.details.ssl=t.useSSL,t.interceptor&&t.interceptor.error&&t.interceptor.error(s),s}const s=t.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(s)&&!t.hasToken&&!t.credentialToken&&i&&i.user&&i.user.username&&!Ye(s)){const t=ei(s,!0);t&&iu.trustedServers.push(t)}const n=t.credential;if(n&&Ya){const t=Ya.findServerInfo(n.server);let e=t&&t.owningSystemUrl;if(e){e=e.replace(/\/?$/,"/sharing");const t=Ya.findCredential(e,n.userId);t&&-1===Ya._getIdenticalSvcIdx(e,t)&&t.resources.unshift(e)}}return{data:i,getHeader:e?t=>e.headers.get(t):lu,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}(a);return o&&o.after&&o.after(u),u}h("host-webworker")||(h("edge")||h("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser");const iu=H.request,su="FormData"in r,ru=[499,498,403,401],nu=["COM_0056","COM_0057","SB_0008"],ou=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],lu=()=>null;function au(t,e,i,s){let r="Error";const n={url:i.url,requestOptions:i.requestOptions,getHeader:lu,ssl:!1};if(e instanceof ge)return e.details?(e.details=w(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=n,e;if(e){const t=s&&(t=>s.headers.get(t)),i=s&&s.status,o=e.message;o&&(r=o),t&&(n.getHeader=t),n.httpStatus=(null!=e.httpCode?e.httpCode:e.code)||i||0,n.subCode=e.subcode,n.messageCode=e.messageCode,n.messages="string"==typeof e.details?[e.details]:e.details}return Ji(e)?$i():new ge(t,r,n)}async function uu(){Ya||await import("./p-4db17e79.js")}function hu(t){return ou.some((e=>e.test(t)))}async function cu(t){let e=t.params.url;const i=t.params.requestOptions,s=t.fetchOptions,r=si(e)||ri(e),n=i.responseType||"json",o=r?0:null!=i.timeout?i.timeout:iu.timeout;let l=!1;if(!r){t.useSSL&&(e=ci(e)),i.cacheBust&&"default"===s.cache&&(e=gi(e,"request.preventCache",Date.now()));let r={...i.query};t.credentialToken&&(r.token=t.credentialToken);let n=Fe(r);h("esri-url-encodes-apostrophe")&&(n=n.replace(/'/g,"%27"));const o=e.length+1+n.length;let a;l="post"===i.method||!!i.body||o>iu.maxUrlLength;const u=i.useProxy||!!Be(e);if(u){const t=Le(e);a=t.path,!l&&a.length+1+o>iu.maxUrlLength&&(l=!0),t.query&&(r={...t.query,...r})}if("HEAD"===s.method&&(l||u)){if(l){if(o>iu.maxUrlLength)throw au("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params);throw au("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params)}if(u)throw au("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(l?(s.method="POST",i.body?e=Si(e,r):(s.body=Fe(r),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=Si(e,r),u&&(t.useProxy=!0,e=`${a}?${e}`),r.token&&su&&s.body instanceof FormData){const t=s.body;t.set?t.set("token",r.token):t.append("token",r.token)}if(i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(Ye(e))t.withCredentials=!0;else if(Ya){const i=Ya.findServerInfo(e);i&&i.webTierAuth&&(t.withCredentials=!0)}t.withCredentials&&(s.credentials="include")}let a,u,c=0,f=!1;o>0&&(c=setTimeout((()=>{f=!0,t.controller.abort()}),o));try{if("image"!==i.responseType||"default"!==s.cache||"GET"!==s.method||l||function(t){if(t)for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0;return!1}(i.headers)||!r&&!t.useProxy&&iu.proxyUrl&&!function(t){const e=ei(t);return!e||e.endsWith(".arcgis.com")||-1!==eu._corsServers.indexOf(e)||Ye(e)}(e)){if(a=await eu._abortableFetch(e,s),t.useProxy||function(t){if(si(t)||ri(t))return;const e=ei(t);e&&-1===eu._corsServers.indexOf(e)&&eu._corsServers.push(e)}(e),a.ok&&"HEAD"!==s.method){switch(n){case"array-buffer":u=await a.arrayBuffer();break;case"blob":case"image":u=await a.blob();break;default:u=await a.text()}if(c&&(clearTimeout(c),c=0),"json"===n||"xml"===n||"document"===n)if(u)switch(n){case"json":u=JSON.parse(u);break;case"xml":u=fu(u,"application/xml");break;case"document":u=fu(u,"text/html")}else u=null;if(u){if("array-buffer"===n||"blob"===n){const t=a.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(t)&&u["blob"===n?"size":"byteLength"]<=750)try{const t=await new Response(u).json();t.error&&(u=t)}catch{}}"image"===n&&u instanceof Blob&&(u=await pu(URL.createObjectURL(u),t,!0))}}}else u=await pu(e,t)}catch(s){if("AbortError"===s.name){if(f)throw new Error("Timeout exceeded");throw $i("Request canceled")}if(!(!a&&s instanceof TypeError&&iu.proxyUrl)||i.body||"post"===i.method||"head"===i.method||t.useProxy)throw s;t.redoRequest=!0,function(t){const e={proxyUrl:t.proxyUrl,urlPrefix:qe(t.urlPrefix)},i=Me.proxyRules,s=e.urlPrefix;let r=i.length;for(let t=0;t<i.length;t++){const e=i[t].urlPrefix;if(0===s.indexOf(e)){if(s.length===e.length)return-1;r=t;break}0===e.indexOf(s)&&(r=t+1)}i.splice(r,0,e)}({proxyUrl:iu.proxyUrl,urlPrefix:pi(De(e).path)})}finally{c&&clearTimeout(c)}return[a,u]}function fu(t,e){let i;try{i=(new DOMParser).parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function du(t,e,i){var s;if(t.redoRequest)return t.redoRequest=!1,!1;if(!e)return!0;if(!e.ok)throw new Error(`Unable to load ${e.url} status: ${e.status}`);let r,n,o,l;i&&i.error&&(r=g(new Error,i.error)),r&&(n=Number(r.code),o=r.hasOwnProperty("subcode")?Number(r.subcode):null,l=r.messageCode,l=l&&l.toUpperCase());const a=t.params.requestOptions.authMode,u=String(null==(s=t.params.requestOptions.query)?void 0:s.token);if(403===n&&(4===o||r.message&&r.message.toLowerCase().indexOf("ssl")>-1&&-1===r.message.toLowerCase().indexOf("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(t.useIdentity&&("no-prompt"!==a||498===n)&&-1!==ru.indexOf(n)&&!hu(t.params.url)&&!u.startsWith("AAPK")&&(403!==n||-1===nu.indexOf(l)&&(null==o||2===o&&t.credentialToken))){await uu();try{const e=await Ya.getCredential(t.params.url,{error:au("request:server",r,t.params),prompt:"no-prompt"!==a,signal:t.controller.signal,token:t.credentialToken});return t.credential=e,t.credentialToken=e.token,t.useSSL=t.useSSL||e.ssl,!1}catch(e){if("no-prompt"===a)return t.credential=null,t.credentialToken=null,!1;r=e}}if(r)throw r;return!0}function pu(t,e,i=!1){const s=e.controller.signal,r=new Image;return r.crossOrigin=e.withCredentials?"use-credentials":"anonymous",r.alt="",r.src=t,Za(r,t,i,s)}eu._abortableFetch=null,eu._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const yu=Object.freeze({__proto__:null,default:eu});var mu;let vu=mu=class extends Wr{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new mu({minValue:this.minValue,maxValue:this.maxValue})}};s([Ut({type:Number,json:{write:!0}})],vu.prototype,"minValue",void 0),s([Ut({type:Number,json:{write:!0}})],vu.prototype,"maxValue",void 0),vu=mu=s([ve("esri.renderer.support.AuthoringInfoClassBreakInfo")],vu);var wu,bu=vu;let gu=wu=class extends Wr{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new wu({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:w(this.classBreakInfos)})}};s([Ut({type:String,json:{write:!0}})],gu.prototype,"field",void 0),s([Ut({type:String,json:{write:!0}})],gu.prototype,"normalizationField",void 0),s([Ut({type:String,json:{write:!0}})],gu.prototype,"label",void 0),s([Ut({type:[bu],json:{write:!0}})],gu.prototype,"classBreakInfos",void 0),gu=wu=s([ve("esri.renderers.support.AuthoringInfoFieldInfo")],gu);var Su,Mu=gu;const xu=new sl({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),ku=new sl({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),Cu={key:t=>"number"==typeof t?"number":"string",typeMap:{number:Number,string:String},base:null},Iu=["high-to-low","above-and-below","centered-on","extremes"],Ou=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],ju=["seconds","minutes","hours","days","months","years"];let Pu=Su=class extends Wr{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return"string"==typeof t||"number"==typeof t?t:null}castStartTime(t){return"string"==typeof t||"number"==typeof t?t:null}get style(){return"color"===this.type?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new Su({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};s([Ut({types:Cu,json:{write:!0}})],Pu.prototype,"endTime",void 0),s([xn("endTime")],Pu.prototype,"castEndTime",null),s([Ut({type:String,json:{write:!0}})],Pu.prototype,"field",void 0),s([Ut({type:Number,json:{write:!0}})],Pu.prototype,"maxSliderValue",void 0),s([Ut({type:Number,json:{write:!0}})],Pu.prototype,"minSliderValue",void 0),s([Ut({types:Cu,json:{write:!0}})],Pu.prototype,"startTime",void 0),s([xn("startTime")],Pu.prototype,"castStartTime",null),s([Ut({type:xu.apiValues,value:null,dependsOn:["type"],json:{type:xu.jsonValues,read:xu.read,write:xu.write}})],Pu.prototype,"style",null),s([Ut({type:Ou,value:null,dependsOn:["type"],json:{type:Ou,origins:{"web-scene":{type:Iu,write:{writer:(t,e)=>{Iu.indexOf(t)>-1&&(e.theme=t)}}}},write:!0}})],Pu.prototype,"theme",null),s([Ut({type:ku.apiValues,json:{type:ku.jsonValues,read:ku.read,write:ku.write}})],Pu.prototype,"type",void 0),s([Ut({type:ju,json:{type:ju,write:!0}})],Pu.prototype,"units",void 0),Pu=Su=s([ve("esri.renderers.support.AuthoringInfoVisualVariable")],Pu);var Au=Pu;let Tu=class extends Wr{constructor(t){super(t),this.type=null}};s([Ut({readOnly:!0,json:{read:!1,write:!0}})],Tu.prototype,"type",void 0),Tu=s([ve("esri.tasks.support.ColorRamp")],Tu);var Nu,Ru=Tu;let _u=Nu=class extends Ru{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new Nu({fromColor:w(this.fromColor),toColor:w(this.toColor),algorithm:this.algorithm})}};s([Ml({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],_u.prototype,"algorithm",void 0),s([Ut({type:Fa,json:{type:[mt],write:!0}})],_u.prototype,"fromColor",void 0),s([Ut({type:Fa,json:{type:[mt],write:!0}})],_u.prototype,"toColor",void 0),s([Ut({type:["algorithmic"]})],_u.prototype,"type",void 0),_u=Nu=s([ve("esri.tasks.support.AlgorithmicColorRamp")],_u);var Eu,Du=_u;let $u=Eu=class extends Ru{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new Eu({colorRamps:w(this.colorRamps)})}};s([Ut({type:[Du],json:{write:!0}})],$u.prototype,"colorRamps",void 0),s([Ut({type:["multipart"]})],$u.prototype,"type",void 0),$u=Eu=s([ve("esri.tasks.support.MultipartColorRamp")],$u);var zu=$u;const Fu={key:"type",base:Ru,typeMap:{algorithmic:Du,multipart:zu}};function Lu(t){return t&&t.type?"algorithmic"===t.type?Du.fromJSON(t):"multipart"===t.type?zu.fromJSON(t):null:null}var Uu;const Vu=new sl({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),Gu=new sl({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),qu=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let Bu=Uu=class extends Wr{constructor(t){super(t),this.colorRamp=null,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&"relationship"!==e?"class-breaks-size"===e||"class-breaks-color"===e?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){if(t)return Lu(t)}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(t){this._set("field2",t)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&"relationship"!==t&&"class-breaks-size"!==t&&"class-breaks-color"!==t||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;"classed-size"===t?e="class-breaks-size":"classed-color"===t&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new Uu({classificationMethod:this.classificationMethod,colorRamp:w(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:w(this.field1),field2:w(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((t=>t.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}};s([Ut({type:Vu.apiValues,value:null,dependsOn:["type"],json:{type:Vu.jsonValues,read:Vu.read,write:Vu.write,origins:{"web-document":{default:"manual",type:Vu.jsonValues,read:Vu.read,write:Vu.write}}}})],Bu.prototype,"classificationMethod",null),s([Ut({types:Fu,json:{write:!0}})],Bu.prototype,"colorRamp",void 0),s([vn("colorRamp")],Bu.prototype,"readColorRamp",null),s([Ut({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],Bu.prototype,"fields",null),s([Ut({type:Mu,value:null,dependsOn:["type"],json:{write:!0}})],Bu.prototype,"field1",null),s([Ut({type:Mu,value:null,dependsOn:["type"],json:{write:!0}})],Bu.prototype,"field2",null),s([Ut({type:["HH","HL","LH","LL"],value:null,dependsOn:["type"],json:{write:!0}})],Bu.prototype,"focus",null),s([Ut({type:Number,value:null,dependsOn:["type"],json:{type:mt,write:!0}})],Bu.prototype,"numClasses",null),s([Ut({type:qu,json:{type:qu,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Bu.prototype,"lengthUnit",void 0),s([Ut({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bu.prototype,"maxSliderValue",void 0),s([Ut({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bu.prototype,"minSliderValue",void 0),s([Ut({type:Object,value:null,dependsOn:["type","univariateTheme"],json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bu.prototype,"statistics",null),s([Ut({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],Bu.prototype,"standardDeviationInterval",null),s([Ut({type:Gu.apiValues,value:null,json:{type:Gu.jsonValues,read:Gu.read,write:Gu.write}})],Bu.prototype,"type",null),s([Ut({type:[Au],json:{write:!0}})],Bu.prototype,"visualVariables",void 0),s([Ut({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,dependsOn:["type","univariateTheme"],json:{write:!0,origins:{"web-scene":{write:!1}}}})],Bu.prototype,"univariateSymbolStyle",null),s([Ut({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Bu.prototype,"univariateTheme",null),Bu=Uu=s([ve("esri.renderers.support.AuthoringInfo")],Bu);var Hu=Bu;const Ju=new sl({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});let Wu=class extends Wr{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const e=new Set;return await this.collectRequiredFields(e,t),Array.from(e).sort()}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};s([Ut({type:Hu,json:{write:!0}})],Wu.prototype,"authoringInfo",void 0),s([Ut({type:Ju.apiValues,readOnly:!0,json:{type:Ju.jsonValues,read:!1,write:{writer:Ju.write,ignoreOrigin:!0}}})],Wu.prototype,"type",void 0),Wu=s([ve("esri.renderers.Renderer")],Wu);var Yu,Xu=Wu;let Qu=Yu=class extends Wr{constructor(){super(...arguments),this.title=null}clone(){return new Yu({title:this.title})}};s([Ut({type:String,json:{write:!0}})],Qu.prototype,"title",void 0),Qu=Yu=s([ve("esri.renderers.support.LegendOptions")],Qu);var Ku,Zu=Qu;let th=Ku=class extends Zu{constructor(){super(...arguments),this.showLegend=null}clone(){return new Ku({title:this.title,showLegend:this.showLegend})}};s([Ut({type:Boolean,json:{write:!0}})],th.prototype,"showLegend",void 0),th=Ku=s([ve("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],th);var eh=th;const ih=W.getLogger("esri.renderers.visualVariables.VisualVariable"),sh=new sl({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let rh=class extends Wr{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return null==t?t:"function"==typeof t?(ih.error(".field: field must be a string value"),null):K(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};s([Ut()],rh.prototype,"index",void 0),s([Ut({type:sh.apiValues,readOnly:!0,json:{read:sh.read,write:sh.write}})],rh.prototype,"type",void 0),s([Ut({type:String,json:{write:!0}})],rh.prototype,"field",void 0),s([xn("field")],rh.prototype,"castField",null),s([Ut({type:String,json:{write:!0}})],rh.prototype,"valueExpression",void 0),s([Ut({type:String,json:{write:!0}})],rh.prototype,"valueExpressionTitle",void 0),s([Ut({readOnly:!0,dependsOn:["valueExpression"]})],rh.prototype,"arcadeRequired",null),s([Ut({type:eh,json:{write:!0}})],rh.prototype,"legendOptions",void 0),rh=s([ve("esri.renderers.visualVariables.VisualVariable")],rh);var nh,oh=rh;let lh=nh=class extends Wr{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=null==t?0:t}clone(){return new nh({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};s([Ut({type:Fa,json:{type:[mt],write:!0}})],lh.prototype,"color",void 0),s([Ut({type:String,json:{write:!0}})],lh.prototype,"label",void 0),s([Ut({type:Number,json:{write:{allowNull:!0}}})],lh.prototype,"value",void 0),s([be("value")],lh.prototype,"writeValue",null),lh=nh=s([ve("esri.renderers.visualVariables.support.ColorStop")],lh);var ah,uh=lh;let hh=ah=class extends oh{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new ah({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};s([Ut({readOnly:!0,dependsOn:["valueExpression","stops"]})],hh.prototype,"cache",null),s([Ut({type:["color"],json:{type:["colorInfo"]}})],hh.prototype,"type",void 0),s([Ut({type:String,json:{write:!0}})],hh.prototype,"normalizationField",void 0),s([Ut({type:[uh],json:{write:!0}})],hh.prototype,"stops",null),hh=ah=s([ve("esri.renderers.visualVariables.ColorVariable")],hh);var ch,fh=hh;function dh(t){const e=tt(100*(1-t));return Math.max(0,Math.min(e,100))}function ph(t){return Math.max(0,Math.min(1-t/100,1))}let yh=ch=class extends Wr{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return ph(e.transparency)}writeOpacity(t,e,i){e[i]=dh(t)}clone(){return new ch({label:this.label,opacity:this.opacity,value:this.value})}};s([Ut({type:String,json:{write:!0}})],yh.prototype,"label",void 0),s([Ut({type:Number,json:{type:mt,write:{target:"transparency"}}})],yh.prototype,"opacity",void 0),s([vn("opacity",["transparency"])],yh.prototype,"readOpacity",null),s([be("opacity")],yh.prototype,"writeOpacity",null),s([Ut({type:Number,json:{write:!0}})],yh.prototype,"value",void 0),yh=ch=s([ve("esri.renderers.visualVariables.support.OpacityStop")],yh);var mh,vh=yh;let wh=mh=class extends oh{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new mh({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};s([Ut({readOnly:!0,dependsOn:["valueExpression","stops"]})],wh.prototype,"cache",null),s([Ut({type:["opacity"],json:{type:["transparencyInfo"]}})],wh.prototype,"type",void 0),s([Ut({type:String,json:{write:!0}})],wh.prototype,"normalizationField",void 0),s([Ut({type:[vh],json:{write:!0}})],wh.prototype,"stops",null),wh=mh=s([ve("esri.renderers.visualVariables.OpacityVariable")],wh);var bh,gh=wh;let Sh=bh=class extends oh{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,s){s&&s.messages&&s.messages.push(new ge("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:`visualVariables[${this.index}].valueExpressionTitle`,context:s}))}clone(){return new bh({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};s([Ut({readOnly:!0,dependsOn:["valueExpression"]})],Sh.prototype,"cache",null),s([Ut({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Sh.prototype,"axis",void 0),s([Ut({type:["rotation"],json:{type:["rotationInfo"]}})],Sh.prototype,"type",void 0),s([Ut({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Sh.prototype,"rotationType",void 0),s([Ut({type:String,json:{write:!0}})],Sh.prototype,"valueExpressionTitle",void 0),s([be("web-scene","valueExpressionTitle")],Sh.prototype,"writeValueExpressionTitleWebScene",null),Sh=bh=s([ve("esri.renderers.visualVariables.RotationVariable")],Sh);var Mh=Sh;const xh=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function kh(t){return t?t/72*96:0}function Ch(t){return t?72*t/96:0}function Ih(t){if("string"==typeof t){if(xh.test(t)){const e=t.match(xh),i=Number(e[1]),s=e[3]&&e[3].toLowerCase(),r="-"===t.charAt(0),n="px"===s?Ch(i):i;return r?-n:n}return console.warn("screenUtils.toPt: input not recognized!"),null}return t}function Oh(t=0,e=0){return{x:t,y:e}}function jh(t){return t}var Ph;let Ah=Ph=class extends Wr{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new Ph({label:this.label,size:this.size,value:this.value})}};s([Ut({type:String,json:{write:!0}})],Ah.prototype,"label",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Ah.prototype,"size",void 0),s([Ut({type:Number,json:{write:!0}})],Ah.prototype,"value",void 0),Ah=Ph=s([ve("esri.renderers.visualVariables.support.SizeStop")],Ah);var Th,Nh=Ah;let Rh=Th=class extends eh{constructor(){super(...arguments),this.customValues=null}clone(){return new Th({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};s([Ut({type:[Number],json:{write:!0}})],Rh.prototype,"customValues",void 0),Rh=Th=s([ve("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],Rh);var _h=Rh;function Eh(t){return t&&"esri.renderers.visualVariables.SizeVariable"===t.declaredClass}function Dh(t){return null!=t&&!isNaN(t)&&isFinite(t)}function $h(t){return t.valueExpression?"expression":t.field&&"string"==typeof t.field?"field":"unknown"}class zh{constructor(){this._emitter=new zh.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class e{constructor(t=null){this.target=t,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear()}emit(t,e){const i=this._listenersMap&&this._listenersMap.get(t);if(!i)return!1;const s=this.target||this;return[...i].forEach((t=>{t.call(s,e)})),i.length>0}on(t,e){if(Array.isArray(t))return St(t.map((t=>this.on(t,e))));if(t.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const i=this._listenersMap.get(t)||[];return i.push(e),this._listenersMap.set(t,i),{remove:()=>{const i=this._listenersMap&&this._listenersMap.get(t)||[],s=i.indexOf(e);s>=0&&i.splice(s,1)}}}once(t,e){let i;return i=this.on(t,(t=>{i.remove(),e.call(null,t)})),i}hasEventListener(t){const e=this._listenersMap&&this._listenersMap.get(t);return null!=e&&e.length>0}}t.EventEmitter=e,t.EventedMixin=t=>{let i=class extends t{constructor(){super(...arguments),this._emitter=new e}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return i=s([ve("esri.core.Evented")],i),i};let i=class extends Rr{constructor(){super(...arguments),this._emitter=new zh.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};i=s([ve("esri.core.Evented")],i),t.EventedAccessor=i}(zh||(zh={}));var Fh,Lh=zh;const Uh=new ds(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1})),Vh=()=>{};function Gh(t){return t?t instanceof Kh?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function qh(t){if(t&&t.length)return t[0]}function Bh(t,e,i,s){const r=Math.min(t.length-i,e.length-s);let n=0;for(;n<r&&t[i+n]===e[s+n];)n++;return n}function Hh(t,e,i,s){e&&e.forEach(((e,r,n)=>{t.push(e),Hh(t,i.call(s,e,r,n),i,s)}))}const Jh=new Set,Wh=new Set,Yh=new Set,Xh=new Map;let Qh=0,Kh=Fh=class extends Lh.EventedAccessor{constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._timer=null,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Qh++})}static isCollection(t){return null!=t&&t instanceof Fh}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Fh?{items:t}:t:{}}*[Symbol.iterator](){yield*this.items}get items(){return this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,...Gh(t)),this._emitAfterChanges(1))}hasEventListener(t){return"change"===t?this._chgListeners.length>0:this._emitter.hasEventListener(t)}on(t,e){if("change"===t){const t=this._chgListeners,i={removed:!1,callback:e};return t.push(i),this._notifications&&this._notifications.push({listeners:t.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=Vh,i.removed=!0,t.splice(t.indexOf(i),1)}}}return this._emitter.on(t,e)}once(t,e){const i=this.on(t,e);return{remove(){i.remove()}}}add(t,e){if(this._emitBeforeChanges(1))return this;const i=this.getNextIndex(null!=e?e:null);return this._splice(i,0,t),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(!t||!t.length)return this;if(this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e);return this._splice(i,0,...Gh(t)),this._emitAfterChanges(1),this}removeAll(){if(!this.length||this._emitBeforeChanges(2))return[];const t=this._splice(0,this.length)||[];return this._emitAfterChanges(2),t}clone(){return this._createNewInstance({items:this._items.map(w)})}concat(...t){const e=t.map(Gh);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(!this.length||this._emitBeforeChanges(2))return;const i=this._splice(0,this.length),s=i.length;for(let r=0;r<s;r++)t.call(e,i[r],r,i);this._emitAfterChanges(2)}every(t,e){return this._items.every(t,e)}filter(t,e){let i;return i=2===arguments.length?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return this._items.find(t,e)}findIndex(t,e){return this._items.findIndex(t,e)}flatten(t,e){const i=[];return Hh(i,this,t,e),new Fh(i)}forEach(t,e){return this._items.forEach(t,e)}getItemAt(t){return this._items[t]}getNextIndex(t){const e=this.length;return(t=null==t?e:t)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return this._items.includes(t,e)}indexOf(t,e=0){return this._items.indexOf(t,e)}join(t=","){return this._items.join(t)}lastIndexOf(t,e=this.length-1){return this._items.lastIndexOf(t,e)}map(t,e){const i=this._items.map(t,e);return new Fh({items:i})}reorder(t,e=this.length-1){const i=this.indexOf(t);if(-1!==i){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(4))return t;this._splice(i,1),this._splice(e,0,t),this._emitAfterChanges(4)}return t}}pop(){if(!this.length||this._emitBeforeChanges(2))return;const t=qh(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return this._emitBeforeChanges(1)||(this._splice(this.length,0,...t),this._emitAfterChanges(1)),this.length}reduce(t,e){const i=this._items;return 2===arguments.length?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){const i=this._items;return 2===arguments.length?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return this.removeAt(this.indexOf(t))}removeAt(t){if(t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=qh(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(!t||!t.length||this._emitBeforeChanges(2))return[];const e=t instanceof Fh?t.toArray():t,i=this._items,s=[],r=e.length;for(let t=0;t<r;t++){const r=i.indexOf(e[t]);if(r>-1){const n=1+Bh(e,i,t+1,r+1),o=this._splice(r,n);o&&o.length>0&&s.push.apply(s,o),t+=n-1}}return this._emitAfterChanges(2),s}reverse(){if(this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,...t)),this._emitAfterChanges(4),this}shift(){if(!this.length||this._emitBeforeChanges(2))return;const t=qh(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return this._items.some(t,e)}sort(t){if(!this.length||this._emitBeforeChanges(4))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,...e),this._emitAfterChanges(4),this}splice(t,e,...i){const s=(e?2:0)|(i.length?1:0);if(this._emitBeforeChanges(s))return[];const r=this._splice(t,e,...i)||[];return this._emitAfterChanges(s),r}toArray(){return this._items.slice()}toJSON(){return this.toArray()}toLocaleString(){return this._items.toLocaleString()}toString(){return this._items.toString()}unshift(...t){return!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,...t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,...i){const s=this._items,r=this.constructor.prototype.itemType;let n,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=dr((()=>this._dispatchChange()))),e){if(o=s.splice(t,e),this.hasEventListener("before-remove")){const e=Uh.acquire();e.target=this,e.cancellable=!0;for(let i=0,r=o.length;i<r;i++)n=o[i],e.reset(n),this.emit("before-remove",e),e.defaultPrevented&&(o.splice(i,1),s.splice(t,0,n),t+=1,i-=1,r-=1);Uh.release(e)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const t=Uh.acquire();t.target=this,t.cancellable=!1;const e=o.length;for(let i=0;i<e;i++)t.reset(o[i]),this.emit("after-remove",t);Uh.release(t)}}if(i&&i.length){if(r){const t=[];for(const e of i){const i=r.ensureType(e);null==i&&null!=e||t.push(i)}i=t}const e=this.hasEventListener("before-add"),n=this.hasEventListener("after-add"),o=t===this.length;if(e||n){const r=Uh.acquire();r.target=this,r.cancellable=!0;const l=Uh.acquire();l.target=this,l.cancellable=!1;for(const a of i)e?(r.reset(a),this.emit("before-add",r),r.defaultPrevented||(o?s.push(a):s.splice(t++,0,a),this._set("length",s.length),n&&(l.reset(a),this.emit("after-add",l)))):(o?s.push(a):s.splice(t++,0,a),this._set("length",s.length),l.reset(a),this.emit("after-add",l));Uh.release(l),Uh.release(r)}else{if(o)for(const t of i)s.push(t);else s.splice(t,0,...i);this._set("length",s.length)}}return(i&&i.length||o&&o.length)&&this._notifyChangeEvent(i,o),o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Uh.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Uh.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Uh.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Uh.release(e)}}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const t=e.changes;Jh.clear(),Wh.clear(),Yh.clear();for(const{added:e,removed:i}of t){if(e)if(0===Yh.size&&0===Wh.size)for(const t of e)Jh.add(t);else for(const t of e)Wh.has(t)?(Yh.add(t),Wh.delete(t)):Yh.has(t)||Jh.add(t);if(i)if(0===Yh.size&&0===Jh.size)for(const t of i)Wh.add(t);else for(const t of i)Jh.has(t)?Jh.delete(t):(Yh.delete(t),Wh.add(t))}const i=Fs.acquire();Jh.forEach((t=>{i.push(t)}));const s=Fs.acquire();Wh.forEach((t=>{s.push(t)}));const r=this._items,n=e.items,o=Fs.acquire();if(Yh.forEach((t=>{n.indexOf(t)!==r.indexOf(t)&&o.push(t)})),e.listeners&&(i.length||s.length||o.length)){const t={target:this,added:i,removed:s,moved:o},r=e.listeners.length;for(let i=0;i<r;i++){const s=e.listeners[i];s.removed||s.callback.call(this,t)}}Fs.release(i),Fs.release(s),Fs.release(o)}Jh.clear(),Wh.clear(),Yh.clear()}};Kh.ofType=t=>{if(!t)return Fh;if(Xh.has(t))return Xh.get(t);let e=null;if("function"==typeof t)e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const s=t.typeMap[i].prototype.declaredClass;e?e+=` | ${s}`:e=s}let i=class extends Fh{};i=s([ve(`esri.core.Collection<${e}>`)],i);const r={Type:t,ensureType:"function"==typeof t?ut(t):yt(t)};return Object.defineProperty(i.prototype,"itemType",{value:r}),Xh.set(t,i),i},s([Ut()],Kh.prototype,"length",void 0),s([Ut()],Kh.prototype,"items",null),Kh=Fh=s([ve("esri.core.Collection")],Kh);var Zh=Kh;let tc=class extends Wr{constructor(t){super(t),this.type=null}};s([Ut({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],tc.prototype,"type",void 0),tc=s([ve("esri.popup.content.Content")],tc);var ec,ic=tc;let sc=ec=class extends ic{constructor(t){super(t),this.displayType=null,this.type="attachments"}clone(){return new ec({displayType:this.displayType})}};s([Ut({type:["preview","list"],json:{write:!0}})],sc.prototype,"displayType",void 0),s([Ut({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],sc.prototype,"type",void 0),sc=ec=s([ve("esri.popup.content.AttachmentsContent")],sc);var rc,nc=sc;let oc=rc=class extends ic{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new rc({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?w(this.outFields):null})}};s([Ut()],oc.prototype,"creator",void 0),s([Ut()],oc.prototype,"destroyer",void 0),s([Ut()],oc.prototype,"outFields",void 0),s([Ut({type:["custom"],readOnly:!0})],oc.prototype,"type",void 0),oc=rc=s([ve("esri.popup.content.CustomContent")],oc);var lc=oc;const ac=rl()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});var uc,hc,cc;let fc;ac.toJSON.bind(ac),ac.fromJSON.bind(ac);const dc=null!=(uc=null==(hc=r.esriConfig)?void 0:hc.locale)?uc:null==(cc=r.dojoConfig)?void 0:cc.locale;function pc(){var t,e;return null!=(t=null!=dc?dc:null==(e=r.navigator)?void 0:e.language)?t:"en"}function yc(){return void 0===fc&&(fc=pc()),fc}const mc=[];function vc(t){return mc.push(t),{remove(){mc.splice(mc.indexOf(t),1)}}}const wc=[];function bc(t){return wc.push(t),{remove(){mc.splice(wc.indexOf(t),1)}}}null==r.addEventListener||r.addEventListener("languagechange",(function(){const t=pc();fc!==t&&(fc=t,[...wc].forEach((e=>{e.call(null,t)})),[...mc].forEach((e=>{e.call(null,t)})))}));const gc={year:"numeric",month:"numeric",day:"numeric"},Sc={year:"numeric",month:"long",day:"numeric"},Mc={year:"numeric",month:"short",day:"numeric"},xc={year:"numeric",month:"long",weekday:"long",day:"numeric"},kc={hour:"numeric",minute:"numeric"},Cc={...kc,second:"numeric"},Ic={"short-date":gc,"short-date-short-time":{...gc,...kc},"short-date-short-time-24":{...gc,...kc,hour12:!1},"short-date-long-time":{...gc,...Cc},"short-date-long-time-24":{...gc,...Cc,hour12:!1},"short-date-le":gc,"short-date-le-short-time":{...gc,...kc},"short-date-le-short-time-24":{...gc,...kc,hour12:!1},"short-date-le-long-time":{...gc,...Cc},"short-date-le-long-time-24":{...gc,...Cc,hour12:!1},"long-month-day-year":Sc,"long-month-day-year-short-time":{...Sc,...kc},"long-month-day-year-short-time-24":{...Sc,...kc,hour12:!1},"long-month-day-year-long-time":{...Sc,...Cc},"long-month-day-year-long-time-24":{...Sc,...Cc,hour12:!1},"day-short-month-year":Mc,"day-short-month-year-short-time":{...Mc,...kc},"day-short-month-year-short-time-24":{...Mc,...kc,hour12:!1},"day-short-month-year-long-time":{...Mc,...Cc},"day-short-month-year-long-time-24":{...Mc,...Cc,hour12:!1},"long-date":xc,"long-date-short-time":{...xc,...kc},"long-date-short-time-24":{...xc,...kc,hour12:!1},"long-date-long-time":{...xc,...Cc},"long-date-long-time-24":{...xc,...Cc,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":kc,"long-time":Cc},Oc=rl()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),jc=(Oc.toJSON.bind(Oc),Oc.fromJSON.bind(Oc),{ar:"ar-u-nu-latn-ca-gregory"});let Pc=new WeakMap,Ac=Ic["short-date-short-time"];function Tc(t){return Ic[t]||null}function Nc(t,e){return function(t){const e=t||Ac;if(!Pc.has(e)){const t=yc(),i=jc[yc()]||t;Pc.set(e,new Intl.DateTimeFormat(i,e))}return Pc.get(e)}(e).format(t)}bc((()=>{Pc=new WeakMap,Ac=Ic["short-date-short-time"]}));const Rc={ar:"ar-u-nu-latn"};let _c=new WeakMap,Ec={};function Dc(t={}){const e={};return null!=t.digitSeparator&&(e.useGrouping=t.digitSeparator),null!=t.places&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function $c(t,e){return function(t){const e=t||Ec;if(!_c.has(e)){const i=yc(),s=Rc[yc()]||i;_c.set(e,new Intl.NumberFormat(s,t))}return _c.get(e)}(e).format(t)}var zc;bc((()=>{_c=new WeakMap,Ec={}}));let Fc=zc=class extends Wr{constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}clone(){return new zc({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}format(t){return this.dateFormat?Nc(t,Tc(this.dateFormat)):$c(t,Dc(this))}};s([Ml(ac)],Fc.prototype,"dateFormat",void 0),s([Ut({type:Boolean,json:{write:!0}})],Fc.prototype,"digitSeparator",void 0),s([Ut({type:mt,json:{write:!0}})],Fc.prototype,"places",void 0),Fc=zc=s([ve("esri.popup.support.FieldInfoFormat")],Fc);var Lc,Uc=Fc;let Vc=Lc=class extends Wr{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!1,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new Lc({fieldName:this.fieldName,format:this.format?w(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};s([Ut({type:String,json:{write:!0}})],Vc.prototype,"fieldName",void 0),s([Ut({type:Uc,json:{write:!0}})],Vc.prototype,"format",void 0),s([Ut({type:Boolean,json:{write:!0,default:!1}})],Vc.prototype,"isEditable",void 0),s([Ut({type:String,json:{write:!0}})],Vc.prototype,"label",void 0),s([Ml(new sl({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Vc.prototype,"stringFieldOption",void 0),s([Ut({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Vc.prototype,"statisticType",void 0),s([Ut({type:String,json:{write:!0}})],Vc.prototype,"tooltip",void 0),s([Ut({type:Boolean,json:{write:!0}})],Vc.prototype,"visible",void 0),Vc=Lc=s([ve("esri.popup.FieldInfo")],Vc);var Gc,qc=Vc;let Bc=Gc=class extends ic{constructor(t){super(t),this.fieldInfos=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map((t=>t.toJSON()))}clone(){return new Gc({fieldInfos:Array.isArray(this.fieldInfos)?w(this.fieldInfos):null})}};s([Ut({type:[qc]})],Bc.prototype,"fieldInfos",void 0),s([be("fieldInfos")],Bc.prototype,"writeFieldInfos",null),s([Ut({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],Bc.prototype,"type",void 0),Bc=Gc=s([ve("esri.popup.content.FieldsContent")],Bc);var Hc=Bc;let Jc=class extends Wr{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};s([Ut({type:String,json:{write:!0}})],Jc.prototype,"altText",void 0),s([Ut({type:String,json:{write:!0}})],Jc.prototype,"caption",void 0),s([Ut({type:String,json:{write:!0}})],Jc.prototype,"title",void 0),s([Ut({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Jc.prototype,"type",void 0),Jc=s([ve("esri.popup.content.mixins.MediaInfo")],Jc);var Wc,Yc=Jc;function Xc(t,e){return Ut({aliasOf:e?{...e,source:t}:t})}let Qc=Wc=class extends Rr{constructor(t){super(t),this.tooltip=null,this.value=null,this.x=null,this.y=null}clone(){return new Wc({tooltip:this.tooltip,value:this.value})}};s([Ut()],Qc.prototype,"tooltip",void 0),s([Ut()],Qc.prototype,"value",void 0),s([Xc("value")],Qc.prototype,"x",void 0),s([Xc("tooltip")],Qc.prototype,"y",void 0),Qc=Wc=s([ve("esri.popup.content.support.ChartMediaInfoValueSeries")],Qc);var Kc,Zc=Qc;let tf=Kc=class extends Wr{constructor(t){super(t),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new Kc({fields:w(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};s([Ut({type:[String],json:{write:!0}})],tf.prototype,"fields",void 0),s([Ut({type:String,json:{write:!0}})],tf.prototype,"normalizeField",void 0),s([Ut({type:[Zc],json:{read:!1}})],tf.prototype,"series",void 0),s([Ut({type:String,json:{write:!0}})],tf.prototype,"tooltipField",void 0),tf=Kc=s([ve("esri.popup.content.support.ChartMediaInfoValue")],tf);var ef=tf;let sf=class extends Yc{constructor(t){super(t),this.type=null,this.value=null}};s([Ut({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],sf.prototype,"type",void 0),s([Ut({type:ef,json:{write:!0}})],sf.prototype,"value",void 0),sf=s([ve("esri.popup.content.mixins.ChartMediaInfo")],sf);var rf=sf;const nf=rl()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var of;let lf=of=class extends rf{constructor(t){super(t),this.type="bar-chart"}clone(){return new of({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};s([Ut({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:nf.write}})],lf.prototype,"type",void 0),lf=of=s([ve("esri.popup.content.BarChartMediaInfo")],lf);var af,uf=lf;let hf=af=class extends rf{constructor(t){super(t),this.type="column-chart"}clone(){return new af({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};s([Ut({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:nf.write}})],hf.prototype,"type",void 0),hf=af=s([ve("esri.popup.content.ColumnChartMediaInfo")],hf);var cf,ff=hf;let df=cf=class extends Wr{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new cf({linkURL:this.linkURL,sourceURL:this.sourceURL})}};s([Ut({type:String,json:{write:!0}})],df.prototype,"linkURL",void 0),s([Ut({type:String,json:{write:!0}})],df.prototype,"sourceURL",void 0),df=cf=s([ve("esri.popup.content.support.ImageMediaInfoValue")],df);var pf,yf=df;let mf=pf=class extends Yc{constructor(t){super(t),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new pf({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};s([Ut({type:Number,json:{write:!0}})],mf.prototype,"refreshInterval",void 0),s([Ut({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],mf.prototype,"type",void 0),s([Ut({type:yf,json:{write:!0}})],mf.prototype,"value",void 0),mf=pf=s([ve("esri.popup.content.ImageMediaInfo")],mf);var vf,wf=mf;let bf=vf=class extends rf{constructor(t){super(t),this.type="line-chart"}clone(){return new vf({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};s([Ut({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:nf.write}})],bf.prototype,"type",void 0),bf=vf=s([ve("esri.popup.content.LineChartMediaInfo")],bf);var gf,Sf=bf;let Mf=gf=class extends rf{constructor(t){super(t),this.type="pie-chart"}clone(){return new gf({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};s([Ut({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:nf.write}})],Mf.prototype,"type",void 0),Mf=gf=s([ve("esri.popup.content.PieChartMediaInfo")],Mf);var xf=Mf;const kf={base:Yc,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":uf,"column-chart":ff,"line-chart":Sf,"pie-chart":xf,image:wf}};var Cf;let If=Cf=class extends ic{constructor(t){super(t),this.activeMediaInfoIndex=null,this.mediaInfos=null,this.type="media"}readMediaInfos(t){return t&&t.map((t=>"image"===t.type?wf.fromJSON(t):"barchart"===t.type?uf.fromJSON(t):"columnchart"===t.type?ff.fromJSON(t):"linechart"===t.type?Sf.fromJSON(t):"piechart"===t.type?xf.fromJSON(t):void 0)).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map((t=>t.toJSON()))}clone(){return new Cf({activeMediaInfoIndex:this.activeMediaInfoIndex,mediaInfos:this.mediaInfos?w(this.mediaInfos):null})}};s([Ut()],If.prototype,"activeMediaInfoIndex",void 0),s([Ut({types:[kf]})],If.prototype,"mediaInfos",void 0),s([vn("mediaInfos")],If.prototype,"readMediaInfos",null),s([be("mediaInfos")],If.prototype,"writeMediaInfos",null),s([Ut({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],If.prototype,"type",void 0),If=Cf=s([ve("esri.popup.content.MediaContent")],If);var Of,jf=If;let Pf=Of=class extends ic{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new Of({text:this.text})}};s([Ut({type:String,json:{write:!0}})],Pf.prototype,"text",void 0),s([Ut({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Pf.prototype,"type",void 0),Pf=Of=s([ve("esri.popup.content.TextContent")],Pf);var Af=Pf;const Tf={base:null,key:"type",typeMap:{attachment:nc,media:jf,text:Af,field:Hc}};var Nf;let Rf=Nf=class extends Wr{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new Nf({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};s([Ut({type:String,json:{write:!0}})],Rf.prototype,"name",void 0),s([Ut({type:String,json:{write:!0}})],Rf.prototype,"title",void 0),s([Ut({type:String,json:{write:!0}})],Rf.prototype,"expression",void 0),s([Ut({type:["string","number"],json:{write:!0}})],Rf.prototype,"returnType",void 0),Rf=Nf=s([ve("esri.popup.ExpressionInfo")],Rf);var _f,Ef=Rf;let Df=_f=class extends Wr{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new _f({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};s([Ut({type:Boolean,json:{write:!0}})],Df.prototype,"returnTopmostRaster",void 0),s([Ut({type:Boolean,json:{write:!0}})],Df.prototype,"showNoDataRecords",void 0),Df=_f=s([ve("esri.popup.LayerOptions")],Df);var $f,zf=Df;let Ff=$f=class extends Wr{constructor(t){super(t),this.field=null,this.order=null}clone(){return new $f({field:this.field,order:this.order})}};s([Ut({type:String,json:{write:!0}})],Ff.prototype,"field",void 0),s([Ut({type:["asc","desc"],json:{write:!0}})],Ff.prototype,"order",void 0),Ff=$f=s([ve("esri.popup.support.RelatedRecordsInfoFieldOrder")],Ff);var Lf,Uf=Ff;let Vf=Lf=class extends Wr{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new Lf({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?w(this.orderByFields):null})}};s([Ut({type:Boolean,json:{write:!0}})],Vf.prototype,"showRelatedRecords",void 0),s([Ut({type:[Uf],json:{write:!0}})],Vf.prototype,"orderByFields",void 0),Vf=Lf=s([ve("esri.popup.RelatedRecordsInfo")],Vf);var Gf=Vf;let qf=0;const Bf=t=>{let e=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+qf++})}};return e=s([ve("esri.core.Identifiable")],e),e};let Hf=class extends(Bf(class{})){};var Jf;Hf=s([ve("esri.core.Identifiable")],Hf);let Wf=Jf=class extends(Bf(Rr)){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new Jf({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};s([Ut()],Wf.prototype,"active",void 0),s([Ut()],Wf.prototype,"className",void 0),s([Ut()],Wf.prototype,"disabled",void 0),s([Ut()],Wf.prototype,"id",void 0),s([Ut()],Wf.prototype,"indicator",void 0),s([Ut()],Wf.prototype,"title",void 0),s([Ut()],Wf.prototype,"type",void 0),s([Ut()],Wf.prototype,"visible",void 0),Wf=Jf=s([ve("esri.support.actions.ActionBase")],Wf);var Yf,Xf=Wf;let Qf=Yf=class extends Xf{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new Yf({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};s([Ut()],Qf.prototype,"image",void 0),Qf=Yf=s([ve("esri.support.Action.ActionButton")],Qf);var Kf,Zf=Qf;let td=Kf=class extends Xf{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new Kf({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};s([Ut()],td.prototype,"image",void 0),s([Ut()],td.prototype,"value",void 0),td=Kf=s([ve("esri.support.Action.ActionToggle")],td);var ed,id=td;const sd=Zh.ofType({key:"type",defaultKeyValue:"button",base:Xf,typeMap:{button:Zf,toggle:id}}),rd={base:ic,key:"type",typeMap:{media:jf,custom:lc,text:Af,attachments:nc,fields:Hc}},nd=W.getLogger("esri.PopupTemplate"),od=["attachments","fields","media","text"];let ld=ed=class extends Wr{constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title="",this.relatedRecordsInfo=null}castContent(t){return Array.isArray(t)?t.map((t=>yt(rd,t))):"string"==typeof t||"function"==typeof t||t instanceof HTMLElement||is(t)?t:(nd.error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:i}=e;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(e):this._readPopupInfo(e)}writeContent(t,e){"string"!=typeof t?Array.isArray(t)&&(e.popupElements=t.filter((t=>-1!==od.indexOf(t.type))).map((t=>t&&t.toJSON())),e.popupElements.forEach((t=>{"attachments"===t.type?this._writeAttachmentContent(e):"media"===t.type?this._writeMediaContent(t,e):"text"===t.type&&this._writeTextContent(t,e)}))):e.description=t}writeFieldInfos(t,e){const{content:i}=this,s=Array.isArray(i)?i:null;if(t){const i=!!s&&s.some((t=>"fields"===t.type&&(!t.fieldInfos||0===t.fieldInfos.length)));e.fieldInfos=t.filter(Boolean).map((t=>{const e=t.toJSON();return i||(e.visible=!1),e}))}if(s)for(const t of s)"fields"===t.type&&this._writeFieldsContent(t,e)}writeLayerOptions(t,e){e.layerOptions=!t||null===t.showNoDataRecords&&null===t.returnTopmostRaster?null:t.toJSON()}writeTitle(t,e){e.title=t||""}clone(){const{actions:t}=this,e=t?w(t.toArray()):[];return new ed({actions:e,content:Array.isArray(this.content)?w(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?w(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?w(this.fieldInfos):null,layerOptions:this.layerOptions?w(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?w(this.outFields):null,overwriteActions:this.overwriteActions,returnGeometry:this.returnGeometry,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?w(this.relatedRecordsInfo):null})}async collectRequiredFields(t,e){await this._collectExpressionInfoFields(t,e,this.expressionInfos),Wl(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const e=new Set;return await this.collectRequiredFields(e,t),[...e].sort()}_writeFieldsContent(t,e){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const i=w(t.fieldInfos);Array.isArray(e.fieldInfos)?i.forEach((t=>{const i=e.fieldInfos.find((e=>e.fieldName.toLowerCase()===t.fieldName.toLowerCase()));i?i.visible=!0:e.fieldInfos.push(t)})):e.fieldInfos=i}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text)}_writeMediaContent(t,e){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=w(t.mediaInfos);e.mediaInfos=Array.isArray(e.mediaInfos)?[...e.mediaInfos,...i]:i}_readPopupInfoElements({description:t,mediaInfos:e,popupElements:i}){const s={description:!1,mediaInfos:!1};return i.map((i=>"media"===i.type?(i.mediaInfos||!e||s.mediaInfos||(i.mediaInfos=e,s.mediaInfos=!0),jf.fromJSON(i)):"text"===i.type?(i.text||!t||s.description||(i.text=t,s.description=!0),Af.fromJSON(i)):"attachments"===i.type?nc.fromJSON(i):"fields"===i.type?Hc.fromJSON(i):void 0)).filter(Boolean)}_readPopupInfo({description:t,mediaInfos:e,showAttachments:i}){const s=[];return s.push(t?new Af({text:t}):new Hc),Array.isArray(e)&&e.length&&s.push(jf.fromJSON({mediaInfos:e})),i&&s.push(nc.fromJSON({displayType:"list"})),s.length?s:t}_getContentElementFields(t){return t&&"attachments"!==t.type?"custom"===t.type?t.outFields||[]:"fields"===t.type?this._getFieldInfoFields(t.fieldInfos||this.fieldInfos):"media"===t.type?(t.mediaInfos||[]).reduce(((t,e)=>[...t,...this._getMediaInfoFields(e)]),[]):"text"===t.type?this._extractFieldNames(t.text):void 0:[]}_getMediaInfoFields(t){const{caption:e,title:i,value:s}=t,r=s||{},{fields:n=[],normalizeField:o,tooltipField:l,sourceURL:a,linkURL:u}=r,h=[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(a),...this._extractFieldNames(u),...n];return o&&h.push(o),l&&h.push(l),h}_getContentFields(t){return"string"==typeof t?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((t,e)=>[...t,...this._getContentElementFields(e)]),[]):[]}async _collectExpressionInfoFields(t,e,i){i&&await Ei(i.map((i=>Kl(t,e,i.expression))))}_getFieldInfoFields(t){return t?t.filter((t=>void 0===t.visible||!!t.visible)).map((t=>t.fieldName)).filter((t=>-1===t.indexOf("relationships/")&&-1===t.indexOf("expression/"))):[]}_getActionsFields(t){return t?t.toArray().reduce(((t,e)=>[...t,...this._getActionFields(e)]),[]):[]}_getActionFields(t){const{className:e,title:i,type:s}=t,r="button"===s||"toggle"===s?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(r)]}_getTitleFields(t){return"string"==typeof t?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||"string"!=typeof t)return[];const e=t.match(/{[^}]*}/g);if(!e)return[];const i=/\{(\w+):.+\}/,s=e.filter((t=>!(0===t.indexOf("{relationships/")||0===t.indexOf("{expression/")))).map((t=>t.replace(i,"{$1}")));return s?s.map((t=>t.slice(1,-1))):[]}};s([Ut({type:sd})],ld.prototype,"actions",void 0),s([Ut()],ld.prototype,"content",void 0),s([xn("content")],ld.prototype,"castContent",null),s([vn("content",["description","popupElements","mediaInfos","showAttachments"])],ld.prototype,"readContent",null),s([be("content",{popupElements:{type:Zh.ofType(Tf)},showAttachments:{type:Boolean},mediaInfos:{type:Zh.ofType(kf)},description:{type:String}})],ld.prototype,"writeContent",null),s([Ut({type:[Ef],json:{write:!0}})],ld.prototype,"expressionInfos",void 0),s([Ut({type:[qc]})],ld.prototype,"fieldInfos",void 0),s([be("fieldInfos")],ld.prototype,"writeFieldInfos",null),s([Ut({type:zf})],ld.prototype,"layerOptions",void 0),s([be("layerOptions")],ld.prototype,"writeLayerOptions",null),s([Ut({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],ld.prototype,"lastEditInfoEnabled",void 0),s([Ut()],ld.prototype,"outFields",void 0),s([Ut()],ld.prototype,"overwriteActions",void 0),s([Ut()],ld.prototype,"returnGeometry",void 0),s([Ut({json:{type:String}})],ld.prototype,"title",void 0),s([be("title")],ld.prototype,"writeTitle",null),s([Ut({type:Gf,json:{write:!0}})],ld.prototype,"relatedRecordsInfo",void 0),ld=ed=s([ve("esri.PopupTemplate")],ld);var ad=ld;let ud=class extends Wr{constructor(t){super(t),this.enabled=!0,this.type=null}writeEnabled(t,e,i){t||(e[i]=t)}};s([Ut({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],ud.prototype,"enabled",void 0),s([be("enabled")],ud.prototype,"writeEnabled",null),s([Ut({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],ud.prototype,"type",void 0),ud=s([ve("esri.symbols.Symbol3DLayer")],ud);var hd=ud;const cd={type:Fa,json:{type:[mt],default:null,read:{source:["color","transparency"],reader:function(t,e){const i=null!=e.transparency?ph(e.transparency):1,s=e.color;return s&&Array.isArray(s)?new Fa([s[0]||0,s[1]||0,s[2]||0,i]):null}},write:{target:{color:{type:[mt]},transparency:{type:mt}},writer:function(t,e){e.color=t.toJSON().slice(0,3);const i=dh(t.a);0!==i&&(e.transparency=i)}}}},fd={type:Number,cast:Ih,json:{write:!0}},dd={type:[Number],cast:t=>null!=t?t:Array.isArray(t)?t.map(Ih):null,json:{read:!1,write:!1}};let pd=class extends Wr{constructor(t){super(t),this.color=new Fa([0,0,0,1]),this.extensionLength=0,this.size=Ch(1)}clone(){}cloneProperties(){return{color:w(this.color),size:this.size,extensionLength:this.extensionLength}}};s([Ut({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],pd.prototype,"type",void 0),s([Ut(cd)],pd.prototype,"color",void 0),s([Ut({...fd,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],pd.prototype,"extensionLength",void 0),s([Ut(fd)],pd.prototype,"size",void 0),pd=s([ve("esri.symbols.edges.Edges3D")],pd);var yd,md=pd;let vd=yd=class extends md{constructor(t){super(t),this.type="sketch"}clone(){return new yd(this.cloneProperties())}};s([Ml({sketch:"sketch"},{readOnly:!0})],vd.prototype,"type",void 0),vd=yd=s([ve("esri.symbols.edges.SketchEdges3D")],vd);var wd,bd=vd;let gd=wd=class extends md{constructor(t){super(t),this.type="solid"}clone(){return new wd(this.cloneProperties())}};s([Ml({solid:"solid"},{readOnly:!0})],gd.prototype,"type",void 0),gd=wd=s([ve("esri.symbols.support.SolidEdges3D")],gd);const Sd={types:{key:"type",base:md,typeMap:{solid:gd,sketch:bd}},json:{write:!0}};var Md;let xd=Md=class extends Wr{constructor(){super(...arguments),this.color=null}clone(){return new Md({color:M(this.color)?this.color.clone():null})}};s([Ut(cd)],xd.prototype,"color",void 0),xd=Md=s([ve("esri.symbols.support.Symbol3DMaterial")],xd);var kd,Cd=xd;let Id=kd=class extends hd{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new kd({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:M(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};s([Ml({Extrude:"extrude"},{readOnly:!0})],Id.prototype,"type",void 0),s([Ut({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Id.prototype,"size",void 0),s([Ut({type:Cd,json:{write:!0}})],Id.prototype,"material",void 0),s([Ut({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Id.prototype,"castShadows",void 0),s([Ut(Sd)],Id.prototype,"edges",void 0),Id=kd=s([ve("esri.symbols.ExtrudeSymbol3DLayer")],Id);var Od=Id;let jd=class extends qa{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};s([Ml({esriSLS:"simple-line"},{readOnly:!0})],jd.prototype,"type",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],jd.prototype,"width",void 0),jd=s([ve("esri.symbols.LineSymbol")],jd);var Pd,Ad=jd;let Td=Pd=class extends Wr{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,s){e[i]="web-map"===(null==s?void 0:s.origin)?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t&&null!=t[0]?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,s){"web-map"===(null==s?void 0:s.origin)||(e[i]=t)}clone(){return new Pd({color:w(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${null==(t=this.color)?void 0:t.hash()}.${this.style}`}};s([Ut({type:["begin","end","begin-end"],json:{default:"begin-end",write:!0}})],Td.prototype,"placement",void 0),s([Ml({"line-marker":"line-marker"},{readOnly:!0}),Ut({json:{origins:{"web-map":{write:!1}}}})],Td.prototype,"type",void 0),s([Ut({type:["arrow","circle","square","diamond","cross","x"]})],Td.prototype,"style",void 0),s([be("style")],Td.prototype,"writeStyle",null),s([Ut({type:Fa,value:null,json:{write:{allowNull:!0}}})],Td.prototype,"color",null),s([vn("color")],Td.prototype,"readColor",null),s([be("color")],Td.prototype,"writeColor",null),Td=Pd=s([ve("esri.symbols.LineSymbolMarker")],Td);var Nd,Rd=Td;const _d=new sl({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Ed=Nd=class extends Ad{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,s,r,n){if(t&&"string"!=typeof t)return t;const o={};return null!=t&&(o.style=t),null!=e&&(o.color=e),null!=i&&(o.width=Ih(i)),null!=s&&(o.cap=s),null!=r&&(o.join=r),null!=n&&(o.miterLimit=Ih(n)),o}clone(){var t;return new Nd({color:w(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null==(t=this.marker)?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${null==(e=this.marker)?void 0:e.hash()}`}};s([Ml({esriSLS:"simple-line"},{readOnly:!0})],Ed.prototype,"type",void 0),s([Ut({type:_d.apiValues,json:{read:_d.read,write:_d.write}})],Ed.prototype,"style",void 0),s([Ut({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&(null==i||null==i.origin)})}}})],Ed.prototype,"cap",void 0),s([Ut({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&(null==i||null==i.origin)})}}})],Ed.prototype,"join",void 0),s([Ut({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Rd}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Ed.prototype,"marker",void 0),s([Ut({type:Number,json:{read:!1,write:!1}})],Ed.prototype,"miterLimit",void 0),Ed=Nd=s([ve("esri.symbols.SimpleLineSymbol")],Ed);var Dd=Ed;let $d=class extends qa{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};s([Ut({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Dd}},json:{default:null,write:!0}})],$d.prototype,"outline",void 0),s([Ut({type:["simple-fill","picture-fill"],readOnly:!0})],$d.prototype,"type",void 0),$d=s([ve("esri.symbols.FillSymbol")],$d);var zd=$d;let Fd=class extends Wr{constructor(t){super(t)}clone(){}};s([Ut({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Fd.prototype,"type",void 0),Fd=s([ve("esri.symbols.patterns.Pattern3D")],Fd);var Ld,Ud=Fd;let Vd=Ld=class extends Ud{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new Ld({style:this.style})}};s([Ut({type:["style"]})],Vd.prototype,"type",void 0),s([Ut({type:["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"],json:{read:!0,write:!0}})],Vd.prototype,"style",void 0),Vd=Ld=s([ve("esri.symbols.patterns.StylePattern3D")],Vd);var Gd=Vd;const qd={types:{key:"type",base:Ud,typeMap:{style:Gd}},json:{read:function(t,e,i){if(!t)return t;switch(t.type){case"style":{const e=new Gd;return e.read(t,i),e}}},write:!0}},Bd=new Fa("white"),Hd=(new Fa("black"),new Fa([255,255,255,0]));var Jd;let Wd=Jd=class extends Cd{clone(){return new Jd({color:M(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})}};s([Ml({multiply:"multiply",replace:"replace",tint:"tint"})],Wd.prototype,"colorMixMode",void 0),Wd=Jd=s([ve("esri.symbols.support.Symbol3DFillMaterial")],Wd);var Yd,Xd=Wd;let Qd=Yd=class extends Wr{constructor(){super(...arguments),this.color=new Fa([0,0,0,1]),this.size=Ch(1),this.stipplePattern=null,this.stippleOffColor=null}clone(){return new Yd({color:M(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}};s([Ut(cd)],Qd.prototype,"color",void 0),s([Ut(fd)],Qd.prototype,"size",void 0),s([Ut(dd)],Qd.prototype,"stipplePattern",void 0),s([Ut({type:Fa})],Qd.prototype,"stippleOffColor",void 0),Qd=Yd=s([ve("esri.symbols.support.Symbol3DOutline")],Qd);var Kd,Zd=Qd;let tp=Kd=class extends hd{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){return new Kd({edges:M(this.edges)?this.edges.clone():null,enabled:this.enabled,material:M(this.material)?this.material.clone():null,pattern:M(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:M(this.outline)?this.outline.clone():null})}static fromSimpleFillSymbol(t){return new Kd({material:{color:(t.color||Hd).clone()},pattern:t.style&&"solid"!==t.style?new Gd({style:t.style}):null,outline:t.outline?new Zd({size:t.outline.width||0,color:(t.outline.color||Bd).clone()}):null})}};s([Ml({Fill:"fill"},{readOnly:!0})],tp.prototype,"type",void 0),s([Ut({type:Xd,json:{write:!0}})],tp.prototype,"material",void 0),s([Ut(qd)],tp.prototype,"pattern",void 0),s([Ut({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],tp.prototype,"castShadows",void 0),s([Ut({type:Zd,json:{write:!0}})],tp.prototype,"outline",void 0),s([Ut(Sd)],tp.prototype,"edges",void 0),tp=Kd=s([ve("esri.symbols.FillSymbol3DLayer")],tp);var ep,ip=tp;let sp=ep=class extends Wr{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Ih(t)}clone(){return new ep({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};s([Ut({type:["underline","line-through","none"],json:{default:"none",write:!0}})],sp.prototype,"decoration",void 0),s([Ut({type:String,json:{write:!0}})],sp.prototype,"family",void 0),s([Ut({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],sp.prototype,"size",void 0),s([xn("size")],sp.prototype,"castSize",null),s([Ut({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],sp.prototype,"style",void 0),s([Ut({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],sp.prototype,"weight",void 0),sp=ep=s([ve("esri.symbols.Font")],sp);var rp=sp;function np(t,e){const i=e&&e.url&&e.url.path;if(t&&i&&(t=Qe(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=Ke(t,e.portalItem.itemUrl);hp.test(i)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return fp(t,e&&e.portal)}function op(t,e){if(!t)return t;!ii(t)&&e&&e.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let i=Qe(t);if(e){const s=e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.rootPath||e.url&&e.url.path;if(s){const r=fp(s,e.portal);i=Ke(fp(i,e.portal),r,r),i!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=function(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?vi(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}(i,e&&e.portal),ii(i)&&(i=Ze(i)),i}function lp(t,e,i){return np(t,i)}function ap(t,e,i,s){const r=op(t,s);void 0!==r&&(e[i]=r)}const up=/\/items\/([^\/]+)\/resources\//,hp=/^\.\/resources\//;function cp(t){const e=M(t)?t.match(up):null;return M(e)?e[1]:null}function fp(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`;return We(Re,`${Re.scheme}://${i}`)?vi(t,e.portalHostname,i):vi(t,i,e.portalHostname)}var dp,pp=Object.freeze({__proto__:null,fromJSON:np,toJSON:op,read:lp,write:ap,itemIdFromResourceUrl:cp});const yp=rl()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let mp=dp=class extends Wr{constructor(t){super(t)}readHref(t,e,i){return t?np(t,i):e.dataURI}writeHref(t,e,i,s){t&&(ri(t)?e.dataURI=t:(e.href=op(t,s),ii(e.href)&&(e.href=Ze(e.href))))}clone(){return new dp({href:this.href,primitive:this.primitive})}};s([Ut({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],mp.prototype,"href",void 0),s([vn("href")],mp.prototype,"readHref",null),s([be("href",{href:{type:String},dataURI:{type:String}})],mp.prototype,"writeHref",null),s([Ml(yp)],mp.prototype,"primitive",void 0),mp=dp=s([ve("esri.symbols.support.IconSymbol3DLayerResource")],mp);var vp,wp=mp;let bp=vp=class extends Rr{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new vp({x:this.x,y:this.y})}};s([Ut({type:Number})],bp.prototype,"x",void 0),s([Ut({type:Number})],bp.prototype,"y",void 0),bp=vp=s([ve("esri.symbols.support.Symbol3DAnchorPosition2D")],bp);var gp,Sp=bp;const Mp=W.getLogger("esri.symbols.IconSymbol3DLayer");let xp=gp=class extends hd{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new gp({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:M(this.material)?this.material.clone():null,outline:M(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||Bd,i=kp(t),s=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||Bd).clone()}:null;return new gp({size:t.size,resource:{primitive:Op(t.style)},material:{color:e},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||function(t){return 0===t.r&&0===t.g&&0===t.b}(t.color)?Bd:t.color,i=kp(t);return new gp({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new gp({resource:{href:ai({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};function kp(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,s=Cp(t.xoffset),r=Cp(t.yoffset);return(s||r)&&e&&i?{x:-s/e,y:r/i}:null}function Cp(t){return isFinite(t)?t:0}s([Ut({type:Cd,json:{write:!0}})],xp.prototype,"material",void 0),s([Ut({type:wp,json:{write:!0}})],xp.prototype,"resource",void 0),s([Ml({Icon:"icon"},{readOnly:!0})],xp.prototype,"type",void 0),s([Ut(fd)],xp.prototype,"size",void 0),s([Ml({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),Ut({json:{default:"center"}})],xp.prototype,"anchor",void 0),s([Ut({type:bp,json:{type:[Number],read:{reader:t=>new bp({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],xp.prototype,"anchorPosition",void 0),s([Ut({type:Zd,json:{write:!0}})],xp.prototype,"outline",void 0),xp=gp=s([ve("esri.symbols.IconSymbol3DLayer")],xp);const Ip={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Op(t){return Ip[t]||(Mp.warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}var jp,Pp=xp;let Ap=jp=class extends hd{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Ch(1),this.stipplePattern=null,this.stippleOffColor=null}clone(){return new jp({enabled:this.enabled,material:M(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}static fromSimpleLineSymbol(t){return new jp({size:t.width||1,cap:t.cap||"butt",join:t.join||"miter",material:{color:(t.color||Bd).clone()}})}};s([Ut({type:Cd,json:{write:!0}})],Ap.prototype,"material",void 0),s([Ml({Line:"line"},{readOnly:!0})],Ap.prototype,"type",void 0),s([Ut({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],Ap.prototype,"join",void 0),s([Ut({type:["butt","square","round"],json:{write:!0,default:"butt"}})],Ap.prototype,"cap",void 0),s([Ut(fd)],Ap.prototype,"size",void 0),s([Ut(dd)],Ap.prototype,"stipplePattern",void 0),s([Ut({type:Fa})],Ap.prototype,"stippleOffColor",void 0),Ap=jp=s([ve("esri.symbols.LineSymbol3DLayer")],Ap);var Tp,Np=Ap;const Rp=rl()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let _p=Tp=class extends Wr{clone(){return new Tp({href:this.href,primitive:this.primitive})}};s([Ut({type:String,json:{read:lp,write:ap}})],_p.prototype,"href",void 0),s([Ml(Rp)],_p.prototype,"primitive",void 0),_p=Tp=s([ve("esri.symbols.support.ObjectSymbol3DLayerResource")],_p);var Ep,Dp=_p;let $p=Ep=class extends Rr{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new Ep({x:this.x,y:this.y,z:this.z})}};var zp;s([Ut({type:Number})],$p.prototype,"x",void 0),s([Ut({type:Number})],$p.prototype,"y",void 0),s([Ut({type:Number})],$p.prototype,"z",void 0),$p=Ep=s([ve("esri.symbols.support.Symbol3DAnchorPosition3D")],$p);let Fp=zp=class extends hd{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new zp({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:M(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||"string"!=typeof this.resource.href}};s([Ut({type:Cd,json:{write:!0}})],Fp.prototype,"material",void 0),s([Ut({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Fp.prototype,"castShadows",void 0),s([Ut({type:Dp,json:{write:!0}})],Fp.prototype,"resource",void 0),s([Ml({Object:"object"},{readOnly:!0})],Fp.prototype,"type",void 0),s([Ut({type:Number,json:{write:!0}})],Fp.prototype,"width",void 0),s([Ut({type:Number,json:{write:!0}})],Fp.prototype,"height",void 0),s([Ut({type:Number,json:{write:!0}})],Fp.prototype,"depth",void 0),s([Ml({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),Ut({json:{default:"origin"}})],Fp.prototype,"anchor",void 0),s([Ut({type:$p,json:{type:[Number],read:{reader:t=>new $p({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],Fp.prototype,"anchorPosition",void 0),s([Ut({type:Number,json:{write:!0}})],Fp.prototype,"heading",void 0),s([Ut({type:Number,json:{write:!0}})],Fp.prototype,"tilt",void 0),s([Ut({type:Number,json:{write:!0}})],Fp.prototype,"roll",void 0),s([Ut({readOnly:!0,dependsOn:["resource","resource.href"]})],Fp.prototype,"isPrimitive",null),Fp=zp=s([ve("esri.symbols.ObjectSymbol3DLayer")],Fp);var Lp,Up=Fp;let Vp=Lp=class extends hd{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}get size(){return this.width&&this.height?this.width===this.height?this.width:void 0:this.width?this.width:this.height?this.height:void 0}set size(t){this.width=t,this.height=t}readSize(t,e){return e.height||e.width?t:e.size}clone(){return new Lp({enabled:this.enabled,material:M(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};s([Ut({type:Cd,json:{write:!0}})],Vp.prototype,"material",void 0),s([Ut({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Vp.prototype,"castShadows",void 0),s([Ml({Path:"path"},{readOnly:!0})],Vp.prototype,"type",void 0),s([Ut({type:Number})],Vp.prototype,"size",null),s([vn("size")],Vp.prototype,"readSize",null),s([Ut({type:["circle","quad"],json:{write:!0,default:"circle"}})],Vp.prototype,"profile",void 0),s([Ut({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],Vp.prototype,"join",void 0),s([Ut({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],Vp.prototype,"cap",void 0),s([Ut({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Vp.prototype,"width",void 0),s([Ut({type:Number,json:{write:!0}})],Vp.prototype,"height",void 0),s([Ut({type:["center","bottom","top"],json:{write:!0,default:"center"}})],Vp.prototype,"anchor",void 0),s([Ut({type:["heading","all"],json:{write:!0,default:"all"}})],Vp.prototype,"profileRotation",void 0),Vp=Lp=s([ve("esri.symbols.PathSymbol3DLayer")],Vp);var Gp,qp=Vp;let Bp=Gp=class extends Wr{constructor(){super(...arguments),this.color=new Fa([0,0,0,1]),this.size=0}clone(){return new Gp({color:w(this.color),size:this.size})}};s([Ut(cd)],Bp.prototype,"color",void 0),s([Ut(fd)],Bp.prototype,"size",void 0),Bp=Gp=s([ve("esri.symbols.support.Symbol3DHalo")],Bp);var Hp,Jp=Bp;let Wp=Hp=class extends hd{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.material=null,this.text=void 0,this.type="text"}get font(){return this._get("font")||null}set font(t){t&&this._userSize&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,s){const r={...s,textSymbol3D:!0};e.font=t.write({},r),delete e.font.size}get size(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9}set size(t){this._userSize=t,this.font&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){return new Hp({enabled:this.enabled,font:this.font&&w(this.font),halo:this.halo&&w(this.halo),material:M(this.material)?this.material.clone():null,size:this.size,text:this.text})}static fromTextSymbol(t){const e=function(t,e){return t&&e>0?{color:w(t),size:e}:null}(t.haloColor,t.haloSize),i=t.font?t.font.clone():new rp;return new Hp({size:i.size,font:i,halo:e,material:t.color?{color:t.color.clone()}:null,text:t.text})}};s([Ut({type:rp,json:{write:!0}})],Wp.prototype,"font",null),s([be("font")],Wp.prototype,"writeFont",null),s([Ut({type:Jp,json:{write:!0}})],Wp.prototype,"halo",void 0),s([Ut({type:Cd,json:{write:!0}})],Wp.prototype,"material",void 0),s([Ut(fd),Ut({dependsOn:["font.size"]})],Wp.prototype,"size",null),s([Ut({type:String,json:{write:!0}})],Wp.prototype,"text",void 0),s([Ml({Text:"text"},{readOnly:!0})],Wp.prototype,"type",void 0),Wp=Hp=s([ve("esri.symbols.TextSymbol3DLayer")],Wp);var Yp,Xp=Wp;let Qp=Yp=class extends hd{constructor(t){super(t),this.color=Kp.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new Yp({color:w(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};s([Ut({type:Fa,nonNullable:!0,json:{type:[mt],write:(t,e,i)=>e[i]=t.toArray(1),default:()=>Kp.clone(),defaultEquals:t=>t.toCss(!0)===Kp.toCss(!0)}})],Qp.prototype,"color",void 0),s([Ml({Water:"water"},{readOnly:!0})],Qp.prototype,"type",void 0),s([Ut({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Qp.prototype,"waterbodySize",void 0),s([Ut({type:Number,json:{write:!0,default:null}})],Qp.prototype,"waveDirection",void 0),s([Ut({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Qp.prototype,"waveStrength",void 0),Qp=Yp=s([ve("esri.symbols.WaterSymbol3DLayer")],Qp);const Kp=new Fa([0,119,190]);var Zp=Qp;function ty(t,e,i=Zh){return e||(e=new i),e===t||(e.removeAll(),function(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}(t)?e.addMany(t):t&&e.add(t)),e}function ey(t){return t}const iy=W.getLogger("esri.intl");function sy(t,e,i={}){const{format:s={}}=i;return G(t,(t=>function(t,e,i){let s,r;const n=t.indexOf(":");if(-1===n?s=t.trim():(s=t.slice(0,n).trim(),r=t.slice(n+1).trim()),!s)return"";const o=$(s,e);if(null==o)return"";const l=i[r]||i[s];return l?function(t,e){switch(e.type){case"date":return Nc(t,e.intlOptions);case"number":return $c(t,e.intlOptions);default:return iy.warn("missing format descriptor for key {key}"),ry(t)}}(o,l):r?function(t,e){switch(e.toLowerCase()){case"dateformat":return Nc(t);case"numberformat":return $c(t);default:return iy.warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Nc(t):/^numberformat/i.test(e)?$c(t):ry(t)}}(o,r):ry(o)}(t,e,s)))}function ry(t){switch(typeof t){case"string":return t;case"number":return $c(t);case"boolean":return""+t;default:return t instanceof Date?Nc(t):""}}const ny=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,oy=new Set(["ar","bs","ca","cs","da","de","el","en","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"]),ly=[],ay=new Map;async function uy(t){const e=yc();ay.has(t)||ay.set(t,async function(t,e){const i=[];for(const s of ly)if(hy(s.pattern,t))try{return await s.fetchMessageBundle(t,e)}catch(t){i.push(t)}if(i.length)throw new ge("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i});throw new ge("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}(t,e));const i=ay.get(t);return await cy.add(i),i}function hy(t,e){return"string"==typeof t?e.startsWith(t):t.test(e)}bc((()=>{ay.clear()}));const cy=new class{constructor(){this._numLoading=0}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Yi())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}};async function fy(t){return M(py.fetchBundleAsset)?py.fetchBundleAsset(t):(await eu(t,{responseType:"json"})).data}class dy{constructor({base:t="",pattern:e,location:i=new URL(window.location.href)}){let s;s="string"==typeof i?t=>new URL(t,new URL(i,r.location)).href:i instanceof URL?t=>new URL(t,i).href:i,this.pattern="string"==typeof e?new RegExp(`^${e}`):e,this.getAssetUrl=s,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,e){return async function(t,e,i,s){const r=e.exec(i);if(!r)throw new ge("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const n=r[1]?`${r[1]}/`:"",o=r[2],l=function(t){if(!ny.test(t))return null;const[,e,i]=ny.exec(t),s=e+(i?"-"+i.toUpperCase():"");return oy.has(s)?s:oy.has(e)?e:null}(s),a=`${n}${o}.json`,u=l?`${n}${o}_${l}.json`:a;let h;try{h=await fy(t(u))}catch(e){if(u===a)throw e;try{h=await fy(t(a))}catch{throw new ge("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:e})}}return h}(this.getAssetUrl,this.matcher,t,e)}}const py={};function yy(t){return ti(H.assetsPath,t)}!function(t){if(!ly.includes(t)){for(const e of ay.keys())hy(t.pattern,e)&&ay.delete(e);ly.unshift(t)}}(new dy({pattern:"esri/",location:yy}));class my{constructor(t){this.instance=t,this._resolver=Yi(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp()}),(()=>{this._status=2,this._cleanUp()}))}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject($i())}when(t,e){return this._resolver.promise.then(t,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const t=Yi(),e=[...this._resolvingPromises,t.promise],i=this._allPromise=Ei(e);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve(this.instance)}),(t=>{this.isFulfilled()||this._allPromise!==i||Ji(t)||this._resolver.reject(t)})),t.resolve()}}const vy=t=>{let e=class extends t{constructor(...t){super(...t),this._promiseProps=new my(this),this.addResolvingPromise(ts())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,e){return Di(((t,e)=>{this._promiseProps.when(t,e)})).then(t,e)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return e=s([ve("esri.core.Promise")],e),e};let wy=class extends(vy(Rr)){};wy=s([ve("esri.core.Promise")],wy);const by=t=>{let e=class extends t{constructor(...t){super(...t),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((t=>{const e=this.load.bind(this);this.load=i=>{const s=new Promise(((t,e)=>{const s=Bi(i,e);this.destroyed&&e(new ge("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(t,e).finally((()=>{s&&s.remove()}))}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const t=this._loadController=zi();e({signal:t.signal}),qi(t.signal,(()=>{this._promiseProps.abort()}))}return t(),s}}))),this.when((()=>{this._set("loadStatus","loaded"),this._loadController=null}),(t=>{this._set("loadStatus","failed"),this._set("loadError",t),this._loadController=null}))}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var t;return this.isFulfilled()||(this._set("loadError",new ge("load:cancelled","Cancelled")),null==(t=this._loadController)||t.abort()),this}};return s([Ut({readOnly:!0,dependsOn:["loadStatus"]})],e.prototype,"loaded",null),s([Ut({readOnly:!0})],e.prototype,"loadError",void 0),s([Ut()],e.prototype,"loadStatus",void 0),s([Ut({type:[Bt],readOnly:!0})],e.prototype,"loadWarnings",null),e=s([ve("esri.core.Loadable")],e),e};let gy=class extends(by(wy)){};gy=s([ve("esri.core.Loadable")],gy),function(t){t.LoadableMixin=by,t.isLoadable=function(t){return!(!t||!t.load)}}(gy||(gy={}));var Sy,My=gy;const xy=new sl({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let ky=Sy=class extends Rr{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new Sy({categories:this.categories?w(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i,s;if(this.categories&&(i=this.categories.map((t=>Array.isArray(t)?JSON.stringify(t):t))),this.extent){const t=_n(this.extent,mn.WGS84);t&&(s=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`)}let r=this.query;!this.disableExtraQuery&&t.extraQuery&&(r="("+r+")"+t.extraQuery);const n={categories:i,bbox:s,q:r,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map((t=>xy.toJSON(t.trim()))).join(","),n.sortOrder=this.sortOrder),{query:{...e,...n}}}};s([Ut()],ky.prototype,"categories",void 0),s([Ut()],ky.prototype,"disableExtraQuery",void 0),s([Ut({type:bo})],ky.prototype,"extent",void 0),s([Ut()],ky.prototype,"num",void 0),s([Ut()],ky.prototype,"query",void 0),s([Ut()],ky.prototype,"sortField",void 0),s([Ut()],ky.prototype,"sortOrder",null),s([Ut()],ky.prototype,"start",void 0),ky=Sy=s([ve("esri.portal.PortalQueryParams")],ky);var Cy=ky;let Iy=class extends Rr{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};s([Ut()],Iy.prototype,"nextQueryParams",void 0),s([Ut()],Iy.prototype,"queryParams",void 0),s([Ut()],Iy.prototype,"results",void 0),s([Ut()],Iy.prototype,"total",void 0),Iy=s([ve("esri.portal.PortalQueryResult")],Iy);var Oy=Iy;let jy=class extends Wr{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new ge("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};s([Ut({type:Date})],jy.prototype,"created",void 0),s([Ut()],jy.prototype,"id",void 0),s([Ut()],jy.prototype,"portal",void 0),s([Ut()],jy.prototype,"title",void 0),s([Ut({dependsOn:["portal.restUrl"],readOnly:!0})],jy.prototype,"url",null),s([Ut()],jy.prototype,"username",void 0),jy=s([ve("esri.portal.PortalFolder")],jy);var Py=jy;let Ay=class extends Wr{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.get("portal.restUrl");return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal._request(this.url+"/categorySchema",t).then((e=>{const i=e.categorySchema||[];return i.some((t=>"contentCategorySetsGroupQuery.LivingAtlas"===t.source))?this._fetchCategorySchemaSet("LivingAtlas",t):i}))}fetchMembers(t){return this.portal._request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new ge("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(t,e){let i=ut(Cy,t);return parseFloat(this.portal.currentVersion)>5?(i=i||new Cy,this.portal._queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Cy,i.query="group:"+this.id+(i.query?" "+i.query:""),this.portal.queryItems(i,e))}_fetchCategorySchemaSet(t,e){return this.portal._fetchSelf(this.portal.authMode,!0,e).then((t=>{const i=t.contentCategorySetsGroupQuery;if(i){const t=new Cy;return t.disableExtraQuery=!0,t.num=1,t.query=i,this.portal.queryGroups(t,e)}throw new ge("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((i=>{if(i.total){const s=i.results[0],r=new Cy;return r.num=1,r.query=`typekeywords:"${t}"`,s.queryItems(r,e)}throw new ge("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((t=>t.total?t.results[0].fetchData("json",e).then((t=>{const e=t&&t.categorySchema;return e&&e.length?e:[]})):[]))}};s([Ut()],Ay.prototype,"access",void 0),s([Ut({type:Date})],Ay.prototype,"created",void 0),s([Ut()],Ay.prototype,"description",void 0),s([Ut()],Ay.prototype,"id",void 0),s([Ut()],Ay.prototype,"isInvitationOnly",void 0),s([Ut({type:Date})],Ay.prototype,"modified",void 0),s([Ut()],Ay.prototype,"owner",void 0),s([Ut()],Ay.prototype,"portal",void 0),s([Ut()],Ay.prototype,"snippet",void 0),s([Ut()],Ay.prototype,"sortField",void 0),s([Ut()],Ay.prototype,"sortOrder",void 0),s([Ut()],Ay.prototype,"tags",void 0),s([Ut()],Ay.prototype,"thumbnail",void 0),s([Ut({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],Ay.prototype,"thumbnailUrl",null),s([Ut()],Ay.prototype,"title",void 0),s([Ut({dependsOn:["portal.restUrl"],readOnly:!0})],Ay.prototype,"url",null),Ay=s([ve("esri.portal.PortalGroup")],Ay);var Ty=Ay;const Ny=Object.freeze({__proto__:null,default:Ty});var Ry;let _y=Ry=class extends Wr{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.get("portal.restUrl");return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t&&t.data,s=t&&t.folder,r={method:"post"};e&&(r.query=e.createPostQuery(),null!=i&&("string"==typeof i?r.query.text=i:"object"==typeof i&&(r.query.text=JSON.stringify(i))));let n=this.userContentUrl;return s&&(n+="/"+("string"==typeof s?s:s.id)),this.portal._request(n+"/addItem",r).then((t=>(e.id=t.id,e.portal=this.portal,e.loaded?e.reload():e.load())))}deleteItem(t){let e=this.userContentUrl;return t.ownerFolder&&(e+="/"+t.ownerFolder),this.portal._request(e+`/items/${t.id}/delete`,{method:"post"}).then((()=>{t.id=null,t.portal=null}))}deleteItems(t){const e=this.userContentUrl+"/deleteItems",i=t.map((t=>t.id));if(i.length){const s={method:"post",query:{items:i.join(",")}};return this.portal._request(e,s).then((()=>{t.forEach((t=>{t.id=null,t.portal=null}))}))}return ts(void 0)}fetchFolders(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then((t=>{let e;return e=t&&t.folders?t.folders.map((t=>{const e=Py.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchGroups(){return this.portal._request(this.url).then((t=>{let e;return e=t&&t.groups?t.groups.map((t=>{const e=Ty.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchItems(t){t||(t={});let e,i=this.userContentUrl;return t.folder&&(i+="/"+t.folder.id),import("./p-b92ca348.js").then((({default:s})=>(e=s,this.portal._request(i,{query:{folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"}})))).then((t=>{let i;return t&&t.items?(i=t.items.map((t=>{const i=e.fromJSON(t);return i.portal=this.portal,i})),Ei(i.map((t=>t.load()))).catch((t=>t)).then((()=>({items:i,nextStart:t.nextStart,total:t.total})))):{items:[],nextStart:-1,total:0}}))}fetchTags(){return this.portal._request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Ty({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Zi(new ge("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new ge("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new Ry;return e.sourceJSON=t,e.read(t),e}};s([Ut()],_y.prototype,"access",void 0),s([Ut({type:Date})],_y.prototype,"created",void 0),s([Ut()],_y.prototype,"culture",void 0),s([Ut()],_y.prototype,"description",void 0),s([Ut()],_y.prototype,"email",void 0),s([Ut()],_y.prototype,"favGroupId",void 0),s([Ut()],_y.prototype,"fullName",void 0),s([Ut({type:Date})],_y.prototype,"modified",void 0),s([Ut()],_y.prototype,"orgId",void 0),s([Ut()],_y.prototype,"portal",void 0),s([Ut()],_y.prototype,"preferredView",void 0),s([Ut()],_y.prototype,"privileges",void 0),s([Ut()],_y.prototype,"region",void 0),s([Ut()],_y.prototype,"role",void 0),s([Ut()],_y.prototype,"roleId",void 0),s([Ut()],_y.prototype,"sourceJSON",void 0),s([Ut()],_y.prototype,"thumbnail",void 0),s([Ut({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],_y.prototype,"thumbnailUrl",null),s([Ut()],_y.prototype,"units",void 0),s([Ut({dependsOn:["portal.restUrl"],readOnly:!0})],_y.prototype,"userContentUrl",null),s([Ut({dependsOn:["portal.restUrl"],readOnly:!0})],_y.prototype,"url",null),s([Ut()],_y.prototype,"username",void 0),s([Ut()],_y.prototype,"userType",void 0),_y=Ry=s([ve("esri.portal.PortalUser")],_y);var Ey=_y;const Dy=Object.freeze({__proto__:null,default:Ey});var $y;let zy;const Fy={PortalGroup:()=>Promise.resolve().then((function(){return Ny})),PortalItem:()=>import("./p-b92ca348.js"),PortalUser:()=>Promise.resolve().then((function(){return Dy}))};let Ly=$y=class extends(Br(My)){constructor(t){super(t),this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=H.portalUrl,this.urlKey=null,this.user=null,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return"string"==typeof t?{url:t}:t}destroy(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)-1===H.request.trustedServers.indexOf(e)&&H.request.trustedServers.push(e);return t}readDefaultBasemap(t){if(t){const e=zy.fromJSON(t);return e.portalItem={portal:this},e}return null}readDefaultVectorBasemap(t){if(t){const e=zy.fromJSON(t);return e.portalItem={portal:this},e}return null}get extraQuery(){return this.id&&this.user&&this.user.orgId&&!this.canSearchPublic?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t?t.toLowerCase():t}readUser(t){let e=null;return t&&(e=Ey.fromJSON(t),e.portal=this),e}load(t){const e=import("./p-fc1054b9.js").then((function(t){return t.B})).then((({default:e})=>{Fi(t),zy=e})).then((()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,t))).then((t=>{if(Ya){const t=Ya;this.credential=t.findCredential(this.restUrl),this.credential||this.authMode!==$y.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=t.on("credential-create",(()=>{t.findCredential(this.restUrl)&&this._signIn()})))}this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),ts(this)}async createClosestFacilityTask(){await this.load();const t=this._getHelperServiceUrl("closestFacility");return new((await import("./p-97cfd955.js")).default)(t)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await import("./p-08ed9c2f.js")).default;return t?t.map((t=>new e({id:t.id,url:t.url}))):[]}async createGeometryService(){await this.load();const t=this._getHelperServiceUrl("geometry");return new((await import("./p-b6a88f2a.js")).default)({url:t})}async createPrintTask(){await this.load();const t=this._getHelperServiceUrl("printTask");return new((await import("./p-8bb0c83c.js")).default)(t)}async createRouteTask(){await this.load();const t=this._getHelperServiceUrl("route");return new((await import("./p-c50c0709.js")).default)(t)}async createServiceAreaTask(){await this.load();const t=this._getHelperServiceUrl("serviceArea");return new((await import("./p-8de9069e.js")).default)(t)}fetchBasemaps(t,e){const i=new Cy;return i.query=t||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0,this.queryGroups(i,e).then((t=>{if(i.num=100,i.query='type:"Web Map" -type:"Web Application"',t.total){const s=t.results[0];return i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc",s.queryItems(i,e)}return null})).then((t=>{let e;return e=t&&t.total?t.results.filter((t=>"Web Map"===t.type)).map((t=>new zy({portalItem:t}))):[],e}))}fetchCategorySchema(t){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",t).then((t=>t.categorySchema)):Ui(t)?Zi($i()):ts([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new Cy;if(i.num=100,i.sortField="title",e&&e.length){const s=[];for(const t of e)s.push(`(title:"${t.title}" AND owner:${t.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,t).then((t=>t.results))}return Ui(t)?Zi($i()):ts([])}fetchRegions(t){const e=this.user&&this.user.culture||this.culture||yc();return this._request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}static getDefault(){return $y._default&&!$y._default.destroyed||($y._default=new $y),$y._default}queryGroups(t,e){return this._queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this._queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this._queryPortal("/community/users",t,"PortalUser",e)}toJSON(){throw new ge("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new $y({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new ge("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}_getHelperServiceUrl(t){const e=this._getHelperService(t);if(!e.url)throw new ge("portal:service-url-not-found",`The \`helperServices\` entry "${t}" does not include a \`url\` value`);return e.url}_fetchSelf(t=this.authMode,e=!1,i){const s=this.restUrl+"/portals/self",r={authMode:t,query:{culture:yc().toLowerCase()},...i};return"auto"===r.authMode&&(r.authMode="no-prompt"),e&&(r.query.default=!0),this._request(s,r)}_queryPortal(t,e,i,s){const r=ut(Cy,e),n=e=>this._request(this.restUrl+t,{...r.toRequestOptions(this),...s}).then((t=>{const i=r.clone();return i.start=t.nextStart,new Oy({nextQueryParams:i,queryParams:r,total:t.total,results:$y._resultsToTypedArray(e,{portal:this},t,s)})})).then((t=>Ei(t.results.map((e=>"function"==typeof e.when?e.when():t))).then((()=>t),(e=>(Vi(e),t)))));return i&&Fy[i]?Fy[i]().then((({default:t})=>(Fi(s),n(t)))):n()}_signIn(){if(this.authMode===$y.AUTH_MODE_ANONYMOUS)return Zi(new ge("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Zi(this.loadError);const t=t=>ts().then((()=>"not-loaded"===this.loadStatus?(t||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=t,this._fetchSelf("immediate")))):this.user&&this.credential===t?null:(this.credential=t,this._fetchSelf("immediate")))).then((t=>{t&&(this.sourceJSON=t,this.read(t))}));return Ya?Ya.getCredential(this.restUrl).then((e=>t(e))):t(this.credential)}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_normalizeUrl(t){const e=this.credential&&this.credential.token;return this._normalizeSSL(e?t+(t.indexOf("?")>-1?"&":"?")+"token="+e:t)}_requestToTypedArray(t,e,i){return this._request(t,e).then((t=>{const e=$y._resultsToTypedArray(i,{portal:this},t);return Ei(e.map((e=>"function"==typeof e.when?e.when():t))).then((()=>e),(()=>e))}))}_request(t,e={}){const i={f:"json",...e.query},{authMode:s=(this.authMode===$y.AUTH_MODE_ANONYMOUS?"anonymous":"auto"),body:r=null,cacheBust:n=!1,method:o="auto",responseType:l="json",signal:a}=e,u={authMode:s,body:r,cacheBust:n,method:o,query:i,responseType:l,timeout:0,signal:a};return eu(this._normalizeSSL(t),u).then((t=>t.data))}static _resultsToTypedArray(t,e,i,s){let r;if(i){const n=M(s)?s.signal:null;r=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(r=r.map((i=>{const s=g(t?t.fromJSON(i):i,e);return"function"==typeof s.load&&s.load(n),s})))}else r=[];return r}};Ly.AUTH_MODE_ANONYMOUS="anonymous",Ly.AUTH_MODE_AUTO="auto",Ly.AUTH_MODE_IMMEDIATE="immediate",s([Ut()],Ly.prototype,"access",void 0),s([Ut()],Ly.prototype,"allSSL",void 0),s([Ut()],Ly.prototype,"authMode",void 0),s([Ut()],Ly.prototype,"authorizedCrossOriginDomains",void 0),s([vn("authorizedCrossOriginDomains")],Ly.prototype,"readAuthorizedCrossOriginDomains",null),s([Ut()],Ly.prototype,"basemapGalleryGroupQuery",void 0),s([Ut()],Ly.prototype,"bingKey",void 0),s([Ut()],Ly.prototype,"canListApps",void 0),s([Ut()],Ly.prototype,"canListData",void 0),s([Ut()],Ly.prototype,"canListPreProvisionedItems",void 0),s([Ut()],Ly.prototype,"canProvisionDirectPurchase",void 0),s([Ut()],Ly.prototype,"canSearchPublic",void 0),s([Ut()],Ly.prototype,"canShareBingPublic",void 0),s([Ut()],Ly.prototype,"canSharePublic",void 0),s([Ut()],Ly.prototype,"canSignInArcGIS",void 0),s([Ut()],Ly.prototype,"canSignInIDP",void 0),s([Ut()],Ly.prototype,"colorSetsGroupQuery",void 0),s([Ut()],Ly.prototype,"commentsEnabled",void 0),s([Ut({type:Date})],Ly.prototype,"created",void 0),s([Ut()],Ly.prototype,"credential",void 0),s([Ut()],Ly.prototype,"culture",void 0),s([Ut()],Ly.prototype,"currentVersion",void 0),s([Ut()],Ly.prototype,"customBaseUrl",void 0),s([Ut()],Ly.prototype,"defaultBasemap",void 0),s([vn("defaultBasemap")],Ly.prototype,"readDefaultBasemap",null),s([Ut({type:bo})],Ly.prototype,"defaultExtent",void 0),s([Ut()],Ly.prototype,"defaultVectorBasemap",void 0),s([vn("defaultVectorBasemap")],Ly.prototype,"readDefaultVectorBasemap",null),s([Ut()],Ly.prototype,"description",void 0),s([Ut()],Ly.prototype,"eueiEnabled",void 0),s([Ut({dependsOn:["user","id","canSearchPublic"],readOnly:!0})],Ly.prototype,"extraQuery",null),s([Ut()],Ly.prototype,"featuredGroups",void 0),s([Ut()],Ly.prototype,"featuredItemsGroupQuery",void 0),s([Ut()],Ly.prototype,"galleryTemplatesGroupQuery",void 0),s([Ut()],Ly.prototype,"livingAtlasGroupQuery",void 0),s([Ut()],Ly.prototype,"hasCategorySchema",void 0),s([Ut()],Ly.prototype,"helpBase",void 0),s([Ut()],Ly.prototype,"helperServices",void 0),s([Ut()],Ly.prototype,"helpMap",void 0),s([Ut()],Ly.prototype,"homePageFeaturedContent",void 0),s([Ut()],Ly.prototype,"homePageFeaturedContentCount",void 0),s([Ut()],Ly.prototype,"httpPort",void 0),s([Ut()],Ly.prototype,"httpsPort",void 0),s([Ut()],Ly.prototype,"id",void 0),s([Ut()],Ly.prototype,"ipCntryCode",void 0),s([Ut({dependsOn:["access"],readOnly:!0})],Ly.prototype,"isOrganization",null),s([Ut()],Ly.prototype,"isPortal",void 0),s([Ut()],Ly.prototype,"isReadOnly",void 0),s([Ut()],Ly.prototype,"layerTemplatesGroupQuery",void 0),s([Ut()],Ly.prototype,"maxTokenExpirationMinutes",void 0),s([Ut({type:Date})],Ly.prototype,"modified",void 0),s([Ut()],Ly.prototype,"name",void 0),s([Ut()],Ly.prototype,"portalHostname",void 0),s([Ut()],Ly.prototype,"portalMode",void 0),s([Ut()],Ly.prototype,"portalProperties",void 0),s([Ut()],Ly.prototype,"region",void 0),s([Ut({dependsOn:["url"],readOnly:!0})],Ly.prototype,"restUrl",null),s([Ut()],Ly.prototype,"rotatorPanels",void 0),s([Ut()],Ly.prototype,"showHomePageDescription",void 0),s([Ut()],Ly.prototype,"sourceJSON",void 0),s([Ut()],Ly.prototype,"staticImagesUrl",void 0),s([Ut()],Ly.prototype,"stylesGroupQuery",void 0),s([Ut()],Ly.prototype,"supportsHostedServices",void 0),s([Ut()],Ly.prototype,"symbolSetsGroupQuery",void 0),s([Ut()],Ly.prototype,"templatesGroupQuery",void 0),s([Ut()],Ly.prototype,"thumbnail",void 0),s([Ut({dependsOn:["restUrl","thumbnail"],readOnly:!0})],Ly.prototype,"thumbnailUrl",null),s([Ut()],Ly.prototype,"units",void 0),s([Ut()],Ly.prototype,"url",void 0),s([Ut()],Ly.prototype,"urlKey",void 0),s([vn("urlKey")],Ly.prototype,"readUrlKey",null),s([Ut()],Ly.prototype,"user",void 0),s([vn("user")],Ly.prototype,"readUser",null),s([Ut()],Ly.prototype,"useStandardizedQuery",void 0),s([Ut()],Ly.prototype,"useVectorBasemaps",void 0),s([Ut()],Ly.prototype,"vectorBasemapGalleryGroupQuery",void 0),Ly=$y=s([ve("esri.portal.Portal")],Ly);var Uy,Vy=Ly;let Gy=Uy=class extends Rr{constructor(){super(...arguments),this.portal=null}clone(){return new Uy({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};s([Ut({type:String})],Gy.prototype,"name",void 0),s([Ut({type:String})],Gy.prototype,"styleUrl",void 0),s([Ut({type:String})],Gy.prototype,"styleName",void 0),s([Ut({type:Vy})],Gy.prototype,"portal",void 0),Gy=Uy=s([ve("esri.symbols.support.StyleOrigin")],Gy);var qy,By=Gy;let Hy=qy=class extends Rr{clone(){return new qy({url:this.url})}};s([Ut({type:String})],Hy.prototype,"url",void 0),Hy=qy=s([ve("esri.symbols.support.Thumbnail")],Hy);var Jy=Hy;const Wy={icon:Pp,object:Up,line:Np,path:qp,fill:ip,extrude:Od,text:Xp,water:Zp},Yy=Zh.ofType({base:hd,key:"type",typeMap:Wy,errorContext:"symbol-layer"}),Xy=W.getLogger("esri.symbols.Symbol3D");let Qy=class extends qa{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const e=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers;this._set("symbolLayers",new(e&&e.type||Zh))}get color(){return null}set color(t){Xy.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){ty(t,this._get("symbolLayers"))}readStyleOrigin(t,e,i){if(t.styleUrl&&t.name){const e=np(t.styleUrl,i);return new By({styleUrl:e,name:t.name})}if(t.styleName&&t.name)return new By({portal:i&&i.portal||Vy.getDefault(),styleName:t.styleName,name:t.name});i&&i.messages&&i.messages.push(new Bt("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:t}))}writeStyleOrigin(t,e,i,s){if(t.styleUrl&&t.name){let i=op(t.styleUrl,s);ii(i)&&(i=Ze(i)),e.styleOrigin={styleUrl:i,name:t.name}}else t.styleName&&t.name&&(t.portal&&s&&s.portal&&!He(t.portal.restUrl,s.portal.restUrl)?s&&s.messages&&s.messages.push(new Bt("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):e.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof hd||t&&Wy[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};s([Ut({json:{read:!1,write:!1}})],Qy.prototype,"color",null),s([Ut({type:Yy,nonNullable:!0,json:{write:!0}}),xn(ey)],Qy.prototype,"symbolLayers",null),s([Ut({type:By})],Qy.prototype,"styleOrigin",void 0),s([vn("styleOrigin")],Qy.prototype,"readStyleOrigin",null),s([be("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Qy.prototype,"writeStyleOrigin",null),s([Ut({type:Jy,json:{read:!1}})],Qy.prototype,"thumbnail",void 0),s([Ut({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Qy.prototype,"type",void 0),Qy=s([ve("esri.symbols.Symbol3D")],Qy);var Ky,Zy=Qy;let tm=Ky=class extends Wr{constructor(){super(...arguments),this.color=new Fa("white")}clone(){return new Ky({color:w(this.color)})}};s([Ut(cd)],tm.prototype,"color",void 0),tm=Ky=s([ve("esri.symbols.callouts.LineCallout3DBorder")],tm);var em=tm;Object.freeze({__proto__:null,get LineCallout3DBorder(){return tm},default:em});let im=class extends Wr{constructor(t){super(t),this.visible=!0}clone(){}};s([Ut({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],im.prototype,"type",void 0),s([Ut({readOnly:!0})],im.prototype,"visible",void 0),im=s([ve("esri.symbols.callouts.Callout3D")],im);var sm,rm=im;let nm=sm=class extends rm{constructor(t){super(t),this.type="line",this.color=new Fa([0,0,0,1]),this.size=Ch(1),this.border=null}get visible(){return this.size>0&&M(this.color)&&this.color.a>0}clone(){return new sm({color:w(this.color),size:this.size,border:w(this.border)})}};s([Ml({line:"line"},{readOnly:!0})],nm.prototype,"type",void 0),s([Ut(cd)],nm.prototype,"color",void 0),s([Ut(fd)],nm.prototype,"size",void 0),s([Ut({type:em,json:{write:!0}})],nm.prototype,"border",void 0),s([Ut({dependsOn:["size","color"],readOnly:!0})],nm.prototype,"visible",null),nm=sm=s([ve("esri.symbols.callouts.LineCallout3D")],nm);var om,lm=nm;let am=om=class extends Wr{constructor(){super(...arguments),this.screenLength=0,this.minWorldLength=0}clone(){return new om({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};s([Ut(fd)],am.prototype,"screenLength",void 0),s([Ut({type:Number,json:{write:!0,default:0}})],am.prototype,"minWorldLength",void 0),s([Ut({type:Number,json:{write:!0}})],am.prototype,"maxWorldLength",void 0),am=om=s([ve("esri.symbols.support.Symbol3DVerticalOffset")],am);var um=am;function hm(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength<=0)}function cm(t){if(!t)return!1;if(!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!hm(t)}const fm={types:{key:"type",base:rm,typeMap:{line:lm}},json:{write:!0}};var dm;const pm=Zh.ofType({base:null,key:"type",typeMap:{text:Xp}});let ym=dm=class extends Zy{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new pm,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return cm(this)}hasVisibleVerticalOffset(){return hm(this)}clone(){return new dm({styleOrigin:w(this.styleOrigin),symbolLayers:w(this.symbolLayers),thumbnail:w(this.thumbnail),callout:w(this.callout),verticalOffset:w(this.verticalOffset)})}static fromTextSymbol(t){return new dm({symbolLayers:[Xp.fromTextSymbol(t)]})}};s([Ut({type:um,json:{write:!0}})],ym.prototype,"verticalOffset",void 0),s([Ut(fm)],ym.prototype,"callout",void 0),s([Ut({json:{read:!1,write:!1}})],ym.prototype,"styleOrigin",void 0),s([Ut({type:pm})],ym.prototype,"symbolLayers",void 0),s([Ml({LabelSymbol3D:"label-3d"},{readOnly:!0})],ym.prototype,"type",void 0),ym=dm=s([ve("esri.symbols.LabelSymbol3D")],ym);var mm,vm=ym;const wm=Zh.ofType({base:null,key:"type",typeMap:{line:Np,path:qp}}),bm=Zh.ofType({base:null,key:"type",typeMap:{line:Np,path:qp}});let gm=mm=class extends Zy{constructor(t){super(t),this.symbolLayers=new wm,this.type="line-3d"}clone(){return new mm({styleOrigin:w(this.styleOrigin),symbolLayers:w(this.symbolLayers),thumbnail:w(this.thumbnail)})}static fromSimpleLineSymbol(t){return new mm({symbolLayers:[Np.fromSimpleLineSymbol(t)]})}};s([Ut({type:wm,json:{type:bm}})],gm.prototype,"symbolLayers",void 0),s([Ml({LineSymbol3D:"line-3d"},{readOnly:!0})],gm.prototype,"type",void 0),gm=mm=s([ve("esri.symbols.LineSymbol3D")],gm);var Sm=gm;let Mm=class extends qa{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};s([Ut({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Mm.prototype,"angle",void 0),s([Ut({type:["simple-marker","picture-marker"],readOnly:!0})],Mm.prototype,"type",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Mm.prototype,"xoffset",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Mm.prototype,"yoffset",void 0),s([Ut({type:Number,cast:t=>"auto"===t?t:Ih(t),json:{write:!0}})],Mm.prototype,"size",void 0),Mm=s([ve("esri.symbols.MarkerSymbol")],Mm);var xm,km=Mm;const Cm=Zh.ofType({base:null,key:"type",typeMap:{fill:ip}});let Im=xm=class extends Zy{constructor(t){super(t),this.symbolLayers=new Cm,this.type="mesh-3d"}clone(){return new xm({styleOrigin:w(this.styleOrigin),symbolLayers:w(this.symbolLayers),thumbnail:w(this.thumbnail)})}};s([Ut({type:Cm})],Im.prototype,"symbolLayers",void 0),s([Ml({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Im.prototype,"type",void 0),Im=xm=s([ve("esri.symbols.MeshSymbol3D")],Im);var Om=Im;function jm(t,e){return function(t){return t&&("service"===t.origin||"portal-item"===t.origin)&&t.layer&&("feature"===t.layer.type||"stream"===t.layer.type)}(e)&&!ii(t)&&e.layer.parsedUrl?ti(e.layer.parsedUrl.path,"images",t):np(t,e)}const Pm={json:{read:{source:["imageData","url"],reader:function(t,e,i){return e.imageData?ai({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):jm(e.url,i)}},write:{writer(t,e,i,s){!function(t,e,i,s){if(ri(t)){const r=li(t);e.contentType=r.mediaType,e.imageData=r.data,i&&i.imageData===e.imageData&&i.url&&ap(i.url,e,"url",s)}else ap(t,e,"url",s)}(t,e,this.source,s)}}}},Am={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const s={};return e.imageData&&(s.imageData=e.imageData),e.contentType&&(s.contentType=e.contentType),e.url&&(s.url=jm(e.url,i)),s}}}};var Tm;let Nm=Tm=class extends zd{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,s){if(t&&"string"!=typeof t&&null==t.imageData)return t;const r={};return t&&(r.url=t),e&&(r.outline=e),null!=i&&(r.width=Ih(i)),null!=s&&(r.height=Ih(s)),r}clone(){const t=new Tm({color:w(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",w(this.source)),t}hash(){var t;return`${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};s([Ml({esriPFS:"picture-fill"},{readOnly:!0})],Nm.prototype,"type",void 0),s([Ut(Pm)],Nm.prototype,"url",void 0),s([Ut({type:Number,json:{write:!0}})],Nm.prototype,"xscale",void 0),s([Ut({type:Number,json:{write:!0}})],Nm.prototype,"yscale",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Nm.prototype,"width",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Nm.prototype,"height",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Nm.prototype,"xoffset",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Nm.prototype,"yoffset",void 0),s([Ut(Am)],Nm.prototype,"source",void 0),Nm=Tm=s([ve("esri.symbols.PictureFillSymbol")],Nm);var Rm,_m=Nm;let Em=Rm=class extends km{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t&&null==t.imageData)return t;const s={};return t&&(s.url=t),null!=e&&(s.width=Ih(e)),null!=i&&(s.height=Ih(i)),s}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new Rm({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",w(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};s([Ut({json:{write:!1}})],Em.prototype,"color",void 0),s([Ml({esriPMS:"picture-marker"},{readOnly:!0})],Em.prototype,"type",void 0),s([Ut(Pm)],Em.prototype,"url",void 0),s([Ut(Am)],Em.prototype,"source",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Em.prototype,"height",void 0),s([vn("height",["height","size"])],Em.prototype,"readHeight",null),s([Ut({type:Number,cast:Ih,json:{write:!0}})],Em.prototype,"width",void 0),s([Ut({json:{write:!1}})],Em.prototype,"size",void 0),Em=Rm=s([ve("esri.symbols.PictureMarkerSymbol")],Em);var Dm,$m=Em;const zm=Zh.ofType({base:null,key:"type",typeMap:{icon:Pp,object:Up,text:Xp}}),Fm=Zh.ofType({base:null,key:"type",typeMap:{icon:Pp,object:Up}});let Lm=Dm=class extends Zy{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new zm,this.type="point-3d"}writeSymbolLayers(t,e,i,s){const r=t.filter((t=>"text"!==t.type));if(s&&s.messages&&r.length<t.length){const e=t.find((t=>"text"===t.type));s.messages.push(new ge("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:e}))}e[i]=r.map((t=>t.write({},s))).toArray()}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return cm(this)}hasVisibleVerticalOffset(){return hm(this)}clone(){return new Dm({verticalOffset:w(this.verticalOffset),callout:w(this.callout),styleOrigin:w(this.styleOrigin),symbolLayers:w(this.symbolLayers),thumbnail:w(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Dm({symbolLayers:[Pp.fromSimpleMarkerSymbol(t)]})}static fromPictureMarkerSymbol(t){return new Dm({symbolLayers:[Pp.fromPictureMarkerSymbol(t)]})}static fromCIMSymbol(t){return new Dm({symbolLayers:[Pp.fromCIMSymbol(t)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})}static fromTextSymbol(t){return new Dm({symbolLayers:[Xp.fromTextSymbol(t)]})}};s([Ut({type:um,json:{write:!0}})],Lm.prototype,"verticalOffset",void 0),s([Ut(fm)],Lm.prototype,"callout",void 0),s([Ut({type:zm,json:{type:Fm,origins:{"web-scene":{type:Fm}}}})],Lm.prototype,"symbolLayers",void 0),s([be("web-scene","symbolLayers")],Lm.prototype,"writeSymbolLayers",null),s([Ml({PointSymbol3D:"point-3d"},{readOnly:!0})],Lm.prototype,"type",void 0),Lm=Dm=s([ve("esri.symbols.PointSymbol3D")],Lm);var Um,Vm=Lm;const Gm=Zh.ofType({base:null,key:"type",typeMap:{extrude:Od,fill:ip,icon:Pp,line:Np,object:Up,text:Xp,water:Zp}}),qm=Zh.ofType({base:null,key:"type",typeMap:{extrude:Od,fill:ip,icon:Pp,line:Np,object:Up,water:Zp}});let Bm=Um=class extends Zy{constructor(t){super(t),this.type="polygon-3d"}writeSymbolLayers(t,e,i,s){const r=t.filter((t=>"text"!==t.type));if(s&&s.messages&&r.length<t.length){const e=t.find((t=>"text"===t.type));s.messages.push(new ge("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:e}))}e[i]=r.map((t=>t.write({},s))).toArray()}clone(){return new Um({styleOrigin:w(this.styleOrigin),symbolLayers:w(this.symbolLayers),thumbnail:w(this.thumbnail)})}static fromJSON(t){const e=new Um;if(e.read(t),2===e.symbolLayers.length&&"fill"===e.symbolLayers.getItemAt(0).type&&"line"===e.symbolLayers.getItemAt(1).type){const i=e.symbolLayers.getItemAt(0),s=e.symbolLayers.getItemAt(1);!s.enabled||t.symbolLayers&&t.symbolLayers[1]&&!1===t.symbolLayers[1].enable||(i.outline={size:s.size,color:M(s.material)?s.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new Um({symbolLayers:[ip.fromSimpleFillSymbol(t)]})}};s([Ut({type:Gm,json:{type:qm}})],Bm.prototype,"symbolLayers",void 0),s([be("web-scene","symbolLayers")],Bm.prototype,"writeSymbolLayers",null),s([Ml({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],Bm.prototype,"type",void 0),Bm=Um=s([ve("esri.symbols.PolygonSymbol3D")],Bm);var Hm,Jm=Bm;const Wm=new sl({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Ym=Hm=class extends zd{constructor(...t){super(...t),this.color=new Fa([0,0,0,.25]),this.outline=new Dd,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.style=t),e&&(s.outline=e),i&&(s.color=i),s}clone(){return new Hm({color:w(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};s([Ut()],Ym.prototype,"color",void 0),s([Ut()],Ym.prototype,"outline",void 0),s([Ml({esriSFS:"simple-fill"},{readOnly:!0})],Ym.prototype,"type",void 0),s([Ut({type:Wm.apiValues,json:{read:Wm.read,write:Wm.write}})],Ym.prototype,"style",void 0),Ym=Hm=s([ve("esri.symbols.SimpleFillSymbol")],Ym);var Xm,Qm=Ym;const Km=new sl({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Zm=Xm=class extends km{constructor(...t){super(...t),this.color=new Fa([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Dd}normalizeCtorArgs(t,e,i,s){if(t&&"string"!=typeof t)return t;const r={};return t&&(r.style=t),null!=e&&(r.size=Ih(e)),i&&(r.outline=i),s&&(r.color=s),r}writeColor(t,e){t&&"x"!==this.style&&"cross"!==this.style&&(e.color=t.toJSON()),null===t&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new Xm({angle:this.angle,color:w(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${null==(t=this.outline)?void 0:t.hash()}`}};s([Ut()],Zm.prototype,"color",void 0),s([be("color")],Zm.prototype,"writeColor",null),s([Ml({esriSMS:"simple-marker"},{readOnly:!0})],Zm.prototype,"type",void 0),s([Ut()],Zm.prototype,"size",void 0),s([Ut({type:Km.apiValues,json:{read:Km.read,write:Km.write}})],Zm.prototype,"style",void 0),s([Ut({type:String,json:{write:!0}})],Zm.prototype,"path",null),s([Ut({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Dd}},json:{default:null,write:!0}})],Zm.prototype,"outline",void 0),Zm=Xm=s([ve("esri.symbols.SimpleMarkerSymbol")],Zm);var tv,ev=Zm;let iv=tv=class extends qa{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new rp,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment=null,this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.text=t),e&&(s.font=e),i&&(s.color=i),s}writeLineWidth(t,e,i,s){s&&"string"!=typeof s||(e[i]=t)}castLineWidth(t){return Ih(t)}writeLineHeight(t,e,i,s){s&&"string"!=typeof s||(e[i]=t)}clone(){return new tv({angle:this.angle,backgroundColor:w(this.backgroundColor),borderLineColor:w(this.borderLineColor),borderLineSize:this.borderLineSize,color:w(this.color),font:this.font&&this.font.clone(),haloColor:w(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};s([Ut({type:Fa,json:{write:!0}})],iv.prototype,"backgroundColor",void 0),s([Ut({type:Fa,json:{write:!0}})],iv.prototype,"borderLineColor",void 0),s([Ut({type:Number,json:{write:!0}})],iv.prototype,"borderLineSize",void 0),s([Ut({type:rp,json:{write:!0}})],iv.prototype,"font",void 0),s([Ut({type:["left","right","center","justify"],json:{write:!0}})],iv.prototype,"horizontalAlignment",void 0),s([Ut({type:Boolean,json:{write:!0}})],iv.prototype,"kerning",void 0),s([Ut({type:Fa,json:{write:!0}})],iv.prototype,"haloColor",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],iv.prototype,"haloSize",void 0),s([Ut({type:Boolean,json:{write:!0}})],iv.prototype,"rightToLeft",void 0),s([Ut({type:Boolean,json:{write:!0}})],iv.prototype,"rotated",void 0),s([Ut({type:String,json:{write:!0}})],iv.prototype,"text",void 0),s([Ml({esriTS:"text"},{readOnly:!0})],iv.prototype,"type",void 0),s([Ut({type:["baseline","top","middle","bottom"],json:{write:!0}})],iv.prototype,"verticalAlignment",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],iv.prototype,"xoffset",void 0),s([Ut({type:Number,cast:Ih,json:{write:!0}})],iv.prototype,"yoffset",void 0),s([Ut({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],iv.prototype,"angle",void 0),s([Ut({type:Number,json:{write:!0}})],iv.prototype,"width",void 0),s([Ut({type:Number})],iv.prototype,"lineWidth",void 0),s([be("lineWidth")],iv.prototype,"writeLineWidth",null),s([xn("lineWidth")],iv.prototype,"castLineWidth",null),s([Ut({type:Number})],iv.prototype,"lineHeight",void 0),s([be("lineHeight")],iv.prototype,"writeLineHeight",null),iv=tv=s([ve("esri.symbols.TextSymbol")],iv);var sv,rv=iv;const nv=W.getLogger("esri.symbols.WebStyleSymbol");let ov=sv=class extends qa{constructor(t){super(t),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}read(t,e){this.portal=e?e.portal:void 0,super.read(t,e)}clone(){return new sv({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=await import("./p-dc697c54.js").then((function(t){return t.s}));Fi(e);const s=i.resolveWebStyleSymbol(this,{portal:this.portal},t,e);return s.catch((t=>{nv.error("#fetchSymbol()","Failed to create symbol from style",t)})),s}};s([Ut({json:{write:!1}})],ov.prototype,"color",void 0),s([Ut({type:String,json:{write:!0}})],ov.prototype,"styleName",void 0),s([Ut({type:Vy,json:{write:!1}})],ov.prototype,"portal",void 0),s([Ut({type:String,json:{read:lp,write:ap}})],ov.prototype,"styleUrl",void 0),s([Ut({type:Jy,json:{read:!1}})],ov.prototype,"thumbnail",void 0),s([Ut({type:String,json:{write:!0}})],ov.prototype,"name",void 0),s([Ml({styleSymbolReference:"web-style"},{readOnly:!0})],ov.prototype,"type",void 0),ov=sv=s([ve("esri.symbols.WebStyleSymbol")],ov);var lv=ov;function av(t,e,i,s){const r=function(t,e,i){if(!t)return null;if(i&&"web-scene"===i.origin&&!(t instanceof Zy)&&!(t instanceof lv)){const s="cim"!==t.type?function(t,e=!1,i=!1,s=!0){if(!t)return{symbol:null};let r;if(cv(t)||t instanceof lv)r=t.clone();else if("cim"===t.type)r=Vm.fromCIMSymbol(t);else if(t instanceof Dd)r=Sm.fromSimpleLineSymbol(t);else if(t instanceof ev)r=Vm.fromSimpleMarkerSymbol(t);else if(t instanceof $m)r=Vm.fromPictureMarkerSymbol(t);else if(t instanceof Qm)r=Jm.fromSimpleFillSymbol(t);else{if(!(t instanceof rv))return{error:new ge("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};r=s?vm.fromTextSymbol(t):Vm.fromTextSymbol(t)}if(e&&(r.id=t.id),i&&cv(r))for(let t=0;t<r.symbolLayers.length;++t)r.symbolLayers.getItemAt(t)._ignoreDrivers=!0;return{symbol:r}}(t):{symbol:null,error:new ge("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:t})};return s.symbol?s.symbol.write(e,i):(i.messages&&i.messages.push(new ge("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:s.error})),null)}return i&&"web-map"===i.origin&&"web-style"===t.type?(i.messages&&i.messages.push(new ge("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:t,context:i})),null):t.write(e,i)}(t,{},s);r&&(e[i]=r)}function uv(t,e){return dv(t,null,e)}function hv(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function cv(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const fv={base:qa,key:"type",typeMap:{"simple-fill":Qm,"picture-fill":_m,"picture-marker":$m,"simple-line":Dd,"simple-marker":ev,text:rv,"label-3d":vm,"line-3d":Sm,"mesh-3d":Om,"point-3d":Vm,"polygon-3d":Jm,"web-style":lv,cim:Ha},errorContext:"symbol"},dv=Yt({types:fv}),pv={base:qa,key:"type",typeMap:{"simple-fill":Qm,"picture-fill":_m,"picture-marker":$m,"simple-line":Dd,"simple-marker":ev,text:rv,"line-3d":Sm,"mesh-3d":Om,"point-3d":Vm,"polygon-3d":Jm,"web-style":lv,cim:Ha},errorContext:"symbol"},yv={base:qa,key:"type",typeMap:{text:rv,"label-3d":vm},errorContext:"symbol"},mv={base:qa,key:"type",typeMap:{"line-3d":Sm,"mesh-3d":Om,"point-3d":Vm,"polygon-3d":Jm,"web-style":lv},errorContext:"symbol"},vv={base:qa,key:"type",typeMap:{"label-3d":vm},errorContext:"symbol"},wv=yt(fv);let bv=0;function gv(){return bv++}var Sv;let Mv=Sv=class extends Wr{constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:gv(),configurable:!0})}normalizeCtorArgs(t,e,i,s){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:i,popupTemplate:s}}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}getEffectivePopupTemplate(t=!1){return this.popupTemplate?this.popupTemplate:this.sourceLayer?"popupTemplate"in this.sourceLayer&&this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:t&&"defaultPopupTemplate"in this.sourceLayer&&M(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null}getAttribute(t){return this.attributes&&this.attributes[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:M(this.geometry)?this.geometry.toJSON():null,symbol:M(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new Sv(this.cloneProperties())}cloneProperties(){return{attributes:w(this.attributes),geometry:w(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:w(this.symbol),visible:this.visible}}_notifyLayer(t,e,i,s){if(!this.layer||!("graphicChanged"in this.layer))return;const r={graphic:this,property:t,oldValue:e,newValue:i};"attributes"===t&&(r.attributeName=s),this.layer.graphicChanged(r)}};s([Ut({value:null})],Mv.prototype,"attributes",null),s([Ut({value:null,types:ml,json:{read:fl}})],Mv.prototype,"geometry",null),s([Ut({type:Boolean})],Mv.prototype,"isAggregate",void 0),s([Ut()],Mv.prototype,"layer",void 0),s([Ut({type:ad})],Mv.prototype,"popupTemplate",void 0),s([Ut()],Mv.prototype,"sourceLayer",void 0),s([Ut({value:null,types:fv})],Mv.prototype,"symbol",null),s([Ut({type:Boolean,value:!0})],Mv.prototype,"visible",null),Mv=Sv=s([ve("esri.Graphic")],Mv),(Mv||(Mv={})).generateUID=gv;var xv=Mv;function kv(t){return new mn({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${t.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}const Cv=kv(Cn),Iv=kv(In),Ov=kv(On),jv=new mn({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${Cn.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});function Pv(t){return an(t)?In:hn(t)?On:Cn}const Av=39.37,Tv=Cn.radius*Math.PI/200,Nv=/UNIT\[([^\]]+)\]\]$/i,Rv=Yr,_v=/UNIT\[([^\]]+)\]/i,Ev=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),Dv=rl()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),$v=t=>t*t,zv=t=>t*t*t,Fv={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:$v(.001)},"square-centimeters":{inBaseUnits:$v(.01)},"square-decimeters":{inBaseUnits:$v(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:$v(1e3)},"square-inches":{inBaseUnits:$v(.0254)},"square-feet":{inBaseUnits:$v(.3048)},"square-yards":{inBaseUnits:$v(.9144)},"square-miles":{inBaseUnits:$v(1609.344)},"square-us-feet":{inBaseUnits:$v(1200/3937)},acres:{inBaseUnits:.0015625*$v(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*zv(.001)},"cubic-centimeters":{inBaseUnits:1e3*zv(.01)},"cubic-decimeters":{inBaseUnits:1e3*zv(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*zv(1e3)},"cubic-inches":{inBaseUnits:1e3*zv(.0254)},"cubic-feet":{inBaseUnits:1e3*zv(.3048)},"cubic-yards":{inBaseUnits:1e3*zv(.9144)},"cubic-miles":{inBaseUnits:1e3*zv(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Lv=function(){const t={};for(const e in Fv)for(const i in Fv[e].units)t[i]=e;return t}();function Uv(t){const e=Lv[t];if(e)return e;throw new Error("unknown measure")}function Vv(t,e=null){return e=e||Uv(t),Fv[e].baseUnit===t}function Gv(t,e,i){if(e===i)return t;const s=Uv(e);if(s!==Uv(i))throw new Error("incompatible units");const r=Vv(e,s)?t:function(t,e,i){return t*Fv[i].units[e].inBaseUnits}(t,e,s);return Vv(i,s)?r:function(t,e,i){return t/Fv[i].units[e].inBaseUnits}(r,i,s)}function qv(t){return Dv.fromJSON(t.toLowerCase())||null}function Bv(t){if(t&&"object"==typeof t&&!function(t){return!(un(t)||cn(t))}(t))return 1;const e=Jv(t);return e>1e5?1:e}function Hv(t){return Jv(t)>=(t instanceof mn?function(t){return t&&(un(t)||t===Iv)?In:t&&(cn(t)||t===Ov)?On:Cn}(t).metersPerDegree:1e5)?"meters":Wv(t)}function Jv(t,e=Cn.metersPerDegree){return function(t,e=!1){let i,s,r=null;if(null!=t&&("object"==typeof t?(i=t.wkid,s=t.wkt):"number"==typeof t?i=t:"string"==typeof t&&(s=t)),i){if(an(i))return In.metersPerDegree;if(hn(i))return On.metersPerDegree;r=Rv.values[Rv[i]],!r&&e&&Ev.has(i)&&(r=Tv)}else if(s)if(-1!==s.search(/^PROJCS/i)){const t=Nv.exec(s);t&&t[1]&&(r=parseFloat(t[1].split(",")[1]))}else if(-1!==s.search(/^GEOCCS/i)){const t=_v.exec(s);t&&t[1]&&(r=parseFloat(t[1].split(",")[1]))}return r}(t,!0)||e}function Wv(t){let e,i,s=null;if(null!=t&&("object"==typeof t?(e=t.wkid,i=t.wkt):"number"==typeof t?e=t:"string"==typeof t&&(i=t)),e)s=Rv.units[Rv[e]];else if(i&&-1!==i.search(/^PROJCS/i)){let t=Nv.exec(i);t&&t[1]&&(t=/[\\"\\']{1}([^\\"\\']+)/.exec(t[1]),s=t&&t[1])}return s?qv(s):null}const Yv={inches:Gv(1,"meters","inches"),feet:Gv(1,"meters","feet"),"us-feet":Gv(1,"meters","us-feet"),yards:Gv(1,"meters","yards"),miles:Gv(1,"meters","miles"),"nautical-miles":Gv(1,"meters","nautical-miles"),millimeters:Gv(1,"meters","millimeters"),centimeters:Gv(1,"meters","centimeters"),decimeters:Gv(1,"meters","decimeters"),meters:Gv(1,"meters","meters"),kilometers:Gv(1,"meters","kilometers"),"decimal-degrees":1/function(t,e,i){return Gv(1,"meters","meters")/(i*Math.PI/180)}(0,0,Cn.radius)},Xv=W.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),Qv=new xv,Kv=Math.PI,Zv=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function tw(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"color"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.ColorVariable"!==s.declaredClass)return void Xv.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const r="number"==typeof e,n=r?null:e,o=n&&n.attributes;let l=r?e:null;const a=s.field,{ipData:u,hasExpression:h}=s.cache;let c=s.cache.compiledFunc;if(!a&&!h){const t=s.stops;return t&&t[0]&&t[0].color}if("number"!=typeof l)if(h){if(!M(i)||!M(i.arcade))return void Xv.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),r=t.createExecContext(n,e);if(!c){const e=t.createSyntaxTree(s.valueExpression);c=t.createFunction(e),s.cache.compiledFunc=c}l=t.executeFunction(c,r)}else o&&(l=o[a]);const f=s.normalizationField,d=o?parseFloat(o[f]):void 0;if(null!=l&&(!f||r||!isNaN(d)&&0!==d)){isNaN(d)||r||(l/=d);const t=lw(l,u);if(t){const e=t[0],r=t[1],n=e===r?s.stops[e].color:Fa.blendColors(s.stops[e].color,s.stops[r].color,t[2],M(i)?i.color:void 0);return new Fa(n)}}}function ew(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"opacity"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.OpacityVariable"!==s.declaredClass)return void Xv.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r="number"==typeof e,n=r?null:e,o=n&&n.attributes;let l=r?e:null;const a=s.field,{ipData:u,hasExpression:h}=s.cache;let c=s.cache.compiledFunc;if(!a&&!h){const t=s.stops;return t&&t[0]&&t[0].opacity}if("number"!=typeof l)if(h){if(x(i)||x(i.arcade))return void Xv.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),r=t.createExecContext(n,e);if(!c){const e=t.createSyntaxTree(s.valueExpression);c=t.createFunction(e),s.cache.compiledFunc=c}l=t.executeFunction(c,r)}else o&&(l=o[a]);const f=s.normalizationField,d=o?parseFloat(o[f]):void 0;if(null!=l&&(!f||r||!isNaN(d)&&0!==d)){isNaN(d)||r||(l/=d);const t=lw(l,u);if(t){const e=t[0],i=t[1];if(e===i)return s.stops[e].opacity;{const r=s.stops[e].opacity;return r+(s.stops[i].opacity-r)*t[2]}}}}function iw(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"rotation"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.RotationVariable"!==s.declaredClass)return void Xv.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=s.axis||"heading",n="heading"===r&&"arithmetic"===s.rotationType?90:0,o="heading"===r&&"arithmetic"===s.rotationType?-1:1,l="number"==typeof e?null:e,a=l&&l.attributes,u=s.field,{hasExpression:h}=s.cache;let c=s.cache.compiledFunc,f=0;if(!u&&!h)return f;if(h){if(x(i)||x(i.arcade))return void Xv.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),r=t.createExecContext(l,e);if(!c){const e=t.createSyntaxTree(s.valueExpression);c=t.createFunction(e),s.cache.compiledFunc=c}f=t.executeFunction(c,r)}else a&&(f=a[u]||0);return f="number"!=typeof f||isNaN(f)?null:n+o*f,f}function sw(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"size"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.SizeVariable"!==s.declaredClass)return void Xv.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=function(t,e,i,s,r){switch(e.transformationType){case"additive":return function(t,e,i,s){return t+(rw(e.minSize,i,s)||e.minDataValue)}(t,e,i,s);case"constant":return function(t,e,i){const s=t.stops;let r=s&&s.length&&s[0].size;return null==r&&(r=t.minSize),rw(r,e,i)}(e,i,s);case"clamped-linear":return function(t,e,i,s){const r=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),n=rw(e.minSize,i,s),o=rw(e.maxSize,i,s),l=M(s)?s.shape:void 0;if(t<=e.minDataValue)return n;if(t>=e.maxDataValue)return o;if("area"===e.scaleBy&&l){const t="circle"===l,e=t?Kv*Math.pow(n/2,2):n*n,i=e+r*((t?Kv*Math.pow(o/2,2):o*o)-e);return t?2*Math.sqrt(i/Kv):Math.sqrt(i)}return n+r*(o-n)}(t,e,i,s);case"proportional":return function(t,e,i,s){const r=M(s)?s.shape:void 0,n=t/e.minDataValue,o=rw(e.minSize,i,s),l=rw(e.maxSize,i,s);let a=null;return a="circle"===r?2*Math.sqrt(n*Math.pow(o/2,2)):"square"===r||"diamond"===r||"image"===r?Math.sqrt(n*Math.pow(o,2)):n*o,nw(a,o,l)}(t,e,i,s);case"stops":return function(t,e,i,s,r){const[n,o,l]=lw(t,r);if(n===o)return rw(e.stops[n].size,i,s);{const t=rw(e.stops[n].size,i,s);return t+(rw(e.stops[o].size,i,s)-t)*l}}(t,e,i,s,r);case"real-world-size":return function(t,e,i,s){const r=(M(s)&&s.resolution?s.resolution:1)*Yv[e.valueUnit],n=rw(e.minSize,i,s),o=rw(e.maxSize,i,s),{valueRepresentation:l}=e;let a=null;return a="area"===l?2*Math.sqrt(t/Kv)/r:"radius"===l||"distance"===l?2*t/r:t/r,nw(a,n,o)}(t,e,i,s);case"identity":return t;case"unknown":return null}}(function(t,e,i){const s="number"==typeof e,r=s?null:e,n=r&&r.attributes;let o=s?e:null;const{isScaleDriven:l}=t.cache;let a=t.cache.compiledFunc;if(l){const e=M(i)?i.scale:void 0,s=M(i)?i.view:void 0;o=null==e||"3d"===s?function(t){let e=null,i=null;const s=t.stops;return s?(e=s[0].value,i=s[s.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}(t):e}else if(!s)switch(t.inputValueType){case"expression":{if(x(i)||x(i.arcade))return void Xv.error("Use of arcade expressions requires an arcade context");const e=i.arcade.arcadeUtils,s=e.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=e.createExecContext(r,s);if(!a){const i=e.createSyntaxTree(t.valueExpression);a=e.createFunction(i),t.cache.compiledFunc=a}o=e.executeFunction(a,n);break}case"field":n&&(o=n[t.field]);break;case"unknown":o=null}if(!Dh(o))return null;if(s||!t.normalizationField)return o;const u=n?parseFloat(n[t.normalizationField]):null;return Dh(u)&&0!==u?o/u:null}(s,e,i),s,e,i,s.cache.ipData);return null==r||isNaN(r)?0:r}function rw(t,e,i){return null==t?null:Eh(t)?sw(t,e,i):Dh(t)?t:null}function nw(t,e,i){return Dh(i)&&t>i?i:Dh(e)&&t<e?e:t}function ow(t,e,i){const{isScaleDriven:s}=t.cache;if(!(s&&"3d"===i||e))return null;const r={scale:e,view:i};let n=rw(t.minSize,Qv,r),o=rw(t.maxSize,Qv,r);if(null!=n||null!=o){if(n>o){const t=o;o=n,n=t}return{minSize:n,maxSize:o}}}function lw(t,e){if(!e)return;let i=0,s=e.length-1;return e.some(((e,r)=>t<e?(s=r,!0):(i=r,!1))),[i,s,(t-e[i])/(e[s]-e[i])]}function aw(t,e,i){const s=["proportional","proportional","proportional"];for(const r of t){const t=r.useSymbolValue?"symbol-value":sw(r,e,i);switch(r.axis){case"width":s[0]=t;break;case"depth":s[1]=t;break;case"height":s[2]=t;break;case"width-and-depth":s[0]=t,s[1]=t;break;case"all":case void 0:case null:s[0]=t,s[1]=t,s[2]=t}}return s}var uw;const hw=W.getLogger("esri.renderers.visualVariables.SizeVariable"),cw=new sl({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),fw=new sl({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function dw(t){if(null!=t)return"string"==typeof t||"number"==typeof t?Ih(t):"size"===t.type?Eh(t)?t:(delete(t={...t}).type,new yw(t)):void 0}function pw(t,e,i){if("object"!=typeof t)return t;const s=new yw;return s.read(t,i),s}let yw=uw=class extends oh{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:Zv.test(this.valueExpression)}}set expression(t){hw.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===t?(this.valueExpression="$view.scale",this._set("expression",t)):this._set("expression",null)}set index(t){Eh(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),Eh(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return $h(this)}set maxDataValue(t){t&&this.stops&&(hw.warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(hw.warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return dw(t)}readMaxSize(t,e,i){return pw(t,0,i)}set minDataValue(t){t&&this.stops&&(hw.warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(hw.warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return dw(t)}readMinSize(t,e,i){return pw(t,0,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(t){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)):t&&(hw.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return function(t,e){return"unknown"===(e||$h(t))?"constant":t.stops?"stops":null!=t.minSize&&null!=t.maxSize&&null!=t.minDataValue&&null!=t.maxDataValue?"clamped-linear":"unknown"===(t.valueUnit||"unknown")?null!=t.minSize&&null!=t.minDataValue?t.minSize&&t.minDataValue?"proportional":"additive":"identity":"real-world-size"}(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,s){if("$view.scale"===t){if(s&&s.messages){const t=this.index;s.messages.push(new ge("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:("string"==typeof t?t:`visualVariables[${t}]`)+".valueExpression",context:s}))}}else e[i]=t}readValueUnit(t){return t?fw.read(t):null}clone(){return new uw({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Eh(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Eh(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((t=>t.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if("clamped-linear"===this.transformationType){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if("stops"===this.transformationType){const t=this.stops,e=t.map((t=>t.size)).reverse(),i=t.length;for(let s=0;s<i;s++)t[s].size=e[s];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};s([Ut({readOnly:!0,dependsOn:["valueExpression","stops"]})],yw.prototype,"cache",null),s([Ut({type:cw.apiValues,json:{type:cw.jsonValues,origins:{"web-map":{read:!1}},read:cw.read,write:cw.write}})],yw.prototype,"axis",void 0),s([Ut({type:String,value:null,json:{read:!1}})],yw.prototype,"expression",null),s([Ut()],yw.prototype,"index",null),s([Ut({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],yw.prototype,"inputValueType",null),s([Ut({type:_h,json:{write:!0}})],yw.prototype,"legendOptions",void 0),s([Ut({type:Number,value:null,json:{write:!0}})],yw.prototype,"maxDataValue",null),s([Ut({type:Number,value:null,json:{write:!0}})],yw.prototype,"maxSize",null),s([xn("maxSize")],yw.prototype,"castMaxSize",null),s([vn("maxSize")],yw.prototype,"readMaxSize",null),s([Ut({type:Number,value:null,json:{write:!0}})],yw.prototype,"minDataValue",null),s([Ut({type:Number,value:null,json:{write:!0}})],yw.prototype,"minSize",null),s([xn("minSize")],yw.prototype,"castMinSize",null),s([vn("minSize")],yw.prototype,"readMinSize",null),s([Ut({type:String,json:{write:!0}})],yw.prototype,"normalizationField",void 0),s([Ut({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],yw.prototype,"arcadeRequired",null),s([Ut({type:String})],yw.prototype,"scaleBy",void 0),s([Ut({type:[Nh],value:null,json:{write:!0}})],yw.prototype,"stops",null),s([Ut({type:["outline"],json:{write:!0}})],yw.prototype,"target",void 0),s([Ut({type:String,readOnly:!0,dependsOn:["minDataValue","maxDataValue","minSize","maxSize","valueUnit","inputValueType","stops"]})],yw.prototype,"transformationType",null),s([Ut({type:["size"],json:{type:["sizeInfo"]}})],yw.prototype,"type",void 0),s([Ut({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],yw.prototype,"useSymbolValue",void 0),s([Ut({type:String,json:{write:!0}})],yw.prototype,"valueExpression",void 0),s([vn("valueExpression",["valueExpression","expression"])],yw.prototype,"readValueExpression",null),s([be("web-scene","valueExpression")],yw.prototype,"writeValueExpressionWebScene",null),s([Ut({type:["radius","diameter","area","width","distance"],json:{write:!0}})],yw.prototype,"valueRepresentation",void 0),s([Ut({type:fw.apiValues,json:{write:fw.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],yw.prototype,"valueUnit",void 0),s([vn("valueUnit")],yw.prototype,"readValueUnit",null),yw=uw=s([ve("esri.renderers.visualVariables.SizeVariable")],yw);var mw=yw;const vw=W.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),ww={color:fh,size:mw,opacity:gh,rotation:Mh},bw=new sl({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),gw=/^\[([^\]]+)\]$/i;let Sw=class extends Rr{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),(t=t&&t.filter((t=>!!t)))&&t.length){for(const e of t)switch(e.type){case"color":this.colorVariables.push(e);break;case"opacity":this.opacityVariables.push(e);break;case"rotation":this.rotationVariables.push(e);break;case"size":this.sizeVariables.push(e)}this.sizeVariables.length&&this.sizeVariables.some((t=>!!t.target))&&t.sort(((t,e)=>{let i=null;return i=t.target===e.target?0:t.target?1:-1,i}));for(let e=0;e<t.length;e++)t[e].index=e;this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,e,i){const{rotationExpression:s,rotationType:r}=e,n=s&&s.match(gw),o=n&&n[1];if(o&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:r,field:o})),t)return t.map((t=>{const e=bw.read(t.type),s=ww[e];s||(vw.warn(`Unknown variable type: ${e}`),i&&i.messages&&i.messages.push(new Bt("visual-variable:unsupported",`visualVariable of type '${e}' is not supported`,{definition:t,context:i})));const r=new s;return r.read(t,i),r}))}writeVariables(t,e){const i=[];for(const s of t){const t=s.toJSON(e);t&&i.push(t)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};s([Ut()],Sw.prototype,"visualVariables",null),Sw=s([ve("esri.renderers.visualVariables.VisualVariableFactory")],Sw);var Mw=Sw;const xw={base:oh,key:"type",typeMap:{opacity:gh,color:fh,rotation:Mh,size:mw}},kw=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new Mw}set visualVariables(t){this._vvFactory.visualVariables=t,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(t,e,i){return this._vvFactory.readVariables(t,e,i)}writeVisualVariables(t,e,i,s){e[i]=this._vvFactory.writeVariables(t,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const t of this.visualVariables)if(t.arcadeRequired)return!0;return!1}hasVisualVariables(t,e){return t?!!this.getVisualVariablesForType(t,e):!!(this.getVisualVariablesForType("size",e)||this.getVisualVariablesForType("color",e)||this.getVisualVariablesForType("opacity",e)||this.getVisualVariablesForType("rotation",e))}getVisualVariablesForType(t,e){const i=this.visualVariables;if(!i)return;const s=i.filter((i=>i.type===t&&("string"==typeof e?i.target===e:!1!==e||!i.target)));return s&&0===s.length?void 0:s}async collectVVRequiredFields(t,e){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const s of i)s&&(s.field&&Yl(t,e,s.field),s.normalizationField&&Yl(t,e,s.normalizationField),s.valueExpression&&await Kl(t,e,s.valueExpression))}};return s([Ut({types:[xw],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),s([vn("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),s([be("visualVariables")],e.prototype,"writeVisualVariables",null),e=s([ve("esri.renderers.mixins.VisualVariablesMixin")],e),e};class Cw{constructor(t,e,i){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",i&&(this._storage.registerRemoveFunc(this._namespace,i),this._removeFunc=!0)}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}put(t,e,i,s=0){this._storage.put(this._namespace+t,e,i,s)}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,i){this._storage.updateSize(this._namespace+t,e,i)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class Iw{constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new nr}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs=this._removeFuncs.filter((e=>e[0]!==t))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,e,i,s){const r=this._db.get(t);if(r&&(this._size-=r.size,this._db.delete(t),r.entry!==e&&this._notifyRemoved(t,r.entry)),i>this._maxSize)return void this._notifyRemoved(t,e);if(void 0===e)return void console.warn("Refusing to cache undefined entry ");if(!i||i<0)return void console.warn("Refusing to cache entry with invalid size "+i);const n=1+Math.max(s,-3)- -3;this._db.set(t,{entry:e,size:i,lifetime:n,lives:n}),this._size+=i,this._checkSizeLimit()}updateSize(t,e,i){const s=this._db.get(t);s&&s.entry===e&&(this._size-=s.size,i>this._maxSize?this._notifyRemoved(t,e):(s.size=i,this._size+=i,this._checkSizeLimit()))}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},i=new Array;this._db.forEach(((t,s)=>{const r=t.lifetime;i[r]=(i[r]||0)+t.size,this._users.forAll((i=>{const r=i.namespace;s.startsWith(r)&&(e[r]=(e[r]||0)+t.size)}))}));const s={};this._users.forAll((t=>{const i=t.namespace;!isNaN(t.hitRate)&&t.hitRate>0?(e[i]=e[i]||0,s[i]=Math.round(100*t.hitRate)+"%"):s[i]="0%"}));const r=Object.keys(e);r.forEach((t=>e[t]=e[t]/this._size*100)),r.sort(((t,i)=>e[i]-e[t])),r.forEach((i=>t[i]=Math.round(e[i])+"% / "+s[i]));for(let e=i.length-1;e>=0;--e){const s=i[e];s&&(t["Priority "+(e+-3-1)]=Math.round(s/this.size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){this._db.forEach(((e,i)=>{i.startsWith(t)&&(this._size-=e.size,this._db.delete(i),this._notifyRemoved(i,e.entry))}))}clearAll(){this._db.forEach(((t,e)=>this._notifyRemoved(e,t.entry))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(t,e){this._removeFuncs.forEach((i=>{t.startsWith(i[0])&&i[1](e)}))}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db)if(this._db.delete(t),e.lives<=1?(this._size-=e.size,this._notifyRemoved(t,e.entry)):(--e.lives,this._db.set(t,e)),this._size<=.9*this.maxSize)return}}class Ow{constructor(t,e){this._storage=new Iw,this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e,i){this._storage.put(t,e,i,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}}var jw;const Pw=W.getLogger("esri.renderers.DictionaryRenderer");let Aw=jw=class extends(kw(Xu)){constructor(t){super(t),this._ongoingRequests=new Map,this._symbolCache=new Ow(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,s){null!=s&&s.origin||super.writeVisualVariables(t,e,i,s)}clone(){return new jw({config:w(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:w(this.fieldMap),url:w(this.url),visualVariables:w(this.visualVariables)})}async getSymbolAsync(t,e){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(e));try{i=await this._dictionaryPromise}catch(t){if(Ji(t))return this._dictionaryPromise=null,null}const s={};if(this.fieldMap)for(const e of this._symbolFields){const i=this.fieldMap[e];s[e]=i&&null!=t.attributes[i]?""+t.attributes[i]:""}const r=i(s,e);if(!r||"string"!=typeof r)return null;const n=B(r).toString(),o=this._symbolCache.get(n);if(o)return o.catch((()=>{this._symbolCache.pop(n)})),o;const l=r.split(";"),a=[],u=[];for(const t of l)if(t&&0!==t.length)if(-1===t.indexOf("po:"))if(-1!==t.indexOf("|"))for(const e of t.split("|"))this._itemNames.has(e)&&a.push(e);else this._itemNames.has(t)&&a.push(t);else{const e=t.substr(3).split("|");if(3===e.length){const t=e[0],i=e[1];let s=e[2];if("DashTemplate"===i)s=s.split(" ").map((t=>Number(t)));else if("Color"===i){const t=new Fa(s).toRgba();s=[t[0],t[1],t[2],255*t[3]]}else s=Number(s);u.push({primitiveName:t,propertyName:i,value:s})}}const h=this._cimPartsToCIMSymbol(a,u,e);return this._symbolCache.put(n,h,1),h}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await Kl(t,e,this.scaleExpression);const i=e.map((t=>t.name));for(const e in this.fieldMap)i.indexOf(this.fieldMap[e])<0||t.add(this.fieldMap[e])}get arcadeRequired(){return!0}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void Pw.error("no valid URL!");const e=M(t)?t.abortOptions:null,i=eu(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},...e}),[{data:s}]=await Ei([i,wl()]);if(!s)throw this._dictionaryPromise=null,new ge("esri.renderers.DictionaryRenderer","Bad dictionary data!");const r=s.expression,n=s.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+s.cimRefTemplateUrl,this._itemNames=new Set(s.itemsNames),this._symbolFields=n.symbol;const o={};if(this.config){const t=this.config;for(const e in t)o[e]=t[e]}for(const t of n.configuration)o.hasOwnProperty(t.name)||(o[t.name]=t.value);const l=[];if(M(t)&&t.fields&&this.fieldMap)for(const e of this._symbolFields){const i=this.fieldMap[e],s=t.fields.filter((t=>t.name===i));s.length>0&&l.push({...s[0],name:e})}return this._dictionaryPromise=((t,e,i,s)=>Sl.create(t,e,i,s,["$feature","$view"]))(r,M(t)?t.spatialReference:null,l,o).then((t=>{const e={scale:0};return(i,s)=>{const r=t.repurposeFeature({geometry:null,attributes:i});return e.scale=M(s)?s.scale:void 0,t.evaluate({$feature:r,$view:e})}})).catch((t=>(Pw.error("Creating dictinoary expression failed:",t),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(t,e){if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then((t=>t.data));const i=eu(this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,t),{responseType:"json",query:{f:"json"},...e});this._ongoingRequests.set(t,i);try{return(await i).data}catch(e){return this._ongoingRequests.delete(t),Zi(e)}}_combineSymbolParts(t,e){if(!t||0===t.length)return null;if(1===t.length)return{type:"CIMSymbolReference",symbol:t[0],primitiveOverrides:e};const i={...t[0]};i.symbolLayers=[];for(const e of t)i.symbolLayers.unshift(...e.symbolLayers);return{type:"CIMSymbolReference",symbol:i,primitiveOverrides:e}}async _cimPartsToCIMSymbol(t,e,i){const s=new Array(t.length);for(let e=0;e<t.length;e++)s[e]=this._getSymbolPart(t[e],i);const r=await Ei(s);return new Ha({data:this._combineSymbolParts(r,e)})}};s([Ut({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Aw.prototype,"config",void 0),s([Ut({type:Object,json:{write:!0}})],Aw.prototype,"fieldMap",void 0),s([Ut({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Aw.prototype,"scaleExpression",void 0),s([be("scaleExpression")],Aw.prototype,"writeData",null),s([Ut({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Aw.prototype,"scaleExpressionTitle",void 0),s([Ut({type:String,json:{write:!0}})],Aw.prototype,"url",void 0),s([be("visualVariables")],Aw.prototype,"writeVisualVariables",null),Aw=jw=s([ve("esri.renderers.DictionaryRenderer")],Aw);var Tw=Aw;const Nw=Object.freeze({__proto__:null,default:Tw}),Rw=(t,e,i)=>[e,i],_w=(t,e,i)=>[e,i,t[2]],Ew=(t,e,i)=>[e,i,t[2],t[3]];function Dw(t){return t?{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:[t.tolerance,t.tolerance],translate:[t.extent.xmin,t.extent.ymax]}:null}function $w({scale:t,translate:e},i){return i*t[0]+e[0]}function zw({scale:t,translate:e},i){return e[1]-i*t[1]}function Fw(t,e,i){const s=new Array(i.length);if(!i.length)return s;const[r,n]=t.scale;let o=$w(t,i[0][0]),l=zw(t,i[0][1]);s[0]=e(i[0],o,l);for(let t=1;t<i.length;t++){const a=i[t];o+=a[0]*r,l-=a[1]*n,s[t]=e(a,o,l)}return s}function Lw(t,e,i){const s=new Array(i.length);for(let r=0;r<i.length;r++)s[r]=Fw(t,e,i[r]);return s}function Uw(t,e,i,s,r){const n=t.referencesGeometry()&&r?function(t,e,i){const{transform:s,hasZ:r,hasM:n}=i;Vw.has(e)||Vw.set(e,function(t){const e={};switch(t){case"esriGeometryPoint":return(t,i,s,r)=>function(t,e,i,s,r){return e.x=$w(t,i.x),e.y=zw(t,i.y),e!==i&&(s&&(e.z=i.z),r&&(e.m=i.m)),e}(i,e,t,s,r);case"esriGeometryPolygon":return(t,i,s,r)=>function(t,e,i,s,r){return e.rings=function(t,e,i,s){return Lw(t,i?s?Ew:_w:s?_w:Rw,e)}(t,i.rings,s,r),e}(i,e,t,s,r);case"esriGeometryPolyline":return(t,i,s,r)=>function(t,e,i,s,r){return e.paths=function(t,e,i,s){return Lw(t,i?s?Ew:_w:s?_w:Rw,e)}(t,i.paths,s,r),e}(i,e,t,s,r);case"esriGeometryMultipoint":return(t,i,s,r)=>function(t,e,i,s,r){return e.points=function(t,e,i,s){return Fw(t,i?s?Ew:_w:s?_w:Rw,e)}(t,i.points,s,r),e}(i,e,t,s,r);default:return W.getLogger("esri.views.2d.support.arcadeOnDemand").error(new ge("mapview-arcade",`Unable to handle geometryType: ${t}`)),t=>t}}(e));const o=Vw.get(e)(t.geometry,s,r,n);return{...t,geometry:o}}(e,s,r):e,o=t.repurposeFeature(n);try{return t.evaluate({...i,$feature:o})}catch(t){return W.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",t),null}}const Vw=new Map;function Gw(t,e,i,s){return function(t){return"function"==typeof t}(t)?t(e,i,s):t}function qw(t){return[t.r,t.g,t.b,t.a]}function Bw(t,e,i){const s=t=>{let e=t.length;for(;e--;)if(-1===" /-,\n".indexOf(t.charAt(e)))return!1;return!0},r=[];let n=0,o=-1;do{if(o=e.indexOf("[",n),o>=n){if(o>n){const t=e.substr(n,o-n);r.push([t,null,s(t)])}if(n=o+1,o=e.indexOf("]",n),o>=n){if(o>n){const i=t[e.substr(n,o-n)];i&&r.push([null,i,!1])}n=o+1}}}while(-1!==o);if(n<e.length-1){const t=e.substr(n);r.push([t,null,s(t)])}return t=>{let e="",s=null;for(const i of r){const[r,n,o]=i;if(r)o?s=r:(s&&(e+=s,s=null),e+=r);else{const i=t.attributes[n];i&&(s&&(e+=s,s=null),e+=i)}}return Hw(e,i)}}function Hw(t,e){switch("string"!=typeof t&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function Jw(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}}function Ww(t,e,i,s){if("CIMTextSymbol"!==t.type){if(i&&t.effects)for(const i of t.effects)Xw(i,e);if(t.symbolLayers)for(const i of t.symbolLayers)switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":Yw(i,e,s);break;case"CIMPictureStroke":case"CIMSolidStroke":null!=s&&s.preserveOutlineWidth||(i.width*=e);break;case"CIMPictureFill":i.height*=e,i.offsetX*=e,i.offsetY*=e;break;case"CIMHatchFill":Ww(i.lineSymbol,e,!0,{...s,preserveOutlineWidth:!1}),i.offsetX*=e,i.offsetY*=e,i.separation*=e}}else t.height*=e}function Yw(t,e,i){if(t.markerPlacement&&function(t,e){switch(function(t){return"CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type}(t)&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset*=e,t.offsetAlongLine*=e,t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset*=e,t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset*=e;break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine*=e;break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition*=e,t.endPosition*=e;break;case"CIMMarkerPlacementPolygonCenter":t.offsetX*=e,t.offsetY*=e;break;case"CIMMarkerPlacementInsidePolygon":t.offsetX*=e,t.offsetY*=e,t.stepX*=e,t.stepY*=e}}(t.markerPlacement,e),t.offsetX*=e,t.offsetY*=e,t.anchorPoint&&"Absolute"===t.anchorPointUnits&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size*=e,"CIMVectorMarker"===t.type&&t.markerGraphics)for(const s of t.markerGraphics)t.scaleSymbolsProportionally||Ww(s.symbol,e,!0,i)}function Xw(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width*=e;break;case"CIMGeometricEffectBuffer":t.size*=e;break;case"CIMGeometricEffectCut":t.beginCut*=e,t.endCut*=e,t.middleCut*=e;break;case"CIMGeometricEffectDashes":if(t.customEndingOffset*=e,t.offsetAlongLine*=e,t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map((t=>t*e));t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length*=e;break;case"CIMGeometricEffectMove":t.offsetX*=e,t.offsetY*=e;break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset*=e;break;case"CIMGeometricEffectRegularPolygon":t.radius*=e;break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth*=e,t.length*=e,t.toWidth*=e;break;case"CIMGeometricEffectWave":t.amplitude*=e,t.period*=e}}class Qw{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)&&(this.rz=Math.atan2(this.rz_s,this.rz_c)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rz_c=1,this.rz_s=0}setTranslate(t,e){this.tx=t,this.ty=e}setTranslateZ(t){this.tz=t}setRotateCS(t,e){this.rz=void 0,this.rz_c=t,this.rz_s=e}setRotate(t){this.rz=t,this.rz_c=void 0,this.rz_s=void 0}setRotateY(t){this.ry=t}setScale(t){this.s=t}setMeasure(t){this.m=t}}function Kw(t=rb){return[t[0],t[1],t[2],t[3]]}function Zw(t,e,i,s,r=Kw()){return r[0]=t,r[1]=e,r[2]=i,r[3]=s,r}function tb(t,e=Kw()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function eb(t,e){return new bo({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function ib(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}const sb=[1/0,1/0,-1/0,-1/0],rb=[0,0,0,0];class nb{constructor(t){this._geometry=t}next(){const t=this._geometry;return this._geometry=null,t}}function ob(t){const e=w(t);return function(t){t&&(cl(t)?hb(t.rings):hl(t)?hb(t.paths):al(t)&&ub(t.points))}(e),e}function lb(t){if(t)for(let e=t.length-1;e>0;--e)t[e][0]-=t[e-1][0],t[e][1]-=t[e-1][1]}function ab(t){if(t)for(const e of t)lb(e)}function ub(t){if(t){const e=t.length;for(let i=1;i<e;++i)t[i][0]+=t[i-1][0],t[i][1]+=t[i-1][1]}}function hb(t){if(t)for(const e of t)ub(e)}function cb(t){t&&(cl(t)?ab(t.rings):hl(t)?ab(t.paths):al(t)&&lb(t.points))}function fb(t){if(t)for(const e of t)db(e)}function db(t){t&&t.reverse()}function pb(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i]}function yb(t){return t[4]}function mb(t,e){t[4]=e}class vb{constructor(t,e,i,s){this.acceptPolygon=e,this.acceptPolyline=i,this.geomUnitsPerPoint=s,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1,t&&(cl(t)?e&&(this.multiPath=t.rings,this.isClosed=!0):hl(t)?i&&(this.multiPath=t.paths,this.isClosed=!1):ll(t)&&e&&(this.multiPath=bb(t).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length)),this.internalPlacement=new Qw}next(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const t=this.processPath(this.multiPath[this.pathIndex]);if(t)return t}return this.pathCount=-1,this.pathIndex=-1,this.multiPath=null,null}}class wb{constructor(t,e,i,s){this.inputGeometries=t,this.acceptPolygon=e,this.acceptPolyline=i,this.geomUnitsPerPoint=s,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1}next(){for(;;){if(!this.multiPath){let t=this.inputGeometries.next();for(;t;){if(cl(t)?this.acceptPolygon&&(this.multiPath=t.rings,this.isClosed=!0):hl(t)?this.acceptPolyline&&(this.multiPath=t.paths,this.isClosed=!1):ll(t)&&this.acceptPolygon&&(this.multiPath=bb(t).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length,this.pathIndex=-1;break}t=this.inputGeometries.next()}if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const t=this.processPath(this.multiPath[this.pathIndex]);if(t)return t}this.pathCount=-1,this.pathIndex=-1,this.multiPath=null}}}function bb(t){return{rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}}class gb{static local(){return null===gb.instance&&(gb.instance=new gb),gb.instance}execute(t,e,i){return new Sb(t,e,i)}}gb.instance=null;class Sb{constructor(t,e,i){this._inputGeometries=t,this._angleTolerance=void 0!==e.angleTolerance?e.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let t=this._inputGeometries.next();for(;t;){if(cl(t)){this._isClosed=!0;const e=w(t);return this._processMultipath(e.rings),e}if(hl(t)){this._isClosed=!1;const e=w(t);return this._processMultipath(e.paths),e}if(ll(t)){if(this._maxCosAngle)return t;this._isClosed=!0;const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];return this._processPath(e),{rings:[e]}}t=this._inputGeometries.next()}return null}_processMultipath(t){if(t)for(const e of t)this._processPath(e)}_processPath(t){if(t){let e,i,s,r,n,o,l=t.length,a=t[0];this._isClosed&&++l;for(let u=1;u<l;++u){let h;h=this._isClosed&&u===l-1?t[0]:t[u];const c=h[0]-a[0],f=h[1]-a[1],d=Math.sqrt(c*c+f*f);u>1&&d>0&&s>0&&(e*c+i*f)/d/s<=this._maxCosAngle&&mb(a,1),1===u&&(r=c,n=f,o=d),d>0&&(a=h,e=c,i=f,s=d)}this._isClosed&&s>0&&o>0&&(e*r+i*n)/o/s<=this._maxCosAngle&&mb(t[0],1)}}}class Mb{constructor(){this._path=[]}path(){return this._path}addPath(t,e){e||t.reverse(),Array.prototype.push.apply(this._path,t),e||t.reverse()}static mergePath(t,e){e&&Array.prototype.push.apply(t,e)}startPath(t){this._path.push(t)}lineTo(t){this._path.push(t)}close(){const t=this._path;t.length>1&&(t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]||t.push([t[0][0],t[0][1]]))}}class xb{constructor(t=0,e=!1){}normalize(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);t[0]/=e,t[1]/=e}calculateLength(t,e){const i=e[0]-t[0],s=e[1]-t[1];return Math.sqrt(i*i+s*s)}calculateSegLength(t,e){return this.calculateLength(t[e],t[e+1])}calculatePathLength(t){let e=0;const i=t?t.length:0;for(let s=0;s<i-1;++s)e+=this.calculateSegLength(t,s);return e}calculatePathArea(t){let e=0;const i=t?t.length:0;for(let s=0;s<i-1;++s)e+=(t[s+1][0]-t[s][0])*(t[s+1][1]+t[s][1]);return e/2}getCoord2D(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i]}getSegCoord2D(t,e,i){return this.getCoord2D(t[e],t[e+1],i)}getAngle(t,e,i){return Math.atan2(e[1]-t[1],e[0]-t[0])}getSegAngle(t,e,i){return this.getAngle(t[e],t[e+1],i)}getAngleCS(t,e,i){const s=e[0]-t[0],r=e[1]-t[1],n=Math.sqrt(s*s+r*r);return n>0?[s/n,r/n]:[1,0]}getSegAngleCS(t,e,i){return this.getAngleCS(t[e],t[e+1],i)}cut(t,e,i,s){return[i<=0?t[e]:this.getSegCoord2D(t,e,i),s>=1?t[e+1]:this.getSegCoord2D(t,e,s)]}addSegment(t,e,i){i&&t.push(e[0]),t.push(e[1])}getSubCurve(t,e,i){const s=[];return this.appendSubCurve(s,t,e,i)?s:null}appendSubCurve(t,e,i,s){const r=e?e.length-1:0;let n=0,o=!0,l=0;for(;l<r;){const r=this.calculateSegLength(e,l);if(0!==r){if(o){if(n+r>i){let a=1,u=!1;n+r>=s&&(a=(s-n)/r,u=!0);const h=this.cut(e,l,(i-n)/r,a);if(h&&this.addSegment(t,h,o),u)break;o=!1}}else{if(n+r>s){const i=this.cut(e,l,0,(s-n)/r);i&&this.addSegment(t,i,o);break}this.addSegment(t,[e[l],e[l+1]],o)}n+=r,++l}else++l}return!0}getCIMPointAlong(t,e){const i=t?t.length-1:0;let s=0,r=-1;for(;r<i;){++r;const i=this.calculateSegLength(t,r);if(0!==i){if(s+i>e)return this.getCoord2D(t[r],t[r+1],(e-s)/i);s+=i}}return null}isEmpty(t,e){if(!t||t.length<=1)return!0;const i=t?t.length-1:0;let s=-1;for(;s<i;){if(++s,t[s+1][0]!==t[s][0]||t[s+1][1]!==t[s][1])return!1;if(e&&t[s+1][2]!==t[s][2])return!1}return!0}offset(t,e,i,s,r){if(!t||t.length<2)return null;let n=t.length;const o=t[0][0]===t[n-1][0]&&t[0][1]===t[n-1][1];if(o){if(t.length<3)return null;--n}const l=[];let a=o?t[n-1]:null,u=t[0];for(let r=0;r<n;r++){const h=r===n-1?o?t[0]:null:t[r+1];if(a)if(h){const t=[h[0]-u[0],h[1]-u[1]];this.normalize(t);const r=[u[0]-a[0],u[1]-a[1]];this.normalize(r);const n=r[0]*t[1]-r[1]*t[0],o=r[0]*t[0]+r[1]*t[1];if(n>=0==e<=0){const i=[t[0]-r[0],t[1]-r[1]];this.normalize(i);const s=Math.sqrt((1+o)/2),n=-Math.abs(e)/s;l.push([u[0]-i[0]*n,u[1]-i[1]*n])}else switch(i){case"Mitered":{const i=Math.sqrt((1+o)/2);if(i>0&&1/i<s){const s=[t[0]-r[0],t[1]-r[1]];this.normalize(s);const n=Math.abs(e)/i;l.push([u[0]-s[0]*n,u[1]-s[1]*n]);break}}case"Bevelled":l.push([u[0]+r[1]*e,u[1]-r[0]*e]),l.push([u[0]+t[1]*e,u[1]-t[0]*e]);break;case"Rounded":{l.push([u[0]+r[1]*e,u[1]-r[0]*e]);const i=5,s=1/i;let n=s;for(let o=1;o<i;o++,n+=s){const i=[r[1]*(1-n)+t[1]*n,-r[0]*(1-n)-t[0]*n];this.normalize(i),l.push([u[0]+i[0]*e,u[1]+i[1]*e])}l.push([u[0]+t[1]*e,u[1]-t[0]*e]);break}case"Square":default:if(n<0)l.push([u[0]+(r[1]+r[0])*e,u[1]+(r[1]-r[0])*e]),l.push([u[0]+(t[1]-t[0])*e,u[1]-(t[0]+t[1])*e]);else{const i=Math.sqrt((1+Math.abs(o))/2),s=[t[0]-r[0],t[1]-r[1]];this.normalize(s);const n=e/i;l.push([u[0]-s[0]*n,u[1]-s[1]*n])}}}else{const t=[u[0]-a[0],u[1]-a[1]];this.normalize(t),l.push([u[0]+t[1]*e,u[1]-t[0]*e])}else{const t=[h[0]-u[0],h[1]-u[1]];this.normalize(t),l.push([u[0]+t[1]*e,u[1]-t[0]*e])}a=u,u=h}return o&&l.push([l[0][0],l[0][1]]),l}}const kb=1.7320508075688772;class Cb{static local(){return null===Cb.instance&&(Cb.instance=new Cb),Cb.instance}execute(t,e,i){return new Ib(t,e,i)}}Cb.instance=null;class Ib extends wb{constructor(t,e,i){super(t,!1,!0),this._curveHelper=new xb,this._width=(void 0!==e.width?e.width:5)*i,this._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:"OpenEnded",this._offsetFlattenError=.03*i}processPath(t){switch(this._arrowType){case"OpenEnded":default:return this._constructSimpleArrow(t,!0);case"Block":return this._constructSimpleArrow(t,!1);case"Crossed":return this._constructCrossedArrow(t)}}_constructSimpleArrow(t,e){const i=this._curveHelper.calculatePathLength(t);let s=this._width;i<2*s&&(s=i/2);const r=this._curveHelper.getSubCurve(t,0,i-s);if(!r)return null;const n=s/2;if(this._curveHelper.isEmpty(r,!1))return null;const o=this._constructOffset(r,-n);if(!o)return null;const l=this._constructOffset(r,n);if(!l)return null;const a=this._constructArrowBasePoint(o,-n/2);if(!a)return null;const u=this._constructArrowBasePoint(l,n/2);if(!u)return null;const h=t[t.length-1];e||(this._makeControlPoint(l,!0),this._makeControlPoint(o,!0));const c=new Mb;return c.addPath(l,!0),c.lineTo(u),this._makeControlPoint(c.path()),c.lineTo(h),this._makeControlPoint(c.path()),c.lineTo(a),this._makeControlPoint(c.path()),c.addPath(o,!1),e?{paths:[c.path()]}:(c.close(),{rings:[c.path()]})}_constructCrossedArrow(t){const e=this._curveHelper.calculatePathLength(t);let i=this._width;e<i*(1+kb+1)&&(i=e/(1+kb+1));const s=this._curveHelper.getSubCurve(t,0,e-i*(1+kb));if(!s)return null;const r=i/2;if(this._curveHelper.isEmpty(s,!1))return null;const n=this._constructOffset(s,r);if(!n)return null;const o=this._constructOffset(s,-r);if(!o)return null;const l=this._curveHelper.getSubCurve(t,0,e-i);if(!l)return null;if(this._curveHelper.isEmpty(l,!1))return null;const a=this._constructOffset(l,r);if(!a)return null;const u=this._constructOffset(l,-r);if(!u)return null;const h=a[a.length-1],c=this._constructArrowBasePoint(a,r/2);if(!c)return null;const f=u[u.length-1],d=this._constructArrowBasePoint(u,-r/2);if(!d)return null;const p=t[t.length-1];this._makeControlPoint(n,!1),this._makeControlPoint(o,!1);const y=new Mb;return y.addPath(n,!0),this._makeControlPoint(y.path()),y.lineTo(f),y.lineTo(d),this._makeControlPoint(y.path()),y.lineTo(p),this._makeControlPoint(y.path()),y.lineTo(c),this._makeControlPoint(y.path()),y.lineTo(h),this._makeControlPoint(y.path()),y.addPath(o,!1),{paths:[y.path()]}}_constructOffset(t,e){return this._curveHelper.offset(t,e,"Rounded",4,this._offsetFlattenError)}_constructArrowBasePoint(t,e){if(!t||t.length<2)return null;const i=t[t.length-2],s=t[t.length-1],r=[s[0]-i[0],s[1]-i[1]];return this._curveHelper.normalize(r),[s[0]+r[1]*e,s[1]-r[0]*e]}_makeControlPoint(t,e=!1){mb(e?t[0]:t[t.length-1],1)}}class Ob{static local(){return null===Ob.instance&&(Ob.instance=new Ob),Ob.instance}execute(t,e,i){return new jb(t,e,i)}}Ob.instance=null;class jb{constructor(t,e,i){this._inputGeometries=t,this._curveHelper=new xb,this._size=(void 0!==e.size?e.size:1)*i,this._offsetFlattenError=.03*i}next(){let t=this._inputGeometries.next();for(;t;){if(ll(t))if(this._size>0){const e=this._curveHelper.offset([[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]],this._size,"Rounded",4,this._offsetFlattenError);if(e)return{rings:[e]}}else{if(!(this._size<0))return t;if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._size>0)return{xmin:t.xmin-this._size,xmax:t.xmax+this._size,ymin:t.ymin-this._size,ymax:t.ymax+this._size}}if(cl(t)){if(0===this._size)return t;const e=[];for(const i of t.rings){const t=this._curveHelper.offset(i,this._size,"Rounded",4,this._offsetFlattenError);t&&e.push(t)}if(e.length)return{rings:e}}if(hl(t)&&this._size>0){const e=[];for(const i of t.paths)if(i&&i.length>1){const t=this._curveHelper.offset(i,this._size,"Rounded",4,this._offsetFlattenError),s=this._curveHelper.offset(i,-this._size,"Rounded",4,this._offsetFlattenError);if(t&&s){for(let e=s.length-1;e>=0;e--)t.push(s[e]);t.push([t[0][0],t[0][1]]),e.push(t)}}if(e.length)return{rings:e}}t=this._inputGeometries.next()}return null}}class Pb{static local(){return null===Pb.instance&&(Pb.instance=new Pb),Pb.instance}execute(t,e,i){return new Ab(t,e,i)}}Pb.instance=null;class Ab extends wb{constructor(t,e,i){super(t,!0,!0),this._curveHelper=new xb,this._beginCut=(void 0!==e.beginCut?e.beginCut:1)*i,this._endCut=(void 0!==e.endCut?e.endCut:1)*i,this._middleCut=(void 0!==e.middleCut?e.middleCut:0)*i,this._invert=void 0!==e.invert&&e.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(t){const e=this._beginCut,i=this._endCut,s=this._middleCut,r=this._curveHelper.calculatePathLength(t),n=[];if(this._invert)if(0===e&&0===i&&0===s);else if(e+i+s>=r)n.push(t);else{let o=this._curveHelper.getSubCurve(t,0,e);o&&n.push(o),o=this._curveHelper.getSubCurve(t,.5*(r-s),.5*(r+s)),o&&n.push(o),o=this._curveHelper.getSubCurve(t,r-i,i),o&&n.push(o)}else if(0===e&&0===i&&0===s)n.push(t);else if(e+i+s>=r);else if(0===s){const s=this._curveHelper.getSubCurve(t,e,r-i);s&&n.push(s)}else{let o=this._curveHelper.getSubCurve(t,e,.5*(r-s));o&&n.push(o),o=this._curveHelper.getSubCurve(t,.5*(r+s),r-i),o&&n.push(o)}return 0===n.length?null:{paths:n}}}class Tb{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(t,e,i=!0){if(this._setEmpty(),!t||0===t.length)return!1;for(let e=0;e<t.length;e++){let s=Math.abs(t[e]);i&&s<1e-7&&(s=1e-7),this._values.push(s),this._length+=s}return e&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(t){const e=this._values?this._values.length:0;for(let i=0;i<e;++i)this._values[i]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t}addValue(t){this._length+=t,this._values.push(t)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class Nb{constructor(){this.reset()}reset(){this.segment=-1,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return-1!==this.segment}copyTo(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd}}class Rb extends xb{constructor(t=0,e=!1){super(t,e),this._tolerance=.03,this._currentPosition=new Nb}updateTolerance(t){this._tolerance=.03*t}init(t,e,i=!0){return i?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._path=t,this._seg=-1,this.setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(t,e=0){const i=new Nb;return!!this._nextPosition(t,i,null,e)&&(i.copyTo(this._currentPosition),!0)}curPointAndAngle(t){t.pt=this._getPoint(this._currentPosition);const[e,i]=this._getAngle(this._currentPosition);t.ca=e,t.sa=i}nextPointAndAngle(t,e,i=0){const s=new Nb;if(!this._nextPosition(t,s,null,i))return!1;s.copyTo(this._currentPosition),e.pt=this._getPoint(s);const[r,n]=this._getAngle(s);return e.ca=r,e.sa=n,!0}nextCurve(t){if(0===t)return null;const e=[],i=new Nb;return this._nextPosition(t,i,e,1)?(i.copyTo(this._currentPosition),e):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){if(-1===this._currentPosition.segment)throw new Error("missing segment");return this._path[this._currentPosition.segment+1]}_nextPosition(t,e,i,s){if(this._currentPosition.isPathEnd)return!1;let r=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(r/=this._currentPosition.segmentLength),this._currentPosition.copyTo(e);e.abscissa+t*this._partLengthRatio>e.segmentLength+this._tolerance;){if(i){if(0===i.length)if(0===r){const t=this._path[e.segment];i.push([t[0],t[1]])}else i.push(this.getSegCoord2D(this._path,e.segment,r));const t=this._path[e.segment+1];i.push([t[0],t[1]])}if(r=0,t-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this.nextSegment(),e.segmentLength=this.calculateSegLength(this._path,e.segment),e.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart())return 0!==s&&(e.segmentLength=this.calculateSegLength(this._path,e.segment),e.isPartEnd=!0,1===s?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+t,!0);this._currentPosition.copyTo(e)}}if(e.abscissa+=t*this._partLengthRatio,i){if(0===i.length)if(0===r){const t=this._path[e.segment];i.push([t[0],t[1]])}else i.push(this.getSegCoord2D(this._path,e.segment,r));const t=e.abscissa/e.segmentLength;if(1===t){const t=this._path[e.segment+1];i.push([t[0],t[1]])}else i.push(this.getSegCoord2D(this._path,e.segment,t))}return this._partSegCount||Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0),!0}_getPoint(t){if(-1===t.segment)throw new Error("missing segment");return this.getSegCoord2D(this._path,t.segment,t.segmentLength<=0?0:t.abscissa/t.segmentLength)}_getAngle(t){if(-1===t.segment)throw new Error("missing segment");return this.getSegAngleCS(this._path,t.segment,t.segmentLength<=0?0:t.abscissa/t.segmentLength)}setPosAtNextPart(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===yb(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}let t=this._partSegCount;for(;t;)this.previousSegment(),--t;this._currentPosition.segment=this.nextSegment(),this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const e=this.getStartPointIndex();this._ctrlPtBegin=1===yb(this._path[e]);let i=e+this._partSegCount+1;if(i>=this._path.length&&(i=0),this._ctrlPtEnd=1===yb(this._path[i]),this._patternLength>0){const t=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,e=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let i=Math.round((this._partLength-(t+e))/this._patternLength);i<=0&&(i=t+e>0?0:1),this._partLengthRatio=this._partLength/(t+e+i*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}hasNextSegment(){return this._seg<this._path.length-2}previousSegment(){return--this._seg}nextSegment(){return++this._seg}getStartPointIndex(){return this._seg}getEndPointIndex(){return this._seg+1}}class _b{static local(){return null===_b.instance&&(_b.instance=new _b),_b.instance}execute(t,e,i){return new Eb(t,e,i)}}_b.instance=null;class Eb extends wb{constructor(t,e,i){super(t,!0,!0),this._walker=new Rb,this._walker.updateTolerance(i),this._endings=e.lineDashEnding,this._customDashPos=void 0!==e.offsetAlongLine?e.offsetAlongLine*i:0,this._offsetAtEnd=void 0!==e.customEndingOffset?e.customEndingOffset*i:0,this._pattern=new Tb,this._pattern.init(e.dashTemplate,!0),this._pattern.scale(i)}processPath(t){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[t]};if(!this.iteratePath){let e=!0;switch(this._endings){case"HalfPattern":case"HalfGap":default:this._pattern.extPtGap=0;break;case"FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case"FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case"NoConstraint":this.isClosed||(e=!1);break;case"Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const i=this._walker.calculatePathLength(t);if(this._pattern.isEmpty()||i<.1*this._pattern.length())return{paths:[t]};if(!this._walker.init(t,this._pattern,e))return{paths:[t]}}let e;if(this.iteratePath)e=this._pattern.nextValue();else{let t;switch(this._endings){case"HalfPattern":default:t=.5*this._pattern.firstValue();break;case"HalfGap":t=.5*-this._pattern.lastValue();break;case"FullGap":t=-this._pattern.lastValue();break;case"FullPattern":t=0;break;case"NoConstraint":case"Custom":t=-this._customDashPos}let i=t/this._pattern.length();i-=Math.floor(i),t=i*this._pattern.length(),this._pattern.reset(),e=this._pattern.nextValue();let s=!1;for(;t>=e;)t-=e,e=this._pattern.nextValue(),s=!s;e-=t,s?(this._walker.nextPosition(e),e=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(e),e=this._pattern.nextValue(),this._walker.nextPosition(e),e=this._pattern.nextValue())}let i=this._walker.nextCurve(e);return i?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),Mb.mergePath(i,this._firstCurve),this._firstCurve=null)):(e=this._pattern.nextValue(),!this._walker.nextPosition(e)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(i=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,i=this._firstCurve,this._firstCurve=null),{paths:[i]}}}class Db{static local(){return null===Db.instance&&(Db.instance=new Db),Db.instance}execute(t,e,i){return new $b(t,e,i)}}Db.instance=null;class $b{constructor(t,e,i){switch(this._inputGeometries=t,this._curveHelper=new xb,this._width=(void 0!==e.width?e.width:2)*i,e.method){case"Mitered":default:this._method="Mitered";break;case"Bevelled":this._method="Bevelled";break;case"Rounded":case"TrueBuffer":this._method="Rounded";break;case"Square":this._method="Square"}this._option=e.option,this._offsetFlattenError=.03*i}next(){let t=this._inputGeometries.next();for(;t;){if(ll(t)&&this._width>0){if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)-2*this._width<0)return t;const e=[];return e.push([[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]),e.push([[t.xmin+this._width,t.ymin+this._width],[t.xmax-this._width,t.ymin+this._width],[t.xmax-this._width,t.ymax-this._width],[t.xmin+this._width,t.ymax-this._width],[t.xmin+this._width,t.ymin+this._width]]),{rings:e}}if(cl(t)&&this._width>0){const e=[];for(const i of t.rings){const t=this._curveHelper.calculatePathLength(i),s=this._curveHelper.offset(i,this._width,this._method,4,this._offsetFlattenError);s&&(t<0&&s.reverse(),e.push(s))}if(e.length)return{rings:e}}t=this._inputGeometries.next()}return null}}class zb{static local(){return null===zb.instance&&(zb.instance=new zb),zb.instance}execute(t,e,i){return new Fb(t,e,i)}}zb.instance=null;class Fb extends wb{constructor(t,e,i){super(t,!1,!0),this._curveHelper=new xb,this._length=(void 0!==e.length?e.length:20)*i,this._angle=void 0!==e.angle?e.angle:225,this._position=void 0!==e.position?e.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(t){if(this._curveHelper.isEmpty(t,!1))return null;const e=t[0],i=t[t.length-1];this._curveHelper.normalize([i[0]-e[0],i[1]-e[1]]);const s=[e[0]+(i[0]-e[0])*this._position/100,e[1]+(i[1]-e[1])*this._position/100],r=Math.cos((90-this._angle)/180*Math.PI);let n=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(n=-n),this._mirror=!this._mirror,{paths:[[e,[s[0]-this._length/2*r,s[1]-this._length/2*n],[s[0]+this._length/2*r,s[1]+this._length/2*n],i]]}}}class Lb{static local(){return null===Lb.instance&&(Lb.instance=new Lb),Lb.instance}execute(t,e,i){return new Ub(t,e,i)}}Lb.instance=null;class Ub{constructor(t,e,i){this._inputGeometries=t,this._offsetX=void 0!==e.offsetX?e.offsetX*i:0,this._offsetY=void 0!==e.offsetY?-e.offsetY*i:0}next(){let t=this._inputGeometries.next();for(;t;){if(ll(t))return{xmin:t.xmin+this._offsetX,xmax:t.xmax+this._offsetX,ymin:t.ymin+this._offsetY,ymax:t.ymax+this._offsetY};if(cl(t)){const e=w(t);return this._moveMultipath(e.rings,this._offsetX,this._offsetY),e}if(hl(t)){const e=w(t);return this._moveMultipath(e.paths,this._offsetX,this._offsetY),e}if(al(t)){const e=w(t);return this._movePath(e.points,this._offsetX,this._offsetY),e}if(ul(t))return{x:t.x+this._offsetX,y:t.y+this._offsetY};t=this._inputGeometries.next()}return null}_moveMultipath(t,e,i){if(t)for(const s of t)this._movePath(s,e,i)}_movePath(t,e,i){if(t)for(const s of t)s[0]+=e,s[1]+=i}}class Vb{static local(){return null===Vb.instance&&(Vb.instance=new Vb),Vb.instance}execute(t,e,i){return new Gb(t,e,i)}}Vb.instance=null;class Gb{constructor(t,e,i){this._inputGeometries=t,this._curveHelper=new xb,this._offset=(void 0!==e.offset?e.offset:1)*i,this._method=e.method,this._option=e.option,this._offsetFlattenError=.03*i}next(){let t=this._inputGeometries.next();for(;t;){if(0===this._offset)return t;if(ll(t)){if("Rounded"===this._method&&this._offset>0){const e=this._curveHelper.offset([[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]],this._offset,this._method,4,this._offsetFlattenError);return e?{rings:[e]}:null}if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._offset>0)return{xmin:t.xmin-this._offset,xmax:t.xmax+this._offset,ymin:t.ymin-this._offset,ymax:t.ymax+this._offset}}if(cl(t)){const e=[];for(const i of t.rings){const t=this._curveHelper.offset(i,this._offset,this._method,4,this._offsetFlattenError);t&&e.push(t)}if(e.length)return{rings:e}}if(hl(t)){const e=[];for(const i of t.paths){const t=this._curveHelper.offset(i,this._offset,this._method,4,this._offsetFlattenError);t&&e.push(t)}if(e.length)return{paths:e}}t=this._inputGeometries.next()}return null}}class qb{static local(){return null===qb.instance&&(qb.instance=new qb),qb.instance}execute(t,e,i){return new Bb(t,e,i)}}qb.instance=null;class Bb{constructor(t,e,i){this._inputGeometries=t,this._reverse=void 0===e.reverse||e.reverse}next(){let t=this._inputGeometries.next();for(;t;){if(!this._reverse)return t;if(hl(t)){const e=w(t);return fb(e.paths),e}t=this._inputGeometries.next()}return null}}class Hb{static local(){return null===Hb.instance&&(Hb.instance=new Hb),Hb.instance}execute(t,e,i){return new Jb(t,e,i)}}Hb.instance=null;class Jb{constructor(t,e,i){this._inputGeometries=t,this._rotateAngle=void 0!==e.angle?-e.angle*Math.PI/180:0}next(){let t=this._inputGeometries.next();for(;t;){if(0===this._rotateAngle)return t;const e=Kw();Do(e,t);const i=(e[2]+e[0])/2,s=(e[3]+e[1])/2;if(ll(t)){const e={rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]};return this._rotateMultipath(e.rings,i,s),e}if(cl(t)){const e=w(t);return this._rotateMultipath(e.rings,i,s),e}if(hl(t)){const e=w(t);return this._rotateMultipath(e.paths,i,s),e}if(al(t)){const e=w(t);return this._rotatePath(e.points,i,s),e}if(ul(t))return t;t=this._inputGeometries.next()}return null}_rotateMultipath(t,e,i){if(t)for(const s of t)this._rotatePath(s,e,i)}_rotatePath(t,e,i){if(t){const s=Math.cos(this._rotateAngle),r=Math.sin(this._rotateAngle);for(const n of t){const t=n[0]-e,o=n[1]-i;n[0]=e+t*s-o*r,n[1]=i+t*r+o*s}}}}class Wb{static local(){return null===Wb.instance&&(Wb.instance=new Wb),Wb.instance}execute(t,e,i){return new Yb(t,e,i)}}Wb.instance=null;class Yb{constructor(t,e,i){this._inputGeometries=t,this._xFactor=void 0!==e.xScaleFactor?e.xScaleFactor:1.15,this._yFactor=void 0!==e.yScaleFactor?e.yScaleFactor:1.15}next(){let t=this._inputGeometries.next();for(;t;){if(1===this._xFactor&&1===this._yFactor)return t;const e=Kw();Do(e,t);const i=(e[2]+e[0])/2,s=(e[3]+e[1])/2;if(ll(t)){const e={rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]};return this._scaleMultipath(e.rings,i,s),e}if(cl(t)){const e=w(t);return this._scaleMultipath(e.rings,i,s),e}if(hl(t)){const e=w(t);return this._scaleMultipath(e.paths,i,s),e}if(al(t)){const e=w(t);return this._scalePath(e.points,i,s),e}if(ul(t))return t;t=this._inputGeometries.next()}return null}_scaleMultipath(t,e,i){if(t)for(const s of t)this._scalePath(s,e,i)}_scalePath(t,e,i){if(t)for(const s of t){const t=(s[1]-i)*this._yFactor;s[0]=e+(s[0]-e)*this._xFactor,s[1]=i+t}}}class Xb{static local(){return null===Xb.instance&&(Xb.instance=new Xb),Xb.instance}execute(t,e,i){return new Qb(t,e,i)}}Xb.instance=null;class Qb{constructor(t,e,i){this._inputGeometries=t,this._height=(void 0!==e.amplitude?e.amplitude:2)*i,this._period=(void 0!==e.period?e.period:3)*i,this._style=e.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new Tb,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new Rb,this._walker.updateTolerance(i)}next(){let t=this._inputGeometries.next();for(;t;){if(0===this._height||0===this._period)return t;if(hl(t)){const e=this._processGeom(t.paths);if(e.length)return{paths:e}}if(cl(t)){const e=this._processGeom(t.rings);if(e.length)return{rings:e}}t=this._inputGeometries.next()}return null}_processGeom(t){const e=[];for(const i of t)if(this._walker.init(i,this._pattern))switch(this._style){case"Sinus":default:e.push(this._constructCurve(i,!1));break;case"Square":e.push(this._constructSquare(i));break;case"Triangle":e.push(this._constructTriangle(i));break;case"Random":e.push(this._constructCurve(i,!0))}else e.push(i);return e}_constructCurve(t,e){const i=new Mb,s=this._walker.calculatePathLength(t);let r=Math.round(s/this._period);0===r&&(r=1);const n=this._period/16,o=1/(16*r+1),l=2*Math.PI*s/(s/r),a=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),h=2*Math.PI*Math.random(),c=.75-Math.random()/2,f=.75-Math.random()/2,d={};this._walker.curPointAndAngle(d),i.startPath(d.pt);let p=0;for(;;){if(!this._walker.nextPointAndAngle(n,d)){i.lineTo(t[t.length-1]);break}{const t=p;let s;if(p+=o,e){const e=this._height/2*(1+.3*Math.sin(c*l*t+a));s=e*Math.sin(l*t+u),s+=e*Math.sin(f*l*t+h),s/=2}else s=.5*this._height*Math.sin(.5*l*t);i.lineTo([d.pt[0]-s*d.sa,d.pt[1]+s*d.ca])}}return i.path()}_constructSquare(t){const e=new Mb;this._walker.calculatePathLength(t);let i=!0;for(;;){let t=!1;if(this._walker.curPositionIsValid()){const s={};this._walker.curPointAndAngle(s);const r={};if(this._walker.nextPointAndAngle(this._period,r)){const n={};this._walker.nextPointAndAngle(this._period,n)&&(i?(e.startPath(s.pt),i=!1):e.lineTo(s.pt),e.lineTo([s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca]),e.lineTo([r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca]),e.lineTo([r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca]),e.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca]),t=!0)}}if(!t){e.lineTo(this._walker.getPathEnd());break}}return e.path()}_constructTriangle(t){const e=new Mb;this._walker.calculatePathLength(t);let i=!0;for(;;){let t=!1;if(this._walker.curPositionIsValid()){const s={};this._walker.curPointAndAngle(s);const r={};if(this._walker.nextPointAndAngle(this._period/2,r)){const n={};this._walker.nextPointAndAngle(this._period,n)&&(this._walker.nextPosition(this._period/2)&&(i?(e.startPath(s.pt),i=!1):e.lineTo(s.pt),e.lineTo([r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca]),e.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca])),t=!0)}}if(!t){e.lineTo(this._walker.getPathEnd());break}}return e.path()}}var Kb;!function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(Kb||(Kb={}));class Zb{static local(){return null===Zb.instance&&(Zb.instance=new Zb),Zb.instance}execute(t,e,i){return new tg(t,e,i)}}Zb.instance=null;class tg extends vb{constructor(t,e,i){super(t,!0,!0),this._grometryWalker=new Rb,this._grometryWalker.updateTolerance(i),this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._originalEndings=e.endings,this._offsetAtEnd=void 0!==e.customEndingOffset?e.customEndingOffset*i:0,this._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*i:0,this._pattern=new Tb,this._pattern.init(e.placementTemplate,!1),this._pattern.scale(i),this._endings=this._originalEndings}processPath(t){if(this._pattern.isEmpty())return null;let e;if(this.iteratePath)e=this._pattern.nextValue();else{this._endings=this._originalEndings===Kb.WithFullGap&&this.isClosed?Kb.WithMarkers:this._originalEndings,this._pattern.extPtGap=0;let i,s=!0;switch(this._endings){case Kb.NoConstraint:i=-this._position,i=this._adjustPosition(i),s=!1;break;case Kb.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case Kb.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case Kb.WithMarkers:i=0;break;case Kb.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(t,this._pattern,s))return null;this._pattern.reset();let r=0;for(;i>r;)i-=r,r=this._pattern.nextValue();r-=i,e=r,this.iteratePath=!0}const i={};return this._grometryWalker.nextPointAndAngle(e,i)?this._endings===Kb.WithFullGap&&this._grometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===Kb.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]+this._offset*i.sa,i.pt[1]-this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(t){let e=t/this._pattern.length();return e-=Math.floor(e),e*this._pattern.length()}}class eg{static local(){return null===eg.instance&&(eg.instance=new eg),eg.instance}execute(t,e,i){return new ig(t,e,i)}}eg.instance=null;class ig extends vb{constructor(t,e,i){super(t,!1,!0),this._curveHelper=new xb,this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._type=e.extremityPlacement,this._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*i:0,this._beginProcessed=!1}processPath(t){let e;switch(this._type){case"Both":default:this._beginProcessed?(e=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(e=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case"JustBegin":e=this._atExtremities(t,this._position,!0);break;case"JustEnd":e=this._atExtremities(t,this._position,!1);break;case"None":}return e}_atExtremities(t,e,i){const s=t.length;if(s<2)return null;const r=i?s:-1,n=i?1:-1;let o,l=0,a=i?t[0]:t[s-1];for(let i=i?1:s-2;i!==r;i+=n){o=a,a=t[i];const s=this._curveHelper.calculateLength(o,a);if(l+s>e){const t=(e-l)/s,[i,r]=this._curveHelper.getAngleCS(o,a,t),n=pb(o,a,t);return this.internalPlacement.setTranslate(n[0]-this._offset*r,n[1]+this._offset*i),this._angleToLine&&this.internalPlacement.setRotateCS(-i,-r),this.internalPlacement}l+=s}return null}}class sg{static local(){return null===sg.instance&&(sg.instance=new sg),sg.instance}execute(t,e,i){return new rg(t,e,i)}}sg.instance=null;class rg extends vb{constructor(t,e,i){super(t,!0,!0),this._walker=new Rb,this._walker.updateTolerance(i),this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._beginGap=void 0!==e.beginPosition?e.beginPosition*i:0,this._endGap=void 0!==e.endPosition?e.endPosition*i:0,this._flipFirst=void 0===e.flipFirst||e.flipFirst,this._pattern=new Tb,this._pattern.init(e.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(t){if(this._pattern.isEmpty())return null;let e;if(this.iteratePath){const t=this._pattern.nextValue()*this._subPathLen,i=this._beginGap+t;e=i-this._prevPos,this._prevPos=i}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=this._walker.calculatePathLength(t)-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();const i=this._pattern.nextValue()*this._subPathLen,s=this._beginGap+i;e=s-this._prevPos,this._prevPos=s,this.iteratePath=!0}const i={};if(!this._walker.nextPointAndAngle(e,i,1))return this.iteratePath=!1,null;let s,r;return this.internalPlacement.setTranslate(i.pt[0]+this._offset*i.sa,i.pt[1]-this._offset*i.ca),this._angleToLine?(s=i.ca,r=i.sa):(s=1,r=0),this._isFirst&&this._flipFirst&&(s=-s,r=-r),this.internalPlacement.setRotateCS(s,r),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}class ng{static local(){return null===ng.instance&&(ng.instance=new ng),ng.instance}execute(t,e,i){return new og(t,e,i)}}ng.instance=null;class og{constructor(t,e,i){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._stepX=(void 0!==e.stepX?Math.abs(e.stepX):16)*i,this._stepY=(void 0!==e.stepY?Math.abs(e.stepY):16)*i,0!==this._stepX&&0!==this._stepY&&t&&void 0!==t.rings&&t.rings){if(this._gridType=void 0!==e.gridType?e.gridType:"Fixed","Random"===this._gridType)this._randomness=void 0!==e.randomness?e.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0;else{if(this._randomness=0,this._gridAngle=void 0!==e.gridAngle?e.gridAngle:0,this._shiftOddRows=void 0!==e.shiftOddRows&&e.shiftOddRows,this._offsetX=void 0!==e.offsetX?e.offsetX*i:0,this._offsetY=void 0!==e.offsetY?e.offsetY*i:0,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginX=0,this._graphicOriginY=0,this._internalPlacement=new Qw,this._calculateMinMax(t),this._geometry=t}}next(){return this._geometry?this._nextInside():null}_calculateMinMax(t){let e,i,s,r,n,o,l,a;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,n=o=Number.MAX_VALUE,l=a=-Number.MAX_VALUE;for(const u of t.rings){const t=u?u.length:0;for(let h=0;h<t;++h)e=u[h][0]-this._graphicOriginX-this._offsetX,i=u[h][1]-this._graphicOriginY-this._offsetY,s=this._cosAngle*e-this._sinAngle*i,r=this._sinAngle*e+this._cosAngle*i,n=Math.min(n,s),l=Math.max(l,s),o=Math.min(o,r),a=Math.max(a,r)}n+=this._graphicOriginX,l+=this._graphicOriginX,o+=this._graphicOriginY,a+=this._graphicOriginY,this._xMin=Math.round(n/this._stepX),this._xMax=Math.round(l/this._stepX),this._yMin=Math.round(o/this._stepY),this._yMax=Math.round(a/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);const e=this._currentY*this._stepY+this._offsetY;let i,s;return this._currentX++,"Random"===this._gridType?(i=this._graphicOriginX+t+this._stepX*this._randomness*(.5-Math.random())*2/3,s=this._graphicOriginY+e+this._stepY*this._randomness*(.5-Math.random())*2/3):(i=this._graphicOriginX+this._cosAngle*t+this._sinAngle*e,s=this._graphicOriginY-this._sinAngle*t+this._cosAngle*e),this._internalPlacement.setTranslate(i,s),this._internalPlacement}}}class lg{static local(){return null===lg.instance&&(lg.instance=new lg),lg.instance}execute(t,e,i){return new ag(t,e,i)}}lg.instance=null;class ag extends vb{constructor(t,e,i){super(t,!0,!0),this._curveHelper=new xb,this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._relativeTo=e.relativeTo,this._position=void 0!==e.startPointOffset?e.startPointOffset*i:0,this._epsilon=.001*i}processPath(t){const e=this._position;if("SegmentMidpoint"===this._relativeTo){for(this.iteratePath||(this._segmentCount=t.length,this._curSegment=1,this.iteratePath=!0);this._curSegment<this._segmentCount;){const e=this._curSegment;this._curSegment++;const i=t[e-1],s=t[e],r=this._curveHelper.calculateLength(i,s);if(r<this._epsilon)continue;const n=.5+this._position/r,[o,l]=this._curveHelper.getAngleCS(i,s,n),a=pb(i,s,n);return this.internalPlacement.setTranslate(a[0]-this._offset*l,a[1]+this._offset*o),this._angleToLine&&this.internalPlacement.setRotateCS(o,l),this.internalPlacement}return this.iteratePath=!1,null}"LineEnd"===this._relativeTo&&db(t);const i=this.onLine(t,e);return"LineEnd"===this._relativeTo&&db(t),i}onLine(t,e){let i,s=!1;switch(this._relativeTo){case"LineMiddle":default:i=this._curveHelper.calculatePathLength(t)/2+e;break;case"LineBeginning":i=e;break;case"LineEnd":i=e,s=!0}const r=t.length;let n,o=0,l=t[0];for(let e=1;e<r;++e){n=l,l=t[e];const r=this._curveHelper.calculateLength(n,l);if(o+r>i){const t=(i-o)/r,[e,a]=this._curveHelper.getAngleCS(n,l,t),u=pb(n,l,t),h=s?this._offset:-this._offset;return this.internalPlacement.setTranslate(u[0]-h*a,u[1]+h*e),this._angleToLine&&(s?this.internalPlacement.setRotateCS(-e,-a):this.internalPlacement.setRotateCS(e,a)),this.internalPlacement}o+=r}return null}}class ug{static local(){return null===ug.instance&&(ug.instance=new ug),ug.instance}execute(t,e,i){return new hg(t,e,i)}}ug.instance=null;class hg extends vb{constructor(t,e,i){super(t,!0,!0),this._curveHelper=new xb,this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._endPoints=void 0===e.placeOnEndPoints||e.placeOnEndPoints,this._controlPoints=void 0===e.placeOnControlPoints||e.placeOnControlPoints,this._regularVertices=void 0===e.placeOnRegularVertices||e.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);let i=e[0],s=e[1];if(0!==this._offset){const t=Math.cos(e[2]),r=Math.sin(e[2]);i-=this._offset*r,s+=this._offset*t}return this.internalPlacement.setTranslate(i,s),this._tagIterator++,this.internalPlacement}_preparePath(t){this._tags.length=0,this._tagIterator=0;const e=function(t){return!(!t||0===t.length)&&t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]}(t),i=t.length-1;let s,r,n=0,o=0,l=0,a=0,u=0;for(;n<i;){n++,s=t[n-1],r=t[n];const h=yb(s),c=yb(r);(this._angleToLine||0!==this._offset)&&(a=this._curveHelper.getAngle(s,r,0)),1===n?e?(o=a,l=h):this._endPoints&&this._tags.push([s[0],s[1],a]):1===h?this._controlPoints&&this._tags.push([s[0],s[1],cg(u,a)]):this._regularVertices&&this._tags.push([s[0],s[1],cg(u,a)]),(this._angleToLine||0!==this._offset)&&(u=this._curveHelper.getAngle(s,r,1)),n===i&&(e?1===c||1===l?this._controlPoints&&this._tags.push([r[0],r[1],cg(u,o)]):this._regularVertices&&this._tags.push([r[0],r[1],cg(u,o)]):this._endPoints&&this._tags.push([r[0],r[1],u]))}this._tagIterator=0}}function cg(t,e){const i=Math.PI;for(;Math.abs(e-t)>i+2e-15;)e-t>i?e-=2*i:e+=2*i;return(t+e)/2}class fg{static local(){return null===fg.instance&&(fg.instance=new fg),fg.instance}execute(t,e,i){return new dg(t,e,i)}}fg.instance=null;class dg{constructor(t,e,i){this._geometry=t,this._offsetX=void 0!==e.offsetX?e.offsetX*i:0,this._offsetY=void 0!==e.offsetY?e.offsetY*i:0,this._method=void 0!==e.method?e.method:"OnPolygon",this._internalPlacement=new Qw}next(){const t=this._geometry;return this._geometry=null,t&&void 0!==t.rings?this._polygonCenter(t):null}_polygonCenter(t){let e=!1;switch(this._method){case"OnPolygon":default:case"CenterOfMass":case"BoundingBoxCenter":{const i=Kw();Do(i,t),this._internalPlacement.setTranslate((i[2]+i[0])/2+this._offsetX,(i[3]+i[1])/2-this._offsetY),e=!0;break}}return e?this._internalPlacement:null}}function pg(t){if(!t)return null;switch(t.type){case"CIMGeometricEffectAddControlPoints":return gb.local();case"CIMGeometricEffectArrow":return Cb.local();case"CIMGeometricEffectBuffer":return Ob.local();case"CIMGeometricEffectCut":return Pb.local();case"CIMGeometricEffectDashes":return _b.local();case"CIMGeometricEffectDonut":return Db.local();case"CIMGeometricEffectJog":return zb.local();case"CIMGeometricEffectMove":return Lb.local();case"CIMGeometricEffectOffset":return Vb.local();case"CIMGeometricEffectReverse":return qb.local();case"CIMGeometricEffectRotate":return Hb.local();case"CIMGeometricEffectScale":return Wb.local();case"CIMGeometricEffectWave":return Xb.local()}return null}function yg(t){if(!t)return null;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":return Zb.local();case"CIMMarkerPlacementAtExtremities":return eg.local();case"CIMMarkerPlacementAtRatioPositions":return sg.local();case"CIMMarkerPlacementInsidePolygon":return ng.local();case"CIMMarkerPlacementOnLine":return lg.local();case"CIMMarkerPlacementOnVertices":return ug.local();case"CIMMarkerPlacementPolygonCenter":return fg.local()}return null}class mg{constructor(t=0,e=0,i=0,s=0){this.x=t,this.y=e,this.width=i,this.height=s}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}const vg=Math.PI/180,wg=W.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class bg{constructor(t){this._t=t}static createIdentity(){return new bg([1,0,0,0,1,0])}clone(){return new bg(this._t.slice())}transform(t){const e=this._t;return[e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}static createScale(t,e){return new bg([t,0,0,0,e,0])}scale(t,e){const i=this._t;return i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=e,i[4]*=e,i[5]*=e,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(t,e){return new bg([0,0,t,0,0,e])}translate(t,e){const i=this._t;return i[2]+=t,i[5]+=e,this}static createRotate(t){const e=Math.cos(t),i=Math.sin(t);return new bg([e,-i,0,i,e,0])}rotate(t){return this.multiply(bg.createRotate(t))}multiply(t){const e=this._t,i=t._t,s=e[1]*i[0]+e[4]*i[1],r=e[2]*i[0]+e[5]*i[1]+i[2],n=e[0]*i[3]+e[3]*i[4],o=e[1]*i[3]+e[4]*i[4],l=e[2]*i[3]+e[5]*i[4]+i[5];return e[0]=e[0]*i[0]+e[3]*i[1],e[1]=s,e[2]=r,e[3]=n,e[4]=o,e[5]=l,this}}class gg{constructor(t){this._transfos=[],this._sizeTransfos=[],this._transfos.push(t||bg.createIdentity()),this._sizeTransfos.push(t?t.scaleRatio():1)}transformPt(t){return this._transfos[this._transfos.length-1].transform(t)}transformSize(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}back(){return this._transfos[this._transfos.length-1]}push(t,e){const i=e?t.scaleRatio():1;t.multiply(this.back()),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*i)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(t,e){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(t,e)}}drawMultiLayerSymbol(t,e){if(!t)return;const i=t.symbolLayers;if(!i)return;const s=t.effects;if(s){const t=this.executeEffects(s,e);if(t){let e=t.next();for(;e;)this.drawSymbolLayers(i,e),e=t.next()}}else this.drawSymbolLayers(i,e)}executeEffects(t,e){let i=new nb(e);for(const e of t){const t=pg(e);t&&(i=t.execute(i,e,1))}return i}drawSymbolLayers(t,e){let i=t.length;for(;i--;){const s=t[i];if(!s||!1===s.enable)continue;const r=s.effects;if(r){const t=this.executeEffects(r,e);if(t){let e=t.next();for(;e;)this.drawSymbolLayer(s,e),e=t.next()}}else this.drawSymbolLayer(s,e)}}drawSymbolLayer(t,e){switch(t.type){case"CIMSolidFill":this.drawSolidFill(e,t.color);break;case"CIMHatchFill":this.drawHatchFill(t,e);break;case"CIMSolidStroke":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(t,e)}}drawHatchFill(t,e){const i=this._buildHatchPolyline(t,e,1);i&&(this.pushClipPath(e),this.drawMultiLayerSymbol(t.lineSymbol,i),this.popClipPath())}drawMarkerLayer(t,e){const i=t.markerPlacement;if(i){const s=yg(i);if(s){const r="CIMMarkerPlacementInsidePolygon"===i.type;r&&this.pushClipPath(e);const n=s.execute(e,i,1);if(n){let e=n.next();for(;e;)this.drawMarker(t,e),e=n.next()}r&&this.popClipPath()}}else{const i=new Qw;i.tx=e.x,i.ty=e.y,this.drawMarker(t,i)}}drawMarker(t,e){switch(t.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(t,e);break;case"CIMVectorMarker":this.drawVectorMarker(t,e)}}drawPictureMarker(t,e){}drawVectorMarker(t,e){if(!t)return;const i=t.markerGraphics;if(!i)return;const s=t.size,r=t.frame,n=r?r.ymax-r.ymin:0,o=s&&n?s/n:1,l=bg.createIdentity();r&&l.translate(.5*-(r.xmax+r.xmin),.5*-(r.ymax+r.ymin));const a=t.anchorPoint;if(a){let e=a.x,i=a.y;"Absolute"!==t.anchorPointUnits&&r&&(e*=r.xmax-r.xmin,i*=r.ymax-r.ymin),l.translate(-e,-i)}1!==o&&l.scale(o,o),t.rotation&&l.rotate(t.rotation*vg),l.translate(t.offsetX||0,t.offsetY||0),l.translate(e.tx,e.ty),this.push(l,t.scaleSymbolsProportionally);for(const t of i)t&&t.symbol&&t.geometry||wg.error("Invalid marker graphic",t),this.drawSymbol(t.symbol,t.geometry);this.pop()}_buildHatchPolyline(t,e,i){let s=(void 0!==t.separation?t.separation:4)*i,r=void 0!==t.rotation?t.rotation:0;if(0===s)return null;s<0&&(s=-s);let n=0;const o=.5*s;for(;n>o;)n-=s;for(;n<-o;)n+=s;const l=Kw();Do(l,e),l[0]-=o,l[1]-=o,l[2]+=o,l[3]+=o;const a=[[l[0],l[1]],[l[0],l[3]],[l[2],l[3]],[l[2],l[1]]];for(;r>180;)r-=180;for(;r<0;)r+=180;const u=Math.cos(r*vg),h=Math.sin(r*vg),c=-s*h,f=s*u;let d,p,y,m;n=(void 0!==t.offsetX?t.offsetX*i:0)*h-(void 0!==t.offsetY?t.offsetY*i:0)*u,d=y=Number.MAX_VALUE,p=m=-Number.MAX_VALUE;for(const t of a){const e=t[0],i=t[1],s=u*e+h*i,r=-h*e+u*i;d=Math.min(d,s),y=Math.min(y,r),p=Math.max(p,s),m=Math.max(m,r)}y=Math.floor(y/s)*s;let v=u*d-h*y-c*n/s,w=h*d+u*y-f*n/s,b=u*p-h*y-c*n/s,g=h*p+u*y-f*n/s;const S=1+Math.round((m-y)/s),M=[];for(let t=0;t<S;t++)v+=c,w+=f,b+=c,g+=f,M.push([[v,w],[b,g]]);return{paths:M}}}class Sg extends gg{constructor(){super(),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new mg(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}drawSolidFill(t){!t||this._clipCount>0||(cl(t)?this._processPath(t.rings,0):hl(t)&&this._processPath(t.paths,0))}drawSolidStroke(t,e,i){if(!t||this._clipCount>0)return;const s=.5*this.transformSize(i);cl(t)?this._processPath(t.rings,s):hl(t)&&this._processPath(t.paths,s)}pushClipPath(t){this.drawSolidFill(t),++this._clipCount}popClipPath(){--this._clipCount}_processPath(t,e){if(t)for(const i of t){const t=i?i.length:0;if(t>1){this._merge(this.transformPt(i[0]),e);for(let s=1;s<t;++s)this._merge(this.transformPt(i[s]),e)}}}_merge(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e)}}class Mg extends gg{constructor(t,e){super(e),this._ctx=t}drawSolidFill(t,e){if(!t)return;if(cl(t))this._buildPath(t.rings,!0);else{if(!hl(t))return;this._buildPath(t.paths,!0)}const i=this._ctx;i.fillStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+e[3]/255+")",i.fill("evenodd")}drawSolidStroke(t,e,i,s,r,n){if(!t||!e||0===i)return;if(cl(t))this._buildPath(t.rings,!0);else{if(!hl(t))return;this._buildPath(t.paths,!1)}const o=this._ctx;o.strokeStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+e[3]/255+")",o.lineWidth=this.transformSize(i)+.5,this._setCapStyle(s),this._setJoinStyle(r),o.miterLimit=n,o.stroke()}pushClipPath(t){this._ctx.save(),cl(t)?this._buildPath(t.rings,!0):hl(t)&&this._buildPath(t.paths,!0),this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}_buildPath(t,e){const i=this._ctx;if(i.beginPath(),t)for(const s of t){const t=s?s.length:0;if(t>1){let r=this.transformPt(s[0]);i.moveTo(r[0],r[1]);for(let e=1;e<t;++e)r=this.transformPt(s[e]),i.lineTo(r[0],r[1]);e&&i.closePath()}}}_setCapStyle(t){switch(t){case"Butt":this._ctx.lineCap="butt";break;case"Round":this._ctx.lineCap="round";break;case"Square":this._ctx.lineCap="square"}}_setJoinStyle(t){switch(t){case"Bevel":this._ctx.lineJoin="bevel";break;case"Round":this._ctx.lineJoin="round";break;case"Miter":this._ctx.lineJoin="miter"}}}const xg=[1,256,65536,16777216],kg=[1/256,1/65536,1/16777216,1/4294967296],Cg=function(t,e=0){let i=0;for(let s=0;s<4;s++)i+=t[e+s]*kg[s];return i}(new Uint8ClampedArray([255,255,255,255]));function Ig(t,e,i=0){const s=function(t){return t<0?0:t>Cg?Cg:t}(t);for(let t=0;t<4;t++)e[i+t]=Math.floor(256*((r=s*xg[t])-Math.floor(r)));var r}const Og=Math.PI,jg=Og/2,Pg=W.getLogger("esri.symbols.cim.CIMSymbolHelper");function Ag(t,e){switch(e.type){case"CIMSymbolReference":t.drawSymbol(e.symbol,{type:"point",x:0,y:0});break;case"CIMPointSymbol":t.drawSymbol(e,{type:"point",x:0,y:0});break;case"CIMTextSymbol":break;case"CIMVectorMarker":{const i=new Qw;t.drawMarker(e,i);break}}return t.envelope()}class Tg{static getEnvelope(t){const e=new Sg;if(Array.isArray(t)){let i;for(const s of t)i?i.union(Ag(e,s)):i=Ag(e,s);return i}return Ag(e,t)}static getTextureAnchor(t){const e=this.getEnvelope(t);if(!e||e.width<=0||e.height<=0)return[0,0,0];const i=96/72,s=e.height*i+2;return[(e.x+.5*e.width)*i/(e.width*i+2),-(e.y+.5*e.height)*i/s,s]}static rasterize(t,e,i,s=!0){const r=i||this.getEnvelope(e);if(!r||r.width<=0||r.height<=0)return[null,0,0,0,0];const n=96/72,o=(r.x+.5*r.width)*n,l=(r.y+.5*r.height)*n;t.width=r.width*n,t.height=r.height*n,i||(t.width+=2,t.height+=2);const a=t.getContext("2d"),u=bg.createScale(n,-n);u.translate(.5*t.width-o,.5*t.height+l);const h=new Mg(a,u);switch(e.type){case"CIMPointSymbol":h.drawSymbol(e,{type:"point",x:0,y:0});break;case"CIMVectorMarker":{const t=new Qw;h.drawMarker(e,t);break}}const c=a.getImageData(0,0,t.width,t.height),f=new Uint8Array(c.data);if(s){let t;for(let e=0;e<f.length;e+=4)t=f[e+3]/255,f[e]=f[e]*t,f[e+1]=f[e+1]*t,f[e+2]=f[e+2]*t}return[f,t.width,t.height,-o/t.width,-l/t.height]}static fromSimpleMarker(t){const e=50;let i,s;const r=t.style;if("circle"===r||"esriSMSCircle"===r){let t=Math.acos(.995),r=Math.ceil(Og/t/4);0===r&&(r=1),t=jg/r,r*=4;const n=[];n.push([e,0]);for(let i=1;i<r;i++)n.push([e*Math.cos(i*t),-50*Math.sin(i*t)]);n.push([e,0]),i={rings:[n]},s={xmin:-50,ymin:-50,xmax:e,ymax:e}}else if("cross"===r||"esriSMSCross"===r){const t=0;i={rings:[[[t,e],[t,t],[e,t],[e,-t],[t,-t],[t,-50],[-t,-50],[-t,-t],[-50,-t],[-50,t],[-t,t],[-t,e],[t,e]]]},s={xmin:-50,ymin:-50,xmax:e,ymax:e}}else if("diamond"===r||"esriSMSDiamond"===r)i={rings:[[[-50,0],[0,e],[e,0],[0,-50],[-50,0]]]},s={xmin:-50,ymin:-50,xmax:e,ymax:e};else if("square"===r||"esriSMSSquare"===r)i={rings:[[[-50,-50],[-50,e],[e,e],[e,-50],[-50,-50]]]},s={xmin:-50,ymin:-50,xmax:e,ymax:e};else if("x"===r||"esriSMSX"===r){const t=0;i={rings:[[[0,t],[e-t,e],[e,e-t],[t,0],[e,t-e],[e-t,-50],[0,-t],[t-e,-50],[-50,t-e],[-t,0],[-50,e-t],[t-e,e],[0,t]]]},s={xmin:-50,ymin:-50,xmax:e,ymax:e}}else if("triangle"===r||"esriSMSTriangle"===r){const t=57.735026918962575,e=-t,r=2/3*100,n=r-100;i={rings:[[[e,n],[0,r],[t,n],[e,n]]]},s={xmin:e,ymin:n,xmax:t,ymax:r}}else"arrow"!==r&&"esriSMSArrow"!==r||(i={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},s={xmin:-50,ymin:-50,xmax:e,ymax:e});let n;if(i&&s){const e=[{type:"CIMSolidFill",enable:!0,color:t.color}];t.outline&&e.push({type:"CIMSolidStroke",enable:!0,width:t.outline.width,color:t.outline.color}),n={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:t.angle,size:t.size,offsetX:t.xoffset,offsetY:t.yoffset,frame:s,markerGraphics:[{type:"CIMMarkerGraphic",geometry:i,symbol:{type:"CIMPolygonSymbol",symbolLayers:e}}]}]}}return n}static fromCIMHatchFill(t){const e=void 0!==t.separation?t.separation:4,i=e/2;let s=this._getLineSymbolPeriod(t.lineSymbol)||4;for(;s<4;)s*=2;const r=s/2;return{type:"CIMVectorMarker",frame:{xmin:-r,xmax:r,ymin:-i,ymax:i},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-r,0],[r,0]]]},symbol:t.lineSymbol}],size:e}}static _getLineSymbolPeriod(t){if(t){const e=this._getEffectsRepeat(t.effects);if(e)return e;if(t.symbolLayers)for(const e of t.symbolLayers){const t=this._getEffectsRepeat(e.effects);if(t)return t;if(e){const t=this._getPlacementRepeat(e.markerPlacement);if(t)return t}}}return 0}static _getEffectsRepeat(t){if(t)for(const e of t)if(e)switch(e.type){case"CIMGeometricEffectDashes":{const t=e.dashTemplate;if(t&&t.length){let e=0;for(const i of t)e+=i;return 1&t.length&&(e*=2),e}break}case"CIMGeometricEffectWave":return e.period;default:Pg.error(`unsupported geometric effect type ${e.type}`)}return 0}static _getPlacementRepeat(t){if(t)switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const e=t.placementTemplate;if(e&&e.length){let t=0;for(const i of e)t+=i;return 1&e.length&&(t*=2),t}break}}return 0}static fromCIMInsidePolygon(t){const e=t.markerPlacement,i=e.stepX/2,s=e.stepY/2,r={xmin:-i,xmax:i,ymin:-s,ymax:s},n={type:t.type,...t};return n.markerPlacement=null,n.anchorPoint=null,{type:"CIMVectorMarker",frame:r,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[n]}}],size:e.stepY}}static getFillColor(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=Tg.getFillColor(e);if(null!=t)return t}break;case"CIMTextSymbol":return Tg.getFillColor(t.symbol);case"CIMSolidFill":return t.color}}static getStrokeColor(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=Tg.getStrokeColor(e);if(void 0!==t)return t}break;case"CIMTextSymbol":return Tg.getStrokeColor(t.symbol);case"CIMSolidStroke":return t.color}}static getStrokeWidth(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=Tg.getStrokeWidth(e);if(void 0!==t)return t}break;case"CIMTextSymbol":return Tg.getStrokeWidth(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}static getSize(t){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers){const t=Tg.getSize(i);t>e&&(e=t)}return e}case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":return t.width;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":return t.size}}static getMarkerScaleRatio(t){if(t)switch(t.type){case"CIMVectorMarker":if(!1!==t.scaleSymbolsProportionally&&t.frame)return t.size/(t.frame.ymax-t.frame.ymin)}return 1}}class Ng{static rasterizeSimpleFill(t,e,i){"solid"!==e&&"none"!==e&&"esriSFSSolid"!==e&&"esriSFSNull"!==e||console.error("Unexpected: style does not require rasterization");const s=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}(Math.ceil(i)),r=this._isHorizontalOrVertical(e)?8*s:16*s,n=2*s;t.width=r,t.height=r;const o=t.getContext("2d");o.strokeStyle="#FFFFFF",o.lineWidth=s,o.beginPath(),"vertical"!==e&&"cross"!==e&&"esriSFSCross"!==e&&"esriSFSVertical"!==e||(o.moveTo(r/2,-n),o.lineTo(r/2,r+n)),"horizontal"!==e&&"cross"!==e&&"esriSFSCross"!==e&&"esriSFSHorizontal"!==e||(o.moveTo(-n,r/2),o.lineTo(r+n,r/2)),"forward-diagonal"!==e&&"diagonal-cross"!==e&&"esriSFSDiagonalCross"!==e&&"esriSFSForwardDiagonal"!==e||(o.moveTo(-n,-n),o.lineTo(r+n,r+n),o.moveTo(r-n,-n),o.lineTo(r+n,n),o.moveTo(-n,r-n),o.lineTo(n,r+n)),"backward-diagonal"!==e&&"diagonal-cross"!==e&&"esriSFSBackwardDiagonal"!==e&&"esriSFSDiagonalCross"!==e||(o.moveTo(r+n,-n),o.lineTo(-n,r+n),o.moveTo(n,-n),o.lineTo(-n,n),o.moveTo(r+n,r-n),o.lineTo(r-n,r+n)),o.stroke();const l=o.getImageData(0,0,t.width,t.height),a=new Uint8Array(l.data);let u;for(let t=0;t<a.length;t+=4)u=a[t+3]/255,a[t]=a[t]*u,a[t+1]=a[t+1]*u,a[t+2]=a[t+2]*u;return[a,t.width,t.height]}static rasterizeSimpleLine(t,e){let i;switch(e){case"butt":i="Butt";break;case"square":i="Square";break;default:i="Round"}const s="Butt"===i;let r;switch(t){case"dash":case"esriSLSDash":r=s?[4,3]:[3,4];break;case"dash-dot":case"esriSLSDashDot":r=s?[4,3,1,3]:[3,4,0,4];break;case"dot":case"esriSLSDot":r=s?[1,3]:[0,4];break;case"long-dash":case"esriSLSLongDash":r=s?[8,3]:[7,4];break;case"long-dash-dot":case"esriSLSLongDashDot":r=s?[8,3,1,3]:[7,4,0,4];break;case"long-dash-dot-dot":case"esriSLSDashDotDot":r=s?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case"short-dash":case"esriSLSShortDash":r=s?[4,1]:[3,2];break;case"short-dash-dot":case"esriSLSShortDashDot":r=s?[4,1,1,1]:[3,2,0,2];break;case"short-dash-dot-dot":case"esriSLSShortDashDotDot":r=s?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case"short-dot":case"esriSLSShortDot":r=s?[1,1]:[0,2];break;case"solid":case"esriSLSSolid":case"none":Pg.error("Unexpected: style does not require rasterization"),r=[0,0];break;default:Pg.error(`Tried to rasterize SLS, but found an unexpected style: ${t}!`),r=[0,0]}return this.rasterizeDash(r,i)}static rasterizeDash(t,e){const i="Butt"===e,s="Square"===e,r=!i&&!s;let n=0;for(const e of t)n+=e;const o=15*n,l=31*o,a=new Float32Array(l),u=r?225:15;for(let t=0;t<l;++t)a[t]=u;const h=7.5;let c=0,f=0,d=!0;for(const e of t){c=f,f+=15*e;let t=c;for(;t<f;){let e=0;for(;e<31;){const n=e*o+t,l=r?(e-15)*(e-15):Math.abs(e-15);a[n]=d?i?Math.max(Math.max(c+h-t,l),Math.max(t-f+h,l)):l:r?Math.min((t-c)*(t-c)+l,(t-f)*(t-f)+l):s?Math.min(Math.max(t-c,l),Math.max(f-t,l)):Math.min(Math.max(t-c+h,l),Math.max(f+h-t,l)),e++}t++}d=!d}const p=a.length,y=new Uint8Array(4*p);for(let t=0;t<p;++t)Ig((r?Math.sqrt(a[t]):a[t])/15,y,4*t);return[y,o,31]}static _isHorizontalOrVertical(t){return"vertical"===t||"horizontal"===t||"cross"===t||"esriSFSCross"===t||"esriSFSVertical"===t||"esriSFSHorizontal"===t}}class Rg{static findApplicableOverrides(t,e,i){if(e){if(t.primitiveName){let s=!1;for(const e of i)if(e.primitiveName===t.primitiveName){s=!0;break}if(!s)for(const s of e)s.primitiveName===t.primitiveName&&i.push(s)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const s of t.effects)Rg.findApplicableOverrides(s,e,i);if(t.symbolLayers)for(const s of t.symbolLayers)Rg.findApplicableOverrides(s,e,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(t.effects)for(const s of t.effects)Rg.findApplicableOverrides(s,e,i);if(t.markerPlacement&&Rg.findApplicableOverrides(t.markerPlacement,e,i),"CIMVectorMarker"===t.type){if(t.markerGraphics)for(const s of t.markerGraphics)Rg.findApplicableOverrides(s,e,i),Rg.findApplicableOverrides(s.symbol,e,i)}else"CIMCharacterMarker"===t.type?Rg.findApplicableOverrides(t.symbol,e,i):"CIMHatchFill"===t.type&&Rg.findApplicableOverrides(t.lineSymbol,e,i)}}}static applyOverrides(t,e,i,s){if(e){if(t.primitiveName)for(const n of e)if(n.primitiveName===t.primitiveName){const e=(r=n.propertyName)?r.charAt(0).toLowerCase()+r.substr(1):r;if(s&&s.push({cim:t,nocapPropertyName:e,value:t[e]}),n.expression&&(n.value=Rg.toValue(n.propertyName,n.expression)),i){let e=!1;for(const s of i)s.primitiveName===t.primitiveName&&(e=!0);e||i.push(n)}t[e]=n.value}var r;switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const r of t.effects)Rg.applyOverrides(r,e,i,s);if(t.symbolLayers)for(const r of t.symbolLayers)Rg.applyOverrides(r,e,i,s);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(t.effects)for(const r of t.effects)Rg.applyOverrides(r,e,i,s);if("CIMVectorMarker"===t.type&&t.markerGraphics)for(const r of t.markerGraphics)Rg.applyOverrides(r,e,i,s),Rg.applyOverrides(r.symbol,e,i,s)}}}static restoreOverrides(t){for(const e of t)e.cim[e.nocapPropertyName]=e.value}static buildOverrideKey(t){let e="";for(const i of t)void 0!==i.value&&(e+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return e}static toValue(t,e){if("DashTemplate"===t)return e.split(" ").map((t=>Number(t)));if("Color"===t){const t=new Fa(e).toRgba();return t[3]*=255,t}return e}}function _g(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":{const e=t.symbolLayers;return e&&1===e.length?_g(e[0]):null}case"CIMVectorMarker":{const e=t.markerGraphics;if(!e||1!==e.length)return null;const i=e[0];if(!i)return null;const s=i.geometry;if(!s)return null;const r=i.symbol;return!r||"CIMPolygonSymbol"!==r.type&&"CIMLineSymbol"!==r.type?null:{geom:s,asFill:"CIMPolygonSymbol"===r.type}}case"sdf":return{geom:t.geom,asFill:t.asFill}}return null}function Eg(t){let e=1/0,i=-1/0,s=1/0,r=-1/0;for(const n of t)for(const t of n)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<s&&(s=t[1]),t[1]>r&&(r=t[1]);return[e,s,i,r]}function Dg(t){return t?t.rings?Eg(t.rings):t.paths?Eg(t.paths):ll(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function $g(t,e,i,s,r){const[n,o,l,a]=t;if(l<n||a<o)return[0,0,0];const u=l-n,h=a-o,c=Math.floor(31.5),f=(128-2*(c+1))/Math.max(u,h),d=Math.round(u*f)+2*c,p=Math.round(h*f)+2*c;let y=1;e&&(y=p/f/(e.ymax-e.ymin));let m=0,v=0;return s&&(r?e&&i&&e.ymax-e.ymin>0&&(m=s.x/(i*((e.xmax-e.xmin)/(e.ymax-e.ymin))),v=s.y/i):(m=s.x,v=s.y)),m=.5*(e.xmax+e.xmin)+m*(e.xmax-e.xmin),v=.5*(e.ymax+e.ymin)+v*(e.ymax-e.ymin),m-=n,v-=o,m*=f,v*=f,m+=c,v+=c,[y,m/d-.5,-(v/p-.5)]}function zg(t,e){const i=2*e,s=t.length,r=new Uint8Array(4*s);for(let e=0;e<s;++e)Ig(.5-t[e]/i,r,4*e);return r}const Fg=W.getLogger("esri.symbols.cim.cimAnalyzer");function Lg(t){switch(t){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function Ug(t){switch(t){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function Vg(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function Gg(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function qg(t,e,i,s){let r;t[e]?r=t[e]:(r={},t[e]=r),r[i]=s}function Bg(t){const e=t.markerPlacement;return e&&e.angleToLine?1:0}async function Hg(t,e,i,s){const r=i||[];if(!t)return r;let n,o;const l={};if("CIMSymbolReference"!==t.type)return Fg.error("Expect cim type to be 'CIMSymbolReference'"),r;if(n=t.symbol,o=t.primitiveOverrides,o){const t=[];for(const i of o){const s=i.valueExpressionInfo;if(s&&e){const r=gl(s.expression,e.spatialReference,e.fields).then((t=>{t&&qg(l,i.primitiveName,i.propertyName,t)}));t.push(r)}else null!=i.value&&qg(l,i.primitiveName,i.propertyName,i.value)}await Ei(t)}switch(n.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(t,e,i,s,r,n){if(!t)return;const o=t.symbolLayers;if(!o)return;let l;const a=Tg.getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(l=1);let u=o.length;for(;u--;){const h=o[u];if(!h||!1===h.enable)continue;const c=[];switch(Rg.findApplicableOverrides(h,e,c),h.type){case"CIMSolidFill":Jg(h,i,c,s,r);break;case"CIMPictureFill":Wg(h,i,c,s,r);break;case"CIMHatchFill":Yg(h,i,c,s,r);break;case"CIMGradientFill":Xg(h,i,c,s,r);break;case"CIMSolidStroke":Qg(h,i,c,s,r,"CIMPolygonSymbol"===t.type,a);break;case"CIMPictureStroke":Kg(h,i,c,s,r,"CIMPolygonSymbol"===t.type,a);break;case"CIMGradientStroke":Zg(h,i,c,s,r,"CIMPolygonSymbol"===t.type,a);break;case"CIMCharacterMarker":if(tS(h,i,c,s,r))break;break;case"CIMPictureMarker":if(tS(h,i,c,s,r))break;"CIMLineSymbol"===t.type&&(l=Bg(h)),eS(h,i,c,s,r,l,a);break;case"CIMVectorMarker":if(tS(h,i,c,s,r))break;"CIMLineSymbol"===t.type&&(l=Bg(h)),iS(h,i,c,s,r,l,a,n);break;default:Fg.error("Cannot analyze CIM layer",h.type)}}}(n,o,l,e,r,s)}return r}function Jg(t,e,i,s,r){const n=t.primitiveName,o=Jw(t.color),l=B(JSON.stringify(t)).toString();r.push({type:"fill",templateHash:l,materialHash:0===i.length?l:()=>l,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:aS(n,e,"Color",s,o,lS),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t.effects})}function Wg(t,e,i,s,r){const n=t.primitiveName,o=t.tintColor?Jw(t.tintColor):{r:255,g:255,b:255,a:1},l=B(JSON.stringify(t)).toString(),a=B(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();r.push({type:"fill",templateHash:l,materialHash:0===i.length?a:()=>a,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,color:aS(n,e,"TintColor",s,o,lS),height:aS(n,e,"Height",s,t.height),scaleX:aS(n,e,"ScaleX",s,t.scaleX),angle:aS(n,e,"Rotation",s,t.rotation),offsetX:aS(n,e,"OffsetX",s,t.offsetX),offsetY:aS(n,e,"OffsetY",s,t.offsetY)})}function Yg(t,e,i,s,r){const n=["Rotation","OffsetX","OffsetY"],o=i.filter((e=>e.primitiveName!==t.primitiveName&&-1===n.indexOf(e.propertyName))),l=t.primitiveName,a=B(JSON.stringify(t)).toString(),u=B(`${t.separation}${JSON.stringify(t.lineSymbol)}`).toString();r.push({type:"fill",templateHash:a,materialHash:0===i.length?u:uS(u,e,o,s),cim:t,materialOverrides:o,colorLocked:t.colorLocked,effects:t.effects,color:{r:255,g:255,b:255,a:1},height:aS(l,e,"Separation",s,t.separation),scaleX:1,angle:aS(l,e,"Rotation",s,t.rotation),offsetX:aS(l,e,"OffsetX",s,t.offsetX),offsetY:aS(l,e,"OffsetY",s,t.offsetY)})}function Xg(t,e,i,s,r){const n=B(JSON.stringify(t)).toString();r.push({type:"fill",templateHash:n,materialHash:0===i.length?n:uS(n,e,i,s),cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function Qg(t,e,i,s,r,n,o){const l=B(JSON.stringify(t)).toString(),a=t.primitiveName,u=Jw(t.color),h=void 0!==t.width?t.width:4,c=Lg(t.capStyle),f=Ug(t.joinStyle),d=t.miterLimit;r.push({type:"line",templateHash:l,materialHash:0===i.length?l:()=>l,cim:t,materialOverrides:null,isOutline:n,colorLocked:t.colorLocked,effects:t.effects,color:aS(a,e,"Color",s,u,lS),width:aS(a,e,"Width",s,h),cap:aS(a,e,"CapStyle",s,c),join:aS(a,e,"JoinStyle",s,f),miterLimit:aS(a,e,"MiterLimit",s,d),referenceWidth:o,zOrder:oS(t.name),isDashed:!1})}function Kg(t,e,i,s,r,n,o){const l=B(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),a=t.primitiveName,u=Jw(t.tintColor),h=void 0!==t.width?t.width:4,c=Lg(t.capStyle),f=Ug(t.joinStyle),d=t.miterLimit,p=B(JSON.stringify(t)).toString();r.push({type:"line",templateHash:p,materialHash:0===i.length?l:()=>l,cim:t,materialOverrides:null,isOutline:n,colorLocked:t.colorLocked,effects:t.effects,color:aS(a,e,"TintColor",s,u,lS),width:aS(a,e,"Width",s,h),cap:aS(a,e,"CapStyle",s,c),join:aS(a,e,"JoinStyle",s,f),miterLimit:aS(a,e,"MiterLimit",s,d),referenceWidth:o,zOrder:oS(t.name),isDashed:!1})}function Zg(t,e,i,s,r,n,o){const l=t.primitiveName,a=void 0!==t.width?t.width:4,u=Lg(t.capStyle),h=Ug(t.joinStyle),c=t.miterLimit,f=B(JSON.stringify(t)).toString();r.push({type:"line",templateHash:f,materialHash:0===i.length?f:uS(f,e,i,s),cim:t,materialOverrides:null,isOutline:n,colorLocked:t.colorLocked,effects:t.effects,color:{r:128,g:128,b:128,a:1},width:aS(l,e,"Width",s,a),cap:aS(l,e,"CapStyle",s,u),join:aS(l,e,"JoinStyle",s,h),miterLimit:aS(l,e,"MiterLimit",s,c),referenceWidth:o,zOrder:oS(t.name),isDashed:!1})}function tS(t,e,i,s,r){const n=t.markerPlacement;if(!n||"CIMMarkerPlacementInsidePolygon"!==n.type)return!1;const o=n,l=["Rotation","OffsetX","OffsetY"],a=i.filter((e=>e.primitiveName!==t.primitiveName&&-1===l.indexOf(e.propertyName))),u=B(JSON.stringify(t)).toString();return r.push({type:"fill",templateHash:u,materialHash:0===i.length?u:uS(u,e,a,s),cim:t,materialOverrides:a,colorLocked:t.colorLocked,effects:t.effects,color:{r:255,g:255,b:255,a:1},height:aS(o.primitiveName,e,"StepY",s,o.stepY),scaleX:1,angle:aS(o.primitiveName,e,"GridAngle",s,o.gridAngle),offsetX:aS(o.primitiveName,e,"OffsetX",s,o.offsetX),offsetY:aS(o.primitiveName,e,"OffsetY",s,o.offsetY)}),!0}function eS(t,e,i,s,r,n,o){const l=t.primitiveName,a=t.size,u=t.scaleX,h=t.rotation,c=t.offsetX,f=t.offsetY,d=Jw(t.tintColor),p=B(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();let y=!1,m="";for(const t of i)t.primitiveName===l&&(void 0!==t.value?m+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`:t.valueExpressionInfo&&(y=!0));r.push({type:"marker",templateHash:B(JSON.stringify(t)+m).toString(),materialHash:y?()=>p:p,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:!1,alignment:n,size:aS(l,e,"Size",s,a),scaleX:aS(l,e,"ScaleX",s,u),rotation:aS(l,e,"Rotation",s,h),offsetX:aS(l,e,"OffsetX",s,c),offsetY:aS(l,e,"OffsetY",s,f),color:aS(l,e,"TintColor",s,d,lS),anchorPoint:t.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:o,sizeRatio:1,markerPlacement:t.markerPlacement})}function iS(t,e,i,s,r,n,o,l){const a=t.markerGraphics;if(!a)return;let u=0;if(t.scaleSymbolsProportionally){const e=t.frame;e&&(u=e.ymax-e.ymin)}for(const h of a)if(h){const a=h.symbol;if(!a)continue;switch(a.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":rS(t,h,i,e,s,r,n,o,u,l);break;case"CIMTextSymbol":sS(t,h,e,i,s,r,n,o,u)}}}function sS(t,e,i,s,r,n,o,l,a){Rg.findApplicableOverrides(e,s,[]);const u=e.geometry;if(!("x"in u)||!("y"in u))return;const h=e.symbol,c=(f=h).underline?"underline":f.strikethrough?"line-through":"none";var f;const d=function(t){let e="normal",i="normal";if(t){const s=t.toLowerCase();-1!==s.indexOf("italic")?e="italic":-1!==s.indexOf("oblique")&&(e="oblique"),-1!==s.indexOf("bold")?i="bold":-1!==s.indexOf("light")&&(i="lighter")}return{style:e,weight:i}}(h.fontStyleName);h.font={family:h.fontFamilyName,decoration:c,...d};const p=t.frame,y=t.size/a,m=t.primitiveName,v=(h.height||0)*y,w=h.angle||0,b=((h.offsetX||0)+(u.x-.5*(p.xmin+p.xmax)))*y,g=((h.offsetY||0)+(u.y-.5*(p.ymin+p.ymax)))*y,S=Jw(Tg.getFillColor(h));let M=Jw(Tg.getStrokeColor(h)),x=Tg.getStrokeWidth(h);x||(M=Jw(Tg.getFillColor(h.haloSymbol)),x=h.haloSize*y);let k="";for(const t of s)t.primitiveName===m&&void 0!==t.value&&(k+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`);const C=JSON.stringify(t.effects)+Number(t.colorLocked)+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement),I=B(JSON.stringify(e)+C+k).toString();n.push({type:"text",templateHash:I,materialHash:()=>B(JSON.stringify(h.font)).toString(),cim:h,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,alignment:o,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:h.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:aS(m,i,"Size",r,v),angle:aS(m,i,"Rotation",r,w),offsetX:aS(m,i,"OffsetX",r,b),offsetY:aS(m,i,"OffsetY",r,g),horizontalAlignment:Vg(h.horizontalAlignment),verticalAlignment:Gg(h.verticalAlignment),text:aS(e.primitiveName,i,"TextString",r,e.textString,Hw,h.textCase),color:S,outlineColor:M,outlineSize:x,referenceSize:l,sizeRatio:1,markerPlacement:t.markerPlacement})}function rS(t,e,i,s,r,n,o,l,a,u){const h=e.geometry;if(!h)return;const c=e.symbol.symbolLayers;if(!c)return;if(u)return void nS(t,e,s,i,r,n,o,l,a);let f=c.length;for(;f--;){const u=c[f];if(u&&!1!==u.enable)switch(u.type){case"CIMSolidFill":case"CIMSolidStroke":{const c=Dg(h);if(!c)continue;const[f,d,p]=$g(c,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),y="CIMSolidFill"===u.type,m={type:"sdf",geom:h,asFill:y},v=t.primitiveName,w=t.size,b=t.rotation||0,g=t.offsetX,S=t.offsetY,M=u.primitiveName,x=Jw(y?Tg.getFillColor(u):Tg.getStrokeColor(u)),k=y?{r:0,g:0,b:0,a:0}:Jw(Tg.getStrokeColor(u)),C=Tg.getStrokeWidth(u);if(!y&&!C)break;let I=!1,O="";for(const t of i)t.primitiveName!==M&&t.primitiveName!==v||(void 0!==t.value?O+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`:t.valueExpressionInfo&&(I=!0));const j=JSON.stringify({...t,markerGraphics:null}),P=B(JSON.stringify(m)).toString(),A={type:"marker",templateHash:B(JSON.stringify(e)+JSON.stringify(u)+j+O).toString(),materialHash:I?()=>P:P,cim:m,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:d,y:p},isAbsoluteAnchorPoint:!1,size:aS(t.primitiveName,s,"Size",r,w),rotation:aS(t.primitiveName,s,"Rotation",r,b),offsetX:aS(t.primitiveName,s,"OffsetX",r,g),offsetY:aS(t.primitiveName,s,"OffsetY",r,S),scaleX:1,frameHeight:a,rotateClockwise:t.rotateClockwise,referenceSize:l,sizeRatio:f,color:aS(M,s,"Color",r,x,lS),outlineColor:aS(M,s,"Color",r,k,lS),outlineWidth:aS(M,s,"Width",r,C),markerPlacement:t.markerPlacement};n.push(A);break}default:nS(t,e,s,i,r,n,o,l,a)}}}function nS(t,e,i,s,r,n,o,l,a){const u=function(t,e){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[e],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath,effects:t.effects}}(t,e);let h=[];const c=["Rotation","OffsetX","OffsetY"];h=s.filter((e=>e.primitiveName!==t.primitiveName||-1===c.indexOf(e.propertyName)));let f="";for(const t of s)void 0!==t.value&&(f+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`);const[d,p,y]=Tg.getTextureAnchor(u),m=t.primitiveName,v=t.rotation||0,w=t.offsetX||0,b=t.offsetY||0,g=B(JSON.stringify(u)+f).toString(),S={type:"marker",templateHash:g,materialHash:0===h.length?g:uS(g,i,h,r),cim:u,materialOverrides:h,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:d,y:p},isAbsoluteAnchorPoint:!1,size:t.size,rotation:aS(m,i,"Rotation",r,v),offsetX:aS(m,i,"OffsetX",r,w),offsetY:aS(m,i,"OffsetY",r,b),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:a,rotateClockwise:t.rotateClockwise,referenceSize:l,sizeRatio:y/kh(t.size),markerPlacement:t.markerPlacement};n.push(S)}function oS(t){if(t&&0===t.indexOf("Level_")){const e=parseInt(t.substr(6),10);if(NaN!==e)return e}return 0}function lS(t){if(!t||0===t.length)return null;const e=new Fa(t).toRgba();return{r:e[0],g:e[1],b:e[2],a:e[3]}}function aS(t,e,i,s,r,n,o){const l=e[t];if(l){const t=l[i];if("string"==typeof t||"number"==typeof t||t instanceof Array)return n?n.call(null,t,o):t;if(null!=t&&t instanceof Sl)return(e,i,l)=>{let a=Uw(t,e,{$view:l},s.geometryType,i);return null!==a&&n&&(a=n.call(null,a,o)),null!==a?a:r}}return r}function uS(t,e,i,s){for(const t of i)if(t.valueExpressionInfo){const i=e[t.primitiveName]&&e[t.primitiveName][t.propertyName];i instanceof Sl&&(t.fn=(t,e,r)=>Uw(i,t,{$view:r},s.geometryType,e))}return(e,s,r)=>{for(const t of i)t.fn&&(t.value=t.fn(e,s,r));return B(t+Rg.buildOverrideKey(i)).toString()}}function hS(t,e){if(!e||0===e.length)return t;const i=JSON.parse(JSON.stringify(t));return Rg.applyOverrides(i,e),i}class cS{dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(t,e,i){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===t.type||"esriSFS"===t.type){const[i,s,r]=Ng.rasterizeSimpleFill(this._rasterizationCanvas,t.style,e);return{size:[s,r],image:new Uint32Array(i.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===t.type||"esriSLS"===t.type){const[e,i,s]=Ng.rasterizeSimpleLine(t.style,t.cap);return{size:[i,s],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let s,r,n;if("simple-marker"===t.type||"esriSMS"===t.type||"line-marker"===t.type?(s=Tg.fromSimpleMarker(t),n=_g(s)):"CIMHatchFill"===t.type?(s=Tg.fromCIMHatchFill(t),r=new mg(s.frame.xmin,-s.frame.ymax,s.frame.xmax-s.frame.xmin,s.frame.ymax-s.frame.ymin)):t.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type?(s=Tg.fromCIMInsidePolygon(t),r=new mg(s.frame.xmin,-s.frame.ymax,s.frame.xmax-s.frame.xmin,s.frame.ymax-s.frame.ymin)):(s=t,n=_g(s)),n&&!i){const[t,e,i]=function(t){const e=(i=t.geom)?i.rings?i.rings:i.paths?i.paths:void 0!==i.xmin&&void 0!==i.ymin&&void 0!==i.xmax&&void 0!==i.ymax?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:null:null;var i;const s=function(t){let e=1/0,i=-1/0,s=1/0,r=-1/0;for(const n of t)for(const t of n)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<s&&(s=t[1]),t[1]>r&&(r=t[1]);return new mg(e,s,i-e,r-s)}(e),r=Math.floor(31.5),n=(128-2*(r+1))/Math.max(s.width,s.height),o=Math.round(s.width*n)+2*r,l=Math.round(s.height*n)+2*r,a=[];for(const i of e)if(i&&i.length>1){const e=[];for(const t of i){let[i,o]=t;i-=s.x,o-=s.y,i*=n,o*=n,i+=r-.5,o+=r-.5,e.push([i,o])}if(t.asFill){const t=e.length-1;e[0][0]===e[t][0]&&e[0][1]===e[t][1]||e.push(e[0])}a.push(e)}const u=function(t,e,i,s){const r=e*i,n=new Array(r),o=s*s+1;for(let t=0;t<r;++t)n[t]=o;for(const r of t){const t=r.length;for(let o=1;o<t;++o){const t=r[o-1],l=r[o];let a,u,h,c;t[0]<l[0]?(a=t[0],u=l[0]):(a=l[0],u=t[0]),t[1]<l[1]?(h=t[1],c=l[1]):(h=l[1],c=t[1]);let f=Math.floor(a)-s,d=Math.floor(u)+s,p=Math.floor(h)-s,y=Math.floor(c)+s;f<0&&(f=0),d>e&&(d=e),p<0&&(p=0),y>i&&(y=i);const m=l[0]-t[0],v=l[1]-t[1],w=m*m+v*v;for(let s=f;s<d;s++)for(let r=p;r<y;r++){let o,a,u=(s-t[0])*m+(r-t[1])*v;u<0?(o=t[0],a=t[1]):u>w?(o=l[0],a=l[1]):(u/=w,o=t[0]+u*m,a=t[1]+u*v);const h=(s-o)*(s-o)+(r-a)*(r-a),c=(i-r-1)*e+s;h<n[c]&&(n[c]=h)}}}for(let t=0;t<r;++t)n[t]=Math.sqrt(n[t]);return n}(a,o,l,r);return t.asFill&&function(t,e,i,s,r){for(const n of t){const t=n.length;for(let o=1;o<t;++o){const t=n[o-1],l=n[o];let a,u,h,c;t[0]<l[0]?(a=t[0],u=l[0]):(a=l[0],u=t[0]),t[1]<l[1]?(h=t[1],c=l[1]):(h=l[1],c=t[1]);let f=Math.floor(a),d=Math.floor(u)+1,p=Math.floor(h),y=Math.floor(c)+1;f<s&&(f=s),d>e-s&&(d=e-s),p<s&&(p=s),y>i-s&&(y=i-s);for(let n=p;n<y;++n){if(t[1]>n==l[1]>n)continue;const o=(i-n-1)*e;for(let e=f;e<d;++e)e<(l[0]-t[0])*(n-t[1])/(l[1]-t[1])+t[0]&&(r[o+e]=-r[o+e]);for(let t=s;t<f;++t)r[o+t]=-r[o+t]}}}}(a,o,l,r,u),[zg(u,r),o,l]}(n);return t?{size:[e,i],image:new Uint32Array(t.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[o,l,a,u,h]=Tg.rasterize(this._rasterizationCanvas,s,r,!i);return o?{size:[l,a],image:new Uint32Array(o.buffer),sdf:!1,simplePattern:!1,anchorX:u,anchorY:h}:null}rasterizeImageResource(t,e,i,s){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=t,this._rasterizationCanvas.height=e;const r=this._rasterizationCanvas.getContext("2d");i instanceof ImageData?r.putImageData(i,0,0):(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`),r.drawImage(i,0,0,t,e));const n=r.getImageData(0,0,t,e),o=new Uint8Array(n.data);if(s)for(const t of s)if(t&&t.oldColor&&4===t.oldColor.length&&t.newColor&&4===t.newColor.length){const[e,i,s,r]=t.oldColor,[n,l,a,u]=t.newColor;if(e===n&&i===l&&s===a&&r===u)continue;for(let t=0;t<o.length;t+=4)e===o[t]&&i===o[t+1]&&s===o[t+2]&&r===o[t+3]&&(o[t]=n,o[t+1]=l,o[t+2]=a,o[t+3]=u)}let l;for(let t=0;t<o.length;t+=4)l=o[t+3]/255,o[t]=o[t]*l,o[t+1]=o[t+1]*l,o[t+2]=o[t+2]*l;let a=o,u=t,h=e;const c=512;if(u>=c||h>=c){const i=u/h;i>1?(u=c,h=Math.round(c/i)):(h=c,u=Math.round(c*i)),a=new Uint8Array(4*u*h),function(t,e,i,s,r,n,o=!0){const l=e/r,a=i/n,u=Math.ceil(l/2),h=Math.ceil(a/2);for(let i=0;i<n;i++)for(let c=0;c<r;c++){const f=4*(c+(o?n-i-1:i)*r);let d=0,p=0,y=0,m=0,v=0,w=0,b=0;const g=(i+.5)*a;for(let s=Math.floor(i*a);s<(i+1)*a;s++){const i=Math.abs(g-(s+.5))/h,r=(c+.5)*l,n=i*i;for(let i=Math.floor(c*l);i<(c+1)*l;i++){let o=Math.abs(r-(i+.5))/u;const l=Math.sqrt(n+o*o);l>=-1&&l<=1&&(d=2*l*l*l-3*l*l+1,d>0&&(o=4*(i+s*e),b+=d*t[o+3],y+=d,t[o+3]<255&&(d=d*t[o+3]/250),m+=d*t[o],v+=d*t[o+1],w+=d*t[o+2],p+=d))}}s[f]=m/p,s[f+1]=v/p,s[f+2]=w/p,s[f+3]=b/y}}(o,t,e,new Uint8ClampedArray(a.buffer),u,h,!1)}return{size:[t,e],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}class fS{constructor(){}rasterizeText(t,e){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d");this.setFontProperties(s,e),this.parameters=e,this.textLines=t.split(/\r?\n/),this.lineHeight=this.computeLineHeight();const r=this.computeTextWidth(s,e),n=this.lineHeight*this.textLines.length;var o;i.width=r,i.height=n,this.renderedLineHeight=Math.round(this.lineHeight*e.pixelRatio),this.renderedHaloSize=e.halo.size*e.pixelRatio,this.renderedWidth=r*e.pixelRatio,this.renderedHeight=n*e.pixelRatio,this.fillStyle=`rgba(${(o=e.color).slice(0,3).toString()},${o[3]})`,this.haloStyle=function(t){return`rgb(${t.slice(0,3).toString()})`}(e.halo.color);const l=this.renderedLineHeight,a=this.renderedHaloSize;this.setFontProperties(s,e);const u=function(t,e){return"center"===t?.5*e:"right"===t?e:0}(s.textAlign,this.renderedWidth)+a,h=a;let c=0,f=0;a>0&&this.renderHalo(s,u,h,c,f,e),f+=h,c+=u;for(const t of this.textLines)s.globalCompositeOperation="destination-out",s.fillStyle="rgb(0, 0, 0)",s.fillText(t,c,f),s.globalCompositeOperation="source-over",s.fillStyle=this.fillStyle,s.fillText(t,c,f),f+=l;const d=s.getImageData(0,0,this.renderedWidth,this.renderedHeight),p=new Uint8Array(d.data);if(e.premultiplyColors){let t;for(let e=0;e<p.length;e+=4)t=p[e+3]/255,p[e]=p[e]*t,p[e+1]=p[e+1]*t,p[e+2]=p[e+2]*t}return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(p.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}renderHalo(t,e,i,s,r,n){const o=this.renderedWidth,l=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=l;const a=this._haloRasterizationCanvas,u=a.getContext("2d");u.clearRect(0,0,o,l),this.setFontProperties(u,n),u.fillStyle=this.haloStyle,u.strokeStyle=this.haloStyle;const h=this.renderedHaloSize<3;u.lineJoin=h?"miter":"round",h?this.renderHaloEmulated(u,e,i):this.renderHaloNative(u,e,i),t.globalAlpha=this.parameters.halo.color[3],t.drawImage(a,0,0,o,l,s,r,o,l),t.globalAlpha=1}renderHaloEmulated(t,e,i){const s=this.renderedLineHeight,r=this.renderedHaloSize;for(const n of this.textLines){for(const[s,o]of dS)t.fillText(n,e+r*s,i+r*o);i+=s}}renderHaloNative(t,e,i){const s=this.renderedLineHeight,r=this.renderedHaloSize;for(const n of this.textLines){const o=2*r,l=5,a=.1;for(let s=0;s<l;s++)t.lineWidth=(1-(l-1)*a+s*a)*o,t.strokeText(n,e,i);i+=s}}setFontProperties(t,e){const i=e.font,s=`${i.style} ${i.weight} ${kh(e.size*e.pixelRatio)}px ${i.family}, sans-serif`;let r;switch(t.font=s,t.textBaseline="top",e.horizontalAlignment){case"left":r="left";break;case"right":r="right";break;case"center":r="center";break;default:r="left"}t.textAlign=r}computeTextWidth(t,e){let i=0;for(const e of this.textLines)i=Math.max(i,t.measureText(e).width);const s=e.font;return("italic"===s.style||"oblique"===s.style||"string"==typeof s.weight&&("bold"===s.weight||"bolder"===s.weight)||"number"==typeof s.weight&&s.weight>600)&&(i+=.3*t.measureText("A").width),i+=2*this.parameters.halo.size,Math.round(i)}computeLineHeight(){return Math.round(1.275*this.parameters.size+2*this.parameters.halo.size)}}const dS=[];{const t=16;for(let e=0;e<360;e+=360/t)dS.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}var pS;!function(t){t.Legend="legend",t.Preview="preview"}(pS||(pS={}));const yS=(t,e,i)=>{if(t&&t.targetSize){let s;if(i){const e=Math.max(i.frame.xmax-i.frame.xmin,i.frame.ymax-i.frame.ymin);s=t.targetSize/kh(e)}else s=t.targetSize/e.referenceSize;return s}return t&&t.scaleFactor?t.scaleFactor:1},mS={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};class vS{constructor(t,e){this._spatialReference=t,this._avoidSDF=e,this._resourceCache=new Map,this._rasterizer=new cS,this._textRasterizer=new fS,this._pictureMarkerCache=new Map}async rasterizeCIMSymbolAsync(t,e,i,s,r,n,o,l){s=s||(e?null!=e.centroid?"esriGeometryPolygon":dl(e.geometry):null)||function(t){if(!(t&&t.data&&t.data.symbol))return null;switch(t.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(t);const a=await this.analyzeCIMSymbol(t,e?function(t){return(t?Object.keys(t):[]).map((e=>({name:e,alias:e,type:"string"==typeof t[e]?"esriFieldTypeString":"esriFieldTypeDouble"})))}(e.attributes):null,i,s,l);return this.rasterizeCIMSymbol(a,e,s,r,n,o)}async analyzeCIMSymbol(t,e,i,s,r){const n=[],o=e?{geometryType:s,spatialReference:this._spatialReference,fields:e}:null;let l;await Hg(t.data,o,n,this._avoidSDF),Fi(r);for(const t of n)"CIMPictureMarker"!==t.cim.type&&"CIMPictureFill"!==t.cim.type&&"CIMPictureStroke"!==t.cim.type||(l||(l=[]),l.push(this.fetchPictureMarkerResource(t,r))),i&&"text"===t.type&&"string"==typeof t.text&&t.text.indexOf("[")>-1&&(t.text=Bw(i,t.text,t.cim.textCase));return l&&await Ei(l),n}async fetchPictureMarkerResource(t,e){const i=t.materialHash;if(!this._pictureMarkerCache.get(i)){const s=(await eu(t.cim.url,{responseType:"image",signal:e&&e.signal})).data;this._pictureMarkerCache.set(i,s)}}rasterizeCIMSymbol(t,e,i,s,r,n){const o=[];for(const l of t){s&&"function"==typeof s.scaleFactor&&(s.scaleFactor=s.scaleFactor(e,r,n));const t=this._getRasterizedResource(l,e,i,s,r,n);if(!t)continue;let a=0,u=t.anchorX||0,h=t.anchorY||0,c=!1,f=0,d=0;if("esriGeometryPoint"===i){const t=yS(s,l,null);if(f=Gw(l.offsetX,e,r,n)*t||0,d=Gw(l.offsetY,e,r,n)*t||0,"marker"===l.type)a=Gw(l.rotation,e,r,n)||0,c=!!l.rotateClockwise&&l.rotateClockwise;else if("text"===l.type){if(a=Gw(l.angle,e,r,n)||0,void 0!==l.horizontalAlignment)switch(l.horizontalAlignment){case"left":u=-.5;break;case"right":u=.5;break;default:u=0}if(void 0!==l.verticalAlignment)switch(l.verticalAlignment){case"top":h=.5;break;case"bottom":h=-.5;break;case"baseline":h=-.25;break;default:h=0}}}null!=t&&o.push({angle:a,rotateClockWise:c,anchorX:u,anchorY:h,offsetX:f,offsetY:d,rasterizedResource:t})}return this.getSymbolImage(o)}getSymbolImage(t){const e=document.createElement("canvas"),i=e.getContext("2d");let s=0,r=0,n=0,o=0;const l=[];for(let e=0;e<t.length;e++){const a=t[e],u=a.rasterizedResource;if(!u)continue;const h=u.size,c=a.offsetX,f=a.offsetY,d=a.anchorX,p=a.anchorY,y=a.rotateClockWise||!1;let m=a.angle,v=kh(c)-h[0]*(.5+d),w=kh(f)-h[1]*(.5+p),b=v+h[0],g=w+h[1];if(m){y&&(m=-m);const t=Math.sin(m*Math.PI/180),e=Math.cos(m*Math.PI/180),i=v*e-w*t,s=v*t+w*e,r=v*e-g*t,n=v*t+g*e,o=b*e-g*t,l=b*t+g*e,a=b*e-w*t,u=b*t+w*e;v=Math.min(i,r,o,a),w=Math.min(s,n,l,u),b=Math.max(i,r,o,a),g=Math.max(s,n,l,u)}s=v<s?v:s,r=w<r?w:r,n=b>n?b:n,o=g>o?g:o;const S=i.createImageData(u.size[0],u.size[1]);S.data.set(new Uint8ClampedArray(u.image.buffer)),l.push({offsetX:c,offsetY:f,rotateClockwise:y,angle:m,rasterizedImage:S,anchorX:d,anchorY:p})}e.width=n-s,e.height=o-r;const a=-s,u=o;for(let t=0;t<l.length;t++){const e=l[t],s=this._imageDataToCanvas(e.rasterizedImage),r=a-e.rasterizedImage.width*(.5+e.anchorX),n=u-e.rasterizedImage.height*(.5-e.anchorY);if(e.angle){const t=(360-e.angle)*Math.PI/180;i.save(),i.translate(kh(e.offsetX),-kh(e.offsetY)),i.translate(a,u),i.rotate(t),i.translate(-a,-u),i.drawImage(s,r,n),i.restore()}else i.drawImage(s,r+kh(e.offsetX),n-kh(e.offsetY))}const h=new Sp({x:a/e.width-.5,y:u/e.height-.5});return{imageData:0!==e.width&&0!==e.height?i.getImageData(0,0,e.width,e.height):i.createImageData(1,1),anchorPosition:h}}_imageDataToCanvas(t){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const e=this._imageDataCanvas,i=e.getContext("2d");return e.width=t.width,e.height=t.height,i.putImageData(t,0,0),e}_imageTo32Array(t,e,i){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const s=this._imageDataCanvas,r=s.getContext("2d");return s.width=e,s.height=i,r.drawImage(t,0,0,e,i),new Uint32Array(r.getImageData(0,0,e,i).data.buffer)}_getRasterizedResource(t,e,i,s,r,n){let o,l,a,u;if("esriGeometryPolyline"===i||"esriGeometryPolygon"===i){const u=s&&s.style?s.style:pS.Legend,h="esriGeometryPolyline"===i?mS.stroke[u]:mS.fill[u];if("line"===t.type){if("CIMSolidStroke"!==t.cim.type){if("CIMPictureStroke"===t.cim.type){const i=Gw(t.width,e,r,n);let s,o,l;return({image:s,width:o,height:l}=this._getPictureResource(t,i)),this._rasterizePictureResource(t,s,o,l,h,i)}return null}({analyzedCIM:o,hash:a}=wS(t,e,r,n)),l=this._embedCIMLayerInVectorMarker(o,h)}else if("marker"===t.type){if("CIMPictureMarker"===t.cim.type)return null;if("CIMVectorMarker"!==t.cim.type)return null;t.cim.offsetX=Gw(t.offsetX,e,r,n),t.cim.offsetY=Gw(t.offsetY,e,r,n),t.cim.rotation=Gw(t.rotation,e,r,n),t.cim.markerPlacement=t.markerPlacement,({analyzedCIM:o}=wS(t,e,r,n)),a=B(JSON.stringify(o)).toString(),l=this._embedCIMLayerInVectorMarker(o,h)}else{if("text"===t.type)return null;if("fill"===t.type){if("CIMHatchFill"===t.cim.type||"CIMVectorMarker"===t.cim.type||"CIMPictureMarker"===t.cim.type||"CIMPictureFill"===t.cim.type){const i=t.cim.size||t.cim.height;let s,l,u;if("CIMPictureMarker"===t.cim.type||"CIMPictureFill"===t.cim.type)({image:s,width:l,height:u}=this._getPictureResource(t,i));else{({analyzedCIM:o,hash:a}=wS(t,e,r,n));const i=this._rasterizer.rasterizeJSONResource(o,1,this._avoidSDF);s=i.image,l=i.size[0],u=i.size[1]}return this._rasterizePictureResource(t,s,l,u,h,null)}if("CIMSolidFill"!==t.cim.type)return null;({analyzedCIM:o,hash:a}=wS(t,e,r,n)),l=this._embedCIMLayerInVectorMarker(o,h)}}}else{if("text"===t.type)return u=this._rasterizeTextResource(t,e,s,r,n),u;({analyzedCIM:o,hash:a}=wS(t,e,r,n));const i=yS(s,t,null);if("CIMPictureMarker"===t.cim.type){const s=Gw(t.size,e,r,n)*i,{image:o,width:l,height:a}=this._getPictureResource(t,s);return u={image:o,size:[l,a],sdf:!1,simplePattern:!1,anchorX:t.anchorPoint?t.anchorPoint.x:0,anchorY:t.anchorPoint?t.anchorPoint.y:0},u}Yw(o,i,{preserveOutlineWidth:!1}),l=o}a+=i,s&&(a+=JSON.stringify(s));const h=this._resourceCache;return h.has(a)?h.get(a):(u=this._rasterizer.rasterizeJSONResource(l,window.devicePixelRatio||1,this._avoidSDF),h.set(a,u),u)}_rasterizeTextResource(t,e,i,s,r){const n=yS(i,t,null),o=Gw(t.text,e,s,r);if(!o||0===o.length)return null;const l=Gw(t.fontName,e,s,r),a=Gw(t.style,e,s,r),u=Gw(t.weight,e,s,r),h=Gw(t.decoration,e,s,r),c=Gw(t.size,e,s,r)*n,f=Gw(t.horizontalAlignment,e,s,r),d=Gw(t.verticalAlignment,e,s,r),p=qw(Gw(t.color,e,s,r)),y=qw(Gw(t.outlineColor,e,s,r)),m={color:p,size:c,horizontalAlignment:f,verticalAlignment:d,font:{family:l,style:a,weight:u,decoration:h},halo:{size:Gw(t.outlineSize,e,s,r)||0,color:y,style:a},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(o,m)}_rasterizePictureResource(t,e,i,s,r,n){const o=document.createElement("canvas"),l=o.getContext("2d");o.height=kh(Math.max(Math.abs(r.frame.ymax-r.frame.ymin),n)),o.width=kh(Math.abs(r.frame.xmax-r.frame.xmin));const a=l.createImageData(i,s);a.data.set(new Uint8ClampedArray(e.buffer));const u=this._imageDataToCanvas(a),h=l.createPattern(u,"repeat"),c=Math.cos((-t.cim.rotation||0)*Math.PI/180),f=Math.sin((-t.cim.rotation||0)*Math.PI/180);h.setTransform({m11:c,m12:f,m21:-f,m22:c,m41:kh(t.cim.offsetX)||0,m42:kh(t.cim.offsetY)||0});const d=r.canvasPaths;let p,y,m;cl(d)?(p=d.rings,l.fillStyle=h,y=l.fill,m=["evenodd"]):hl(d)&&(p=d.paths,l.strokeStyle=h,l.lineWidth=n,y=l.stroke,p[0][0][1]=o.height/2,p[0][1][1]=o.height/2),l.beginPath();for(const t of p){const e=t?t.length:0;if(e>1){let i=t[0];l.moveTo(kh(i[0]),kh(i[1]));for(let s=1;s<e;++s)i=t[s],l.lineTo(kh(i[0]),kh(i[1]));l.closePath()}}y.apply(l,m);const v=l.getImageData(0,0,o.width,o.height),w=new Uint8Array(v.data);return{size:[o.width,o.height],image:new Uint32Array(w.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(t,e){const i=this._pictureMarkerCache.get(t.materialHash);if(!i)return null;const s=i.height/i.width,r=e?s>1?kh(e):kh(e)/s:i.width,n=e?s>1?kh(e)*s:kh(e):i.height;return{image:this._imageTo32Array(i,r,n),width:r,height:n}}_embedCIMLayerInVectorMarker(t,e){const i=cl(e.geometry)?"CIMPolygonSymbol":"CIMLineSymbol";return{type:"CIMVectorMarker",frame:e.frame,markerGraphics:[{type:"CIMMarkerGraphic",geometry:e.geometry,symbol:{type:i,symbolLayers:[t]}}]}}}function wS(t,e,i,s){let r,n;return"function"==typeof t.materialHash?(r=(0,t.materialHash)(e,i,s),n=hS(t.cim,t.materialOverrides)):(r=t.materialHash,n=t.cim),{analyzedCIM:n,hash:r}}class bS{constructor(t){this.styleUrl=null,this.uiUrl=null,this.styleUrl=t.styleUrl,this.uiUrl=t.uiUrl,this._uiFieldCurrentValue=new Map,this._uiFieldCurrentDomain=new Map,this._dynamicSymbolFieldMap=new Map,this._dynamicUIFieldMap=new Map,this._uiFieldSubdomainsMap=new Map,this._uiFieldDefaultValueMap=new Map,this._groupExpandStatus=new Map,this._cimSymbolRasterizer=new vS(null,!0)}async fetchResources(){this.styleUrl=this.styleUrl;const[t,e]=await Promise.all([fetch(this.styleUrl+"/resources/styles/dictionary-info.json").then((t=>t.json())),fetch(this.uiUrl).then((t=>t.json()))]),i=t.authoringInfo;var s;this._configDomains=i.configuration,this._symbols=i.symbol,this._texts=i.text,this._domains=e.domains,this._symbolValueFromUIFields=e.symbolValueFromUIFields,this._uiFields=e.uiFields,this._renderer?this._fieldMap=this._renderer.fieldMap:(this._fieldMap=this._getDefaultFieldMap(this._symbols,this._texts),this._renderer=new Tw({url:this.styleUrl,fieldMap:this._fieldMap,config:this._getDefaultConfig(this._configDomains)})),this._reverseFieldMap=(s=this._fieldMap,Object.keys(s).reduce(((t,e)=>(t[s[e]]=e,t)),{}));let r=e.uiFieldsFromSymbolValues;const n=this._getUIFeatureFields(this._uiFields);let o=[];if(Object.keys(this._symbolValueFromUIFields).forEach((t=>{o.push(Sl.create(this._symbolValueFromUIFields[t],{wkid:102100},n,null,["$feature"]).then((e=>{this._dynamicSymbolFieldMap.set(t,e)})))})),o.push.apply(o,this._processUIFields(this._uiFields,{wkid:102100},n)),r){let t=[];Object.keys(this._fieldMap).forEach((e=>{r=r.split("$feature."+e).join("$feature."+this._fieldMap[e]),t.push({alias:"HAS_NO_ALIAS",editable:!0,length:-1,name:this._fieldMap[e],nullable:!0,type:"esriFieldTypeString"})})),o.push(Sl.create(r,{wkid:102100},t,null,["$feature"]).then((t=>{this._uiFieldsFromSymbolValues=t})))}return Promise.all(o)}getFeature(){const t={},e=this._getUIFeature();return this._symbols.forEach((i=>{t[this._fieldMap[i]]=this._symbolValueFromUIFields[i]?Uw(this._dynamicSymbolFieldMap.get(i),e,null,null,null):e.attributes[i]})),this._texts.forEach((i=>{t[this._fieldMap[i]]=e.attributes[i]})),{attributes:t}}async createPreviewImage(){const t=this.getFeature();return this._renderer.getSymbolAsync(t).then((e=>this._cimSymbolRasterizer.rasterizeCIMSymbolAsync(e,t,this._fieldMap,"esriGeometryPoint",{scaleFactor:1.5}))).then((t=>{const e=document.createElement("canvas");e.width=t.imageData.width,e.height=t.imageData.height,e.getContext("2d").putImageData(t.imageData,0,0);const i=new Image(e.width,e.height);return i.src=e.toDataURL(),i})).then((t=>t))}updateCurrentValue(t,e){this._uiFieldCurrentValue.set(t,e),this._resetSubdomainFields(t)}getUIFields(){return this.getUIFieldsInternal(this._uiFields)}getTreeNodeNamesByValue(t,e){let i=t;for(;i;){const t=[];if(t.push(i.name),i.code===e)return t;const s=this.getTreeNodeNamesByValue(i.children,e);if(s.length>0)return t.concat(s);i=i.peer}return[]}featureToUIFields(t){this._resetFields();const e=t.attributes;if(Object.keys(e).forEach((t=>{this._uiFieldCurrentValue.set(this._reverseFieldMap[t],e[t])})),this._uiFieldsFromSymbolValues){const e=Uw(this._uiFieldsFromSymbolValues,t,null,null,null),i=e?e.attributes:{};Object.keys(i).forEach((t=>{this._uiFieldCurrentValue.set(t,i[t])}))}}search(t){let e=[...this._uiFields];return this._searchUIFields(t,e,null)}_processUIFields(t,e,i){const s=[];return t.forEach((t=>{"group"===t.type&&(this._groupExpandStatus.set(t.key,"true"),s.push.apply(s,this._processUIFields(t.uiFields,e,i))),"expression"===t.type&&s.push(Sl.create(t.expression,e,i,null,["$feature"]).then((e=>{this._dynamicUIFieldMap.set(t.key,e)}))),t.default&&this._uiFieldDefaultValueMap.set(t.key,t.default)})),s}_getUIFeatureFields(t){let e=[];return t.forEach((t=>{"group"===t.type?e.push.apply(e,this._getUIFeatureFields(t.uiFields)):e.push({alias:"HAS_NO_ALIAS",editable:!0,length:-1,name:t.key,nullable:!0,type:"esriFieldTypeString"})})),e}_getDefaultFieldMap(t,e){const i={};return t&&t.forEach((t=>{i[t]=t})),e&&e.forEach((t=>{i[t]=t})),i}_getDefaultConfig(t){const e={};return t&&t.forEach((t=>{e[t.name]=t.value})),e}_initializeField(t,e,i){if(null!=i)return;const s=null!=t.default?t.default:this._uiFieldDefaultValueMap.get(t.key);this._uiFieldCurrentValue.set(t.key,null!=s?s:e.codedValues[0].code)}_resetFields(){this._uiFieldCurrentValue.clear(),this._uiFieldCurrentDomain.clear(),this._uiFieldSubdomainsMap.clear()}_resetSubdomainFields(t){this._uiFieldSubdomainsMap.has(t)&&this._uiFieldSubdomainsMap.get(t).forEach((t=>{this._uiFieldCurrentValue.set(t,null),this._resetSubdomainFields(t)}))}_getUIFeature(){const t={};return this._uiFieldCurrentValue.forEach(((e,i)=>{t[i]=e})),{attributes:t}}_searchUIFields(t,e,i){if(!e||0===e.length)return null;let s=[...e],r=new Array(5),n=-1/0;for(;s.length;){let e=s.pop();if("group"===e.type){s=[...e.uiFields,...s];continue}if("text"===e.type||"expression"===e.type||"inherit"===e.domain)continue;let o=this.getDomain(e.domain).codedValues;for(let s of o){let o=s.code,l=s.name,a=this._getQueryScore(t,l);const u={fieldKey:o,fieldValue:l,uiFieldName:e.name,uiFieldKey:e.key,score:a,parent:i};if(a>n&&(n=this._updateMaxScorer(u,r)),e.subdomains){const i=this._searchUIFields(t,e.subdomains[o],u);if(!i)continue;for(let t=0;t<i.length;t++)i[t]&&i[t].score>n&&(n=this._updateMaxScorer(i[t],r))}}}return r}_getQueryScore(t,e){let i=0,s=0,r=t.toLowerCase(),n=e.toLowerCase();for(let t=0;t<r.length;t++){let e=t,i=0;for(let t=0;t<n.length;t++)r[e]===n[t]&&(e++,i++);if(i>s&&(s=i),s===n.length)break}return i=s*s/(e.length>t.length?e.length:t.length),i}_updateMaxScorer(t,e){let i,s=1/0;for(let t=0;t<e.length;t++)if(e[t]&&e[t].score<s)s=e[t].score,i=t;else if(!e[t]){s=-1/0,i=t;break}return null!=i&&t.score>s&&(e[i]=t),s}getUIFieldsInternal(t){let e=[],i=[];t.forEach(((t,s)=>{if("group"===t.type){const i={type:"group",key:t.key,name:t.name,uiFields:[]};i.uiFields=this.getUIFieldsInternal(t.uiFields),e.push(i)}else if("expression"===t.type)e.push({type:"expression",key:t.key,name:t.name,expression:t.expression,value:""}),i.push(s);else if("text"===t.type&&"inherit"!==t.domain)e.push({type:t.type,name:t.name,key:t.key,domain:t.domain,value:this._uiFieldCurrentValue.get(t.key)});else{if(!("coded-value-domain"===t.type||t.domain.indexOf("$domains.")>-1))throw new Error("UIField type"+t.type+"is not supported.");{const i=t.subdomains,s=this.getDomain(t.domain);if(s&&!i){null==this._uiFieldCurrentValue.get(t.key)&&this._initializeField(t,s,null),this._uiFieldCurrentDomain.get(t.key)&&this._uiFieldCurrentDomain.delete(t.key);let i=null;if("nested-coded-value"===s.type){i={peer:null,children:null};for(let t=0;t<s.codedValues.length;t++){const e=s.codedValues[t],r=e.name.split(":");let n=i;for(let t=0;t<r.length;t++){const e=r[t].trim();n.children?n=this.findOrCreateTreeNode(n.children,e):n.code?(n.children={name:"Default",code:n.code,peer:{name:e,peer:null,children:null},children:null},n.code=null,n=n.children.peer):(n.children={name:e,peer:null,children:null},n=n.children)}n.code=e.code}}e.push({type:"coded-value-domain",key:t.key,name:t.name,domain:s,domainTree:i,value:this._uiFieldCurrentValue.get(t.key)})}s&&i&&e.push.apply(e,this.getUIFieldsFromDomainGroup(t))}}}));for(const t of i){const i=e[t];if("expression"!==i.type)continue;const s=i.key,r=Uw(this._dynamicUIFieldMap.get(s),this._getUIFeature(),null,null,null);i.value=r,this._uiFieldCurrentValue.set(s,r)}return e}findOrCreateTreeNode(t,e){let i=t;for(;i.name!==e;){if(!i.peer){i.peer={name:e,peer:null,children:null},i=i.peer;break}i=i.peer}return i}getUIFieldsFromDomainGroup(t){const e=[],i=t.key,s=this.getDomain(t.domain);let r=this._uiFieldCurrentDomain.get(i);const n=this._uiFieldCurrentValue.get(i);n&&r===t||(this._initializeField(t,s,n),this._uiFieldCurrentDomain.set(i,t));const o=t.subdomains[this._uiFieldCurrentValue.get(i)];return this._uiFieldSubdomainsMap.has(i)||this._uiFieldSubdomainsMap.set(i,new Set),e.push({type:"coded-value-domain",key:t.key,name:t.name,domain:s,value:this._uiFieldCurrentValue.get(i)}),o?(o.forEach((t=>{this._uiFieldSubdomainsMap.get(i).add(t.key)})),e.concat(this.getUIFieldsInternal(o))):e}getDomain(t){const e=t.split("$domains.")[1];return this._domains[e]}}const gS=class{constructor(i){t(this,i),this.symbolChanged=e(this,"symbolChanged",7),this._groupExpandStatus={},this._suggestionList=null,this.symbolObject={uiFields:null,previewImg:null,attributes:null}}watchHandler(t,e){t!==e&&(this.viewModel.featureToUIFields({attributes:t}),this._updateSymbolObject())}connectedCallback(){this._initializeViewModel()}_initializeViewModel(){this.viewModel=new bS({styleUrl:this.styleurl,uiUrl:this.uiurl}),this.viewModel.fetchResources().then((()=>(this.symbolAttributes&&this.viewModel.featureToUIFields({attributes:this.symbolAttributes}),this._updateSymbolObject())))}_updateSymbolObject(){const t=this.viewModel.getUIFields(),e=this.viewModel.getFeature().attributes;return this.viewModel.createPreviewImage().then((i=>{this.symbolObject={uiFields:t,previewImg:i,attributes:e},this.symbolChanged.emit(this.symbolObject)}))}_handleSearchBlur(t){t.target.value="",this._suggestionList=null}_handleInputChange(t){const e=t.target;this.viewModel.updateCurrentValue(e.parentElement.dataset.id,e.value),this._updateSymbolObject()}_handleTreeInputChange(t){const e=t.target,i=e.value;let s=e["data-tree"],r="",n=!1;for(;s;)if(s.name===i||n){if(null!=s.code){r=s.code;break}s=s.children,n=!0}else s=s.peer;this.viewModel.updateCurrentValue(e.parentElement.dataset.id,r),this._updateSymbolObject()}_handleGroupClick(t){let e=t.target.parentElement;"FIELDSET"!==e.tagName&&(e=e.parentElement);const i=Object.assign({},this._groupExpandStatus);i[e.dataset.id]="false"===e.ariaExpanded,this._groupExpandStatus=i}_handleSearchInputChange(t){this._suggestionList=this.viewModel.search(t.target.value)}_handleClickSuggest(t){const e=t.target,i=e["data-item"];let s=[i],r=i.parent;for(;r;)s.push(r),r=r.parent;for(;s.length;){let t=s.pop();this.viewModel.updateCurrentValue(t.uiFieldKey,t.fieldKey)}this._suggestionList=null,e.parentElement.parentElement.previousElementSibling.children[1].value="",this._updateSymbolObject()}renderSearchBox(t){return i("div",{class:"dictionary-symbol-browser-search-container"},i("div",{key:"searchInput",class:"searchInput","data-id":t},i("div",null,"Search"),i("input",{id:"searchFilter",onInput:this._handleSearchInputChange.bind(this),onBlur:this._handleSearchBlur.bind(this)})),this._suggestionList?this.renderSuggestionList():null)}renderSuggestionList(){let t=0;return i("div",{key:"suggestionList",class:"dictionary-symbol-browser-search-result"},i("ul",null,this._suggestionList.map((e=>i("li",{key:"listItem"+t++,"data-item":e,onMouseDown:this._handleClickSuggest.bind(this)},e.uiFieldName+":"+e.fieldValue)))))}renderForm(t){return i("div",{class:"dictionary-symbol-browser-form",key:"form"},i("form",null,this.renderUIFields(t)))}renderUIFields(t){return t.map((t=>"group"===t.type?this.renderGroup(t):"expression"===t.type?this.renderLabel(t,null,t.value):"text"===t.type?this.renderTextInput(t,t.value):"coded-value-domain"===t.type?this.renderLabel(t,t.domain):void 0))}renderGroup(t){const e=!1!==this._groupExpandStatus[t.key];return i("fieldset",{class:"dictionary-symbol-browser-group",key:t.key,"data-id":t.key,"aria-expanded":!1===e?"false":"true"},i("div",{class:"dictionary-symbol-browser-group-title",onClick:this._handleGroupClick.bind(this)},i("span",{class:e?"point-right":"point-down"},"> "),i("span",null,t.name)),i("div",{class:"dictionary-symbol-browser-group-fields"},e?this.renderUIFields(t.uiFields):null))}renderLabel(t,e,s){return i("label",{key:t.key,"data-id":t.key},t.name,s?i("p",null,s):"nested-coded-value"!==e.type?this.renderDropdown(e,t.value):this.renderDomainTree(t.domainTree,t.value))}renderDropdown(t,e){return t&&t&&t.codedValues?i("select",{onChange:this._handleInputChange.bind(this)},t.codedValues.map(((t,s)=>String(e)===""+t.code?i("option",{value:""+t.code,key:s,selected:!0},t.name):i("option",{value:""+t.code,key:s},t.name)))):i("input",null)}renderDomainTree(t,e){let s=t.children,r=this.viewModel.getTreeNodeNamesByValue(s,e),n=new Array(r.length);for(let t=0;t<n.length;t++){let e,i=r[t];for(;s;)s.name==i&&(e=s.children),n[t]||(n[t]=[]),n[t].push(s),s=s.peer;s=e}return n.map(((t,e)=>i("select",{onChange:this._handleTreeInputChange.bind(this),"data-tree":t[0],key:e},t.map(((t,s)=>String(r[e])===""+t.name?i("option",{value:""+t.name,key:s,selected:!0},t.name):i("option",{value:""+t.name,key:s},t.name))))))}renderTextInput(t,e){return i("label",{key:t.key,"data-id":t.key},t.name,i("input",{onKeyUp:this._handleInputChange.bind(this),value:e?String(e):null}))}renderPreview(){return i("div",{class:"dictionary-symbol-browser-preview",key:"preview"},i("label",null,"Preview"),i("img",{id:"previewImg",src:this.symbolObject.previewImg.src}))}render(){var t;return i("div",null,(null===(t=this.symbolObject)||void 0===t?void 0:t.previewImg)&&this.renderPreview(),this.symbolObject.uiFields&&this.renderSearchBox(this.symbolObject.uiFields),this.symbolObject.uiFields&&this.renderForm(this.symbolObject.uiFields))}static get watchers(){return{symbolAttributes:["watchHandler"]}}};gS.style=":host{display:block;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';height:100%}:host>div{height:100%;overflow:hidden}.dictionary-symbol-browser-preview{height:132px;margin:10px}.dictionary-symbol-browser-form{height:calc(100% - 220px);overflow-y:scroll;margin:10px}.dictionary-symbol-browser-search-container{height:50px;margin:10px}.dictionary-symbol-browser-preview img{display:block;margin:auto;max-height:100px}.dictionary-symbol-browser-group-fields{display:flex;flex-direction:column}.dictionary-symbol-browser-group-fields label{padding:5px}.point-right{cursor:pointer;transform:rotate(90deg) scaleY(1.5);-webkit-transform:rotate(90deg) scaleY(1.5);display:inline-block}.point-down{cursor:pointer;transform:rotate(0deg) scaleY(1.5);-webkit-transform:rotate(0deg) scaleY(1.5);display:inline-block}fieldset{border:none}label{display:flex;flex-direction:column;padding:5px}select{margin-top:3px;padding:5px}span{padding:3px}.dictionary-symbol-browser-search-result{background:white;position:absolute;z-index:1;border:gray}li{list-style:none;border:0.5px solid rgba(110, 110, 110, 0.3);padding:3px;font-size:0.9em;cursor:pointer}li:hover{background-color:rgba(110, 110, 110, 0.2);cursor:pointer}ul{padding-inline-start:0;margin-top:0;margin-bottom:0}input{margin-top:3px;padding:4px}";export{Ne as $,q as A,is as B,sl as C,s as D,Ut as E,vn as F,Fl as G,Ll as H,mt as I,Ml as J,ve as K,Wr as L,r as M,E as N,Zi as O,sy as P,Lh as Q,g as R,v as S,zi as T,ts as U,ns as V,qi as W,Ui as X,We as Y,eu as Z,$e as _,Io as a,cs as a$,H as a0,Ze as a1,De as a2,Be as a3,$ as a4,Qe as a5,Fe as a6,Ti as a7,Ya as a8,Qa as a9,yy as aA,ri as aB,My as aC,ty as aD,ui as aE,Fi as aF,be as aG,ae as aH,xv as aI,dl as aJ,yl as aK,$n as aL,zn as aM,rn as aN,ml as aO,Kl as aP,Yv as aQ,rl as aR,Mt as aS,Gr as aT,ap as aU,ph as aV,Fr as aW,He as aX,Bf as aY,us as aZ,zr as a_,Fs as aa,vy as ab,rs as ac,Ji as ad,Zh as ae,vc as af,xn as ag,Xi as ah,uy as ai,Rr as aj,Yi as ak,$i as al,Ai as am,pi as an,Cy as ao,Vy as ap,uv as aq,np as ar,cv as as,Jy as at,By as au,ii as av,_ as aw,Ke as ax,Br as ay,ot as az,M as b,Yl as b$,hs as b0,qr as b1,er as b2,Bt as b3,qv as b4,Hv as b5,Xs as b6,nr as b7,Ow as b8,vr as b9,kh as bA,nl as bB,Yt as bC,yt as bD,fv as bE,Uf as bF,ol as bG,z as bH,Gl as bI,Xl as bJ,Bl as bK,ad as bL,pv as bM,El as bN,Nl as bO,zl as bP,Ue as bQ,Ka as bR,Bv as bS,Ih as bT,Fa as bU,K as bV,kw as bW,Dd as bX,Qm as bY,Xc as bZ,Xu as b_,bi as ba,mi as bb,ti as bc,fn as bd,Jv as be,nn as bf,sn as bg,_n as bh,Kw as bi,Hs as bj,Bi as bk,j as bl,Qi as bm,Ki as bn,St as bo,Wa as bp,ut as bq,sw as br,Ch as bs,tw as bt,ew as bu,iw as bv,ls as bw,ow as bx,Oh as by,li as bz,bn as c,Do as c$,Tw as c0,mv as c1,av as c2,qa as c3,Jm as c4,wv as c5,wl as c6,O as c7,Zu as c8,Z as c9,on as cA,ln as cB,jv as cC,Iv as cD,Ov as cE,un as cF,cn as cG,Ra as cH,_a as cI,On as cJ,In as cK,ja as cL,Da as cM,yi as cN,En as cO,dn as cP,sb as cQ,Dn as cR,Wv as cS,Jo as cT,ll as cU,Jn as cV,po as cW,Dw as cX,Cw as cY,k as cZ,Zw as c_,op as ca,lv as cb,D as cc,qc as cd,Zl as ce,Hc as cf,nc as cg,Uc as ch,yv as ci,vv as cj,Ql as ck,Jl as cl,ev as cm,rv as cn,G as co,ds as cp,Mi as cq,eb as cr,Rn as cs,Hn as ct,tb as cu,Hi as cv,Vi as cw,ib as cx,Cn as cy,Cv as cz,I as d,ki as d$,Iw as d0,Oa as d1,Js as d2,Qs as d3,c as d4,Ea as d5,tr as d6,Ks as d7,ea as d8,ca as d9,Tc as dA,Ef as dB,Zc as dC,_i as dD,Af as dE,Zf as dF,Xf as dG,id as dH,C as dI,Ws as dJ,tt as dK,Av as dL,ey as dM,Sd as dN,lp as dO,$m as dP,mw as dQ,ss as dR,Gt as dS,Fu as dT,Lu as dU,hv as dV,Mh as dW,aw as dX,vt as dY,zu as dZ,Dt as d_,fa as da,ya as db,ma as dc,Ma as dd,gv as de,dr as df,A as dg,T as dh,R as di,gl as dj,es as dk,Gi as dl,N as dm,Wi as dn,Sr as dp,Tt as dq,Aa as dr,d as ds,f as dt,B as du,dh as dv,$c as dw,Dc as dx,Nc as dy,xa as dz,fo as e,cp as e0,si as e1,Vt as e2,pp as e3,Si as e4,$o as e5,Ee as e6,ei as e7,Yr as e8,Pv as e9,Hg as ea,Uw as eb,Bw as ec,Ta as ed,yg as ee,ob as ef,pg as eg,cb as eh,nb as ei,hS as ej,bl as ek,Bs as el,P as em,jh as en,Na as eo,Pa as ep,y as eq,m as er,p as es,Za as et,ni as eu,gS as ev,yu as ew,Nw as ex,il as f,Ja as g,Di as h,Ei as i,yc as j,h as k,W as l,ge as m,Eh as n,ul as o,fl as p,cl as q,hl as r,w as s,x as t,xo as u,al as v,qn as w,tl as x,mn as y,bo as z}