import{l as t}from"./p-dc4230e0.js";import{o as i}from"./p-098cc742.js";import{o as s}from"./p-f6aca36e.js";class n{constructor(t,i){this.x=t,this.y=i}clone(){return new n(this.x,this.y)}equals(t,i){return t===this.x&&i===this.y}isEqual(t){return t.x===this.x&&t.y===this.y}setCoords(t,i){this.x=t,this.y=i}normalize(){const t=this.x,i=this.y,s=Math.sqrt(t*t+i*i);this.x/=s,this.y/=s}rightPerpendicular(){const t=this.x;this.x=this.y,this.y=-t}move(t,i){this.x+=t,this.y+=i}assign(t){this.x=t.x,this.y=t.y}assignAdd(t,i){this.x=t.x+i.x,this.y=t.y+i.y}assignSub(t,i){this.x=t.x-i.x,this.y=t.y-i.y}rotate(t,i){const s=this.x,n=this.y;this.x=s*t-n*i,this.y=s*i+n*t}scale(t){this.x*=t,this.y*=t}length(){const t=this.x,i=this.y;return Math.sqrt(t*t+i*i)}static distance(t,i){const s=i.x-t.x,n=i.y-t.y;return Math.sqrt(s*s+n*n)}static add(t,i){return new n(t.x+i.x,t.y+i.y)}static sub(t,i){return new n(t.x-i.x,t.y-i.y)}}class h{constructor(t=0,i=0,s=0,n=0){this.x=t,this.y=i,this.width=s,this.height=n}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}const r=128/Math.PI;function e(t,i){return(t%=i)>=0?t:t+i}function u(t){return e(t*r,256)}function o(t){return e(.7111111111111111*t,256)}function f(t,i,s){return t>=i&&t<=s||t>=s&&t<=i}class l{constructor(t,i,s){this.ratio=t,this.x=i,this.y=s}}class c{constructor(t,i,n,h=8,r=8){this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=h,this.pixelMargin=r,this.tileSize=s*h,this.dz=t,this.yPos=i,this.xPos=n}setExtent(t){this.finalRatio=this.tileSize/t*(1<<this.dz);let i=this.pixelRatio*this.pixelMargin;i/=this.finalRatio;const s=t>>this.dz;i>s&&(i=s),this.margin=i,this.xmin=s*this.xPos-i,this.ymin=s*this.yPos-i,this.xmax=this.xmin+s+2*i,this.ymax=this.ymin+s+2*i}reset(t){this.type=t,this.lines=[],this.starts=[],this.line=null,this.start=0}moveTo(t,i){this._pushLine(),this._prevIsIn=this._isIn(t,i),this._moveTo(t,i,this._prevIsIn),this._prevPt=new n(t,i),this._firstPt=new n(t,i),this._dist=0}lineTo(t,i){const s=this._isIn(t,i),h=new n(t,i),r=n.distance(this._prevPt,h);let e,u,o,f,c,a,v,_;if(s)this._prevIsIn?this._lineTo(t,i,!0):(e=this._prevPt,u=h,o=this._intersect(u,e),this.start=this._dist+r*(1-this._r),this._lineTo(o.x,o.y,!0),this._lineTo(u.x,u.y,!0));else if(this._prevIsIn)u=this._prevPt,e=h,o=this._intersect(u,e),this._lineTo(o.x,o.y,!0),this._lineTo(e.x,e.y,!1);else{const t=this._prevPt,i=h;if(t.x<=this.xmin&&i.x<=this.xmin||t.x>=this.xmax&&i.x>=this.xmax||t.y<=this.ymin&&i.y<=this.ymin||t.y>=this.ymax&&i.y>=this.ymax)this._lineTo(i.x,i.y,!1);else{const s=[];if((t.x<this.xmin&&i.x>this.xmin||t.x>this.xmin&&i.x<this.xmin)&&(f=(this.xmin-t.x)/(i.x-t.x),_=t.y+f*(i.y-t.y),_<=this.ymin?a=!1:_>=this.ymax?a=!0:s.push(new l(f,this.xmin,_))),(t.x<this.xmax&&i.x>this.xmax||t.x>this.xmax&&i.x<this.xmax)&&(f=(this.xmax-t.x)/(i.x-t.x),_=t.y+f*(i.y-t.y),_<=this.ymin?a=!1:_>=this.ymax?a=!0:s.push(new l(f,this.xmax,_))),(t.y<this.ymin&&i.y>this.ymin||t.y>this.ymin&&i.y<this.ymin)&&(f=(this.ymin-t.y)/(i.y-t.y),v=t.x+f*(i.x-t.x),v<=this.xmin?c=!1:v>=this.xmax?c=!0:s.push(new l(f,v,this.ymin))),(t.y<this.ymax&&i.y>this.ymax||t.y>this.ymax&&i.y<this.ymax)&&(f=(this.ymax-t.y)/(i.y-t.y),v=t.x+f*(i.x-t.x),v<=this.xmin?c=!1:v>=this.xmax?c=!0:s.push(new l(f,v,this.ymax))),0===s.length)this._lineTo(c?this.xmax:this.xmin,a?this.ymax:this.ymin,!0);else if(s.length>1&&s[0].ratio>s[1].ratio)this.start=this._dist+r*s[1].ratio,this._lineTo(s[1].x,s[1].y,!0),this._lineTo(s[0].x,s[0].y,!0);else{this.start=this._dist+r*s[0].ratio;for(let t=0;t<s.length;t++)this._lineTo(s[t].x,s[t].y,!0)}this._lineTo(i.x,i.y,!1)}}this._dist+=r,this._prevIsIn=s,this._prevPt=h}close(){if(this.line.length>2){const t=this._firstPt,i=this._prevPt;t.x===i.x&&t.y===i.y||this.lineTo(t.x,t.y);const s=this.line;let n=s.length;for(;n>=4&&(s[0].x===s[1].x&&s[0].x===s[n-2].x||s[0].y===s[1].y&&s[0].y===s[n-2].y);)s.pop(),s[0].x=s[n-2].x,s[0].y=s[n-2].y,--n}}result(t=!0){return this._pushLine(),0===this.lines.length?null:(3===this.type&&t&&v.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}resultWithStarts(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();const t=this.lines,i=t.length;if(0===i)return null;const s=[];for(let n=0;n<i;n++)s.push({line:t[n],start:this.starts[n]||0});return s}_isIn(t,i){return t>=this.xmin&&t<=this.xmax&&i>=this.ymin&&i<=this.ymax}_intersect(t,i){let s,h,r;if(i.x>=this.xmin&&i.x<=this.xmax)h=i.y<=this.ymin?this.ymin:this.ymax,r=(h-t.y)/(i.y-t.y),s=t.x+r*(i.x-t.x);else if(i.y>=this.ymin&&i.y<=this.ymax)s=i.x<=this.xmin?this.xmin:this.xmax,r=(s-t.x)/(i.x-t.x),h=t.y+r*(i.y-t.y);else{h=i.y<=this.ymin?this.ymin:this.ymax,s=i.x<=this.xmin?this.xmin:this.xmax;const n=(s-t.x)/(i.x-t.x),e=(h-t.y)/(i.y-t.y);n<e?(r=n,h=t.y+n*(i.y-t.y)):(r=e,s=t.x+e*(i.x-t.x))}return this._r=r,new n(s,h)}_pushLine(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}_moveTo(t,i,s){3!==this.type?s&&(t=Math.round((t-(this.xmin+this.margin))*this.finalRatio),i=Math.round((i-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n(t,i))):(s||(t<this.xmin&&(t=this.xmin),t>this.xmax&&(t=this.xmax),i<this.ymin&&(i=this.ymin),i>this.ymax&&(i=this.ymax)),t=Math.round((t-(this.xmin+this.margin))*this.finalRatio),i=Math.round((i-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n(t,i)),this._is_h=!1,this._is_v=!1)}_lineTo(t,i,s){let h,r;if(3!==this.type)if(s){if(t=Math.round((t-(this.xmin+this.margin))*this.finalRatio),i=Math.round((i-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(h=this.line[this.line.length-1],h.equals(t,i)))return;this.line.push(new n(t,i))}else this.line&&this.line.length>0&&this._pushLine();else if(s||(t<this.xmin&&(t=this.xmin),t>this.xmax&&(t=this.xmax),i<this.ymin&&(i=this.ymin),i>this.ymax&&(i=this.ymax)),t=Math.round((t-(this.xmin+this.margin))*this.finalRatio),i=Math.round((i-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){h=this.line[this.line.length-1];const s=h.x===t,e=h.y===i;if(s&&e)return;this._is_h&&s||this._is_v&&e?(h.x=t,h.y=i,r=this.line[this.line.length-2],r.x===t&&r.y===i?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(r=this.line[this.line.length-2],this._is_h=r.x===t,this._is_v=r.y===i)):(this._is_h=r.x===t,this._is_v=r.y===i)):(this.line.push(new n(t,i)),this._is_h=s,this._is_v=e)}else this.line.push(new n(t,i))}}class a{setExtent(t){this._ratio=4096===t?1:4096/t}get validateTessellation(){return this._ratio<1}reset(t){this.lines=[],this.line=null}moveTo(t,i){this.line&&this.lines.push(this.line),this.line=[];const s=this._ratio;this.line.push(new n(t*s,i*s))}lineTo(t,i){const s=this._ratio;this.line.push(new n(t*s,i*s))}close(){const t=this.line;t&&!t[0].isEqual(t[t.length-1])&&t.push(t[0])}result(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:this.lines}}class v{static simplify(t,i,s){if(!s)return;const n=-i,h=t+i,r=-i,e=t+i,u=[],o=[],f=s.length;for(let t=0;t<f;++t){const i=s[t];if(!i||i.length<2)continue;let f,l=i[0];const c=i.length;for(let s=1;s<c;++s)f=i[s],l.x===f.x&&(l.x<=n&&(l.y>f.y?(u.push(t),u.push(s),u.push(0),u.push(-1)):(o.push(t),o.push(s),o.push(0),o.push(-1))),l.x>=h&&(l.y<f.y?(u.push(t),u.push(s),u.push(1),u.push(-1)):(o.push(t),o.push(s),o.push(1),o.push(-1)))),l.y===f.y&&(l.y<=r&&(l.x<f.x?(u.push(t),u.push(s),u.push(2),u.push(-1)):(o.push(t),o.push(s),o.push(2),o.push(-1))),l.y>=e&&(l.x>f.x?(u.push(t),u.push(s),u.push(3),u.push(-1)):(o.push(t),o.push(s),o.push(3),o.push(-1)))),l=f}if(0===u.length||0===o.length)return;v.fillParent(s,o,u),v.fillParent(s,u,o);const l=[];v.calcDeltas(l,o,u),v.calcDeltas(l,u,o),v.addDeltas(l,s)}static fillParent(t,i,s){const n=s.length,h=i.length;for(let r=0;r<h;r+=4){const h=i[r],e=i[r+1],u=i[r+2],o=t[h][e-1],l=t[h][e];let c=8092,a=-1;for(let i=0;i<n;i+=4){if(s[i+2]!==u)continue;const n=s[i],h=s[i+1],r=t[n][h-1],e=t[n][h];switch(u){case 0:case 1:if(f(o.y,r.y,e.y)&&f(l.y,r.y,e.y)){const t=Math.abs(e.y-r.y);t<c&&(c=t,a=i)}break;case 2:case 3:if(f(o.x,r.x,e.x)&&f(l.x,r.x,e.x)){const t=Math.abs(e.x-r.x);t<c&&(c=t,a=i)}}}i[r+3]=a}}static calcDeltas(t,i,s){const n=i.length;for(let h=0;h<n;h+=4){const n=v.calcDelta(h,i,s,[]);t.push(i[h]),t.push(i[h+1]),t.push(i[h+2]),t.push(n)}}static calcDelta(t,i,s,n){const h=i[t+3];if(-1===h)return 0;const r=n.length;return r>1&&n[r-2]===h?0:(n.push(h),v.calcDelta(h,s,i,n)+1)}static addDeltas(t,i){const s=t.length;let n=0;for(let i=0;i<s;i+=4){const s=t[i+3];s>n&&(n=s)}for(let h=0;h<s;h+=4){const s=i[t[h]],r=t[h+1],e=n-t[h+3];switch(t[h+2]){case 0:s[r-1].x-=e,s[r].x-=e,1===r&&(s[s.length-1].x-=e),r===s.length-1&&(s[0].x-=e);break;case 1:s[r-1].x+=e,s[r].x+=e,1===r&&(s[s.length-1].x+=e),r===s.length-1&&(s[0].x+=e);break;case 2:s[r-1].y-=e,s[r].y-=e,1===r&&(s[s.length-1].y-=e),r===s.length-1&&(s[0].y-=e);break;case 3:s[r-1].y+=e,s[r].y+=e,1===r&&(s[s.length-1].y+=e),r===s.length-1&&(s[0].y+=e)}}}}var _=i((function(t){var i;void 0!==(i=function(){var t={DEBUG:!1,assert:function(i,s){if(t.DEBUG&&!i)throw new Error("Assertion failed"+(s?": "+s:""))},GLU_TESS_MAX_COORD:1e150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};return t.geom.vertEq=function(t,i){return t.s===i.s&&t.t===i.t},t.geom.vertLeq=function(t,i){return t.s<i.s||t.s===i.s&&t.t<=i.t},t.geom.edgeEval=function(i,s,n){t.assert(t.geom.vertLeq(i,s)&&t.geom.vertLeq(s,n));var h=s.s-i.s,r=n.s-s.s;return h+r>0?h<r?s.t-i.t+h/(h+r)*(i.t-n.t):s.t-n.t+r/(h+r)*(n.t-i.t):0},t.geom.edgeSign=function(i,s,n){t.assert(t.geom.vertLeq(i,s)&&t.geom.vertLeq(s,n));var h=s.s-i.s,r=n.s-s.s;return h+r>0?(s.t-n.t)*h+(s.t-i.t)*r:0},t.geom.transLeq=function(t,i){return t.t<i.t||t.t===i.t&&t.s<=i.s},t.geom.transEval=function(i,s,n){t.assert(t.geom.transLeq(i,s)&&t.geom.transLeq(s,n));var h=s.t-i.t,r=n.t-s.t;return h+r>0?h<r?s.s-i.s+h/(h+r)*(i.s-n.s):s.s-n.s+r/(h+r)*(n.s-i.s):0},t.geom.transSign=function(i,s,n){t.assert(t.geom.transLeq(i,s)&&t.geom.transLeq(s,n));var h=s.t-i.t,r=n.t-s.t;return h+r>0?(s.s-n.s)*h+(s.s-i.s)*r:0},t.geom.edgeGoesLeft=function(i){return t.geom.vertLeq(i.dst(),i.org)},t.geom.edgeGoesRight=function(i){return t.geom.vertLeq(i.org,i.dst())},t.geom.vertL1dist=function(t,i){return Math.abs(t.s-i.s)+Math.abs(t.t-i.t)},t.geom.vertCCW=function(t,i,s){return t.s*(i.t-s.t)+i.s*(s.t-t.t)+s.s*(t.t-i.t)>=0},t.geom.interpolate_=function(t,i,s,n){return(t=t<0?0:t)<=(s=s<0?0:s)?0===s?(i+n)/2:i+t/(t+s)*(n-i):n+s/(t+s)*(i-n)},t.geom.edgeIntersect=function(i,s,n,h,r){var e,u,o;t.geom.vertLeq(i,s)||(o=i,i=s,s=o),t.geom.vertLeq(n,h)||(o=n,n=h,h=o),t.geom.vertLeq(i,n)||(o=i,i=n,n=o,o=s,s=h,h=o),t.geom.vertLeq(n,s)?t.geom.vertLeq(s,h)?((e=t.geom.edgeEval(i,n,s))+(u=t.geom.edgeEval(n,s,h))<0&&(e=-e,u=-u),r.s=t.geom.interpolate_(e,n.s,u,s.s)):((e=t.geom.edgeSign(i,n,s))+(u=-t.geom.edgeSign(i,h,s))<0&&(e=-e,u=-u),r.s=t.geom.interpolate_(e,n.s,u,h.s)):r.s=(n.s+s.s)/2,t.geom.transLeq(i,s)||(o=i,i=s,s=o),t.geom.transLeq(n,h)||(o=n,n=h,h=o),t.geom.transLeq(i,n)||(o=i,i=n,n=o,o=s,s=h,h=o),t.geom.transLeq(n,s)?t.geom.transLeq(s,h)?((e=t.geom.transEval(i,n,s))+(u=t.geom.transEval(n,s,h))<0&&(e=-e,u=-u),r.t=t.geom.interpolate_(e,n.t,u,s.t)):((e=t.geom.transSign(i,n,s))+(u=-t.geom.transSign(i,h,s))<0&&(e=-e,u=-u),r.t=t.geom.interpolate_(e,n.t,u,h.t)):r.t=(n.t+s.t)/2},t.mesh={},t.mesh.makeEdge=function(i){var s=t.mesh.makeEdgePair_(i.eHead);return t.mesh.makeVertex_(s,i.vHead),t.mesh.makeVertex_(s.sym,i.vHead),t.mesh.makeFace_(s,i.fHead),s},t.mesh.meshSplice=function(i,s){var n=!1,h=!1;i!==s&&(s.org!==i.org&&(h=!0,t.mesh.killVertex_(s.org,i.org)),s.lFace!==i.lFace&&(n=!0,t.mesh.killFace_(s.lFace,i.lFace)),t.mesh.splice_(s,i),h||(t.mesh.makeVertex_(s,i.org),i.org.anEdge=i),n||(t.mesh.makeFace_(s,i.lFace),i.lFace.anEdge=i))},t.mesh.deleteEdge=function(i){var s=i.sym,n=!1;i.lFace!==i.rFace()&&(n=!0,t.mesh.killFace_(i.lFace,i.rFace())),i.oNext===i?t.mesh.killVertex_(i.org,null):(i.rFace().anEdge=i.oPrev(),i.org.anEdge=i.oNext,t.mesh.splice_(i,i.oPrev()),n||t.mesh.makeFace_(i,i.lFace)),s.oNext===s?(t.mesh.killVertex_(s.org,null),t.mesh.killFace_(s.lFace,null)):(i.lFace.anEdge=s.oPrev(),s.org.anEdge=s.oNext,t.mesh.splice_(s,s.oPrev())),t.mesh.killEdge_(i)},t.mesh.addEdgeVertex=function(i){var s=t.mesh.makeEdgePair_(i),n=s.sym;return t.mesh.splice_(s,i.lNext),s.org=i.dst(),t.mesh.makeVertex_(n,s.org),s.lFace=n.lFace=i.lFace,s},t.mesh.splitEdge=function(i){var s=t.mesh.addEdgeVertex(i).sym;return t.mesh.splice_(i.sym,i.sym.oPrev()),t.mesh.splice_(i.sym,s),i.sym.org=s.org,s.dst().anEdge=s.sym,s.sym.lFace=i.rFace(),s.winding=i.winding,s.sym.winding=i.sym.winding,s},t.mesh.connect=function(i,s){var n=!1,h=t.mesh.makeEdgePair_(i),r=h.sym;return s.lFace!==i.lFace&&(n=!0,t.mesh.killFace_(s.lFace,i.lFace)),t.mesh.splice_(h,i.lNext),t.mesh.splice_(r,s),h.org=i.dst(),r.org=s.org,h.lFace=r.lFace=i.lFace,i.lFace.anEdge=r,n||t.mesh.makeFace_(h,i.lFace),h},t.mesh.zapFace=function(i){var s,n=i.anEdge,h=n.lNext;do{if(h=(s=h).lNext,s.lFace=null,null===s.rFace()){s.oNext===s?t.mesh.killVertex_(s.org,null):(s.org.anEdge=s.oNext,t.mesh.splice_(s,s.oPrev()));var r=s.sym;r.oNext===r?t.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,t.mesh.splice_(r,r.oPrev())),t.mesh.killEdge_(s)}}while(s!==n);var e=i.prev,u=i.next;u.prev=e,e.next=u},t.mesh.meshUnion=function(t,i){var s=t.fHead,n=t.vHead,h=t.eHead,r=i.fHead,e=i.vHead,u=i.eHead;return r.next!==r&&(s.prev.next=r.next,r.next.prev=s.prev,r.prev.next=s,s.prev=r.prev),e.next!==e&&(n.prev.next=e.next,e.next.prev=n.prev,e.prev.next=n,n.prev=e.prev),u.next!==u&&(h.sym.next.sym.next=u.next,u.next.sym.next=h.sym.next,u.sym.next.sym.next=h,h.sym.next=u.sym.next),t},t.mesh.deleteMesh=function(){},t.mesh.makeEdgePair_=function(i){var s=new t.GluHalfEdge,n=new t.GluHalfEdge,h=i.sym.next;return n.next=h,h.sym.next=s,s.next=i,i.sym.next=n,s.sym=n,s.oNext=s,s.lNext=n,n.sym=s,n.oNext=n,n.lNext=s,s},t.mesh.splice_=function(t,i){var s=t.oNext,n=i.oNext;s.sym.lNext=i,n.sym.lNext=t,t.oNext=n,i.oNext=s},t.mesh.makeVertex_=function(i,s){var n=s.prev,h=new t.GluVertex(s,n);n.next=h,s.prev=h,h.anEdge=i;var r=i;do{r.org=h,r=r.oNext}while(r!==i)},t.mesh.makeFace_=function(i,s){var n=s.prev,h=new t.GluFace(s,n);n.next=h,s.prev=h,h.anEdge=i,h.inside=s.inside;var r=i;do{r.lFace=h,r=r.lNext}while(r!==i)},t.mesh.killEdge_=function(t){var i=t.next,s=t.sym.next;i.sym.next=s,s.sym.next=i},t.mesh.killVertex_=function(t,i){var s=t.anEdge,n=s;do{n.org=i,n=n.oNext}while(n!==s);var h=t.prev,r=t.next;r.prev=h,h.next=r},t.mesh.killFace_=function(t,i){var s=t.anEdge,n=s;do{n.lFace=i,n=n.lNext}while(n!==s);var h=t.prev,r=t.next;r.prev=h,h.next=r},t.normal={},t.normal.S_UNIT_X_=1,t.normal.S_UNIT_Y_=0,t.normal.projectPolygon=function(i,s,n,h){var r=!1,e=[s,n,h];0===s&&0===n&&0===h&&(t.normal.computeNormal_(i,e),r=!0);var u,o=t.normal.longAxis_(e),f=i.mesh.vHead;if(t.TRUE_PROJECT){t.normal.normalize_(e);var l=[0,0,0],c=[0,0,0];l[o]=0,l[(o+1)%3]=t.normal.S_UNIT_X_,l[(o+2)%3]=t.normal.S_UNIT_Y_;var a=t.normal.dot_(l,e);for(l[0]-=a*e[0],l[1]-=a*e[1],l[2]-=a*e[2],t.normal.normalize_(l),c[0]=e[1]*l[2]-e[2]*l[1],c[1]=e[2]*l[0]-e[0]*l[2],c[2]=e[0]*l[1]-e[1]*l[0],t.normal.normalize_(c),u=f.next;u!==f;u=u.next)u.s=t.normal.dot_(u.coords,l),u.t=t.normal.dot_(u.coords,c)}else{var v=(o+1)%3,_=(o+2)%3,T=e[o]>0?1:-1;for(u=f.next;u!==f;u=u.next)u.s=u.coords[v],u.t=T*u.coords[_]}r&&t.normal.checkOrientation_(i)},t.normal.dot_=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},t.normal.normalize_=function(i){var s=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];t.assert(s>0),s=Math.sqrt(s),i[0]/=s,i[1]/=s,i[2]/=s},t.normal.longAxis_=function(t){var i=0;return Math.abs(t[1])>Math.abs(t[0])&&(i=1),Math.abs(t[2])>Math.abs(t[i])&&(i=2),i},t.normal.computeNormal_=function(i,s){var n,h=[-2*t.GLU_TESS_MAX_COORD,-2*t.GLU_TESS_MAX_COORD,-2*t.GLU_TESS_MAX_COORD],r=[2*t.GLU_TESS_MAX_COORD,2*t.GLU_TESS_MAX_COORD,2*t.GLU_TESS_MAX_COORD],e=[],u=[],o=i.mesh.vHead;for(n=o.next;n!==o;n=n.next)for(var f=0;f<3;++f){var l=n.coords[f];l<r[f]&&(r[f]=l,u[f]=n),l>h[f]&&(h[f]=l,e[f]=n)}var c=0;if(h[1]-r[1]>h[0]-r[0]&&(c=1),h[2]-r[2]>h[c]-r[c]&&(c=2),r[c]>=h[c])return s[0]=0,s[1]=0,void(s[2]=1);var a=0,v=u[c],_=e[c],T=[0,0,0],L=[v.coords[0]-_.coords[0],v.coords[1]-_.coords[1],v.coords[2]-_.coords[2]],d=[0,0,0];for(n=o.next;n!==o;n=n.next){d[0]=n.coords[0]-_.coords[0],d[1]=n.coords[1]-_.coords[1],d[2]=n.coords[2]-_.coords[2],T[0]=L[1]*d[2]-L[2]*d[1],T[1]=L[2]*d[0]-L[0]*d[2],T[2]=L[0]*d[1]-L[1]*d[0];var E=T[0]*T[0]+T[1]*T[1]+T[2]*T[2];E>a&&(a=E,s[0]=T[0],s[1]=T[1],s[2]=T[2])}a<=0&&(s[0]=s[1]=s[2]=0,s[t.normal.longAxis_(L)]=1)},t.normal.checkOrientation_=function(t){for(var i=0,s=t.mesh.fHead,n=s.next;n!==s;n=n.next){var h=n.anEdge;if(!(h.winding<=0))do{i+=(h.org.s-h.dst().s)*(h.org.t+h.dst().t),h=h.lNext}while(h!==n.anEdge)}if(i<0)for(var r=t.mesh.vHead,e=r.next;e!==r;e=e.next)e.t=-e.t},t.render={},t.render.renderMesh=function(i,s,n){for(var h=!1,r=-1,e=s.fHead.prev;e!==s.fHead;e=e.prev)if(e.inside){h||(i.callBeginCallback(t.primitiveType.GL_TRIANGLES),h=!0);var u=e.anEdge;t.assert(u.lNext.lNext.lNext===u,"renderMesh called with non-triangulated mesh");do{if(n){var o=u.rFace().inside?0:1;r!==o&&i.callEdgeFlagCallback(!!(r=o))}i.callVertexCallback(u.org.data),u=u.lNext}while(u!==e.anEdge)}h&&i.callEndCallback()},t.render.renderBoundary=function(i,s){for(var n=s.fHead.next;n!==s.fHead;n=n.next)if(n.inside){i.callBeginCallback(t.primitiveType.GL_LINE_LOOP);var h=n.anEdge;do{i.callVertexCallback(h.org.data),h=h.lNext}while(h!==n.anEdge);i.callEndCallback()}},t.sweep={},t.sweep.SENTINEL_COORD_=4*t.GLU_TESS_MAX_COORD,t.sweep.TOLERANCE_NONZERO_=!1,t.sweep.computeInterior=function(i){var s;for(i.fatalError=!1,t.sweep.removeDegenerateEdges_(i),t.sweep.initPriorityQ_(i),t.sweep.initEdgeDict_(i);null!==(s=i.pq.extractMin());){for(;;){var n=i.pq.minimum();if(null===n||!t.geom.vertEq(n,s))break;n=i.pq.extractMin(),t.sweep.spliceMergeVertices_(i,s.anEdge,n.anEdge)}t.sweep.sweepEvent_(i,s)}var h=i.dict.getMin().getKey();i.event=h.eUp.org,t.sweep.doneEdgeDict_(i),t.sweep.donePriorityQ_(i),t.sweep.removeDegenerateFaces_(i.mesh),i.mesh.checkMesh()},t.sweep.addWinding_=function(t,i){t.winding+=i.winding,t.sym.winding+=i.sym.winding},t.sweep.edgeLeq_=function(i,s,n){var h=i.event,r=s.eUp,e=n.eUp;return r.dst()===h?e.dst()===h?t.geom.vertLeq(r.org,e.org)?t.geom.edgeSign(e.dst(),r.org,e.org)<=0:t.geom.edgeSign(r.dst(),e.org,r.org)>=0:t.geom.edgeSign(e.dst(),h,e.org)<=0:e.dst()===h?t.geom.edgeSign(r.dst(),h,r.org)>=0:t.geom.edgeEval(r.dst(),h,r.org)>=t.geom.edgeEval(e.dst(),h,e.org)},t.sweep.deleteRegion_=function(i,s){s.fixUpperEdge&&t.assert(0===s.eUp.winding),s.eUp.activeRegion=null,i.dict.deleteNode(s.nodeUp),s.nodeUp=null},t.sweep.fixUpperEdge_=function(i,s){t.assert(i.fixUpperEdge),t.mesh.deleteEdge(i.eUp),i.fixUpperEdge=!1,i.eUp=s,s.activeRegion=i},t.sweep.topLeftRegion_=function(i){var s=i.eUp.org;do{i=i.regionAbove()}while(i.eUp.org===s);if(i.fixUpperEdge){var n=t.mesh.connect(i.regionBelow().eUp.sym,i.eUp.lNext);t.sweep.fixUpperEdge_(i,n),i=i.regionAbove()}return i},t.sweep.topRightRegion_=function(t){var i=t.eUp.dst();do{t=t.regionAbove()}while(t.eUp.dst()===i);return t},t.sweep.addRegionBelow_=function(i,s,n){var h=new t.ActiveRegion;return h.eUp=n,h.nodeUp=i.dict.insertBefore(s.nodeUp,h),n.activeRegion=h,h},t.sweep.isWindingInside_=function(i,s){switch(i.windingRule){case t.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&s);case t.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==s;case t.windingRule.GLU_TESS_WINDING_POSITIVE:return s>0;case t.windingRule.GLU_TESS_WINDING_NEGATIVE:return s<0;case t.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return s>=2||s<=-2}return t.assert(!1),!1},t.sweep.computeWinding_=function(i,s){s.windingNumber=s.regionAbove().windingNumber+s.eUp.winding,s.inside=t.sweep.isWindingInside_(i,s.windingNumber)},t.sweep.finishRegion_=function(i,s){var n=s.eUp,h=n.lFace;h.inside=s.inside,h.anEdge=n,t.sweep.deleteRegion_(i,s)},t.sweep.finishLeftRegions_=function(i,s,n){for(var h=s,r=s.eUp;h!==n;){h.fixUpperEdge=!1;var e=h.regionBelow(),u=e.eUp;if(u.org!==r.org){if(!e.fixUpperEdge){t.sweep.finishRegion_(i,h);break}u=t.mesh.connect(r.lPrev(),u.sym),t.sweep.fixUpperEdge_(e,u)}r.oNext!==u&&(t.mesh.meshSplice(u.oPrev(),u),t.mesh.meshSplice(r,u)),t.sweep.finishRegion_(i,h),r=e.eUp,h=e}return r},t.sweep.addRightEdges_=function(i,s,n,h,r,e){var u=!0,o=n;do{t.assert(t.geom.vertLeq(o.org,o.dst())),t.sweep.addRegionBelow_(i,s,o.sym),o=o.oNext}while(o!==h);null===r&&(r=s.regionBelow().eUp.rPrev());for(var f,l=s,c=r;(o=(f=l.regionBelow()).eUp.sym).org===c.org;)o.oNext!==c&&(t.mesh.meshSplice(o.oPrev(),o),t.mesh.meshSplice(c.oPrev(),o)),f.windingNumber=l.windingNumber-o.winding,f.inside=t.sweep.isWindingInside_(i,f.windingNumber),l.dirty=!0,!u&&t.sweep.checkForRightSplice_(i,l)&&(t.sweep.addWinding_(o,c),t.sweep.deleteRegion_(i,l),t.mesh.deleteEdge(c)),u=!1,l=f,c=o;l.dirty=!0,t.assert(l.windingNumber-o.winding===f.windingNumber),e&&t.sweep.walkDirtyRegions_(i,l)},t.sweep.callCombine_=function(i,s,n,h,r){var e=[s.coords[0],s.coords[1],s.coords[2]];s.data=null,s.data=i.callCombineCallback(e,n,h),null===s.data&&(r?i.fatalError||(i.callErrorCallback(t.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),i.fatalError=!0):s.data=n[0])},t.sweep.spliceMergeVertices_=function(i,s,n){var h=[null,null,null,null];h[0]=s.org.data,h[1]=n.org.data,t.sweep.callCombine_(i,s.org,h,[.5,.5,0,0],!1),t.mesh.meshSplice(s,n)},t.sweep.vertexWeights_=function(i,s,n,h,r){var e=t.geom.vertL1dist(s,i),u=t.geom.vertL1dist(n,i),o=r,f=r+1;h[o]=.5*u/(e+u),h[f]=.5*e/(e+u),i.coords[0]+=h[o]*s.coords[0]+h[f]*n.coords[0],i.coords[1]+=h[o]*s.coords[1]+h[f]*n.coords[1],i.coords[2]+=h[o]*s.coords[2]+h[f]*n.coords[2]},t.sweep.getIntersectData_=function(i,s,n,h,r,e){var u=[0,0,0,0],o=[n.data,h.data,r.data,e.data];s.coords[0]=s.coords[1]=s.coords[2]=0,t.sweep.vertexWeights_(s,n,h,u,0),t.sweep.vertexWeights_(s,r,e,u,2),t.sweep.callCombine_(i,s,o,u,!0)},t.sweep.checkForRightSplice_=function(i,s){var n=s.regionBelow(),h=s.eUp,r=n.eUp;if(t.geom.vertLeq(h.org,r.org)){if(t.geom.edgeSign(r.dst(),h.org,r.org)>0)return!1;t.geom.vertEq(h.org,r.org)?h.org!==r.org&&(i.pq.remove(h.org.pqHandle),t.sweep.spliceMergeVertices_(i,r.oPrev(),h)):(t.mesh.splitEdge(r.sym),t.mesh.meshSplice(h,r.oPrev()),s.dirty=n.dirty=!0)}else{if(t.geom.edgeSign(h.dst(),r.org,h.org)<0)return!1;s.regionAbove().dirty=s.dirty=!0,t.mesh.splitEdge(h.sym),t.mesh.meshSplice(r.oPrev(),h)}return!0},t.sweep.checkForLeftSplice_=function(i,s){var n,h=s.regionBelow(),r=s.eUp,e=h.eUp;if(t.assert(!t.geom.vertEq(r.dst(),e.dst())),t.geom.vertLeq(r.dst(),e.dst())){if(t.geom.edgeSign(r.dst(),e.dst(),r.org)<0)return!1;s.regionAbove().dirty=s.dirty=!0,n=t.mesh.splitEdge(r),t.mesh.meshSplice(e.sym,n),n.lFace.inside=s.inside}else{if(t.geom.edgeSign(e.dst(),r.dst(),e.org)>0)return!1;s.dirty=h.dirty=!0,n=t.mesh.splitEdge(e),t.mesh.meshSplice(r.lNext,e.sym),n.rFace().inside=s.inside}return!0},t.sweep.checkForIntersect_=function(i,s){var n=s.regionBelow(),h=s.eUp,r=n.eUp,e=h.org,u=r.org,o=h.dst(),f=r.dst(),l=new t.GluVertex;if(t.assert(!t.geom.vertEq(f,o)),t.assert(t.geom.edgeSign(o,i.event,e)<=0),t.assert(t.geom.edgeSign(f,i.event,u)>=0),t.assert(e!==i.event&&u!==i.event),t.assert(!s.fixUpperEdge&&!n.fixUpperEdge),e===u)return!1;if(Math.min(e.t,o.t)>Math.max(u.t,f.t))return!1;if(t.geom.vertLeq(e,u)){if(t.geom.edgeSign(f,e,u)>0)return!1}else if(t.geom.edgeSign(o,u,e)<0)return!1;t.geom.edgeIntersect(o,e,f,u,l),t.assert(Math.min(e.t,o.t)<=l.t),t.assert(l.t<=Math.max(u.t,f.t)),t.assert(Math.min(f.s,o.s)<=l.s),t.assert(l.s<=Math.max(u.s,e.s)),t.geom.vertLeq(l,i.event)&&(l.s=i.event.s,l.t=i.event.t);var c=t.geom.vertLeq(e,u)?e:u;if(t.geom.vertLeq(c,l)&&(l.s=c.s,l.t=c.t),t.geom.vertEq(l,e)||t.geom.vertEq(l,u))return t.sweep.checkForRightSplice_(i,s),!1;if(!t.geom.vertEq(o,i.event)&&t.geom.edgeSign(o,i.event,l)>=0||!t.geom.vertEq(f,i.event)&&t.geom.edgeSign(f,i.event,l)<=0){if(f===i.event)return t.mesh.splitEdge(h.sym),t.mesh.meshSplice(r.sym,h),h=(s=t.sweep.topLeftRegion_(s)).regionBelow().eUp,t.sweep.finishLeftRegions_(i,s.regionBelow(),n),t.sweep.addRightEdges_(i,s,h.oPrev(),h,h,!0),!0;if(o===i.event){t.mesh.splitEdge(r.sym),t.mesh.meshSplice(h.lNext,r.oPrev()),n=s;var a=(s=t.sweep.topRightRegion_(s)).regionBelow().eUp.rPrev();return n.eUp=r.oPrev(),r=t.sweep.finishLeftRegions_(i,n,null),t.sweep.addRightEdges_(i,s,r.oNext,h.rPrev(),a,!0),!0}return t.geom.edgeSign(o,i.event,l)>=0&&(s.regionAbove().dirty=s.dirty=!0,t.mesh.splitEdge(h.sym),h.org.s=i.event.s,h.org.t=i.event.t),t.geom.edgeSign(f,i.event,l)<=0&&(s.dirty=n.dirty=!0,t.mesh.splitEdge(r.sym),r.org.s=i.event.s,r.org.t=i.event.t),!1}return t.mesh.splitEdge(h.sym),t.mesh.splitEdge(r.sym),t.mesh.meshSplice(r.oPrev(),h),h.org.s=l.s,h.org.t=l.t,h.org.pqHandle=i.pq.insert(h.org),t.sweep.getIntersectData_(i,h.org,e,o,u,f),s.regionAbove().dirty=s.dirty=n.dirty=!0,!1},t.sweep.walkDirtyRegions_=function(i,s){for(var n=s.regionBelow();;){for(;n.dirty;)s=n,n=n.regionBelow();if(!s.dirty&&(n=s,null===(s=s.regionAbove())||!s.dirty))return;s.dirty=!1;var h=s.eUp,r=n.eUp;if(h.dst()!==r.dst()&&t.sweep.checkForLeftSplice_(i,s)&&(n.fixUpperEdge?(t.sweep.deleteRegion_(i,n),t.mesh.deleteEdge(r),r=(n=s.regionBelow()).eUp):s.fixUpperEdge&&(t.sweep.deleteRegion_(i,s),t.mesh.deleteEdge(h),h=(s=n.regionAbove()).eUp)),h.org!==r.org)if(h.dst()===r.dst()||s.fixUpperEdge||n.fixUpperEdge||h.dst()!==i.event&&r.dst()!==i.event)t.sweep.checkForRightSplice_(i,s);else if(t.sweep.checkForIntersect_(i,s))return;h.org===r.org&&h.dst()===r.dst()&&(t.sweep.addWinding_(r,h),t.sweep.deleteRegion_(i,s),t.mesh.deleteEdge(h),s=n.regionAbove())}},t.sweep.connectRightVertex_=function(i,s,n){var h,r=n.oNext,e=s.regionBelow(),u=s.eUp,o=e.eUp,f=!1;u.dst()!==o.dst()&&t.sweep.checkForIntersect_(i,s),t.geom.vertEq(u.org,i.event)&&(t.mesh.meshSplice(r.oPrev(),u),r=(s=t.sweep.topLeftRegion_(s)).regionBelow().eUp,t.sweep.finishLeftRegions_(i,s.regionBelow(),e),f=!0),t.geom.vertEq(o.org,i.event)&&(t.mesh.meshSplice(n,o.oPrev()),n=t.sweep.finishLeftRegions_(i,e,null),f=!0),f?t.sweep.addRightEdges_(i,s,n.oNext,r,r,!0):(h=t.geom.vertLeq(o.org,u.org)?o.oPrev():u,h=t.mesh.connect(n.lPrev(),h),t.sweep.addRightEdges_(i,s,h,h.oNext,h.oNext,!1),h.sym.activeRegion.fixUpperEdge=!0,t.sweep.walkDirtyRegions_(i,s))},t.sweep.connectLeftDegenerate_=function(i,s,n){var h=s.eUp;if(t.geom.vertEq(h.org,n))return t.assert(t.sweep.TOLERANCE_NONZERO_),void(t.sweep.TOLERANCE_NONZERO_&&t.sweep.spliceMergeVertices_(i,h,n.anEdge));if(!t.geom.vertEq(h.dst(),n))return t.mesh.splitEdge(h.sym),s.fixUpperEdge&&(t.mesh.deleteEdge(h.oNext),s.fixUpperEdge=!1),t.mesh.meshSplice(n.anEdge,h),void t.sweep.sweepEvent_(i,n);if(t.assert(t.sweep.TOLERANCE_NONZERO_),t.sweep.TOLERANCE_NONZERO_){var r=(s=t.sweep.topRightRegion_(s)).regionBelow(),e=r.eUp.sym,u=e.oNext,o=u;r.fixUpperEdge&&(t.assert(u!==e),t.sweep.deleteRegion_(i,r),t.mesh.deleteEdge(e),e=u.oPrev()),t.mesh.meshSplice(n.anEdge,e),t.geom.edgeGoesLeft(u)||(u=null),t.sweep.addRightEdges_(i,s,e.oNext,o,u,!0)}},t.sweep.connectLeftVertex_=function(i,s){var n=new t.ActiveRegion;n.eUp=s.anEdge.sym;var h=i.dict.search(n).getKey(),r=h.regionBelow(),e=h.eUp,u=r.eUp;if(0!==t.geom.edgeSign(e.dst(),s,e.org)){var o,f=t.geom.vertLeq(u.dst(),e.dst())?h:r;h.inside||f.fixUpperEdge?(o=f===h?t.mesh.connect(s.anEdge.sym,e.lNext):t.mesh.connect(u.dNext(),s.anEdge).sym,f.fixUpperEdge?t.sweep.fixUpperEdge_(f,o):t.sweep.computeWinding_(i,t.sweep.addRegionBelow_(i,h,o)),t.sweep.sweepEvent_(i,s)):t.sweep.addRightEdges_(i,h,s.anEdge,s.anEdge,null,!0)}else t.sweep.connectLeftDegenerate_(i,h,s)},t.sweep.sweepEvent_=function(i,s){i.event=s;for(var n=s.anEdge;null===n.activeRegion;)if((n=n.oNext)===s.anEdge)return void t.sweep.connectLeftVertex_(i,s);var h=t.sweep.topLeftRegion_(n.activeRegion),r=h.regionBelow(),e=r.eUp,u=t.sweep.finishLeftRegions_(i,r,null);u.oNext===e?t.sweep.connectRightVertex_(i,h,u):t.sweep.addRightEdges_(i,h,u.oNext,e,e,!0)},t.sweep.addSentinel_=function(i,s){var n=new t.ActiveRegion,h=t.mesh.makeEdge(i.mesh);h.org.s=t.sweep.SENTINEL_COORD_,h.org.t=s,h.dst().s=-t.sweep.SENTINEL_COORD_,h.dst().t=s,i.event=h.dst(),n.eUp=h,n.windingNumber=0,n.inside=!1,n.fixUpperEdge=!1,n.sentinel=!0,n.dirty=!1,n.nodeUp=i.dict.insert(n)},t.sweep.initEdgeDict_=function(i){i.dict=new t.Dict(i,t.sweep.edgeLeq_),t.sweep.addSentinel_(i,-t.sweep.SENTINEL_COORD_),t.sweep.addSentinel_(i,t.sweep.SENTINEL_COORD_)},t.sweep.doneEdgeDict_=function(i){for(var s,n=0;null!==(s=i.dict.getMin().getKey());)s.sentinel||(t.assert(s.fixUpperEdge),t.assert(1==++n)),t.assert(0===s.windingNumber),t.sweep.deleteRegion_(i,s);i.dict=null},t.sweep.removeDegenerateEdges_=function(i){for(var s,n=i.mesh.eHead,h=n.next;h!==n;h=s){s=h.next;var r=h.lNext;t.geom.vertEq(h.org,h.dst())&&h.lNext.lNext!==h&&(t.sweep.spliceMergeVertices_(i,r,h),t.mesh.deleteEdge(h),r=(h=r).lNext),r.lNext===h&&(r!==h&&(r!==s&&r!==s.sym||(s=s.next),t.mesh.deleteEdge(r)),h!==s&&h!==s.sym||(s=s.next),t.mesh.deleteEdge(h))}},t.sweep.initPriorityQ_=function(i){var s=new t.PriorityQ;i.pq=s;var n,h=i.mesh.vHead;for(n=h.next;n!==h;n=n.next)n.pqHandle=s.insert(n);s.init()},t.sweep.donePriorityQ_=function(t){t.pq.deleteQ(),t.pq=null},t.sweep.removeDegenerateFaces_=function(i){for(var s,n=i.fHead.next;n!==i.fHead;n=s){s=n.next;var h=n.anEdge;t.assert(h.lNext!==h),h.lNext.lNext===h&&(t.sweep.addWinding_(h.oNext,h),t.mesh.deleteEdge(h))}},t.tessmono={},t.tessmono.tessellateMonoRegion_=function(i){var s=i.anEdge;for(t.assert(s.lNext!==s&&s.lNext.lNext!==s);t.geom.vertLeq(s.dst(),s.org);s=s.lPrev());for(;t.geom.vertLeq(s.org,s.dst());s=s.lNext);for(var n,h=s.lPrev();s.lNext!==h;)if(t.geom.vertLeq(s.dst(),h.org)){for(;h.lNext!==s&&(t.geom.edgeGoesLeft(h.lNext)||t.geom.edgeSign(h.org,h.dst(),h.lNext.dst())<=0);)h=(n=t.mesh.connect(h.lNext,h)).sym;h=h.lPrev()}else{for(;h.lNext!==s&&(t.geom.edgeGoesRight(s.lPrev())||t.geom.edgeSign(s.dst(),s.org,s.lPrev().org)>=0);)n=t.mesh.connect(s,s.lPrev()),s=n.sym;s=s.lNext}for(t.assert(h.lNext!==s);h.lNext.lNext!==s;)h=(n=t.mesh.connect(h.lNext,h)).sym},t.tessmono.tessellateInterior=function(i){for(var s,n=i.fHead.next;n!==i.fHead;n=s)s=n.next,n.inside&&t.tessmono.tessellateMonoRegion_(n)},t.tessmono.discardExterior=function(i){for(var s,n=i.fHead.next;n!==i.fHead;n=s)s=n.next,n.inside||t.mesh.zapFace(n)},t.tessmono.setWindingNumber=function(i,s,n){for(var h,r=i.eHead.next;r!==i.eHead;r=h)h=r.next,r.rFace().inside!==r.lFace.inside?r.winding=r.lFace.inside?s:-s:n?t.mesh.deleteEdge(r):r.winding=0},t.Dict=function(i,s){this.head_=new t.DictNode,this.frame_=i,this.leq_=s},t.Dict.prototype.deleteDict_=function(){},t.Dict.prototype.insertBefore=function(i,s){do{i=i.prev}while(null!==i.key&&!this.leq_(this.frame_,i.key,s));var n=new t.DictNode(s,i.next,i);return i.next.prev=n,i.next=n,n},t.Dict.prototype.insert=function(t){return this.insertBefore(this.head_,t)},t.Dict.prototype.deleteNode=function(t){t.next.prev=t.prev,t.prev.next=t.next},t.Dict.prototype.search=function(t){var i=this.head_;do{i=i.next}while(null!==i.key&&!this.leq_(this.frame_,t,i.key));return i},t.Dict.prototype.getMin=function(){return this.head_.next},t.Dict.prototype.getMax=function(){return this.head_.prev},t.DictNode=function(t,i,s){this.key=t||null,this.next=i||this,this.prev=s||this},t.DictNode.prototype.getKey=function(){return this.key},t.DictNode.prototype.getSuccessor=function(){return this.next},t.DictNode.prototype.getPredecessor=function(){return this.prev},t.GluTesselator=function(){this.state_=t.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=t.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},t.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},t.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(t.GluTesselator.tessState_.T_DORMANT)},t.GluTesselator.prototype.gluTessProperty=function(i,s){switch(i){case t.gluEnum.GLU_TESS_TOLERANCE:return;case t.gluEnum.GLU_TESS_WINDING_RULE:var n=s;switch(n){case t.windingRule.GLU_TESS_WINDING_ODD:case t.windingRule.GLU_TESS_WINDING_NONZERO:case t.windingRule.GLU_TESS_WINDING_POSITIVE:case t.windingRule.GLU_TESS_WINDING_NEGATIVE:case t.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=n)}break;case t.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!s);default:return void this.callErrorCallback(t.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(t.gluEnum.GLU_INVALID_VALUE)},t.GluTesselator.prototype.gluGetTessProperty=function(i){switch(i){case t.gluEnum.GLU_TESS_TOLERANCE:return 0;case t.gluEnum.GLU_TESS_WINDING_RULE:var s=this.windingRule;return t.assert(s===t.windingRule.GLU_TESS_WINDING_ODD||s===t.windingRule.GLU_TESS_WINDING_NONZERO||s===t.windingRule.GLU_TESS_WINDING_POSITIVE||s===t.windingRule.GLU_TESS_WINDING_NEGATIVE||s===t.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),s;case t.gluEnum.GLU_TESS_BOUNDARY_ONLY:return t.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(t.gluEnum.GLU_INVALID_ENUM)}return!1},t.GluTesselator.prototype.gluTessNormal=function(t,i,s){this.normal_[0]=t,this.normal_[1]=i,this.normal_[2]=s},t.GluTesselator.prototype.gluTessCallback=function(i,s){var n=s||null;switch(i){case t.gluEnum.GLU_TESS_BEGIN:case t.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=n);case t.gluEnum.GLU_TESS_EDGE_FLAG:case t.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=n);case t.gluEnum.GLU_TESS_VERTEX:case t.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=n);case t.gluEnum.GLU_TESS_END:case t.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=n);case t.gluEnum.GLU_TESS_ERROR:case t.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=n);case t.gluEnum.GLU_TESS_COMBINE:case t.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=n);case t.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=n);default:return void this.callErrorCallback(t.gluEnum.GLU_INVALID_ENUM)}},t.GluTesselator.prototype.gluTessVertex=function(i,s){var n=!1,h=[0,0,0];this.requireState_(t.GluTesselator.tessState_.T_IN_CONTOUR);for(var r=0;r<3;++r){var e=i[r];e<-t.GLU_TESS_MAX_COORD&&(e=-t.GLU_TESS_MAX_COORD,n=!0),e>t.GLU_TESS_MAX_COORD&&(e=t.GLU_TESS_MAX_COORD,n=!0),h[r]=e}n&&this.callErrorCallback(t.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(h,s)},t.GluTesselator.prototype.gluTessBeginPolygon=function(i){this.requireState_(t.GluTesselator.tessState_.T_DORMANT),this.state_=t.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new t.GluMesh,this.polygonData_=i},t.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(t.GluTesselator.tessState_.T_IN_POLYGON),this.state_=t.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},t.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(t.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=t.GluTesselator.tessState_.T_IN_POLYGON},t.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(t.GluTesselator.tessState_.T_IN_POLYGON),this.state_=t.GluTesselator.tessState_.T_DORMANT,t.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),t.sweep.computeInterior(this),!this.fatalError){var i=this.mesh;if(this.boundaryOnly_?t.tessmono.setWindingNumber(i,1,!0):t.tessmono.tessellateInterior(i),this.mesh.checkMesh(),(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)&&(this.boundaryOnly_?t.render.renderBoundary(this,this.mesh):t.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_)),this.meshCallback_)return t.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}t.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},t.GluTesselator.prototype.requireState_=function(t){this.state_!==t&&this.gotoState_(t)},t.GluTesselator.prototype.gotoState_=function(i){for(;this.state_!==i;)if(this.state_<i)switch(this.state_){case t.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(t.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case t.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(t.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case t.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(t.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case t.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(t.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},t.GluTesselator.prototype.addVertex_=function(i,s){var n=this.lastEdge_;null===n?(n=t.mesh.makeEdge(this.mesh),t.mesh.meshSplice(n,n.sym)):(t.mesh.splitEdge(n),n=n.lNext),n.org.data=s,n.org.coords[0]=i[0],n.org.coords[1]=i[1],n.org.coords[2]=i[2],n.winding=1,n.sym.winding=-1,this.lastEdge_=n},t.GluTesselator.prototype.callBeginCallback=function(t){this.beginCallback_&&this.beginCallback_(t,this.polygonData_)},t.GluTesselator.prototype.callVertexCallback=function(t){this.vertexCallback_&&this.vertexCallback_(t,this.polygonData_)},t.GluTesselator.prototype.callEdgeFlagCallback=function(t){this.edgeFlagCallback_&&this.edgeFlagCallback_(t,this.polygonData_)},t.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},t.GluTesselator.prototype.callCombineCallback=function(t,i,s){return this.combineCallback_&&this.combineCallback_(t,i,s,this.polygonData_)||null},t.GluTesselator.prototype.callErrorCallback=function(t){this.errorCallback_&&this.errorCallback_(t,this.polygonData_)},t.GluFace=function(t,i){this.next=t||this,this.prev=i||this,this.anEdge=null,this.inside=!1},t.GluHalfEdge=function(t){this.next=t||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},t.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},t.GluHalfEdge.prototype.dst=function(){return this.sym.org},t.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},t.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},t.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},t.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},t.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},t.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},t.GluMesh=function(){this.vHead=new t.GluVertex,this.fHead=new t.GluFace,this.eHead=new t.GluHalfEdge,this.eHeadSym=new t.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},t.GluMesh.prototype.checkMesh=function(){if(t.DEBUG){var i,s,n,h=this.fHead,r=this.vHead,e=this.eHead,u=h;for(u=h;(s=u.next)!==h;u=s){t.assert(s.prev===u),i=s.anEdge;do{t.assert(i.sym!==i),t.assert(i.sym.sym===i),t.assert(i.lNext.oNext.sym===i),t.assert(i.oNext.sym.lNext===i),t.assert(i.lFace===s),i=i.lNext}while(i!==s.anEdge)}t.assert(s.prev===u&&null===s.anEdge);var o=r;for(o=r;(n=o.next)!==r;o=n){t.assert(n.prev===o),i=n.anEdge;do{t.assert(i.sym!==i),t.assert(i.sym.sym===i),t.assert(i.lNext.oNext.sym===i),t.assert(i.oNext.sym.lNext===i),t.assert(i.org===n),i=i.oNext}while(i!==n.anEdge)}t.assert(n.prev===o&&null===n.anEdge&&null===n.data);var f=e;for(f=e;(i=f.next)!==e;f=i)t.assert(i.sym.next===f.sym),t.assert(i.sym!==i),t.assert(i.sym.sym===i),t.assert(null!==i.org),t.assert(null!==i.dst()),t.assert(i.lNext.oNext.sym===i),t.assert(i.oNext.sym.lNext===i);t.assert(i.sym.next===f.sym&&i.sym===this.eHeadSym&&i.sym.sym===i&&null===i.org&&null===i.dst()&&null===i.lFace&&null===i.rFace())}},t.GluVertex=function(t,i){this.next=t||this,this.prev=i||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},t.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new t.PriorityQHeap},t.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},t.PriorityQ.prototype.init=function(){this.order_=[];for(var i=0;i<this.size_;i++)this.order_[i]=i;var s,n=(s=this.verts_,function(i,n){return t.geom.vertLeq(s[i],s[n])?1:-1});if(this.order_.sort(n),this.initialized_=!0,this.heap_.init(),t.DEBUG){var h=0+this.size_-1;for(i=0;i<h;++i)t.assert(t.geom.vertLeq(this.verts_[this.order_[i+1]],this.verts_[this.order_[i]]))}},t.PriorityQ.prototype.insert=function(t){if(this.initialized_)return this.heap_.insert(t);var i=this.size_++;return this.verts_[i]=t,-(i+1)},t.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var i=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var s=this.heap_.minimum();if(t.geom.vertLeq(s,i))return this.heap_.extractMin()}do{--this.size_}while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]]);return i},t.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var i=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var s=this.heap_.minimum();if(t.geom.vertLeq(s,i))return s}return i},t.PriorityQ.prototype.remove=function(i){if(i>=0)this.heap_.remove(i);else for(t.assert((i=-(i+1))<this.verts_.length&&null!==this.verts_[i]),this.verts_[i]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},t.PriorityQHeap=function(){this.heap_=t.PriorityQHeap.reallocNumeric_([0],t.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=t.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},t.PriorityQHeap.INIT_SIZE_=32,t.PriorityQHeap.reallocNumeric_=function(t,i){for(var s=new Array(i),n=0;n<t.length;n++)s[n]=t[n];for(;n<i;n++)s[n]=0;return s},t.PriorityQHeap.prototype.init=function(){for(var t=this.size_;t>=1;--t)this.floatDown_(t);this.initialized_=!0},t.PriorityQHeap.prototype.insert=function(i){var s,n=++this.size_;return 2*n>this.max_&&(this.max_*=2,this.handles_=t.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1)),0===this.freeList_?s=n:(s=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[s]=i,this.handles_[s]=n,this.heap_[n]=s,this.initialized_&&this.floatUp_(n),s},t.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},t.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},t.PriorityQHeap.prototype.extractMin=function(){var t=this.heap_,i=this.verts_,s=this.handles_,n=t[1],h=i[n];return this.size_>0&&(t[1]=t[this.size_],s[t[1]]=1,i[n]=null,s[n]=this.freeList_,this.freeList_=n,--this.size_>0&&this.floatDown_(1)),h},t.PriorityQHeap.prototype.remove=function(i){var s=this.heap_,n=this.verts_,h=this.handles_;t.assert(i>=1&&i<=this.max_&&null!==n[i]);var r=h[i];s[r]=s[this.size_],h[s[r]]=r,r<=--this.size_&&(r<=1||t.geom.vertLeq(n[s[r>>1]],n[s[r]])?this.floatDown_(r):this.floatUp_(r)),n[i]=null,h[i]=this.freeList_,this.freeList_=i},t.PriorityQHeap.prototype.floatDown_=function(i){for(var s=this.heap_,n=this.verts_,h=this.handles_,r=i,e=s[r];;){var u=r<<1;u<this.size_&&t.geom.vertLeq(n[s[u+1]],n[s[u]])&&(u+=1),t.assert(u<=this.max_);var o=s[u];if(u>this.size_||t.geom.vertLeq(n[e],n[o]))return s[r]=e,void(h[e]=r);s[r]=o,h[o]=r,r=u}},t.PriorityQHeap.prototype.floatUp_=function(i){for(var s=this.heap_,n=this.verts_,h=this.handles_,r=i,e=s[r];;){var u=r>>1,o=s[u];if(0===u||t.geom.vertLeq(n[o],n[e]))return s[r]=e,void(h[e]=r);s[r]=o,h[o]=r,r=u}},t.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},t.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},t.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},t}())&&(t.exports=i)}));const T=t.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");class L{constructor(){this._currentVertexIndex=0,this._indexCounter=0,this._triangleIndices=[-1,-1,-1],this.glu=new _.GluTesselator,this.glu.gluTessCallback(_.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this)),this.glu.gluTessCallback(_.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this)),this.glu.gluTessCallback(_.gluEnum.GLU_TESS_END,this._endcallback.bind(this)),this.glu.gluTessCallback(_.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this)),this.glu.gluTessCallback(_.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this)),this.glu.gluTessCallback(_.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this)),this.glu.gluTessProperty(_.gluEnum.GLU_TESS_WINDING_RULE,_.windingRule.GLU_TESS_WINDING_ODD)}beginPolygon(t,i){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0,this._indexCounter=0,this.glu.gluTessBeginPolygon(t),this._indices=i}endPolygon(){this.glu.gluTessEndPolygon()}beginContour(){this.glu.gluTessBeginContour()}endContour(){this.glu.gluTessEndContour()}addVertex(t,i){this.glu.gluTessVertex(t,i)}_vertexCallback(t,i){if(i[i.length]=t[0],i[i.length]=t[1],this._triangleIndices[this._currentVertexIndex]=-1,this._currentVertexIndex>=2){for(let t=0;t<3;t++)-1===this._triangleIndices[t]&&(this._triangleIndices[t]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[t];this._currentVertexIndex=0}else this._currentVertexIndex++}_begincallback(){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0}_endcallback(){this._currentVertexIndex=0}_errorcallback(t){T.error(`Encountered error during tesselation: ${t}`)}_combinecallback(t){return[t[0],t[1],t[2]]}_edgeCallback(){}}function d(t,i,s){return t[0]=i[0]-s[0],t[1]=i[1]-s[1],t}function E(t,i){return Math.sqrt(t*t+i*i)}function S(t){const i=E(t[0],t[1]);t[0]/=i,t[1]/=i}function w(t,i){return E(t[0]-i[0],t[1]-i[1])}function A(t){return"function"==typeof t}function U(t){return 1/Math.max(t,1)}function N(t,i,s){B.trackDistance=null!=i.trackDistance&&i.trackDistance,B.wrapDistance=null!=i.wrapDistance?i.wrapDistance:65535,B.thin=null!=i.thin&&i.thin,B.initialDistance=null!=i.initialDistance?i.initialDistance:0,B.enableOuterBisectorSplit=null!=i.enableOuterBisectorSplit&&i.enableOuterBisectorSplit,B.outerBisectorAutoSplitThreshold=null!=i.outerBisectorAutoSplitThreshold?i.outerBisectorAutoSplitThreshold:0,B.enableInnerBisectorSplit=null!=i.enableOuterBisectorSplit&&i.enableOuterBisectorSplit,B.innerBisectorAutoSplitThreshold=null!=i.innerBisectorAutoSplitThreshold?i.innerBisectorAutoSplitThreshold:0,G=t,I=s,O=0,D=0,g=0,m=!1,b=null,C=null,V.currentVertex.x=null,V.currentVertex.y=null,V.distance=B.initialDistance;const n=G[0],h=G[G.length-1];V.canSplit=!1,V.closed=n.x===h.x&&n.y===h.y,G.length<2||2===G.length&&V.closed||(B.thin?B.trackDistance?function(){for(p(),y(),F(1);D-g>B.wrapDistance||O<G.length;)p(),y(),F(2),I.bridge(V),V.leftExit0=V.rightExit0,V.leftExit2=V.rightExit2}():function(){for(;O<G.length;){if(O>0&&(V.inbound.x=V.outbound.x,V.inbound.y=V.outbound.y),O<G.length-1){V.outbound.x=G[O+1].x-G[O].x,V.outbound.y=G[O+1].y-G[O].y;const t=Math.sqrt(V.outbound.x*V.outbound.x+V.outbound.y*V.outbound.y);V.distance+=t,V.outbound.x/=t,V.outbound.y/=t}else V.outbound.x=V.inbound.x,V.outbound.y=V.inbound.y;0===O&&(V.inbound.x=V.outbound.x,V.inbound.y=V.outbound.y),V.currentVertex.x=G[O].x,V.currentVertex.y=G[O].y,V.prevNormal.x=-V.inbound.y,V.prevNormal.y=V.inbound.x,V.nextNormal.x=-V.outbound.y,V.nextNormal.y=V.outbound.x,0===O?(I.vertex(V),V.leftEntry0=V.entry0,V.leftEntry2=V.entry2,V.leftExit0=V.exit0,V.leftExit2=V.exit2):(I.vertex(V),V.rightEntry0=V.entry0,V.rightEntry2=V.entry2,V.rightExit0=V.exit0,V.rightExit2=V.exit2,I.bridge(V),V.leftExit0=V.rightExit0,V.leftExit2=V.rightExit2),++O}}():B.enableOuterBisectorSplit||B.outerBisectorAutoSplitThreshold>0||B.enableInnerBisectorSplit||B.innerBisectorAutoSplitThreshold>0?(V.canSplit=!0,function(){for(p(),x(),V.splitInner=V.gapInner=V.splitOuter=V.gapOuter=!1,k(1),V.closure0=V.leftEntry0,V.closure1=V.leftEntry1,V.closure2=V.leftEntry2;D-g>B.wrapDistance||O<G.length-1||O<G.length&&(!V.closed||B.trackDistance);)p(),x(),V.splitInner=V.gapInner=V.splitOuter=V.gapOuter=!1,k(2),I.bridge(V),V.leftExit0=V.rightExit0,V.leftExit1=V.rightExit1,V.leftExit2=V.rightExit2;V.closed&&!B.trackDistance&&(V.rightEntry0=V.closure0,V.rightEntry1=V.closure1,V.rightEntry2=V.closure2,I.bridge(V),V.leftExit0=V.rightExit0,V.leftExit1=V.rightExit1,V.leftExit2=V.rightExit2)}()):function(){for(p(),x(),k(1),V.closure0=V.leftEntry0,V.closure1=V.leftEntry1,V.closure2=V.leftEntry2;D-g>B.wrapDistance||O<G.length-1||O<G.length&&(!V.closed||B.trackDistance);)p(),x(),k(2),I.bridge(V),V.leftExit0=V.rightExit0,V.leftExit1=V.rightExit1,V.leftExit2=V.rightExit2;V.closed&&!B.trackDistance&&(V.rightEntry0=V.closure0,V.rightEntry1=V.closure1,V.rightEntry2=V.closure2,I.bridge(V),V.leftExit0=V.rightExit0,V.leftExit1=V.rightExit1,V.leftExit2=V.rightExit2)}())}function R(){G=null,I=null}function M(){if(V.cosine<B.innerBisectorAutoSplitThreshold){V.splitInner=!0,V.gapInner=!0;const t=Math.max(B.innerBisectorAutoSplitThreshold,V.cosine),i=Math.sqrt(1-t*t)/t;V.leftInner.x=V.nextNormal.x+V.sign*i*V.outbound.x,V.leftInner.y=V.nextNormal.y+V.sign*i*V.outbound.y,V.rightInner.x=V.prevNormal.x-V.sign*i*V.inbound.x,V.rightInner.y=V.prevNormal.y-V.sign*i*V.inbound.y}else B.enableInnerBisectorSplit&&(V.splitInner=!0,V.gapInner=!1,V.leftInner.x=V.rightInner.x=V.bisector.x/V.cosine,V.leftInner.y=V.rightInner.y=V.bisector.y/V.cosine);if(V.cosine<B.outerBisectorAutoSplitThreshold){V.splitOuter=!0,V.gapOuter=!0;const t=Math.max(B.outerBisectorAutoSplitThreshold,V.cosine),i=Math.sqrt(1-t*t)/t;V.leftOuter.x=V.prevNormal.x-V.sign*i*V.inbound.x,V.leftOuter.y=V.prevNormal.y-V.sign*i*V.inbound.y,V.rightOuter.x=V.nextNormal.x+V.sign*i*V.outbound.x,V.rightOuter.y=V.nextNormal.y+V.sign*i*V.outbound.y}else B.enableOuterBisectorSplit&&(V.splitOuter=!0,V.gapOuter=!1,V.leftOuter.x=V.rightOuter.x=V.bisector.x/V.cosine,V.leftOuter.y=V.rightOuter.y=V.bisector.y/V.cosine)}let G;const B={};let I,O,D,g,m,b,C;const V=new class{constructor(){this.closed=void 0,this.isFirstVertex=void 0,this.isLastVertex=void 0,this.isCap=void 0,this.currentVertex={x:void 0,y:void 0},this.inbound={x:void 0,y:void 0},this.outbound={x:void 0,y:void 0},this.prevNormal={x:void 0,y:void 0},this.nextNormal={x:void 0,y:void 0},this.bisector={x:void 0,y:void 0},this.leftInner={x:void 0,y:void 0},this.rightInner={x:void 0,y:void 0},this.leftOuter={x:void 0,y:void 0},this.rightOuter={x:void 0,y:void 0}}};function p(){if(m)return V.distance=0,V.isCap=V.isFirstVertex=V.isLastVertex=!1,void(m=!1);if(0===D)if(V.isFirstVertex=0===O,C=G[O],0===O){if(D=0,V.closed){V.inbound.x=C.x-G[G.length-2].x,V.inbound.y=C.y-G[G.length-2].y;const t=Math.sqrt(V.inbound.x*V.inbound.x+V.inbound.y*V.inbound.y);V.inbound.x/=t,V.inbound.y/=t}}else V.inbound.x=C.x-b.x,V.inbound.y=C.y-b.y,D=Math.sqrt(V.inbound.x*V.inbound.x+V.inbound.y*V.inbound.y),V.inbound.x/=D,V.inbound.y/=D;if(V.distance+D-g<=B.wrapDistance){if(O<G.length-1){V.outbound.x=G[O+1].x-C.x,V.outbound.y=G[O+1].y-C.y;const t=Math.sqrt(V.outbound.x*V.outbound.x+V.outbound.y*V.outbound.y);V.outbound.x/=t,V.outbound.y/=t}else if(V.closed){V.outbound.x=G[1].x-C.x,V.outbound.y=G[1].y-C.y;const t=Math.sqrt(V.outbound.x*V.outbound.x+V.outbound.y*V.outbound.y);V.outbound.x/=t,V.outbound.y/=t}else V.outbound.x=V.inbound.x,V.outbound.y=V.inbound.y;return 0!==O||V.closed||(V.inbound.x=V.outbound.x,V.inbound.y=V.outbound.y),++O,V.isLastVertex=O===G.length,V.isCap=!V.closed&&(V.isFirstVertex||V.isLastVertex),V.distance+=D-g,D=0,g=0,m=V.distance+D-g===B.wrapDistance,V.currentVertex.x=C.x,V.currentVertex.y=C.y,b=C,void(C=null)}V.outbound.x=V.inbound.x,V.outbound.y=V.inbound.y,g+=B.wrapDistance-V.distance,V.distance=B.wrapDistance,m=!0;const t=g/D;V.currentVertex.x=(1-t)*b.x+t*C.x,V.currentVertex.y=(1-t)*b.y+t*C.y}function y(){V.prevNormal.x=-V.inbound.y,V.prevNormal.y=V.inbound.x,V.nextNormal.x=-V.outbound.y,V.nextNormal.y=V.outbound.x}function x(){y(),V.bisector.x=V.prevNormal.x+V.nextNormal.x,V.bisector.y=V.prevNormal.y+V.nextNormal.y;const t=Math.sqrt(V.bisector.x*V.bisector.x+V.bisector.y*V.bisector.y);if(t<.001)return V.bisector.x=void 0,V.bisector.y=void 0,V.cosine=0,void(V.sign=void 0);V.bisector.x/=t,V.bisector.y/=t,V.cosine=V.bisector.x*V.nextNormal.x+V.bisector.y*V.nextNormal.y,V.sign=V.prevNormal.x*V.nextNormal.y-V.prevNormal.y*V.nextNormal.x>=0?1:-1}function k(t){I.vertex(V),1===t?(V.leftEntry0=V.entry0,V.leftEntry1=V.entry1,V.leftEntry2=V.entry2,V.leftExit0=V.exit0,V.leftExit1=V.exit1,V.leftExit2=V.exit2):2===t&&(V.rightEntry0=V.entry0,V.rightEntry1=V.entry1,V.rightEntry2=V.entry2,V.rightExit0=V.exit0,V.rightExit1=V.exit1,V.rightExit2=V.exit2)}function F(t){I.vertex(V),1===t?(V.leftEntry0=V.entry0,V.leftEntry2=V.entry2,V.leftExit0=V.exit0,V.leftExit2=V.exit2):2===t&&(V.rightEntry0=V.entry0,V.rightEntry2=V.entry2,V.rightExit0=V.exit0,V.rightExit2=V.exit2)}class P{constructor(t,i){this.writeVertex=t,this.writeTriangle=i,this.capType=0,this.joinType=2,this.miterLimitCosine=U(2),this.roundLimitCosine=Math.cos(23*Math.PI/180),this.almostParallelCosine=.97,this.radsPerSlice=.8,this.textured=!1,this.joinOnUTurn=!1}vertex(t){const i=2===this.joinType?this.miterLimitCosine:this.roundLimitCosine,s=t.isCap&&0!==this.capType;let n,h=!1;if(t.cosine>this.almostParallelCosine?(t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance),t.exit2=t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance)):t.cosine<1-this.almostParallelCosine?(h=!t.isCap&&this.joinOnUTurn,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance),t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)):t.canSplit?(M(),t.sign>0?(t.splitInner?(t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,t.leftInner.x,t.leftInner.y,0,-1,t.distance),t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.rightInner.x,t.rightInner.y,0,-1,t.distance)):t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance),t.cosine<i?(h=!t.isCap,t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)):t.splitOuter?(h=h||t.gapOuter,t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,-t.leftOuter.x,-t.leftOuter.y,0,1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,-t.rightOuter.x,-t.rightOuter.y,0,1,t.distance)):t.entry2=t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance)):(t.splitInner?(t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,-t.leftInner.x,-t.leftInner.y,0,1,t.distance),t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,-t.rightInner.x,-t.rightInner.y,0,1,t.distance)):t.exit2=t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance),t.cosine<i?(h=!t.isCap,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance)):t.splitOuter?(h=h||t.gapOuter,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.leftOuter.x,t.leftOuter.y,0,-1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,t.rightOuter.x,t.rightOuter.y,0,-1,t.distance)):t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance))):t.sign>0?(t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance),t.cosine<i?(h=!t.isCap,t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)):t.entry2=t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance)):(t.exit2=t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance),t.cosine<i?(h=!t.isCap,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance)):t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance)),n=t.entry1=t.exit1=t.canSplit&&(t.splitInner||t.splitOuter)||h||s?this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,0,0,0,0,t.distance):null,h&&1!==this.joinType)this.writeTriangle(n,t.sign>0?t.exit2:t.entry0,t.sign>0?t.entry2:t.exit0);else if(s&&1===this.capType||h&&1===this.joinType){let i,s,h,r,e,u;if(t.isCap){const n=Math.PI;e=Math.ceil(n/this.radsPerSlice),u=n/e,t.isFirstVertex?(i=t.prevNormal.x,s=t.prevNormal.y,h=t.entry0,r=t.entry2):t.isLastVertex&&(i=-t.nextNormal.x,s=-t.nextNormal.y,h=t.exit2,r=t.exit0)}else{const n=2*Math.acos(t.cosine);e=Math.ceil(n/this.radsPerSlice),u=n/e,i=t.sign>0?-t.prevNormal.x:t.nextNormal.x,s=t.sign>0?-t.prevNormal.y:t.nextNormal.y,h=t.sign>0?t.entry2:t.exit0,r=t.sign>0?t.exit2:t.entry0}const o=Math.cos(u),f=Math.sin(u),l=f*i+o*s;let c,a;i=o*i-f*s,s=l;for(let u=0;u<e;++u){c=a,u<e-1&&(a=t.isCap?this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,i,s,t.isFirstVertex?-1:1,0,t.distance):this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,i,s,0,t.sign,t.distance)),this.writeTriangle(0===u?h:c,n,u===e-1?r:a);const l=f*i+o*s;i=o*i-f*s,s=l}}else if(s&&2===this.capType){const i=t.isFirstVertex?1:-1;let s,h;this.textured?(s=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x-i*t.inbound.x,t.prevNormal.y-i*t.inbound.y,-i,-1,t.distance),h=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x-i*t.inbound.x,-t.prevNormal.y-i*t.inbound.y,-i,1,t.distance)):(s=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x-i*t.inbound.x,t.prevNormal.y-i*t.inbound.y,0,-1,t.distance),h=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x-i*t.inbound.x,-t.prevNormal.y-i*t.inbound.y,0,1,t.distance)),i>0?(this.writeTriangle(n,t.entry2,h),this.writeTriangle(n,h,s),this.writeTriangle(n,s,t.entry0)):(this.writeTriangle(n,h,t.exit2),this.writeTriangle(n,s,h),this.writeTriangle(n,t.exit0,s))}}bridge(t){this.writeTriangle(t.leftExit0,t.rightEntry0,null!=t.leftExit1?t.leftExit1:t.leftExit2),this.writeTriangle(t.rightEntry0,null!=t.rightEntry1?t.rightEntry1:t.rightEntry2,null!=t.leftExit1?t.leftExit1:t.leftExit2),null!=t.leftExit1&&null!=t.rightEntry1?(this.writeTriangle(t.leftExit1,t.rightEntry1,t.leftExit2),this.writeTriangle(t.rightEntry1,t.rightEntry2,t.leftExit2)):null!=t.leftExit1?this.writeTriangle(t.leftExit1,t.rightEntry2,t.leftExit2):null!=t.rightEntry1&&this.writeTriangle(t.rightEntry1,t.rightEntry2,t.leftExit2)}}const W=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],Y=["آ","أ","إ","ا"],j=["ﻵ","ﻷ","ﻹ","ﻻ"],z=["ﻶ","ﻸ","ﻺ","ﻼ"],X=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],q=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],Z=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],$=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],H=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],J=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],K=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],Q=["ء","ف"],tt=["غ","ي"],it=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],st=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],nt=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],ht=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],rt=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];function et(t,i,s,n,h){const r=function(t,i,s){if(void 0===i.inFormat&&(i.inFormat=s.defInFormat),void 0===i.outFormat&&(i.outFormat=s.defOutFormat),void 0===i.swap&&(i.swap=s.defSwap),i.inFormat===i.outFormat)return i;const n=i.inFormat.substring(0,1),h=i.outFormat.substring(0,1);let r,e=i.inFormat.substring(1,4),u=i.outFormat.substring(1,4);return"C"===e.charAt(0)&&(r=ut(t),e="ltr"===r||"rtl"===r?r.toUpperCase():"L"===i.inFormat.charAt(2)?"LTR":"RTL",i.inFormat=n+e),"C"===u.charAt(0)&&(r=ut(t),"rtl"===r?u="RTL":"ltr"===r?(r=function(t){const i=t.split("");return i.reverse(),ut(i.join(""))}(t),u=r.toUpperCase()):u="L"===i.outFormat.charAt(2)?"LTR":"RTL",i.outFormat=h+u),i}(t,{inFormat:i,outFormat:s,swap:n},h);if(r.inFormat===r.outFormat)return t;s=r.outFormat,n=r.swap;const e=(i=r.inFormat).substring(0,1),u=i.substring(1,4),o=s.substring(0,1),f=s.substring(1,4);if(h.inFormat=i,h.outFormat=s,h.swap=n,"L"===e&&"VLTR"===s){if("LTR"===u)return h.dir=bt,ot(t,h);if("RTL"===u)return h.dir=Ct,ot(t,h)}if("V"===e&&"V"===o)return h.dir="RTL"===u?Ct:bt,ct(t,h);if("L"===e&&"VRTL"===s)return"LTR"===u?(h.dir=bt,t=ot(t,h)):(h.dir=Ct,t=ot(t,h)),ct(t);if("VLTR"===i&&"LLTR"===s)return h.dir=bt,ot(t,h);if("V"===e&&"L"===o&&u!==f)return t=ct(t),"RTL"===u?et(t,"LLTR","VLTR",n,h):et(t,"LRTL","VRTL",n,h);if("VRTL"===i&&"LRTL"===s)return et(t,"LRTL","VRTL",n,h);if("L"===e&&"L"===o){const i=h.swap;return h.swap=i.substr(0,1)+"N","RTL"===u?(h.dir=Ct,t=ot(t,h),h.swap="N"+i.substr(1,2),h.dir=bt,t=ot(t,h)):(h.dir=bt,t=ot(t,h),h.swap="N"+i.substr(1,2),t=et(t,"VLTR","LRTL",h.swap,h)),t}return t}function ut(t){const i=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(t);return i?i[0]<="z"?"ltr":"rtl":""}function ot(t,i){const s=t.split(""),n=[];return ft(s,n,i),function(t,i,s){if(0!==s.hiLevel&&s.swap.substr(0,1)!==s.swap.substr(1,2))for(let s=0;s<t.length;s++)1===i[s]&&(t[s]=Et(t[s]))}(s,n,i),Lt(2,s,n,i),Lt(1,s,n,i),Ot=n,s.join("")}function ft(t,i,s){const n=t.length,h=s.dir?st:it;let r=0,e=-1;const u=[],o=[];s.hiLevel=s.dir,s.lastArabic=!1,s.hasUbatAl=!1,s.hasUbatB=!1,s.hasUbatS=!1;for(let i=0;i<n;i++)u[i]=lt(t[i]);for(let f=0;f<n;f++){const n=r,l=dt(t,u,o,f,s);o[f]=l,r=h[n][l];const c=240&r;r&=15;const a=h[r][gt];if(i[f]=a,c>0)if(16===c){for(let t=e;t<f;t++)i[t]=1;e=-1}else e=-1;if(h[r][mt])-1===e&&(e=f);else if(e>-1){for(let t=e;t<f;t++)i[t]=a;e=-1}5===u[f]&&(i[f]=0),s.hiLevel|=a}s.hasUbatS&&function(t,i,s,n){for(let h=0;h<s;h++)if(6===t[h]){i[h]=n.dir;for(let s=h-1;s>=0&&8===t[s];s--)i[s]=n.dir}}(u,i,n,s)}function lt(t){const i=t.charCodeAt(0),s=ht[i>>8];return s<100?s:rt[s-100][255&i]}function ct(t,i){const s=t.split("");if(i){const t=[];ft(s,t,i),Ot=t}return s.reverse(),Bt.reverse(),s.join("")}function at(t,i,s){for(let n=0;n<i;n++)if(t[n]===s)return n;return-1}function vt(t){for(let i=0;i<Q.length;i++)if(t>=Q[i]&&t<=tt[i])return!0;return!1}function _t(t,i,s,n){for(;i*s<n&&Ut(t[i]);)i+=s;return!!(i*s<n&&vt(t[i]))}function Tt(t,i,s,n){for(;i*s<n&&Ut(t[i]);)i+=s;let h=" ";if(!(i*s<n))return!1;h=t[i];for(let t=0;t<Y.length;t++)if(Y[t]===h)return!0;return!1}function Lt(t,i,s,n){if(n.hiLevel<t)return;if(1===t&&n.dir===Ct&&!n.hasUbatB)return i.reverse(),void Bt.reverse();const h=i.length;let r,e,u,o,f,l=0;for(;l<h;){if(s[l]>=t){for(r=l+1;r<h&&s[r]>=t;)r++;for(e=l,u=r-1;e<u;e++,u--)o=i[e],i[e]=i[u],i[u]=o,f=Bt[e],Bt[e]=Bt[u],Bt[u]=f;l=r}l++}}function dt(t,i,s,n,h){return{UBAT_L:()=>(h.lastArabic=!1,0),UBAT_R:()=>(h.lastArabic=!1,1),UBAT_ON:()=>4,UBAT_AN:()=>3,UBAT_EN:()=>h.lastArabic?3:2,UBAT_AL:()=>(h.lastArabic=!0,h.hasUbatAl=!0,1),UBAT_WS:()=>4,UBAT_CS:()=>{let t,r;return n<1||n+1>=i.length||2!==(t=s[n-1])&&3!==t||2!==(r=i[n+1])&&3!==r?4:(h.lastArabic&&(r=3),r===t?r:4)},UBAT_ES:()=>2===(n>0?s[n-1]:5)&&n+1<i.length&&2===i[n+1]?2:4,UBAT_ET:()=>{if(n>0&&2===s[n-1])return 2;if(h.lastArabic)return 4;let t=n+1;const r=i.length;for(;t<r&&11===i[t];)t++;return t<r&&2===i[t]?2:4},UBAT_NSM:()=>{if("VLTR"===h.inFormat){const s=i.length;let h=n+1;for(;h<s&&12===i[h];)h++;if(h<s){const s=t[n].charCodeAt[0],r=i[h];if((s>=1425&&s<=2303||64286===s)&&(1===r||7===r))return 1}}return n<1||5===i[n-1]?4:s[n-1]},UBAT_B:()=>(h.lastArabic=!0,h.hasUbatB=!0,h.dir),UBAT_S:()=>(h.hasUbatS=!0,4),UBAT_LRE:()=>(h.lastArabic=!1,4),UBAT_RLE:()=>(h.lastArabic=!1,4),UBAT_LRO:()=>(h.lastArabic=!1,4),UBAT_RLO:()=>(h.lastArabic=!1,4),UBAT_PDF:()=>(h.lastArabic=!1,4),UBAT_BN:()=>4}[nt[i[n]]]()}function Et(t){let i,s=0,n=W.length-1;for(;s<=n;)if(i=Math.floor((s+n)/2),t<W[i][0])n=i-1;else{if(!(t>W[i][0]))return W[i][1];s=i+1}return t}function St(t){for(let i=0;i<J.length;i++)if(J[i]===t)return!0;return!1}function wt(t){for(let i=0;i<X.length;i++)if(t===X[i])return $[i];return t}function At(t,i){for(let s=0;s<X.length;s++)if(t===X[s])return i[s];return t}function Ut(t){return t>="ً"&&t<="ٕ"}function Nt(t){return"L"===t?"LTR":"R"===t?"RTL":"C"===t?"CLR":"D"===t?"CRL":""}function Rt(t,i,s,n){for(;i*s<n&&Ut(t[i]);)i+=s;return i*s<n&&(t[i]=" ",!0)}function Mt(t,i){for(let s=0;s<Y.length;s++)if(t===Y[s])return i[s];return t}function Gt(t,i,s,n){for(let h=0;h<t.length;h++)(t[h]>i||!s&&t[h]===i)&&(t[h]+=n)}let Bt=[],It=[],Ot=[];const Dt={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},gt=5,mt=6,bt=0,Ct=1,Vt=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,pt=/[\u0591-\u06ff\ufb1d-\ufefc]/;class yt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(t,i,s){if(this.sourceToTarget=[],this.targetToSource=[],!t)return"";if(function(t,i,s){Bt=[],Ot=[];for(let n=0;n<s;n++)t[n]=n,i[n]=n,Bt[n]=n}(this.sourceToTarget,this.targetToSource,t.length),!this.checkParameters(i,s))return t;s=this.outputFormat;let n=t;const h=Dt,r=Nt((i=this.inputFormat).charAt(1)),e=Nt(s.charAt(1)),u=("I"===i.charAt(0)?"L":i.charAt(0))+r,o=("I"===s.charAt(0)?"L":s.charAt(0))+e,f=i.charAt(2)+s.charAt(2);h.defInFormat=u,h.defOutFormat=o,h.defSwap=f;const l=et(t,u,o,f,h);let c=!1;return"R"===s.charAt(1)?c=!0:"C"!==s.charAt(1)&&"D"!==s.charAt(1)||(c="rtl"===this.checkContextual(l)),this.sourceToTarget=Bt,this.targetToSource=function(t){const i=new Array(t.length);for(let s=0;s<t.length;s++)i[t[s]]=s;return i}(this.sourceToTarget),It=this.targetToSource,n=i.charAt(3)===s.charAt(3)?l:"S"===s.charAt(3)?function(t,i,s){if(0===i.length)return"";void 0===t&&(t=!0),void 0===s&&(s=!0);const n=(i=String(i)).split("");let h=0,r=1,e=n.length;t||(h=n.length-1,r=-1,e=1);const u=function(t,i,s,n,h){let r=0;const e=[];let u=0;for(let o=i;o*s<n;o+=s)if(vt(t[o])||Ut(t[o])){if("ل"===t[o]&&Tt(t,o+s,s,n)){t[o]=Mt(t[o+s],0===r?j:z),o+=s,Rt(t,o,s,n),h&&(e[u]=o,u++),r=0;continue}const i=t[o];t[o]=1===r?_t(t,o+s,s,n)?wt(t[o]):At(t[o],Z):!0===_t(t,o+s,s,n)?At(t[o],H):At(t[o],q),Ut(i)||(r=1),!0===St(i)&&(r=0)}else r=0;return e}(n,h,r,e,s);let o="";for(let i=0;i<n.length;i++)s&&at(u,u.length,i)>-1?(Gt(It,i,!t,-1),Bt.splice(i,1)):o+=n[i];return o}(c,l,!0):function(t,i,s){if(0===t.length)return"";void 0===s&&(s=!0),void 0===i&&(i=!0);let n="";const h=(t=String(t)).split("");for(let r=0;r<t.length;r++){let e=!1;if(h[r]>="ﹰ"&&h[r]<"\ufeff"){const u=t.charCodeAt(r);h[r]>="ﻵ"&&h[r]<="ﻼ"?(i?(r>0&&s&&" "===h[r-1]?n=n.substring(0,n.length-1)+"ل":(n+="ل",e=!0),n+=Y[(u-65269)/2]):(n+=Y[(u-65269)/2],n+="ل",r+1<t.length&&s&&" "===h[r+1]?r++:e=!0),e&&(Gt(It,r,!0,1),Bt.splice(r,0,Bt[r]))):n+=K[u-65136]}else n+=h[r]}return n}(l,c,!0),this.sourceToTarget=Bt,this.targetToSource=It,this.levels=Ot,n}_inputFormatSetter(t){if(!Vt.test(t))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=t}_outputFormatSetter(t){if(!Vt.test(t))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=t}checkParameters(t,i){return t?this._inputFormatSetter(t):t=this.inputFormat,i?this._outputFormatSetter(i):i=this.outputFormat,t!==i}checkContextual(t){let i=ut(t);if("ltr"!==i&&"rtl"!==i){try{i=document.dir.toLowerCase()}catch(t){}"ltr"!==i&&"rtl"!==i&&(i="ltr")}return i}hasBidiChar(t){return pt.test(t)}}export{P as E,o as M,yt as a,c as b,A as c,d,a as e,S as f,u as h,R as i,h as l,M as n,w as o,N as r,L as s,n as t,U as u}