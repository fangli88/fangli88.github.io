(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[163],{874:function(t,e,n){"use strict";n.r(e),n.d(e,"work",(function(){return R})),n.d(e,"wrappedWork",(function(){return J}));var o=n(53);function r(t,e,n){const r=t.byteLength/(4*e),l=new Uint32Array(t,0,r*e);let f=new Uint32Array(r);const u=n&&n.minReduction||0,g=n&&n.originalIndices||null,d=n&&n.componentOffsets||null;let p=0;if(d)for(let o=0;o<d.length-1;o++){const t=d[o+1]-d[o];t>p&&(p=t)}else p=r;const h=Math.floor(1.1*p)+1;(null==a||a.length<2*h)&&(a=new Uint32Array(Object(o.i)(2*h)));for(let o=0;o<2*h;o++)a[o]=0;let m=0;const b=!!d&&!!g,w=b?g.length:r,v=b?new Uint32Array(g.length):null,y=1.96;let O=0!==u?Math.ceil(7.84*y/(u*u)*u*(1-u)):w,j=1,A=d?d[1]:w;for(let o=0;o<w;o++){if(o===O){const t=1-m/o;if(t+y*Math.sqrt(t*(1-t)/o)<u)return null;O*=2}if(o===A){for(let t=0;t<2*h;t++)a[t]=0;if(g)for(let t=d[j-1];t<d[j];t++)v[t]=f[g[t]];A=d[++j]}const t=b?g[o]:o,n=t*e,r=s(l,n,e);let c=r%h,p=m;for(;0!==a[2*c+1];){if(a[2*c]===r){const t=a[2*c+1]-1;if(i(l,n,t*e,e)){p=f[t];break}}c++,c>=h&&(c-=h)}p===m&&(a[2*c]=r,a[2*c+1]=t+1,m++),f[t]=p}if(0!==u&&1-m/r<u)return null;if(b){for(let t=d[j-1];t<v.length;t++)v[t]=f[g[t]];f=v}const I=new Uint32Array(e*m);m=0;for(let o=0;o<w;o++)f[o]===m&&(c(l,(b?g[o]:o)*e,I,m*e,e),m++);if(g&&!b){const t=new Uint32Array(g.length);for(let e=0;e<t.length;e++)t[e]=f[g[e]];f=t}return{buffer:I.buffer,indices:f,uniqueCount:m}}function i(t,e,n,o){for(let r=0;r<o;r++)if(t[e+r]!==t[n+r])return!1;return!0}function c(t,e,n,o,r){for(let i=0;i<r;i++)n[o+i]=t[e+i]}function s(t,e,n){let o=0;for(let r=0;r<n;r++)o=t[e+r]+o|0,o=o+(o<<11)+(o>>>2)|0;return o>>>0}let a=null;const l={divisor:0};function f(t,e={}){e={...l,...e};const n=t.stride;return t.fieldNames.filter(e=>{const n=t.fields.get(e).optional;return!(n&&n.glPadding)}).map(o=>{const r=t.fields.get(o),i=r.constructor.ElementCount,c=function(t){const e=u[t];if(e)return e;throw new Error("BufferType not supported in WebGL")}(r.constructor.ElementType),s=r.offset,a=!(!r.optional||!r.optional.glNormalized);return{name:o,stride:n,count:i,type:c,offset:s,normalized:a,divisor:e.divisor}})}const u={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126};var g=n(654);const d=Object(g.a)().vec3f("position").u16("componentIndex").u16("_padding"),p=(f(Object(g.a)().vec2u8("sideness")),Object(g.a)().vec3f("position0").vec3f("position1").u16("componentIndex").u8("variantOffset",{glNormalized:!0}).u8("variantStroke").u8("variantExtension",{glNormalized:!0}).u8("_padding",{glPadding:!0}).u16("_padding2",{glPadding:!0})),h=p.clone().vec3f("normal"),m=p.clone().vec3f("normalA").vec3f("normalB");var b=n(334),w=n(75),v=n(44);class y{updateSettings(t){this.settings=t}write(t,e,n){const o=function(t){const e=O;e[0]=t.position0[0],e[1]=t.position0[1],e[2]=t.position0[2],e[3]=t.position1[0],e[4]=t.position1[1],e[5]=t.position1[2],A[0]=5381;for(let n=0;n<j.length;n++)A[0]=31*A[0]+j[n];return A[0]}(n);I.seed=o;const r=I.getIntRange(0,255),i=I.getIntRange(0,this.settings.variants-1),c=I.getFloat(),s=255*(.5*function(t,e){const n=t<0?-1:1;return Math.pow(Math.abs(t),1.2)*n}(-(1-Math.min(c/.7,1))+Math.max(0,c-.7)/(1-.7))+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,r),t.variantStroke.set(e,i),t.variantExtension.set(e,s)}trim(t,e){return t.slice(0,e)}}const O=new Float32Array(6),j=new Uint32Array(O.buffer),A=new Uint32Array(1),I=new b.a;class N{constructor(){this.commonWriter=new y}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return h.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),Object(v.c)(S,n.faceNormal0,n.faceNormal1),Object(v.o)(S,S),t.normal.setVec(e,S)}trim(t,e){return this.commonWriter.trim(t,e)}}N.Layout=h,N.glLayout=f(h,{divisor:1});class E{constructor(){this.commonWriter=new y}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return m.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),t.normalA.setVec(e,n.faceNormal0),t.normalB.setVec(e,n.faceNormal1)}trim(t,e){return this.commonWriter.trim(t,e)}}E.Layout=m,E.glLayout=f(m,{divisor:1});const S=Object(w.e)();var U=n(578);function V(t,e){return e.push(t.buffer),{buffer:t.buffer,layout:x(t.layout)}}function x(t){const e=new Array;return t.fields.forEach((t,n)=>{const o={...t,constructor:D(t.constructor)};e.push([n,o])}),{stride:t.stride,fields:e,fieldNames:t.fieldNames}}const k=[U.a,U.m,U.u,U.C,U.f,U.h,U.b,U.n,U.v,U.D,U.g,U.i,U.l,U.t,U.B,U.J,U.j,U.r,U.z,U.H,U.k,U.s,U.A,U.I,U.e,U.q,U.y,U.G,U.c,U.o,U.w,U.E,U.d,U.p,U.x,U.F];function D(t){return`${t.ElementType}_${t.ElementCount}`}const L=new Map;function M(t,e){const n=t.length/3,o=new Uint32Array(e+1),r=new Uint32Array(e+1),i=(t,e)=>{t<e?o[t+1]++:r[e+1]++};for(let m=0;m<n;m++){const e=t[3*m],n=t[3*m+1],o=t[3*m+2];i(e,n),i(n,o),i(o,e)}let c=0,s=0;for(let m=0;m<e;m++){const t=o[m+1],e=r[m+1];o[m+1]=c,r[m+1]=s,c+=t,s+=e}const a=new Uint32Array(6*n),l=o[e],f=(t,e,n)=>{if(t<e){const r=o[t+1]++;a[2*r]=e,a[2*r+1]=n}else{const o=r[e+1]++;a[2*l+2*o]=t,a[2*l+2*o+1]=n}};for(let m=0;m<n;m++){const e=t[3*m],n=t[3*m+1],o=t[3*m+2];f(e,n,m),f(n,o,m),f(o,e,m)}const u=(t,e)=>{const n=2*t,o=e-t;for(let r=1;r<o;r++){const t=a[n+2*r],e=a[n+2*r+1];let o=r-1;for(;o>=0&&a[n+2*o]>t;o--)a[n+2*o+2]=a[n+2*o],a[n+2*o+3]=a[n+2*o+1];a[n+2*o+2]=t,a[n+2*o+3]=e}};for(let m=0;m<e;m++)u(o[m],o[m+1]),u(l+r[m],l+r[m+1]);const g=new Int32Array(3*n),d=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,p=(t,e)=>{const n=d(t,e);g[3*e+n]=-1},h=(t,e,n,o)=>{const r=d(t,e);g[3*e+r]=o;const i=d(n,o);g[3*o+i]=e};for(let m=0;m<e;m++){let t=o[m];const e=o[m+1];let n=r[m];const i=r[m+1];for(;t<e&&n<i;){const e=a[2*t],o=a[2*l+2*n];e===o?(h(m,a[2*t+1],o,a[2*l+2*n+1]),t++,n++):e<o?(p(m,a[2*t+1]),t++):(p(o,a[2*l+2*n+1]),n++)}for(;t<e;)p(m,a[2*t+1]),t++;for(;n<i;)p(a[2*l+2*n],a[2*l+2*n+1]),n++}return g}k.forEach(t=>L.set(D(t),t));var W=n(115),B=n(95),F=n(328);function z(t,e){return t.cosAngle<e}function C(t,e){return t.cosAngle>e}function P(t,e){const n=Object(o.a)(t.cosAngle),r=T.fwd,i=T.ortho;return Object(F.c)(r,t.position1,t.position0),n*(Object(v.e)(Object(v.d)(i,t.faceNormal0,t.faceNormal1),r)>0?-1:1)>e}const T={edge:{position0:Object(w.e)(),position1:Object(w.e)(),faceNormal0:Object(w.e)(),faceNormal1:Object(w.e)(),componentIndex:0,cosAngle:0},ortho:Object(w.e)(),fwd:Object(w.e)()},q={v0:Object(w.e)(),v1:Object(w.e)(),v2:Object(w.e)()},_={anglePlanar:4,angleSignificantEdge:35};async function J(t){const e=function(t){return{data:d.createView(t.dataBuffer),originalIndices:"Uint32Array"===t.originalIndicesType?new Uint32Array(t.originalIndicesBuffer):"Uint16Array"===t.originalIndicesType?new Uint16Array(t.originalIndicesBuffer):void 0,writerSettings:t.writerSettings,skipDeduplicate:t.skipDeduplicate}}(t),n=R(e),o=[e.data.buffer];return{result:function(t,e){return e.push(t.regular.lodInfo.lengths.buffer),e.push(t.silhouette.lodInfo.lengths.buffer),{regular:{instancesData:V(t.regular.instancesData,e),lodInfo:{lengths:t.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:V(t.silhouette.instancesData,e),lodInfo:{lengths:t.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:t.averageEdgeLength}}(n,o),transferList:o}}function R(t){const e=function(t,e,n){if(e&&n)return{faces:n,neighbors:M(n,t.count),vertices:t};{const e=r(t.buffer,t.stride/4,{originalIndices:n}),o=M(e.indices,e.uniqueCount);return{faces:e.indices,neighbors:o,vertices:d.createView(e.buffer)}}}(t.data,t.skipDeduplicate,t.originalIndices);return G.updateSettings(t.writerSettings),$.updateSettings(t.writerSettings),function(t,e,n,r=_){const i=t.vertices.position,c=t.vertices.componentIndex,s=Object(o.d)(r.anglePlanar),a=Object(o.d)(r.angleSignificantEdge),l=Math.cos(a),f=Math.cos(s),u=T.edge,g=u.position0,d=u.position1,p=u.faceNormal0,h=u.faceNormal1,m=function(t){const e=t.faces.length/3,n=t.vertices.position,o=t.faces,r=q.v0,i=q.v1,c=q.v2,s=new Float32Array(3*e);for(let a=0;a<e;a++){const t=o[3*a+0],e=o[3*a+1],l=o[3*a+2];n.getVec(t,r),n.getVec(e,i),n.getVec(l,c),Object(v.g)(i,i,r),Object(v.g)(c,c,r),Object(v.d)(r,i,c),Object(v.o)(r,r),s[3*a+0]=r[0],s[3*a+1]=r[1],s[3*a+2]=r[2]}return s}(t),b=function(t){const e=t.faces.length/3,n=t.faces,o=t.neighbors;let r=0;for(let s=0;s<e;s++){const t=o[3*s+0],e=o[3*s+1],i=o[3*s+2],c=n[3*s+0],a=n[3*s+1],l=n[3*s+2];r+=-1===t||c<a?1:0,r+=-1===e||a<l?1:0,r+=-1===i||l<c?1:0}const i=new Int32Array(4*r);let c=0;for(let s=0;s<e;s++){const t=o[3*s+0],e=o[3*s+1],r=o[3*s+2],a=n[3*s+0],l=n[3*s+1],f=n[3*s+2];(-1===t||a<l)&&(i[c++]=a,i[c++]=l,i[c++]=s,i[c++]=t),(-1===e||l<f)&&(i[c++]=l,i[c++]=f,i[c++]=s,i[c++]=e),(-1===r||f<a)&&(i[c++]=f,i[c++]=a,i[c++]=s,i[c++]=r)}return i}(t),w=b.length/4,y=e.allocate(w);let O=0;const j=w,A=n.allocate(j);let I=0,N=0,E=0;const S=Object(B.h)(0,w),U=new Float32Array(w);Object(W.b)(U,(t,e,n)=>{i.getVec(b[4*e+0],g),i.getVec(b[4*e+1],d),n[e]=Object(v.l)(g,d)}),S.sort((t,e)=>U[e]-U[t]);const V=new Array,x=new Array;for(let o=0;o<w;o++){const t=S[o],r=U[t],a=b[4*t+0],w=b[4*t+1],j=b[4*t+2],k=b[4*t+3],D=-1===k;if(i.getVec(a,g),i.getVec(w,d),D)Object(v.r)(p,m[3*j+0],m[3*j+1],m[3*j+2]),Object(v.h)(h,p),u.componentIndex=c.get(a),u.cosAngle=Object(v.e)(p,h);else{if(Object(v.r)(p,m[3*j+0],m[3*j+1],m[3*j+2]),Object(v.r)(h,m[3*k+0],m[3*k+1],m[3*k+2]),u.componentIndex=c.get(a),u.cosAngle=Object(v.e)(p,h),C(u,f))continue;u.cosAngle<-.9999&&Object(v.h)(h,p)}N+=r,E++,D||z(u,l)?(e.write(y,O++,u),V.push(r)):P(u,s)&&(n.write(A,I++,u),x.push(r))}const k=new Float32Array(V.reverse()),D=new Float32Array(x.reverse());return{regular:{instancesData:e.trim(y,O),lodInfo:{lengths:k}},silhouette:{instancesData:n.trim(A,I),lodInfo:{lengths:D}},averageEdgeLength:N/E}}(e,G,$)}const G=new N,$=new E}}]);
//# sourceMappingURL=163.0dd8f4e2.chunk.js.map