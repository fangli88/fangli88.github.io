(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[8],{425:function(t,e,n){"use strict";n.d(e,"a",(function(){return D})),n.d(e,"b",(function(){return W})),n.d(e,"c",(function(){return X})),n.d(e,"d",(function(){return U})),n.d(e,"e",(function(){return k})),n.d(e,"f",(function(){return B})),n.d(e,"g",(function(){return Z})),n.d(e,"h",(function(){return C})),n.d(e,"i",(function(){return L})),n.d(e,"j",(function(){return H})),n.d(e,"k",(function(){return $})),n.d(e,"l",(function(){return A})),n.d(e,"m",(function(){return I})),n.d(e,"n",(function(){return Y})),n.d(e,"o",(function(){return P})),n.d(e,"p",(function(){return ct})),n.d(e,"q",(function(){return et})),n.d(e,"r",(function(){return it})),n.d(e,"s",(function(){return ut})),n.d(e,"t",(function(){return K})),n.d(e,"u",(function(){return tt})),n.d(e,"v",(function(){return y})),n.d(e,"w",(function(){return b})),n.d(e,"x",(function(){return ot})),n.d(e,"y",(function(){return st}));var r=n(4),i=n(14),s=n(21),o=n(504),a=n(538),u=n(435);function c(t,e){return t?e?4:3:e?3:2}const l=r.a.getLogger("esri.tasks.support.optimizedFeatureSet"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},f=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s},d=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s,t[n+2]=e[r+2]},m=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s,t[n+2]=e[r+3]},p=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s,t[n+2]=e[r+2],t[n+3]=e[r+3]};function g(t,e,n,r){if(t){if(n)return e&&r?p:d;if(e&&r)return m}else if(e&&r)return d;return f}function y({scale:t,translate:e},n){return Math.round((n-e[0])/t[0])}function b({scale:t,translate:e},n){return Math.round((e[1]-n)/t[1])}function x({scale:t,translate:e},n){return n*t[0]+e[0]}function _({scale:t,translate:e},n){return e[1]-n*t[1]}function I(t,e,n){return t?e?n?R(t):j(t):n?S(t):w(t):null}function w(t){const e=t.coords;return{x:e[0],y:e[1]}}function M(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t}function j(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2]}}function O(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t}function S(t){const e=t.coords;return{x:e[0],y:e[1],m:e[2]}}function F(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.m,t}function R(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2],m:e[3]}}function T(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t.coords[3]=e.m,t}function v(t,e){return t&&e?T:t?O:e?F:M}function N(t,e,n,r,i){const s=v(n,r);for(const a of e){const{geometry:e,attributes:n}=a;let r;e&&(r=s(new u.a,e)),t.push(new o.a(r,n,null,n[i]))}return t}function A(t,e,n){if(!t)return null;const r=c(e,n),i=[];for(let s=0;s<t.coords.length;s+=r){const e=[];for(let n=0;n<r;n++)e.push(t.coords[s+n]);i.push(e)}return e?n?{points:i,hasZ:e,hasM:n}:{points:i,hasZ:e}:n?{points:i,hasM:n}:{points:i}}function G(t,e,n,r,i){const s=c(n,r);for(const a of e){const e=a.geometry,n=a.attributes;let r;e&&(r=E(new u.a,e,s)),t.push(new o.a(r,n,null,n[i]))}return t}function E(t,e,n=c(e.hasZ,e.hasM)){t.lengths[0]=e.points.length;const r=t.coords;let i=0;for(const s of e.points)for(let t=0;t<n;t++)r[i++]=s[t];return t}function P(t,e,n){if(!t)return null;const r=c(e,n),{coords:i,lengths:s}=t,o=[];let a=0;for(const u of s){const t=[];for(let e=0;e<u;e++){const e=[];for(let t=0;t<r;t++)e.push(i[a++]);t.push(e)}o.push(t)}return e?n?{paths:o,hasZ:e,hasM:n}:{paths:o,hasZ:e}:n?{paths:o,hasM:n}:{paths:o}}function Q(t,e,n,r,i){const s=c(n,r);for(const a of e){const e=a.geometry,n=a.attributes;let r;e&&(r=C(new u.a,e,s)),t.push(new o.a(r,n,null,n[i]))}return t}function C(t,e,n=c(e.hasZ,e.hasM)){const{lengths:r,coords:i}=t;let s=0;for(const o of e.paths){for(const t of o)for(let e=0;e<n;e++)i[s++]=t[e];r.push(o.length)}return t}function Y(t,e,n){if(!t)return null;const r=c(e,n),{coords:i,lengths:s}=t,o=[];let a=0;for(const u of s){const t=[];for(let e=0;e<u;e++){const e=[];for(let t=0;t<r;t++)e.push(i[a++]);t.push(e)}o.push(t)}return e?n?{rings:o,hasZ:e,hasM:n}:{rings:o,hasZ:e}:n?{rings:o,hasM:n}:{rings:o}}function q(t,e,n,r,i){for(const s of e){const e=s.geometry,a=s.centroid,c=s.attributes;let l;e&&(l=Z(new u.a,e,n,r)),a?t.push(new o.a(l,c,M(new u.a,a),c[i])):t.push(new o.a(l,c,null,c[i]))}return t}function Z(t,e,n=e.hasZ,r=e.hasM){return B(t,e.rings,n,r),t}function B(t,e,n,r){const i=c(n,r),{lengths:s,coords:o}=t;let a=0;s.length=o.length=0;for(const u of e){for(const t of u)for(let e=0;e<i;e++)o[a++]=t[e];s.push(u.length)}return t}const V=[],z=[];function D(t,e,n,r,i){V[0]=t;const[s]=X(z,V,e,n,r,i);return V.length=z.length=0,s}function X(t,e,n,r,s,a){if(t.length=0,!n){for(const n of e){const e=n.attributes[a];t.push(new o.a(null,n.attributes,null,e))}return t}switch(n){case"esriGeometryPoint":return N(t,e,r,s,a);case"esriGeometryMultipoint":return G(t,e,r,s,a);case"esriGeometryPolyline":return Q(t,e,r,s,a);case"esriGeometryPolygon":return q(t,e,r,s,a);default:l.error("convertToFeatureSet:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${n}'`)),t.length=0}return t}function k(t,e,n,r,s,o){const a=t.length;switch(n){case"esriGeometryPoint":N(t,e,r,s,o);break;case"esriGeometryMultipoint":G(t,e,r,s,o);break;case"esriGeometryPolyline":Q(t,e,r,s,o);break;case"esriGeometryPolygon":q(t,e,r,s,o);break;default:l.error("convertToFeatureSet:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${n}'`))}for(let i=0;i<e.length;i++)t[i+a].geometryType=n,t[i+a].insertAfter=e[i].insertAfter,t[i+a].groupId=e[i].groupId;return t}function L(t,e,n,r){z[0]=t,J(V,z,e,n,r);const i=V[0];return V.length=z.length=0,i}function U(t,e,n){if(!t)return null;const r=new u.a;return"hasZ"in t&&null==e&&(e=t.hasZ),"hasM"in t&&null==n&&(n=t.hasM),Object(s.f)(t)?v(null!=e?e:null!=t.z,null!=n?n:null!=t.m)(r,t):Object(s.g)(t)?Z(r,t,e,n):Object(s.h)(t)?C(r,t,c(e,n)):Object(s.e)(t)?E(r,t,c(e,n)):void l.error("convertFromGeometry:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${t}'`))}function $(t,e,n,r){const s=t&&("coords"in t?t:t.geometry);if(!s)return null;switch(e){case"esriGeometryPoint":{let t=w;return n&&r?t=R:n?t=j:r&&(t=S),t(s)}case"esriGeometryMultipoint":return A(s,n,r);case"esriGeometryPolyline":return P(s,n,r);case"esriGeometryPolygon":return Y(s,n,r);default:return void l.error("convertToGeometry:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${e}'`))}}function J(t,e,n,r,s){switch(t.length=0,n){case"esriGeometryPoint":return function(t,e,n,r){let i=w;n&&r?i=R:n?i=j:r&&(i=S);for(const s of e){const{geometry:e,attributes:n}=s,r=e?i(e):null;t.push({attributes:n,geometry:r})}return t}(t,e,r,s);case"esriGeometryMultipoint":return function(t,e,n,r){for(const i of e){const{geometry:e,attributes:s}=i;let o;e&&(o=A(e,n,r)),t.push({attributes:s,geometry:o})}return t}(t,e,r,s);case"esriGeometryPolyline":return function(t,e,n,r){for(const i of e){const{geometry:e,attributes:s}=i;let o;e&&(o=P(e,n,r)),t.push({attributes:s,geometry:o})}return t}(t,e,r,s);case"esriGeometryPolygon":return function(t,e,n,r){for(const i of e){const{geometry:e,attributes:s,centroid:o}=i;let a;if(e&&(a=Y(e,n,r)),o){const e=w(o);t.push({attributes:s,centroid:e,geometry:a})}else t.push({attributes:s,geometry:a})}return t}(t,e,r,s);default:l.error("convertToFeatureSet:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${n}'`))}return t}function H(t){const{objectIdFieldName:e,spatialReference:n,transform:r,fields:i,hasM:s,hasZ:o,features:a,geometryType:u,exceededTransferLimit:c,uniqueIdField:l,queryGeometry:h,queryGeometryType:f}=t,d={features:J([],a,u,o,s),fields:i,geometryType:u,objectIdFieldName:e,spatialReference:n,uniqueIdField:l,queryGeometry:$(h,f,!1,!1)};return r&&(d.transform=r),c&&(d.exceededTransferLimit=c),s&&(d.hasM=s),o&&(d.hasZ=o),d}function W(t,e){const n=new a.a,{hasM:r,hasZ:s,features:o,objectIdFieldName:u,spatialReference:c,geometryType:h,exceededTransferLimit:f,transform:d,fields:m}=t;return m&&(n.fields=m),n.geometryType=h,n.objectIdFieldName=u||e,n.spatialReference=c,n.objectIdFieldName?(o&&X(n.features,o,h,s,r,n.objectIdFieldName),f&&(n.exceededTransferLimit=f),r&&(n.hasM=r),s&&(n.hasZ=s),d&&(n.transform=d),n):(l.error(new i.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function K(t,e){const{geometryType:n,features:r,hasM:i,hasZ:s}=e;if(!t)return e;for(let o=0;o<r.length;o++){const e=r[o],a=e.weakClone();a.geometry=new u.a,tt(a.geometry,e.geometry,i,s,n,t),e.centroid&&(a.centroid=new u.a,tt(a.centroid,e.centroid,i,s,"esriGeometryPoint",t)),r[o]=a}return e.transform=t,e}function tt(t,e,n,r,i,s,o=n,a=r){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),!e||!e.coords.length)return null;const u=h[i],{coords:l,lengths:f}=e,d=c(n,r),m=c(n&&o,r&&a),p=g(n,r,o,a);if(!f.length)return p(t.coords,l,0,0,y(s,l[0]),b(s,l[1])),t.lengths.length&&(t.lengths.length=0),t.coords.length=d,t;let x,_,I,w,M=0,j=0,O=j;for(const c of f){if(c<u)continue;let e=0;j=O,I=x=y(s,l[M]),w=_=b(s,l[M+1]),p(t.coords,l,j,M,I,w),e++,M+=d,j+=m;for(let n=1;n<c;n++,M+=d)I=y(s,l[M]),w=b(s,l[M+1]),I===x&&w===_||(p(t.coords,l,j,M,I-x,w-_),j+=m,e++,x=I,_=w);e>=u&&(t.lengths.push(e),O=j)}return t.coords.length=O,t.coords.length?t:null}function et(t,e,n,r,i,s,o=n,a=r){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),!e||!e.coords.length)return null;const u=h[i],{coords:l,lengths:f}=e,d=c(n,r),m=c(n&&o,r&&a),p=g(n,r,o,a);if(!f.length)return p(t.coords,l,0,0,l[0],l[1]),t.lengths.length&&(t.lengths.length=0),t.coords.length=d,t;let y=0;const b=s*s;for(const c of f){if(c<u){y+=c*d;continue}const e=t.coords.length/m,n=y,r=y+(c-1)*d;p(t.coords,l,t.coords.length,n,l[n],l[n+1]),rt(t.coords,l,d,b,p,n,r),p(t.coords,l,t.coords.length,r,l[r],l[r+1]);const i=t.coords.length/m-e;i>=u?t.lengths.push(i):t.coords.length=e*m,y+=c*d}return t.coords.length?t:null}function nt(t,e,n,r){const i=t[e],s=t[e+1],o=t[n],a=t[n+1],u=t[r],c=t[r+1];let l=o,h=a,f=u-l,d=c-h;if(0!==f||0!==d){const t=((i-l)*f+(s-h)*d)/(f*f+d*d);t>1?(l=u,h=c):t>0&&(l+=f*t,h+=d*t)}return f=i-l,d=s-h,f*f+d*d}function rt(t,e,n,r,i,s,o){let a,u=r,c=0;for(let l=s+n;l<o;l+=n)a=nt(e,l,s,o),a>u&&(c=l,u=a);u>r&&(c-s>n&&rt(t,e,n,r,i,s,c),i(t,e,t.length,c,e[c],e[c+1]),o-c>n&&rt(t,e,n,r,i,c,o))}function it(t,e,n,r){if(!e||!e.coords||!e.coords.length)return null;const i=c(n,r);let s=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(e&&e.coords){const t=e.coords;for(let e=0;e<t.length;e+=i){const n=t[e],r=t[e+1];s=Math.min(s,n),a=Math.max(a,n),o=Math.min(o,r),u=Math.max(u,r)}}return t[0]=s,t[1]=o,t[2]=a,t[3]=u,t}function st(t,e,n,r,i){const{coords:s,lengths:o}=e,a=n?r?p:d:r?d:f,u=c(n,r);if(!s.length)return t!==e&&(t.lengths.length=0,t.coords.length=0),t;if(!o.length)return a(t.coords,s,0,0,x(i,s[0]),_(i,s[1])),t!==e&&(t.lengths.length=0,t.coords.length=u),t;const[l,h]=i.scale;let m=0;for(let c=0;c<o.length;c++){const e=o[c];t.lengths[c]=e;let n=x(i,s[m]),r=_(i,s[m+1]);a(t.coords,s,m,m,n,r),m+=u;for(let i=1;i<e;i++,m+=u)n+=s[m]*l,r-=s[m+1]*h,a(t.coords,s,m,m,n,r)}return t!==e&&(t.lengths.length=o.length,t.coords.length=s.length),t}function ot(t,e,n,r,i,s){const o=c(n,r),a=g(n,r,i,s),u=e.coords;t.coords.length=0,t.lengths.length=0,t.lengths.push(...e.lengths);for(let c=0;c<u.length;c+=o)a(t.coords,u,t.coords.length,c,u[c],u[c+1]);return t}function at(t,e,n,r){let i=0,s=t[r*e],o=t[r*(e+1)];for(let a=1;a<n;a++){const n=s+t[r*(e+a)],u=o+t[r*(e+a)+1],c=(n-s)*(u+o);s=n,o=u,i+=c}return.5*i}function ut(t,e){const{coords:n,lengths:r}=t;let i=0,s=0;for(let o=0;o<r.length;o++)s+=at(n,i,r[o],e),i+=o;return Math.abs(s)}function ct(t,e){const n=t.clone(),r=t.coords,i=t.lengths;let s=0;for(let o=0;o<i.length;o++){const t=i[o];let a=r[e*s],u=r[e*s+1];for(let i=1;i<t;i++){const t=a+r[e*(s+i)],o=u+r[e*(s+i)+1];n.coords[e*(s+i)]=t,n.coords[e*(s+i)+1]=o,a=t,u=o}s+=t}return n}},435:function(t,e,n){"use strict";class r{constructor(t=[],e=[],n=!1){this.lengths=null!=t?t:[],this.coords=null!=e?e:[],this.hasIndeterminateRingOrder=n}get isPoint(){return 0===this.lengths.length}forEachVertex(t){let e=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const r=this.lengths[n];for(let n=0;n<r;n++)t(this.coords[2*(n+e)],this.coords[2*(n+e)+1]);e+=r}}clone(){return new r(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}e.a=r},447:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(486);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function s(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],u(i,t.leaf?r(s):s);return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,i,s){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Object(r.a)(t,o,e,n,s),a.push(e,o,o,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!m(t,e))return n;for(var i,s,o,a,u=[];e;){for(i=0,s=e.children.length;i<s;i++)o=e.children[i],m(t,a=e.leaf?r(o):o)&&(e.leaf?n.push(o):d(t,a)?this._all(o,n):u.push(o));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!m(t,e))return!1;for(var r,i,s,o,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(s=e.children[r],m(t,o=e.leaf?n(s):s)){if(e.leaf||d(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,o,a=this.data,u=this.toBBox(t),c=[],l=[];a||c.length;){if(a||(a=c.pop(),r=c[c.length-1],n=l.pop(),o=!0),a.leaf&&-1!==(i=s(t,a.children,e)))return a.children.splice(i,1),c.push(a),this._condense(c),this;o||a.leaf||!d(a,u)?r?(n++,a=r.children[n],o=!1):a=null:(c.push(a),l.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,s=n-e+1,a=this._maxEntries;if(s<=a)return o(i=p(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(i=p([])).leaf=!1,i.height=r;var u,c,l,h,f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));for(g(t,e,n,d,this.compareMinX),u=e;u<=n;u+=d)for(g(t,u,l=Math.min(u+d-1,n),f,this.compareMinY),c=u;c<=l;c+=f)h=Math.min(c+f-1,l),i.children.push(this._build(t,c,h,r-1));return o(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,s,o,a,u,c,l,f,d,m;r.push(e),!e.leaf&&r.length-1!==n;){for(l=f=1/0,i=0,s=e.children.length;i<s;i++)u=h(o=e.children[i]),d=t,m=o,(c=(Math.max(m.maxX,d.maxX)-Math.min(m.minX,d.minX))*(Math.max(m.maxY,d.maxY)-Math.min(m.minY,d.minY))-u)<f?(f=c,l=u<l?u:l,a=o):c===f&&u<l&&(l=u,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),s=[],o=this._chooseSubtree(i,this.data,e,s);for(o.children.push(t),u(o,i);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(i,s,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),a=p(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,s,o,u,c,l,f,d,m,p,g,y,b;for(c=l=1/0,r=e;r<=n-e;r++)d=i=a(t,0,r,this.toBBox),m=s=a(t,r,n,this.toBBox),void 0,void 0,void 0,void 0,p=Math.max(d.minX,m.minX),g=Math.max(d.minY,m.minY),y=Math.min(d.maxX,m.maxX),b=Math.min(d.maxY,m.maxY),o=Math.max(0,y-p)*Math.max(0,b-g),u=h(i)+h(s),o<c?(c=o,f=r,l=u<l?u:l):o===c&&u<l&&(l=u,f=r);return f},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,s,o=this.toBBox,c=a(t,0,e,o),l=a(t,n-e,n,o),h=f(c)+f(l);for(i=e;i<n-e;i++)s=t.children[i],u(c,t.leaf?o(s):s),h+=f(c);for(i=n-e-1;i>=e;i--)s=t.children[i],u(l,t.leaf?o(s):s),h+=f(l);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},463:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return y}));var r=n(8),i=n(31),s=n(36),o=n(278),a=n(477);const u=[0,0];function c(t,e){if(!e)return null;if("x"in e){const n={x:0,y:0};return[n.x,n.y]=t(e.x,e.y,u),null!=e.z&&(n.z=e.z),null!=e.m&&(n.m=e.m),n}if("xmin"in e){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=t(e.xmin,e.ymin,u),[n.xmax,n.ymax]=t(e.xmax,e.ymax,u),e.hasZ&&(n.zmin=e.zmin,n.zmax=e.zmax,n.hasZ=!0),e.hasM&&(n.mmin=e.mmin,n.mmax=e.mmax,n.hasM=!0),n}return"rings"in e?{rings:l(e.rings,t),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:l(e.paths,t),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:h(e.points,t),hasM:e.hasM,hasZ:e.hasZ}:void 0}function l(t,e){const n=[];for(const r of t)n.push(h(r,e));return n}function h(t,e){const n=[];for(const r of t){const t=e(r[0],r[1],[0,0]);n.push(t),r.length>2&&t.push(r[2]),r.length>3&&t.push(r[3])}return n}async function f(t,e){if(!e)return;const n=Array.isArray(t)?t.map(t=>{var e;return null==(e=t.geometry)?void 0:e.spatialReference}):[t];await Object(o.b)(n.map(t=>({source:t,dest:e})))}const d=c.bind(null,s.c),m=c.bind(null,s.f);function p(t,e,n){return t?(n||(n=e,e=t.spatialReference),Object(i.h)(e)&&Object(i.h)(n)&&!Object(i.c)(e,n)?Object(s.a)(e,n)?Object(i.j)(n)?d(t):m(t):Object(o.h)(a.a,[t],e,n,null)[0]:t):t}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(t,e,n){!t||!t.length||!e||!n||Object(i.c)(e,n);const s={geometries:t,inSpatialReference:e,outSpatialReference:n,resolve:null};return this._jobs.push(s),Object(r.c)(t=>{s.resolve=t,null===this._timer&&(this._timer=setTimeout(this._process,10))})}_process(){this._timer=null;const t=this._jobs.shift();if(!t)return;const{geometries:e,inSpatialReference:n,outSpatialReference:r,resolve:u}=t;Object(s.a)(n,r)?Object(i.j)(r)?u(e.map(d)):u(e.map(m)):u(Object(o.h)(a.a,e,n,r,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function y(t,e,n){return g.push(t,e,n)}},472:function(t,e,n){"use strict";function r(t,e){return t?e?4:3:e?3:2}function i(t,e,n,i,a){if(!e||!e.lengths.length)return null;const u="upperLeft"===(null==a?void 0:a.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const c=t.coords,l=[],h=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:d}=e,m=r(n,i);let p=0;for(const r of f){const t=s(h,d,p,r,n,i,u);t&&l.push(t),p+=r*m}if(l.sort((t,e)=>{let r=u*t[2]-u*e[2];return 0===r&&n&&(r=t[4]-e[4]),r}),l.length){let t=6*l[0][2];c[0]=l[0][0]/t,c[1]=l[0][1]/t,n&&(t=6*l[0][4],c[2]=0!==t?l[0][3]/t:0),(c[0]<h[0]||c[0]>h[1]||c[1]<h[2]||c[1]>h[3]||n&&(c[2]<h[4]||c[2]>h[5]))&&(c.length=0)}if(!c.length){const t=e.lengths[0]?o(d,0,f[0],n,i):null;if(!t)return null;c[0]=t[0],c[1]=t[1],n&&t.length>2&&(c[2]=t[2])}return t}function s(t,e,n,i,s,o,a=1){const u=r(s,o);let c=n,l=n+u,h=0,f=0,d=0,m=0,p=0;for(let r=0,y=i-1;r<y;r++,c+=u,l+=u){const n=e[c],r=e[c+1],i=e[c+2],o=e[l],a=e[l+1],u=e[l+2];let g=n*a-o*r;m+=g,h+=(n+o)*g,f+=(r+a)*g,s&&(g=n*u-o*i,d+=(i+u)*g,p+=g),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),s&&(i<t[4]&&(t[4]=i),i>t[5]&&(t[5]=i))}if(m*a>0&&(m*=-1),p*a>0&&(p*=-1),!m)return null;const g=[h,f,.5*m];return s&&(g[3]=d,g[4]=.5*p),g}function o(t,e,n,i,s){const o=r(i,s);let h=e,f=e+o,d=0,m=0,p=0,g=0;for(let r=0,y=n-1;r<y;r++,h+=o,f+=o){const e=t[h],n=t[h+1],r=t[h+2],s=t[f],o=t[f+1],y=t[f+2],b=i?u(e,n,r,s,o,y):a(e,n,s,o);if(b)if(d+=b,i){const t=l(e,n,r,s,o,y);m+=b*t[0],p+=b*t[1],g+=b*t[2]}else{const t=c(e,n,s,o);m+=b*t[0],p+=b*t[1]}}return d>0?i?[m/d,p/d,g/d]:[m/d,p/d]:n>0?i?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function a(t,e,n,r){const i=n-t,s=r-e;return Math.sqrt(i*i+s*s)}function u(t,e,n,r,i,s){const o=r-t,a=i-e,u=s-n;return Math.sqrt(o*o+a*a+u*u)}function c(t,e,n,r){return[t+.5*(n-t),e+.5*(r-e)]}function l(t,e,n,r,i,s){return[t+.5*(r-t),e+.5*(i-e),n+.5*(s-n)]}n.d(e,"a",(function(){return i}))},477:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={convertToGEGeometry:function(t,e){return null==e?null:t.convertJSONToGeometry(e)},exportPoint:function(t,e,n){const r=new i(t.getPointX(e),t.getPointY(e),n),s=t.hasZ(e),o=t.hasM(e);return s&&(r.z=t.getPointZ(e)),o&&(r.m=t.getPointM(e)),r},exportPolygon:function(t,e,n){return new s(t.exportPaths(e),n,t.hasZ(e),t.hasM(e))},exportPolyline:function(t,e,n){return new o(t.exportPaths(e),n,t.hasZ(e),t.hasM(e))},exportMultipoint:function(t,e,n){return new a(t.exportPoints(e),n,t.hasZ(e),t.hasM(e))},exportExtent:function(t,e,n){const r=t.hasZ(e),i=t.hasM(e),s=new u(t.getXMin(e),t.getYMin(e),t.getXMax(e),t.getYMax(e),n);if(r){const n=t.getZExtent(e);s.zmin=n.vmin,s.zmax=n.vmax}if(i){const n=t.getMExtent(e);s.mmin=n.vmin,s.mmax=n.vmax}return s}};class i{constructor(t,e,n){this.x=t,this.y=e,this.spatialReference=n,this.z=void 0,this.m=void 0}}class s{constructor(t,e,n,r){this.rings=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class o{constructor(t,e,n,r){this.paths=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class a{constructor(t,e,n,r){this.points=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class u{constructor(t,e,n,r,i){this.xmin=t,this.ymin=e,this.xmax=n,this.ymax=r,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},479:function(t,e,n){"use strict";n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return g})),n.d(e,"d",(function(){return x})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return y})),n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return p})),n.d(e,"j",(function(){return m})),n.d(e,"k",(function(){return d})),n.d(e,"l",(function(){return f}));var r=n(6),i=(n(37),n(99));function s(t=I){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function o(t,e,n,r,i,o,a=s()){return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a}function a(t,e,n=t){return b(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n[3]=Math.max(t[3],e[3]),n[4]=Math.max(t[4],e[4]),n[5]=Math.max(t[5],e[5])):Object(i.l)(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[3]=Math.max(t[3],e[2]),n[4]=Math.max(t[4],e[3])):2===e.length?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[3]=Math.max(t[3],e[0]),n[4]=Math.max(t[4],e[1])):3===e.length&&(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n[3]=Math.max(t[3],e[0]),n[4]=Math.max(t[4],e[1]),n[5]=Math.max(t[5],e[2])),n}function u(t,e,n,r=t){const i=e.length;let s=t[0],o=t[1],a=t[2],u=t[3],c=t[4],l=t[5];if(n)for(let h=0;h<i;h++){const t=e[h];s=Math.min(s,t[0]),o=Math.min(o,t[1]),a=Math.min(a,t[2]),u=Math.max(u,t[0]),c=Math.max(c,t[1]),l=Math.max(l,t[2])}else for(let h=0;h<i;h++){const t=e[h];s=Math.min(s,t[0]),o=Math.min(o,t[1]),u=Math.max(u,t[0]),c=Math.max(c,t[1])}return r[0]=s,r[1]=o,r[2]=a,r[3]=u,r[4]=c,r[5]=l,r}function c(t){return t[0]>=t[3]?0:t[3]-t[0]}function l(t){return t[1]>=t[4]?0:t[4]-t[1]}function h(t){return t[2]>=t[5]?0:t[5]-t[2]}function f(t,e=[0,0,0]){return e[0]=c(t),e[1]=l(t),e[2]=h(t),e}function d(t,e,n=t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n!==t&&(n[3]=t[3],n[4]=t[4],n[5]=t[5]),n}function m(t,e,n=t){return n[3]=e[0],n[4]=e[1],n[5]=e[2],n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),t}function p(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function g(t){return t?p(t,_):s(_)}function y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function b(t){return 6===t.length}function x(t,e,n){if(Object(r.g)(t)||Object(r.g)(e))return t===e;if(!b(t)||!b(e))return!1;if(n){for(let r=0;r<t.length;r++)if(!n(t[r],e[r]))return!1}else for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const _=[1/0,1/0,1/0,-1/0,-1/0,-1/0],I=[0,0,0,0,0,0];s()},486:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(300),i=Object(r.b)((function(t){var e;void 0!==(e=function(){function t(n,r,i,s,o){for(;s>i;){if(s-i>600){var a=s-i+1,u=r-i+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*(u-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-u*l/a+h)),Math.min(s,Math.floor(r+(a-u)*l/a+h)),o)}var f=n[r],d=i,m=s;for(e(n,i,r),o(n[s],f)>0&&e(n,i,s);d<m;){for(e(n,d,m),d++,m--;o(n[d],f)<0;)d++;for(;o(n[m],f)>0;)m--}0===o(n[i],f)?e(n,i,m):e(n,++m,s),m<=r&&(i=m+1),r<=m&&(s=m-1)}}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}return function(e,r,i,s,o){t(e,r,i||0,s||e.length-1,o||n)}}())&&(t.exports=e)}))},504:function(t,e,n){"use strict";class r{constructor(t=null,e={},n,r){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=t,e&&(this.attributes=e),n&&(this.centroid=n),null!=r&&(this.objectId=r)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const t=new r(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashIndexed=this.geohashIndexed,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}e.a=r},538:function(t,e,n){"use strict";class r{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new r;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}e.a=r},548:function(t,e,n){"use strict";var r=n(324);e.a=class{constructor(t,e){this._storage=new r.c,this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e){this._storage.put(t,e,1,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.clearAll()}}},589:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return o}));var r=n(5),i=n(11),s=n(158);function o(t){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?s.a:"esriGeometryPolyline"===t?s.c:s.b}}}function a(t,e){if(Object(r.a)("csp-restrictions"))return()=>({[e]:null,...t});try{let n=`this.${e} = null;`;for(const e in t)n+=`this${e.indexOf(".")?`["${e}"]`:"."+e} = ${JSON.stringify(t[e])};`;const r=new Function(n);return()=>new r}catch(n){return()=>({[e]:null,...t})}}function u(t={}){return[{name:"New Feature",description:"",prototype:{attributes:Object(i.a)(t)}}]}},590:function(t,e,n){"use strict";function r(t,e){if(!t)return null;const n=e.featureAdapter,{startTimeField:r,endTimeField:i}=t;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(r&&i)e.forEach(t=>{const e=n.getAttribute(t,r),a=n.getAttribute(t,i);null==e||isNaN(e)||(s=Math.min(s,e)),null==a||isNaN(a)||(o=Math.max(o,a))});else{const t=r||i;e.forEach(e=>{const r=n.getAttribute(e,t);null==r||isNaN(r)||(s=Math.min(s,r),o=Math.max(o,r))})}return{start:s,end:o}}function i(t,e,n){if(!e||!t)return null;const{startTimeField:r,endTimeField:i}=t;if(!r&&!i)return null;const{start:s,end:o}=e;return null===s&&null===o?null:void 0===s&&void 0===o?()=>!1:r&&i?function(t,e,n,r,i){return null!=r&&null!=i?s=>{const o=t.getAttribute(s,e),a=t.getAttribute(s,n);return(null==o||o<=i)&&(null==a||a>=r)}:null!=r?e=>{const i=t.getAttribute(e,n);return null==i||i>=r}:null!=i?n=>{const r=t.getAttribute(n,e);return null==r||r<=i}:void 0}(n,r,i,s,o):function(t,e,n,r){return null!=n&&null!=r&&n===r?r=>t.getAttribute(r,e)===n:null!=n&&null!=r?i=>{const s=t.getAttribute(i,e);return s>=n&&s<=r}:null!=n?r=>t.getAttribute(r,e)>=n:null!=r?n=>t.getAttribute(n,e)<=r:void 0}(n,r||i,s,o)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},624:function(t,e,n){"use strict";var r=n(11),i=n(6),s=n(14),o=n(8),a=n(31),u=n(104),c=n(21),l=n(42),h=n(324),f=n(99),d=n(343),m=n(305),p=n(653),g=n(479),y=n(463),b=n(548),x=n(410);const _=new class{constructor(t,e){this._cache=new b.a(t),this._invalidCache=new b.a(e)}get(t,e){const n=`${e.uid}:${t}`,r=this._cache.get(n);if(r)return r;if(void 0!==this._invalidCache.get(n))return null;try{const r=x.WhereClause.create(t,e);return this._cache.put(n,r),r}catch{return this._invalidCache.put(n,null),null}}}(50,500),I="feature-store:unsupported-query",w=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function M(t,e){return t?_.get(t,e):null}function j(t,e,n,r=!0){const i=[];for(const a of e)if("*"!==a&&!t.has(a))if(r){const e=O(a);try{const n=M(e,t);if(!n)throw new s.a(I,"invalid SQL expression",{where:e});if(!n.isStandardized)throw new s.a(I,"expression is not standard",{clause:n});j(t,n.fieldNames,"expression contains missing fields")}catch(o){const t=o&&o.details;if(t&&(t.clause||t.where))throw o;t&&t.missingFields?i.push(...t.missingFields):i.push(a)}}else i.push(a);if(i.length)throw new s.a(I,n,{missingFields:i})}function O(t){return t.split(" as ")[0]}function S(t,e){const n=e.get(t);return!!n&&!w.has(n.type)}var F=n(636),R=n(590),T=n(425),v=n(208),N=class{constructor(t,e,n){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=e;const r=t.outFields;if(r&&-1===r.indexOf("*")){this.outFields=r;let t=0;for(const e of r){const r=O(e),i=this.fieldsIndex.get(r),s=i?null:M(r,n),o=i?i.name:e.split(" as ")[1]||"FIELD_EXP_"+t++;this._fieldDataCache.set(e,{alias:o,clause:s})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach(t=>this.getAttributes(t)),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,n){const r=n?n.name:e;let i=null;return this._fieldDataCache.has(r)?i=this._fieldDataCache.get(r).clause:n||(i=M(e,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:i})),n?this.featureAdapter.getAttribute(t,r):i.calculateValue(t,this.featureAdapter)}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:M(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testFeature(t,this.featureAdapter)}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:M(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const n={};for(const r of e){const{alias:e,clause:i}=this._fieldDataCache.get(r);n[e]=i?i.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return n}_processAttributesForDistinctValues(t){if(Object(i.g)(t)||!this.returnDistinctValues)return t;const e=this.outFields,n=[];if(e)for(const i of e){const{alias:e}=this._fieldDataCache.get(i);n.push(t[e])}else for(const i in t)n.push(t[i]);const r=`${(e||["*"]).join(",")}=${n.join(",")}`;let s=this._returnDistinctMap.get(r)||0;return this._returnDistinctMap.set(r,++s),s>1?null:t}};function A(t){return t.substr(24,12)+t.substr(19,4)+t.substr(16,2)+t.substr(14,2)+t.substr(11,2)+t.substr(9,2)+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)+t.substr(0,2)}function G(t,e,n){return(n?t>e:t<e)?-1:(n?t<e:t>e)?1:0}function E(t,e,n){return n?e-t:t-e}function P(t,e,n,r){if(n&&"esriFieldTypeDate"===n.type){const n=new Date(t).getTime(),i=new Date(e).getTime();if(!isNaN(n)&&!isNaN(i))return E(n,i,r)}if("number"==typeof t&&"number"==typeof e)return E(t,e,r);if("string"==typeof t&&"string"==typeof e){const i=t.toUpperCase(),s=e.toUpperCase();return!n||"esriFieldTypeGUID"!==n.type&&"esriFieldTypeGlobalID"!==n.type?G(i,s,r):G(A(i),A(s),r)}return r?1:-1}class Q{constructor(t,e,n){this.items=t,this.queryGeometry=e,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(t){const e=new N(t,this.featureAdapter,this.fieldsIndex);if(!t.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:n,having:r}=t;if(!(null==n?void 0:n.length))return 1;const i=new Map,s=new Map,o=new Set,a=t.outStatistics;for(const u of a){const{statisticType:t}=u,a="exceedslimit"!==t?u.onStatisticField:void 0;if(!s.has(a)){const t=[];for(const r of n){const n=this._getAttributeValues(e,r,i);t.push(n)}s.set(a,this._calculateUniqueValues(t))}const c=s.get(a);for(const n in c){const{data:t,items:i}=c[n],s=t.join(",");r&&!e.validateItems(i,r)||o.add(s)}}return o.size}createQueryResponse(t){let e;return e=t.outStatistics?t.outStatistics.some(t=>"exceedslimit"===t.statisticType)?this._createExceedsLimitQueryResponse(t):this._createStatisticsQueryResponse(t):this._createFeatureQueryResponse(t),t.returnQueryGeometry&&(Object(a.h)(t.outSR)&&!Object(a.c)(this.queryGeometry.spatialReference,t.outSR)?e.queryGeometry=Object(F.d)({spatialReference:t.outSR,...Object(y.b)(this.queryGeometry,this.queryGeometry.spatialReference,t.outSR)}):e.queryGeometry=Object(F.d)({spatialReference:t.outSR,...this.queryGeometry})),e}executeAttributesQuery(t){const e=M(t.where,this.fieldsIndex);if(!e)return Object(o.u)(this);if(e.isStandardized){let n=0;const r=[];for(const t of this.items)e.testFeature(t,this.featureAdapter)&&(r[n++]=t);const i=new Q(r,this.queryGeometry,this);return i.definitionExpression=t.where,Object(o.u)(i)}return Object(o.t)(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(i.g)(this.aggregateAdapter))return Object(o.u)(this);const e=new Set;for(const r of t.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(t=>e.add(t));const n=this.featureAdapter.getObjectId;return Object(o.u)(new Q(this.items.filter(t=>e.has(n(t))),this.queryGeometry,this))}executeObjectIdsQuery(t){if(!t.objectIds||!t.objectIds.length)return Object(o.u)(this);const e=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Object(o.u)(new Q(this.items.filter(t=>e.has(n(t))),this.queryGeometry,this))}executeTimeQuery(t){const e=Object(R.b)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(i.h)(e))return Object(o.u)(this);const n=this.items.filter(e);return Object(o.u)(new Q(n,this.queryGeometry,this))}filterLatest(){const{trackIdField:t,startTimeField:e,endTimeField:n}=this.timeInfo,r=n||e,i=new Map,s=this.featureAdapter.getAttribute;for(const o of this.items){const e=s(o,t),n=s(o,r),a=i.get(e);(!a||n>s(a,r))&&i.set(e,o)}const a=Array.from(i.values());return Object(o.u)(new Q(a,this.queryGeometry,this))}async project(t){if(!t||Object(a.c)(this.spatialReference,t))return this;const e=this.featureAdapter,n=(await Object(y.c)(this.items.map(t=>Object(F.f)(this.geometryType,this.hasZ,this.hasM,e.getGeometry(t))),this.spatialReference,t)).map((t,n)=>e.cloneWithGeometry(this.items[n],Object(T.d)(t,this.hasZ,this.hasM)));return new Q(n,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}_sortFeatures(t,e,n){if(t.length>1&&e&&e.length)for(const r of e.reverse()){const e=r.split(" "),i=e[0],s=this.fieldsIndex.get(i),o=e[1]&&"desc"===e[1].toLowerCase();t.sort((t,e)=>P(n(t,i,s),n(e,i,s),s,o))}}_createFeatureQueryResponse(t){const e=this.items,{geometryType:n,hasM:r,hasZ:i,objectIdField:s,spatialReference:o}=this,{outFields:a,outSR:u,quantizationParameters:c,resultRecordCount:l,resultOffset:h,returnZ:f,returnM:d}=t,m=null!=l&&e.length>(h||0)+l,p=a&&(a.indexOf("*")>-1?[...this.fieldsIndex.fields]:a.map(t=>this.fieldsIndex.get(t)));return{exceededTransferLimit:m,features:this._createFeatures(t,e),fields:p,geometryType:n,hasM:r&&d,hasZ:i&&f,objectIdFieldName:s,spatialReference:Object(F.d)(u||o),transform:c&&Object(v.c)(c)||null}}_createFeatures(t,e){const n=new N(t,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:i}=this,{orderByFields:s,quantizationParameters:o,returnGeometry:a,returnCentroid:u,maxAllowableOffset:c,resultOffset:l,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=t,m=i&&f,p=r&&d;let g=[],y=0;const b=[...e];if(this._sortFeatures(b,s,(t,e,r)=>n.getFieldValue(t,e,r)),a||u){const t=Object(v.c)(o);if(a&&!u)for(const e of b)g[y++]={attributes:n.getAttributes(e),geometry:Object(F.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(e),c,t,m,p)};else if(!a&&u)for(const e of b)g[y++]={attributes:n.getAttributes(e),centroid:Object(F.i)(this,this.featureAdapter.getCentroid(e,this),t)};else for(const e of b)g[y++]={attributes:n.getAttributes(e),centroid:Object(F.i)(this,this.featureAdapter.getCentroid(e,this),t),geometry:Object(F.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(e),c,t,m,p)}}else for(const _ of b){const t=n.getAttributes(_);t&&(g[y++]={attributes:t})}const x=l||0;if(null!=h){const t=x+h;g=g.slice(x,Math.min(g.length,t))}return g}_createExceedsLimitQueryResponse(t){let e=!1,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const s of t.outStatistics)if("exceedslimit"===s.statisticType){n=null!=s.maxPointCount?s.maxPointCount:Number.POSITIVE_INFINITY,r=null!=s.maxRecordCount?s.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=s.maxVertexCount?s.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)e=this.items.length>n;else if(this.items.length>r)e=!0;else{const t=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter;e=this.items.reduce((t,e)=>{const r=n.getGeometry(e);return t+(r&&r.coords.length||0)},0)/t>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(e)}}]}}_createStatisticsQueryResponse(t){const e={attributes:{}},n=[],r=new Map,i=new Map,s=new Map,o=new Map,a=new N(t,this.featureAdapter,this.fieldsIndex),u=t.outStatistics,{groupByFieldsForStatistics:c,having:l,orderByFields:h}=t,f=c&&c.length,d=!!f,m=d&&c[0],p=d&&!this.fieldsIndex.get(m);for(const y of u){const{outStatisticFieldName:t,statisticType:u}=y,h=y,g="exceedslimit"!==u?y.onStatisticField:void 0,b="percentile_disc"===u||"percentile_cont"===u,x=d&&1===f&&(g===m||p)&&"count"===u;if(d){if(!s.has(g)){const t=[];for(const e of c){const n=this._getAttributeValues(a,e,r);t.push(n)}s.set(g,this._calculateUniqueValues(t))}const e=s.get(g);for(const n in e){const{count:i,data:s,items:u,itemPositions:f}=e[n],d=s.join(",");if(!l||a.validateItems(u,l)){const e=o.get(d)||{attributes:{}};let n=null;if(x)n=i;else{const t=this._getAttributeValues(a,g,r),e=f.map(e=>t[e]);n=b&&"statisticParameters"in h?this._getPercentileValue(h,e):this._getStatisticValue(h,e)}e.attributes[t]=n,c.forEach((t,n)=>e.attributes[this.fieldsIndex.get(t)?t:"EXPR_"+(n+1)]=s[n]),o.set(d,e)}}}else{const n=this._getAttributeValues(a,g,r);e.attributes[t]=b&&"statisticParameters"in h?this._getPercentileValue(h,n):this._getStatisticValue(h,n,i)}n.push({name:t,alias:t,type:"esriFieldTypeDouble"})}const g=d?Array.from(o.values()):[e];return this._sortFeatures(g,h,(t,e)=>t.attributes[e]),{fields:n,features:g}}_getStatisticValue(t,e,n){const{onStatisticField:r,statisticType:i}=t,s=n&&n.has(r)?n.get(r):this._calculateStatistics(e);return n&&n.set(r,s),s["var"===i?"variance":i]}_getPercentileValue(t,e){const{onStatisticField:n,statisticParameters:r,statisticType:i}=t,{value:s,orderBy:o}=r,a="desc"===o,u=this.fieldsIndex.get(n),c=[...e].filter(t=>null!=t).sort((t,e)=>P(t,e,u,a));return this._calculatePercentile(c,s,"percentile_disc"===i)}_getAttributeValues(t,e,n){if(n.has(e))return n.get(e);const r=this.fieldsIndex.get(e),i=this.items.map(n=>t.getFieldValue(n,e,r));return n.set(e,i),i}_calculateStatistics(t){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=null,i=null,s=null,o=null;const a=[];let u=0;for(const c of t)"string"==typeof c?u++:null==c||isNaN(c)||(r+=c,e=Math.min(e,c),n=Math.max(n,c),a.push(c),u++);if(u){i=r/u;let t=0;for(const e of a)t+=Math.pow(e-i,2);o=u>1?t/(u-1):0,s=Math.sqrt(o)}else e=null,n=null;return{avg:i,count:u,max:n,min:e,stddev:s,sum:r,variance:o}}_calculateUniqueValues(t){const e={},n=this.items,r=n.length;for(let i=0;i<r;i++){const r=n[i],s=[];for(const e of t)s.push(e[i]);const o=s.join(",");null==e[o]?e[o]={count:1,data:s,items:[r],itemPositions:[i]}:(e[o].count++,e[o].items.push(r),e[o].itemPositions.push(i))}return e}_calculatePercentile(t,e,n){if(0===t.length)return null;if(e<=0)return t[0];if(e>=1)return t[t.length-1];const r=(t.length-1)*e,i=Math.floor(r),s=i+1,o=r%1,a=t[i],u=t[s];return s>=t.length||n||"string"==typeof a||"string"==typeof u?a:a*(1-o)+u*o}}var C=Q;const Y=new Set,q=new h.c(2e6);let Z=0;const B=Object(g.b)(),V=Object(g.b)();e.a=class{constructor(t){this.capabilities={query:p.a},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new h.b(Z+++"$$",q)),this.fieldsIndex=new m.a(t.fields),t.scheduler&&t.task&&(this._frameQueue=new d.a,this._frameTask=t.scheduler.registerTask(t.task,t=>this._update(t),()=>this._frameQueue.length>0))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const t=this.featureStore.fullBounds;return t?{xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:Object(F.d)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(R.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(t={},e){let n,i=Object(r.a)(t);try{i=await this._schedule(()=>Object(F.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeAggregateIdsQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i))}catch(s){if(s!==F.a)throw s;n=new C([],null,this)}return n.createQueryResponse(i)}async executeQueryForCount(t={},e){let n,i=Object(r.a)(t);i.returnGeometry=!1,i.returnCentroid=!1,i.outSR=null;try{i=await this._schedule(()=>Object(F.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeAggregateIdsQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i))}catch(s){if(s!==F.a)throw s;return 0}return n.createQueryResponseForCount(i)}async executeQueryForExtent(t={},e){let n,i=Object(r.a)(t);const s=i.outSR;try{i=await this._schedule(()=>Object(F.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),i.returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeAggregateIdsQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i));const t=n.size;if(!t)return{count:t,extent:null};Object(g.i)(V,g.a),this.featureStore.forEachBounds(n.items,t=>Object(g.e)(V,t),B);const e={xmin:V[0],ymin:V[1],xmax:V[3],ymax:V[4],spatialReference:Object(F.d)(this.spatialReference)};this.hasZ&&isFinite(V[2])&&isFinite(V[5])&&(e.zmin=V[2],e.zmax=V[5]);const r=Object(y.b)(e,n.spatialReference,s);if(r.spatialReference=Object(F.d)(s||this.spatialReference),r.xmax-r.xmin==0){const t=Object(l.c)(r.spatialReference);r.xmin-=t,r.xmax+=t}if(r.ymax-r.ymin==0){const t=Object(l.c)(r.spatialReference);r.ymin-=t,r.ymax+=t}if(this.hasZ&&null!=r.zmin&&null!=r.zmax&&r.zmax-r.zmin==0){const t=Object(l.c)(r.spatialReference);r.zmin-=t,r.zmax+=t}return{count:t,extent:r}}catch(o){if(o===F.a)return{count:0,extent:null};throw o}}async executeQueryForIds(t={},e){return this.executeQueryForIdSet(t,e).then(t=>Array.from(t))}async executeQueryForIdSet(t={},e){let n,i=Object(r.a)(t);i.returnGeometry=!1,i.returnCentroid=!1,i.outSR=null;try{i=await this._schedule(()=>Object(F.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeAggregateIdsQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i));const t=n.items,e=new Set;return await this._reschedule(()=>{for(const r of t)e.add(n.featureAdapter.getObjectId(r))}),e}catch(s){if(s===F.a)return new Set;throw s}}async executeQueryForLatestObservations(t={},e){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new s.a("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});let n,i=Object(r.a)(t);try{i=await this._schedule(()=>Object(F.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeAggregateIdsQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i)),n=await this._reschedule(()=>n.filterLatest())}catch(o){if(o!==F.a)throw o;n=new C([],null,this)}return n.createQueryResponse(i)}async _schedule(t){return this._frameQueue?this._frameQueue.push(t):t()}async _reschedule(t){return this._frameQueue?this._frameQueue.unshift(t):t()}_update(t){for(this._budget=t;!t.done&&this._frameQueue&&this._frameQueue.process();)t.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const t=[];this.featureStore.forEach(e=>t.push(e)),this._allItems=new C(t,null,this)}return this._allItems}async _executeGeometryQuery(t){const{geometry:e,outSR:n,spatialRel:r}=t,s=Object(a.h)(n)&&!Object(a.c)(this.spatialReference,n),o=this._geometryQueryCache?s?JSON.stringify({geometry:e,spatialRelationship:r,outSpatialReference:n}):JSON.stringify({geometry:e,spatialRelationship:r}):null;if(o){const t=this._geometryQueryCache.get(o);if(!Object(i.i)(t))return t}const u=async e=>{if(s&&(t.returnGeometry||t.returnCentroid)){const t=await e.project(n);return o&&this._geometryQueryCache.put(o,t,t.size||1),t}return o&&this._geometryQueryCache.put(o,e,e.size||1),e};if(!e)return u(this._getAll());const c=this.featureAdapter;if("esriSpatialRelDisjoint"===r){const t=this._searchFeatures(this._getQueryBBoxes(e));if(!t.length)return u(this._getAll());let n,i;const s=new Set;for(const e of t)s.add(c.getObjectId(e));return await this._reschedule(()=>{let t=0;n=new Array(s.size),this.featureStore.forEach(e=>n[t++]=e),i=s}),u(await this._reschedule(async()=>{const t=await Object(F.g)(r,e,this.geometryType,this.hasZ,this.hasM);return new C(await this._runSpatialFilter(n,e=>!i.has(c.getObjectId(e))||t(c.getGeometry(e))),e,this)}))}const l=this._searchFeatures(this._getQueryBBoxes(e));if(!l.length){const t=new C([],e,this);return o&&this._geometryQueryCache.put(o,t,t.size||1),t}if(this._canExecuteSoloPass(e,t))return u(new C(l,e,this));const h=await Object(F.g)(r,e,this.geometryType,this.hasZ,this.hasM),f=await this._runSpatialFilter(l,t=>h(c.getGeometry(t)));return u(new C(f,e,this))}async _runSpatialFilter(t,e){if(!e)return t;if(!this._budget)return t.filter(t=>e(t));let n=0;const r=new Array,i=async()=>{for(;n<t.length;){const s=t[n];e(s)&&r.push(s),this._budget.done&&await this._reschedule(()=>i()),++n}};return this._reschedule(()=>i()).then(()=>r)}_canExecuteSoloPass(t,e){const{geometryType:n}=this,{spatialRel:r}=e;return Object(F.c)(t)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r||"esriSpatialRelWithin"===r))}_getQueryBBoxes(t){if(Object(F.c)(t)){if(Object(c.d)(t))return[Object(f.i)(t.xmin,t.ymin,t.xmax,t.ymax)];if(Object(c.g)(t))return t.rings.map(t=>Object(f.i)(Math.min(t[0][0],t[2][0]),Math.min(t[0][1],t[2][1]),Math.max(t[0][0],t[2][0]),Math.max(t[0][1],t[2][1])))}return[Object(u.a)(Object(f.d)(),t)]}_searchFeatures(t){for(const r of t)this.featureStore.forEachInBounds(r,t=>{Y.add(t)});const e=new Array(Y.size);let n=0;return Y.forEach(t=>e[n++]=t),Y.clear(),e}async _checkQuerySupport(t){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new s.a("feature-store:unsupported-query","Unsupported query options",{query:t});return Object(o.b)([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(F.e)(t,this.geometryType,this.spatialReference),Object(y.a)(this.spatialReference,t.outSR)]).then(()=>t)}_checkAttributesQuerySupport(t){const{outFields:e,orderByFields:n,returnDistinctValues:r,outStatistics:i}=t,o=i?i.map(t=>t.outStatisticFieldName&&t.outStatisticFieldName.toLowerCase()):[];if(n&&n.length>0){const t=" asc",e=" desc",r=n.map(n=>{const r=n.toLowerCase();return r.indexOf(t)>-1?r.split(t)[0]:r.indexOf(e)>-1?r.split(e)[0]:n}).filter(t=>-1===o.indexOf(t));j(this.fieldsIndex,r,"orderByFields contains missing fields")}if(e&&e.length>0)j(this.fieldsIndex,e,"outFields contains missing fields");else if(r)throw new s.a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:t});!function(t,e){if(!e)return!0;const n=_.get(e,t);if(!n)throw new s.a(I,"invalid SQL expression",{where:e});if(!n.isStandardized)throw new s.a(I,"where clause is not standard",{where:e});j(t,n.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,t.where)}async _checkStatisticsQuerySupport(t){const{outStatistics:e,groupByFieldsForStatistics:n,having:r}=t,i=n&&n.length,o=e&&e.length;if(r){if(!i||!o)throw new s.a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});!function(t,e,n){if(!e)return!0;const r=_.get(e,t);if(!r)throw new s.a(I,"invalid SQL expression",{having:e});if(!r.isAggregate)throw new s.a(I,"having does not contain a valid aggregate function",{having:e});const i=r.fieldNames;if(j(t,i,"having contains missing fields"),!r.getExpressions().every(e=>{const{aggregateType:r,field:i}=e,s=t.has(i)&&t.get(i).name;return n.some(e=>{const{onStatisticField:n,statisticType:i}=e;return(t.has(n)&&t.get(n).name)===s&&i.toLowerCase().trim()===r})}))throw new s.a(I,"expressions in having should also exist in outStatistics",{having:e})}(this.fieldsIndex,r,e)}if(o){if(!function(t){return t.every(t=>"exceedslimit"!==t.statisticType)}(e))return;const r=e.map(t=>t.onStatisticField);j(this.fieldsIndex,r,"onStatisticFields contains missing fields"),i&&j(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields");for(const n of e){const{onStatisticField:e,statisticType:r}=n;if("percentile_disc"!==r&&"percentile_cont"!==r||!("statisticParameters"in n)){if("count"!==r&&e&&S(e,this.fieldsIndex))throw new s.a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:n,query:t})}else{const{statisticParameters:e}=n;if(!e)throw new s.a("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:n,query:t})}}}}}},636:function(t,e,n){"use strict";n.d(e,"a",(function(){return I})),n.d(e,"b",(function(){return R})),n.d(e,"c",(function(){return Z})),n.d(e,"d",(function(){return v})),n.d(e,"e",(function(){return q})),n.d(e,"f",(function(){return F})),n.d(e,"g",(function(){return Y})),n.d(e,"h",(function(){return T})),n.d(e,"i",(function(){return S}));var r=n(6),i=n(25),s=n(14),o=n(8),a=n(31),u=n(73),c=n(234),l=n(235),h=n(21),f=n(42),d=n(304),m=n(435),p=n(425),g=(n(472),n(463));function y(t,e){return t?e?4:3:e?3:2}function b(t,e,n,r,i){if(!t)return!1;const s=y(e,n),{coords:o,lengths:a}=t;let u=!1,c=0;for(const l of a)u=x(u,o,s,c,l,r,i),c+=l*s;return u}function x(t,e,n,r,i,s,o){let a=t,u=r;for(let c=r,l=r+i*n;c<l;c+=n){u=c+n,u===l&&(u=r);const t=e[c],i=e[c+1],h=e[u],f=e[u+1];(i<o&&f>=o||f<o&&i>=o)&&t+(o-i)/(f-i)*(h-t)<s&&(a=!a)}return a}const _=new i.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),I=Object.freeze({}),w=new m.a,M=new m.a,j=new m.a,O={esriGeometryPoint:p.m,esriGeometryPolyline:p.o,esriGeometryPolygon:p.n,esriGeometryMultipoint:p.l};function S(t,e,n,r=t.hasZ,i=t.hasM){const s=t.hasZ&&r,o=t.hasM&&i;if(n){const a=Object(p.u)(j,e,t.hasZ,t.hasM,"esriGeometryPoint",n,r,i);return Object(p.m)(a,s,o)}return Object(p.m)(e,s,o)}function F(t,e,n,r,i,s,o=e,a=n){const u=e&&o,c=n&&a,l=r?"coords"in r?r:r.geometry:null;if(!l)return null;if(i){let r=Object(p.q)(M,l,e,n,t,i,o,a);return s&&(r=Object(p.u)(j,r,u,c,t,s)),O[t](r,u,c)}if(s){const r=Object(p.u)(j,l,e,n,t,s,o,a);return O[t](r,u,c)}return Object(p.x)(w,l,e,n,o,a),O[t](w,u,c)}async function R(t,e,n){const{outFields:r,orderByFields:i,groupByFieldsForStatistics:s,outStatistics:o}=t;if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(i)for(let a=0;a<i.length;a++)i[a]=i[a].trim();if(s)for(let a=0;a<s.length;a++)s[a]=s[a].trim();if(o)for(let a=0;a<o.length;a++)o[a].onStatisticField&&(o[a].onStatisticField=o[a].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),T(t,e,n)}async function T(t,e,n){if(!t)return null;let{where:i}=t;if(t.where=i=i&&i.trim(),(!i||/^1 *= *1$/.test(i)||e&&e===i)&&(t.where=null),!t.geometry)return t;let s=await async function(t){const{geometry:e,distance:n,units:r}=t;if(null==n||"vertexAttributes"in e)return e;const i=e.spatialReference,s=r?_.fromJSON(r):Object(f.e)(i),o=i&&(Object(a.e)(i)||Object(a.j)(i))?e:await Object(g.a)(i,a.a).then(()=>Object(g.b)(e,a.a));return(await C().then(t=>t.geodesicBuffer))(o.spatialReference,o,n,s)}(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:e}=t.geometry;s=Object(l.a)(s),s.spatialReference=e}t.geometry=s,await Object(g.a)(s.spatialReference,n);const o=(await Object(d.a)(Object(h.a)(s)))[0];if(Object(r.g)(o))throw I;const u=o.toJSON(),c=await Object(g.b)(u,u.spatialReference,n);if(!c)throw I;return c.spatialReference=n,t.geometry=c,t}function v(t){return t&&N in t?JSON.parse(JSON.stringify(t,A)):t}const N="_geVersion",A=(t,e)=>t!==N?e:void 0,G={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},E={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},P={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},Q={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function C(){return Promise.all([n.e(6),n.e(28)]).then(n.bind(null,713))}function Y(t,e,n,r,i){if(Object(h.g)(e)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t)){const t=Object(p.g)(new m.a,e,!1,!1);return Object(o.u)(e=>function(t,e,n,r){return b(t,e,n,r.coords[0],r.coords[1])}(t,!1,!1,e))}if(Object(h.g)(e)&&"esriGeometryMultipoint"===n){const n=Object(p.g)(new m.a,e,!1,!1);if("esriSpatialRelContains"===t)return Object(o.u)(t=>function(t,e,n,r,i,s){const o=y(i,s),{coords:a,lengths:u}=r;if(!u)return!1;for(let c=0,l=0;c<u.length;c++,l+=o)if(!b(t,e,n,a[l],a[l+1]))return!1;return!0}(n,!1,!1,t,r,i))}if(Object(h.d)(e)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t))return Object(o.u)(t=>Object(u.e)(e,F(n,r,i,t)));if(Object(h.d)(e)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===t)return Object(o.u)(t=>Object(u.d)(e,F(n,r,i,t)));if(Object(h.d)(e)&&"esriSpatialRelIntersects"===t){const t=Object(c.b)(n);return Object(o.u)(s=>t(e,F(n,r,i,s)))}return C().then(s=>{const o=s[G[t]].bind(null,e.spatialReference,e);return t=>o(F(n,r,i,t))})}async function q(t,e,n){const{spatialRel:r,geometry:i}=t;if(i){if(!0!==E[r])throw new s.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:t});if(Object(a.h)(i.spatialReference)&&Object(a.h)(n)){if(!function(t){return!0===P[Object(h.c)(t)]}(i))throw new s.a("feature-store:unsupported-query","Unsupported query geometry type",{query:t});if(!function(t){return!0===Q[t]}(e))throw new s.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:t});if(t.outSR)return Object(g.a)(t.geometry&&t.geometry.spatialReference,t.outSR)}}}function Z(t){if(Object(h.d)(t))return!0;if(Object(h.g)(t)){for(const e of t.rings){if(5!==e.length)return!1;if(e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1}return!0}return!1}},653:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}}}]);
//# sourceMappingURL=8.22272a6e.chunk.js.map