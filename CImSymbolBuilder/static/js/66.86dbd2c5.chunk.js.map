{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/data/BoundsStore.js","../node_modules/@arcgis/core/layers/graphics/data/optimizedFeatureQueryEngineAdapter.js","../node_modules/@arcgis/core/layers/graphics/data/FeatureStore.js","../node_modules/@arcgis/core/layers/graphics/sources/geojson/geojson.js","../node_modules/@arcgis/core/layers/graphics/sources/support/sourceUtils.js","../node_modules/@arcgis/core/layers/graphics/sources/geojson/GeoJSONSourceWorker.js"],"names":["d","minX","minY","maxX","maxY","n","constructor","this","_indexInvalid","_boundsToLoad","_boundsById","Map","_idByBounds","_index","i","s","_loadIndex","Array","size","forEach","clear","load","length","filter","has","delete","get","remove","forEachInBounds","search","invalidateIndex","set","push","o","getObjectId","t","objectId","getAttributes","attributes","getAttribute","e","cloneWithGeometry","r","getGeometry","geometry","getCentroid","centroid","hasZ","hasM","geometryInfo","_boundsStore","_featuresById","_markedIds","Set","events","featureAdapter","h","geometryType","numFeatures","Math","min","max","coords","featureCount","vertexCount","add","_add","_emitChanged","addMany","removeById","_remove","removeManyById","forEachBounds","getFeature","startMarkingUsedFeatures","sweep","emit","getLogger","error","feature","displayId","onFeatureAdd","a","onFeatureRemove","LineString","MultiLineString","MultiPoint","Point","Polygon","MultiPolygon","type","features","coordinates","c","value","done","next","u","l","f","y","g","p","lengths","m","data","crs","properties","name","RegExp","test","w","Number","NEGATIVE_INFINITY","fields","maxObjectId","objectIdFieldName","objectIdFieldType","unknownFields","b","id","P","Object","keys","alias","code","description","globalId","success","uniqueId","message","details","field","originalValue","sanitizedValue","editable","parseFloat","String","TypeError","simplify","async","D","hasAttachments","capabilities","useStandardizedQueries","supportsCoordinatesQuantization","supportsReturningQueryGeometry","advancedQueryCapabilities","supportsQueryAttachments","supportsStatistics","supportsPercentileStatistics","supportsReturningGeometryCentroid","supportsQueryWithDistance","supportsDistinct","supportsReturningQueryExtent","supportsReturningGeometryProperties","supportsHavingClause","supportsOrderBy","supportsPagination","supportsQueryWithResultType","supportsSqlExpression","supportsDisjointSpatialRel","_queryEngine","destroy","_requiredFields","_fieldsIndex","_createDefaultAttributes","_checkProjection","spatialReference","url","responseType","T","q","objectIdField","x","timeInfo","some","nullable","unshift","jsonValues","indexOf","R","startTimeField","endTimeField","trackIdField","O","warnings","featureErrors","layerDefinition","drawingInfo","F","templates","extent","E","featureStore","_","j","_nextObjectId","S","I","_loadInitialFeatures","adds","updates","_applyEdits","executeQuery","signal","executeQueryForCount","executeQueryForIds","executeQueryForExtent","_assignObjectId","fullExtent","start","end","timeExtent","deletes","addResults","deleteResults","updateResults","uidToObjectId","_applyAddEdits","_applyUpdateEdits","featureEditResults","uid","isFinite"],"mappings":"qLAIiF,MAAMA,EAAE,CAACC,KAAK,EAAEC,KAAK,EAAEC,KAAK,EAAEC,KAAK,GAAG,MAAMC,EAAEC,cAAcC,KAAKC,eAAc,EAAGD,KAAKE,cAAc,GAAGF,KAAKG,YAAY,IAAIC,IAAIJ,KAAKK,YAAY,IAAID,IAAIJ,KAAKM,OAAOC,YAAE,EAAEC,YAAE,oBAAoBA,IAAC,CAAId,KAAKc,EAAE,GAAGb,KAAKa,EAAE,GAAGZ,KAAKY,EAAE,GAAGX,KAAKW,EAAE,KAAK,CAAC,MAAM,MAAM,MAAM,QAAQR,KAAKS,WAAW,KAAK,GAAGT,KAAKC,cAAc,CAAC,MAAMO,EAAE,IAAIE,MAAMV,KAAKK,YAAYM,MAAM,IAAIJ,EAAE,EAAEP,KAAKK,YAAYO,QAAS,CAACnB,EAAEK,KAAKU,EAAED,KAAKT,IAAKE,KAAKC,eAAc,EAAGD,KAAKM,OAAOO,QAAQb,KAAKM,OAAOQ,KAAKN,QAAQR,KAAKE,cAAca,SAASf,KAAKM,OAAOQ,KAAKd,KAAKE,cAAcc,OAAQR,GAAGR,KAAKK,YAAYY,IAAIT,KAAMR,KAAKE,cAAca,OAAO,IAAIF,QAAQb,KAAKC,eAAc,EAAGD,KAAKE,cAAca,OAAO,EAAEf,KAAKG,YAAYU,QAAQb,KAAKK,YAAYQ,QAAQb,KAAKM,OAAOO,QAAQK,OAAOV,GAAG,MAAMD,EAAEP,KAAKG,YAAYgB,IAAIX,GAAGR,KAAKG,YAAYe,OAAOV,GAAGD,IAAIP,KAAKK,YAAYa,OAAOX,GAAGP,KAAKC,eAAeD,KAAKM,OAAOc,OAAOb,IAAIc,gBAAgBb,EAAED,GAAGP,KAAKS,aAAa,IAAI,MAAMX,KAAK,SAASU,EAAED,GAAG,OAAOd,EAAEC,KAAKa,EAAE,GAAGd,EAAEE,KAAKY,EAAE,GAAGd,EAAEG,KAAKW,EAAE,GAAGd,EAAEI,KAAKU,EAAE,GAAGC,EAAEc,OAAO7B,GAA9E,CAAkFO,KAAKM,OAAOE,GAAGD,EAAEP,KAAKK,YAAYc,IAAIrB,IAAIqB,IAAIX,GAAG,OAAOR,KAAKG,YAAYgB,IAAIX,GAAGS,IAAIT,GAAG,OAAOR,KAAKG,YAAYc,IAAIT,GAAGe,kBAAkBvB,KAAKC,gBAAgBD,KAAKC,eAAc,EAAGD,KAAKE,cAAca,OAAO,GAAGS,IAAIhB,EAAED,GAAG,IAAIP,KAAKC,cAAc,CAAC,MAAMM,EAAEP,KAAKG,YAAYgB,IAAIX,GAAGD,IAAIP,KAAKM,OAAOc,OAAOb,GAAGP,KAAKK,YAAYa,OAAOX,IAAIP,KAAKG,YAAYqB,IAAIhB,EAAED,GAAGA,IAAIP,KAAKK,YAAYmB,IAAIjB,EAAEC,GAAGR,KAAKC,gBAAgBD,KAAKE,cAAcuB,KAAKlB,GAAGP,KAAKE,cAAca,OAAO,KAAKf,KAAKS,gB,+BCA54C,MAAMiB,EAAE,CAACC,YAAYC,GAAGA,EAAEC,SAASC,cAAcF,GAAGA,EAAEG,WAAWC,aAAa,CAACJ,EAAEK,IAAIL,EAAEG,WAAWE,GAAGC,kBAAkB,CAACD,EAAEE,IAAI,IAAIP,IAAEO,EAAEF,EAAEF,WAAW,KAAKE,EAAEJ,UAAUO,YAAYR,GAAGA,EAAES,SAASC,YAAY,CAACV,EAAEF,KAAKE,EAAEW,WAAWX,EAAEW,SAASJ,YAAE,IAAIF,IAAEL,EAAES,SAASX,EAAEc,KAAKd,EAAEe,OAAOb,EAAEW,WCAkJ,UAAMxC,YAAYkC,GAAGjC,KAAK0C,aAAaT,EAAEjC,KAAK2C,aAAa,IAAI7C,EAAEE,KAAK4C,cAAc,IAAIxC,IAAIJ,KAAK6C,WAAW,IAAIC,IAAI9C,KAAK+C,OAAO,IAAIvC,IAAER,KAAKgD,eAAeC,EAAE,mBAAmB,OAAOjD,KAAK0C,aAAaQ,aAAa,WAAW,OAAOlD,KAAK0C,aAAaD,KAAK,WAAW,OAAOzC,KAAK0C,aAAaF,KAAK,kBAAkB,OAAOxC,KAAK4C,cAAcjC,KAAK,iBAAiB,IAAIX,KAAKmD,YAAY,OAAO,KAAK,MAAMlB,EAAEP,YAAEnB,KAAG,OAAOP,KAAK4C,cAAchC,QAASgB,IAAI,MAAMO,EAAEnC,KAAK2C,aAAaxB,IAAIS,EAAEC,UAAUM,IAAIF,EAAE,GAAGmB,KAAKC,IAAIlB,EAAE,GAAGF,EAAE,IAAIA,EAAE,GAAGmB,KAAKC,IAAIlB,EAAE,GAAGF,EAAE,IAAIA,EAAE,GAAGmB,KAAKE,IAAInB,EAAE,GAAGF,EAAE,IAAIA,EAAE,GAAGmB,KAAKE,IAAInB,EAAE,GAAGF,EAAE,OAAQA,EAAE,sBAAsB,IAAIA,EAAE,EAAE,OAAOjC,KAAK4C,cAAchC,QAASgB,IAAIA,EAAES,UAAUT,EAAES,SAASkB,SAAStB,GAAGL,EAAES,SAASkB,OAAOxC,UAAW,CAACyC,aAAaxD,KAAK4C,cAAcjC,KAAK8C,YAAYxB,GAAGjC,KAAKwC,KAAKxC,KAAKyC,KAAK,EAAE,EAAEzC,KAAKyC,KAAK,EAAE,IAAIiB,IAAIzB,GAAGjC,KAAK2D,KAAK1B,GAAGjC,KAAK4D,eAAeC,QAAQ5B,GAAG,IAAI,MAAML,KAAKK,EAAEjC,KAAK2D,KAAK/B,GAAG5B,KAAK4D,eAAe/C,QAAQb,KAAK4C,cAAc/B,QAAQb,KAAK2C,aAAa9B,QAAQb,KAAK4D,eAAeE,WAAW7B,GAAG,MAAML,EAAE5B,KAAK4C,cAAczB,IAAIc,GAAG,OAAOL,GAAG5B,KAAK+D,QAAQnC,GAAG5B,KAAK4D,eAAehC,GAAG,KAAKoC,eAAe/B,GAAGjC,KAAK2C,aAAapB,kBAAkB,IAAI,MAAMK,KAAKK,EAAE,CAAC,MAAMA,EAAEjC,KAAK4C,cAAczB,IAAIS,GAAGK,GAAGjC,KAAK+D,QAAQ9B,GAAGjC,KAAK4D,eAAeK,cAAchC,EAAEL,EAAEO,GAAG,IAAI,MAAM3B,KAAKyB,EAAE,CAAC,MAAMA,EAAEjC,KAAK2C,aAAaxB,IAAIX,EAAEqB,UAAUI,GAAGL,EAAEnC,YAAE0C,EAAEF,KAAKiC,WAAWjC,GAAG,OAAOjC,KAAK4C,cAAczB,IAAIc,GAAGhB,IAAIgB,GAAG,OAAOjC,KAAK4C,cAAc3B,IAAIgB,GAAGrB,QAAQqB,GAAGjC,KAAK4C,cAAchC,QAASgB,GAAGK,EAAEL,IAAKP,gBAAgBY,EAAEL,GAAG5B,KAAK2C,aAAatB,gBAAgBY,EAAGA,IAAIL,EAAE5B,KAAK4C,cAAczB,IAAIc,MAAOkC,2BAA2BnE,KAAK2C,aAAapB,kBAAkBvB,KAAK6C,WAAWhC,QAAQuD,QAAQ,IAAInC,GAAE,EAAGjC,KAAK4C,cAAchC,QAAS,CAACgB,EAAEO,KAAKnC,KAAK6C,WAAW5B,IAAIkB,KAAKF,GAAE,EAAGjC,KAAK+D,QAAQnC,MAAO5B,KAAK6C,WAAWhC,QAAQoB,GAAGjC,KAAK4D,eAAeA,eAAe5D,KAAK+C,OAAOsB,KAAK,eAAU,GAAQV,KAAKnD,GAAG,IAAIA,EAAE,OAAO,MAAMD,EAAEC,EAAEqB,SAAS,GAAG,MAAMtB,EAAE,YAAYqB,IAAE0C,UAAU,0CAA0CC,MAAM,IAAIpC,IAAE,+BAA+B,wBAAwB,CAACqC,QAAQhE,KAAK,MAAMf,EAAEO,KAAK4C,cAAczB,IAAIZ,GAAG,IAAIT,EAAE,GAAGE,KAAK6C,WAAWa,IAAInD,GAAGd,GAAGe,EAAEiE,UAAUhF,EAAEgF,UAAU3E,EAAEE,KAAK2C,aAAaxB,IAAIZ,GAAGP,KAAK2C,aAAazB,OAAOX,IAAI0B,YAAEjC,KAAK0E,eAAe1E,KAAK0E,aAAalE,IAAIA,EAAE6B,WAAW7B,EAAE6B,SAASkB,SAAS/C,EAAE6B,SAASkB,OAAOxC,OAAO,OAAOf,KAAK2C,aAAanB,IAAIjB,EAAE,WAAWP,KAAK4C,cAAcpB,IAAIjB,EAAEC,GAAGV,EAAE6E,YAAE7E,GAAG4B,cAAIlB,EAAE6B,SAASrC,KAAK0C,aAAaF,KAAKxC,KAAK0C,aAAaD,MAAMzC,KAAK2C,aAAanB,IAAIjB,EAAET,GAAGE,KAAK4C,cAAcpB,IAAIjB,EAAEC,GAAGuD,QAAQnC,GAAG,OAAOK,YAAEjC,KAAK4E,kBAAkB5E,KAAK4E,gBAAgBhD,GAAG5B,KAAK6C,WAAW3B,OAAOU,EAAEC,UAAU7B,KAAK2C,aAAazB,OAAOU,EAAEC,UAAU7B,KAAK4C,cAAc1B,OAAOU,EAAEC,UAAUD,K,iCCJzqG,oIAI4H,SAASF,EAAEO,GAAG,MAAML,EAAE,GAAG,OAAOK,EAAErB,QAASqB,GAAGL,EAAEH,KAAKQ,IAAKL,EAAE,MAAMO,EAAE,CAAC0C,WAAW,uBAAuBC,gBAAgB,uBAAuBC,WAAW,yBAAyBC,MAAM,oBAAoBC,QAAQ,sBAAsBC,aAAa,uBAAuB,SAAS3E,EAAE0B,GAAG,OAAOA,EAAEkD,MAAM,IAAI,gBAAgBlD,EAAE,MAAM,IAAI,oBAAoB,IAAI,MAAML,KAAKK,EAAEmD,SAASxD,UAAUA,IAAI,SAASpB,EAAEyB,GAAG,IAAIA,EAAE,OAAO,KAAK,OAAOA,EAAEkD,MAAM,IAAI,cAAclD,EAAEoD,YAAY,MAAM,IAAI,aAAa,IAAI,mBAAmBpD,EAAEoD,YAAY,MAAM,IAAI,kBAAkB,IAAI,UAAU,IAAI,MAAMzD,KAAKK,EAAEoD,kBAAkBzD,EAAE,MAAM,IAAI,eAAe,IAAI,MAAMA,KAAKK,EAAEoD,YAAY,IAAI,MAAMpD,KAAKL,QAAQK,GAAG,SAASqD,EAAErD,GAAG,OAAO,CAAC,MAAMsD,MAAM3D,EAAE4D,KAAK1F,GAAGmC,EAAEwD,OAAO,GAAG3F,EAAE,OAAM,EAAG,GAAG8B,EAAEb,OAAO,EAAE,OAAM,GAAI,SAAS2E,EAAEzD,GAAG,IAAIL,EAAE,EAAE,IAAI,IAAI9B,EAAE,EAAEA,EAAEmC,EAAElB,OAAOjB,IAAI,CAAC,MAAM4B,EAAEO,EAAEnC,GAAGqC,EAAEF,GAAGnC,EAAE,GAAGmC,EAAElB,QAAQa,GAAGF,EAAE,GAAGS,EAAE,GAAGA,EAAE,GAAGT,EAAE,GAAG,OAAOE,GAAG,EAAE,SAAS+D,EAAE1D,GAAG,MAAML,EAAEK,EAAE,GAAGnC,EAAEmC,EAAEA,EAAElB,OAAO,GAAG,OAAOa,EAAE,KAAK9B,EAAE,IAAI8B,EAAE,KAAK9B,EAAE,IAAI8B,EAAE,KAAK9B,EAAE,IAAImC,EAAER,KAAKG,GAAGK,EAAE,SAAS2D,EAAE3D,EAAEL,EAAE9B,GAAG,OAAO8B,EAAEuD,MAAM,IAAI,aAAa,OAAO,SAASlD,EAAEL,EAAE9B,GAAG,OAAOL,EAAEwC,EAAEL,EAAEyD,YAAYvF,GAAGmC,EAA5C,CAA+CA,EAAEL,EAAE9B,GAAG,IAAI,kBAAkB,OAAO,SAASmC,EAAEL,EAAE9B,GAAG,IAAI,MAAM4B,KAAKE,EAAEyD,YAAY5F,EAAEwC,EAAEP,EAAE5B,GAAG,OAAOmC,EAA7D,CAAgEA,EAAEL,EAAE9B,GAAG,IAAI,aAAa,OAAO,SAASmC,EAAEL,EAAE9B,GAAG,OAAOL,EAAEwC,EAAEL,EAAEyD,YAAYvF,GAAGmC,EAA5C,CAA+CA,EAAEL,EAAE9B,GAAG,IAAI,eAAe,OAAO,SAASmC,EAAEL,EAAE9B,GAAG,IAAI,MAAM4B,KAAKE,EAAEyD,YAAY,CAACV,EAAE1C,EAAEP,EAAE,GAAG5B,GAAG,IAAI,IAAI8B,EAAE,EAAEA,EAAEF,EAAEX,OAAOa,IAAIiE,EAAE5D,EAAEP,EAAEE,GAAG9B,GAAG,OAAOmC,EAAxG,CAA2GA,EAAEL,EAAE9B,GAAG,IAAI,QAAQ,OAAO,SAASmC,EAAEL,EAAE9B,GAAG,OAAOgG,EAAE7D,EAAEL,EAAEyD,YAAYvF,GAAGmC,EAA5C,CAA+CA,EAAEL,EAAE9B,GAAG,IAAI,UAAU,OAAO,SAASmC,EAAEL,EAAE9B,GAAG,MAAM4B,EAAEE,EAAEyD,YAAYV,EAAE1C,EAAEP,EAAE,GAAG5B,GAAG,IAAI,IAAI8B,EAAE,EAAEA,EAAEF,EAAEX,OAAOa,IAAIiE,EAAE5D,EAAEP,EAAEE,GAAG9B,GAAG,OAAOmC,EAAhG,CAAmGA,EAAEL,EAAE9B,IAAI,SAAS6E,EAAE1C,EAAEL,EAAE9B,GAAG,MAAM4B,EAAEiE,EAAE/D,GAAG8D,EAAEhE,GAAGjC,EAAEwC,EAAEP,EAAE5B,GAAGiG,EAAE9D,EAAEP,EAAE5B,GAAG,SAAS+F,EAAE5D,EAAEL,EAAE9B,GAAG,MAAM4B,EAAEiE,EAAE/D,GAAG8D,EAAEhE,GAAGqE,EAAE9D,EAAEP,EAAE5B,GAAGL,EAAEwC,EAAEP,EAAE5B,GAAG,SAASL,EAAEwC,EAAEL,EAAE9B,GAAG,IAAI,MAAM4B,KAAKE,EAAEkE,EAAE7D,EAAEP,EAAE5B,GAAGmC,EAAE+D,QAAQvE,KAAKG,EAAEb,QAAQ,SAASgF,EAAE9D,EAAEL,EAAE9B,GAAG,IAAI,IAAI4B,EAAEE,EAAEb,OAAO,EAAEW,GAAG,EAAEA,IAAIoE,EAAE7D,EAAEL,EAAEF,GAAG5B,GAAGmC,EAAE+D,QAAQvE,KAAKG,EAAEb,QAAQ,SAAS+E,EAAE7D,EAAEL,EAAE9B,GAAG,MAAM4B,EAAES,EAAE5B,GAAGqB,EAAEK,EAAEsB,OAAO9B,KAAKC,EAAES,GAAGrC,EAAE0C,MAAMP,EAAEsB,OAAO9B,KAAKlB,GAAG,GAAG,SAAS0F,EAAEhE,GAAG,cAAcA,GAAG,IAAI,SAAS,MAAM,sBAAsB,IAAI,SAAS,MAAM,sBAAsB,QAAQ,MAAM,WAAW,SAASgB,EAAErB,GAAG,IAAIA,EAAE,MAAM,IAAIK,IAAE,sBAAsB,yBAAyB,GAAG,YAAYL,EAAEuD,MAAM,sBAAsBvD,EAAEuD,KAAK,MAAM,IAAIlD,IAAE,2CAA2C,+CAA+C,CAACiE,KAAKtE,IAAI,MAAMuE,IAAIrG,GAAG8B,EAAE,IAAI9B,EAAE,OAAO,MAAM4B,EAAE,iBAAiB5B,EAAEA,EAAE,SAASA,EAAEqF,KAAKrF,EAAEsG,WAAWC,KAAK,KAAKlE,EAAE,IAAImE,OAAO,oBAAoB,KAAK,IAAI5E,IAAIS,EAAEoE,KAAK7E,GAAG,MAAM,IAAIO,IAAE,gCAAgC,mCAAmC,CAACkE,IAAIrG,IAAI,SAAS0G,EAAEvE,EAAEL,EAAE,IAAI,MAAM9B,EAAES,EAAE0B,GAAGyD,EAAE,GAAGC,EAAE,IAAI7C,IAAI8C,EAAE,IAAI9C,IAAI,IAAI6B,GAAE,EAAGkB,EAAEY,OAAOC,kBAAkBjH,EAAE,KAAKsG,GAAE,EAAGD,OAAE,GAAQ5C,aAAaD,EAAE,MAAMrB,EAAE4E,GAAE,EAAG,OAAO,CAAC,MAAMjB,MAAMtD,EAAEuD,KAAK5D,GAAG9B,EAAE2F,OAAO,GAAG7D,EAAE,CAAC,MAAMK,EAAExC,GAAG,IAAIA,EAAEsB,QAAQtB,EAAE,IAAI,KAAK,GAAGwC,EAAE,IAAI,MAAML,KAAK8D,EAAE9D,EAAEyE,OAAOpE,IAAIL,EAAEuD,KAAK,oBAAoB,MAAM,CAACwB,OAAOjB,EAAExC,aAAaD,EAAET,KAAKmC,EAAEiC,YAAYxD,KAAKE,IAAI,EAAEuC,GAAGgB,kBAAkB5E,EAAE6E,kBAAkBhB,EAAEiB,cAAcrF,EAAEkE,IAAI,MAAMvD,SAAS9B,EAAE6F,WAAWY,EAAEC,GAAGC,GAAGjF,EAAE,KAAI1B,IAAI0C,IAAIA,EAAEd,EAAE5B,EAAE4E,OAAOhD,EAAE5B,EAAE4E,QAAQlC,MAAQ0B,IAAGA,EAAEW,EAAE9E,EAAED,KAAOwF,IAAIA,EAAE,MAAMmB,EAAEnB,IAAID,SAASoB,EAAE,WAAWpB,IAAIrG,EAAE0H,OAAOC,KAAKJ,GAAGhG,OAAQiB,GAAG+E,EAAE/E,KAAKiF,MAAOnB,GAAG,WAAWD,GAAG,MAAMoB,IAAIrB,EAAEzC,KAAKE,IAAIuC,EAAEqB,GAAGzH,EAAEsB,OAAO,EAAEtB,EAAEA,EAAEuB,OAAQiB,GAAG+E,EAAE/E,KAAKiF,GAAI,IAAIzH,EAAEsB,SAAStB,EAAEuH,EAAEvH,EAAE,MAAMyH,EAAEzH,EAAE,MAAM+G,GAAGQ,GAAE,CAAC,IAAI/E,GAAE,EAAG,IAAI,MAAML,KAAKoF,EAAE,CAAC,GAAGrB,EAAE1E,IAAIW,GAAG,SAAS,MAAM9B,EAAEkH,EAAEpF,GAAG,GAAG,MAAM9B,EAAE,CAACmC,GAAE,EAAG2D,EAAElC,IAAI9B,GAAG,SAAS,MAAMF,EAAEuE,EAAEnG,GAAG,YAAY4B,GAAGkE,EAAE1E,OAAOU,GAAG+D,EAAEjC,IAAI9B,GAAG8D,EAAEjE,KAAK,CAAC4E,KAAKzE,EAAEyF,MAAMzF,EAAEuD,KAAKzD,KAAKkE,EAAElC,IAAI9B,GAAG4E,EAAEvE,IAAK,SAAS+E,EAAE/E,EAAEP,GAAG,OAAO,SAASO,GAAG,MAAML,EAAE,GAAG,OAAO,CAAC,MAAM2D,MAAMzF,EAAE0F,KAAK9D,GAAGO,EAAEwD,OAAO,GAAG/D,EAAE,OAAOE,EAAEA,EAAEH,KAAK3B,IAAnF,CAAwF,UAAUmC,EAAEP,EAAE,IAAI,MAAMwB,aAAa3C,EAAEsG,kBAAkBrG,GAAGkB,EAAE,OAAO,CAAC,MAAM6D,MAAMD,EAAEE,KAAKE,GAAGzD,EAAEwD,OAAO,GAAGC,EAAE,OAAO,MAAMrD,SAASsD,EAAES,WAAWzB,EAAEsC,GAAGpB,GAAGP,EAAE,GAAGK,GAAGxD,EAAEwD,EAAER,QAAQ5E,EAAE,SAAS,MAAMd,EAAEkF,GAAG,GAAGnE,GAAG,MAAMqF,IAAIpG,EAAEe,KAAKf,EAAEe,GAAGqF,GAAG,MAAME,EAAE,IAAInE,IAAE+D,EAAEC,EAAE,IAAI9F,IAAE6F,EAAEjE,GAAG,KAAKjC,SAASsG,GAAzQ,CAA6QxF,EAAE0B,GAAGP,M,iCCJ76H,8LAIoP,MAAMA,EAAE3B,cAAcC,KAAKsH,KAAK,KAAKtH,KAAKuH,YAAY,MAAM,MAAM5B,EAAE5F,YAAY6B,GAAG5B,KAAKuE,MAAM,IAAI7C,EAAE1B,KAAKwH,SAAS,KAAKxH,KAAK6B,SAAS,KAAK7B,KAAKyH,SAAQ,EAAGzH,KAAK0H,SAAS,KAAK1H,KAAKuE,MAAMgD,YAAY3F,GAAG,SAAS8D,EAAE9D,GAAG,OAAO,IAAI+D,EAAE/D,GAAG,MAAM+C,EAAE5E,YAAY6B,GAAG5B,KAAKwH,SAAS,KAAKxH,KAAKyH,SAAQ,EAAGzH,KAAK6B,SAAS7B,KAAK0H,SAAS9F,GAAG,SAAS0D,EAAE1D,GAAG,OAAO,IAAI+C,EAAE/C,GAAG,MAAMgE,EAAE,IAAI9C,IAAI,SAASrD,EAAEmC,EAAEK,EAAEE,EAAE3B,EAAEkB,GAAE,EAAGiE,GAAGC,EAAE/E,QAAQ,IAAI,MAAMoB,KAAKzB,EAAE,CAAC,MAAMmE,EAAE/C,EAAET,IAAIc,GAAG,IAAI0C,EAAE,SAAS,MAAMW,EAAE9E,EAAEyB,GAAGxC,EAAEwG,EAAEtB,EAAEW,GAAG,GAAG7F,IAAI6F,GAAGK,GAAGA,EAAElE,KAAK,CAAC4E,KAAK,qBAAqBsB,QAAQ,wDAAwDC,QAAQ,CAACC,MAAMlD,EAAEmD,cAAcxC,EAAEyC,eAAetI,KAAKmG,EAAElC,IAAIiB,EAAE0B,MAAM1B,IAAIjD,GAAGiD,EAAEqD,UAAU,CAAC,MAAMpG,EAAE9B,YAAE6E,EAAElF,GAAG,GAAGmC,EAAE,OAAO8D,EAAEnF,YAAEqB,EAAE+C,EAAElF,IAAI0C,EAAEwC,EAAE0B,MAAM5G,GAAG,IAAI,MAAMmC,KAAKK,EAAE,IAAI2D,EAAE3E,IAAIW,EAAEyE,MAAM,OAAOX,EAAG,2BAA0B9D,EAAEyE,SAAS,OAAO,KAAK,SAASJ,EAAErE,EAAE9B,GAAG,IAAIS,EAAET,EAAE,MAAM,iBAAiBA,GAAGqC,YAAEP,GAAGrB,EAAE0H,WAAWnI,GAAG,MAAMA,GAAGU,YAAEoB,IAAI,iBAAiB9B,IAAIS,EAAE2H,OAAOpI,IAAImC,YAAE1B,GAAG,IAAIwF,EAAE,SAAS9C,EAAEhB,EAAEnC,GAAG,IAAImC,IAAIL,YAAE9B,GAAG,OAAOmC,EAAE,GAAG,UAAUA,GAAG,UAAUA,EAAE,CAAC,IAAI8D,EAAE,MAAM,IAAIoC,UAAU,8BAA8B,OAAOpC,EAAEqC,SAAStI,EAAEmC,GAAG,OAAOA,EAAgGoG,eAAexC,EAAE5D,EAAEnC,IAAI8B,YAAEK,IAAI,wBAAwBnC,GAAG,yBAAyBA,SAA/KuI,iBAAmB,OAAOtC,IAAIA,QAAQ,qDAAqDA,GAA6FD,K,iCCJ3/C,2IAIgsC,MAAMwC,EAAE,CAACC,gBAAe,EAAGC,aAAa,yCAAyCC,wBAAuB,EAAGC,iCAAgC,EAAGC,gCAA+B,EAAGC,0BAA0B,CAACC,0BAAyB,EAAGC,oBAAmB,EAAGC,8BAA6B,EAAGC,mCAAkC,EAAGC,2BAA0B,EAAGC,kBAAiB,EAAGC,8BAA6B,EAAGC,qCAAoC,EAAGC,sBAAqB,EAAGC,iBAAgB,EAAGC,oBAAmB,EAAGC,6BAA4B,EAAGC,uBAAsB,EAAGC,4BAA2B,IAAoB,gBAAM3J,cAAcC,KAAK2J,aAAa,KAAKC,UAAU5J,KAAK2J,cAAc3J,KAAK2J,cAAc3J,KAAK2J,aAAaC,UAAU5J,KAAK2J,aAAa3J,KAAK6J,gBAAgB7J,KAAK8J,aAAa9J,KAAK+J,yBAAyB,KAAK,WAAWnI,GAAG,MAAMO,EAAE,SAASnC,KAAKgK,iBAAiBpI,EAAEqI,kBAAkB,IAAIvE,EAAE,KAAQ9D,EAAEsI,MAAKxE,SAAShE,kBAAEE,EAAEsI,IAAI,CAACC,aAAa,UAAUjE,WAAWjD,YAAEyC,IAAG,MAAMK,EAAED,YAAEJ,EAAE,CAACxC,aAAatB,EAAEsB,eAAe2C,EAAEjE,EAAE+E,QAAQZ,EAAEY,QAAQ,GAAGrB,EAAE,MAAM1D,EAAEY,KAAKZ,EAAEY,KAAKuD,EAAEvD,KAAK4H,EAAErE,EAAE7C,aAAamH,EAAEzI,EAAE0I,gBAAgB,WAAWvE,EAAEe,kBAAkBf,EAAEc,kBAAkB,aAAa,WAAW0D,EAAE3I,EAAEqI,kBAAkB1J,IAAE,IAAIiG,EAAE5E,EAAE4I,SAAS,IAAIJ,EAAE,MAAM,IAAInI,IAAE,iCAAiC,4EAA4E,GAAG,WAAW8D,EAAEe,mBAAmB3E,EAAEV,KAAK,CAAC4E,KAAK,oCAAoCsB,QAAQ,yDAAyD9B,IAAIE,EAAEY,QAAQZ,EAAEgB,cAAchG,OAAO,GAAGoB,EAAEV,KAAK,CAAC4E,KAAK,oCAAoCsB,QAAQ,4EAA4EC,QAAQ,CAACb,cAAchB,EAAEgB,iBAAiBsD,EAAE,CAAC,IAAIpI,EAAE,KAAK4D,EAAE4E,KAAM7I,GAAGA,EAAEyE,OAAOgE,IAAIpI,EAAEL,GAAE,KAAOK,EAAEkD,KAAK,mBAAmBlD,EAAE+F,UAAS,EAAG/F,EAAEyI,UAAS,GAAI7E,EAAE8E,QAAQ,CAACtD,MAAMgD,EAAEhE,KAAKgE,EAAElF,KAAK,mBAAmB6C,UAAS,EAAG0C,UAAS,IAAK,IAAI,MAAM9I,KAAKiE,EAAE,CAAC,GAAG,MAAMjE,EAAEyE,OAAOzE,EAAEyE,KAAKzE,EAAEyF,OAAO,MAAMzF,EAAEyF,QAAQzF,EAAEyF,MAAMzF,EAAEyE,OAAOzE,EAAEyE,KAAK,MAAM,IAAIpE,IAAE,mCAAmC,wBAAwB,CAAC4F,MAAMjG,IAAI,GAAGA,EAAEyE,OAAOgE,IAAIzI,EAAEuD,KAAK,qBAAqB,IAAIR,IAAEiG,WAAWC,QAAQjJ,EAAEuD,MAAM,MAAM,IAAIlD,IAAE,mCAAoC,2BAA0BL,EAAEyE,QAAQ,CAACwB,MAAMjG,IAAI,MAAMkJ,EAAE,GAAG9K,KAAK6J,gBAAgB,GAAG,IAAI,MAAM5H,KAAK4D,EAAE,GAAG,qBAAqB5D,EAAEkD,MAAM,0BAA0BlD,EAAEkD,KAAK,CAAClD,EAAE+F,SAAS,MAAM/F,EAAE+F,YAAY/F,EAAE+F,SAAS/F,EAAEyI,SAAS,MAAMzI,EAAEyI,YAAYzI,EAAEyI,SAAS,MAAM9I,EAAE9B,YAAEmC,GAAGA,EAAEyI,eAAU,IAAS9I,EAAEkJ,EAAE7I,EAAEoE,MAAMzE,EAAE5B,KAAK6J,gBAAgBpI,KAAKQ,GAAG,GAAGjC,KAAK8J,aAAa,IAAIlE,IAAEC,GAAGW,EAAE,CAAC,GAAGA,EAAEuE,eAAe,CAAC,MAAM9I,EAAEjC,KAAK8J,aAAa3I,IAAIqF,EAAEuE,gBAAgB9I,GAAGuE,EAAEuE,eAAe9I,EAAEoE,KAAKpE,EAAEkD,KAAK,qBAAqBqB,EAAEuE,eAAe,KAAK,GAAGvE,EAAEwE,aAAa,CAAC,MAAM/I,EAAEjC,KAAK8J,aAAa3I,IAAIqF,EAAEwE,cAAc/I,GAAGuE,EAAEwE,aAAa/I,EAAEoE,KAAKpE,EAAEkD,KAAK,qBAAqBqB,EAAEwE,aAAa,KAAK,GAAGxE,EAAEyE,aAAa,CAAC,MAAMhJ,EAAEjC,KAAK8J,aAAa3I,IAAIqF,EAAEyE,cAAchJ,EAAEuE,EAAEyE,aAAahJ,EAAEoE,MAAMG,EAAEyE,aAAa,KAAK9I,EAAEV,KAAK,CAAC4E,KAAK,8CAA8CsB,QAAQ,0BAA0BC,QAAQ,CAAC4C,SAAShE,MAAMA,EAAEuE,gBAAgBvE,EAAEwE,eAAe7I,EAAEV,KAAK,CAAC4E,KAAK,iCAAiCsB,QAAQ,8CAA8CC,QAAQ,CAAC4C,SAAShE,KAAKA,EAAE,MAAM,MAAM0E,EAAE,CAACC,SAAShJ,EAAEiJ,cAAc,GAAGC,gBAAgB,IAAI/C,EAAEgD,YAAYC,YAAEnB,GAAGoB,UAAUxE,YAAE8D,GAAGW,OAAO,KAAKvI,aAAakH,EAAEE,cAAcD,EAAE1D,OAAOd,EAAErD,OAAO8C,EAAEkF,SAAShE,IAAIxG,KAAK2J,aAAa,IAAI+B,IAAE,CAAC/E,OAAOd,EAAE3C,aAAakH,EAAE3H,MAAK,EAAGD,KAAK8C,EAAEgF,cAAcD,EAAEJ,iBAAiBM,EAAEC,SAAShE,EAAEmF,aAAa,IAAIC,IAAE,CAAC1I,aAAakH,EAAE3H,MAAK,EAAGD,KAAK8C,MAAMtF,KAAK+J,yBAAyB8B,YAAEf,EAAET,GAAGrK,KAAK8L,cAAc/F,EAAEa,YAAY,EAAE,MAAMmF,EAAEC,YAAEtG,EAAE,CAACxC,aAAakH,EAAE5H,KAAK8C,EAAEuB,kBAAkB,WAAWd,EAAEe,kBAAkBuD,EAAE,OAAO,IAAI7J,YAAE+J,EAAEhK,KAAG,IAAI,MAAM0B,KAAK8J,EAAE9J,EAAEI,WAAWJ,EAAEI,SAASsD,YAAEM,YAAExG,YAAEwC,EAAEI,SAAS+H,EAAE9E,GAAE,GAAI/E,IAAEgK,KAAK,OAAOvK,KAAKiM,qBAAqBf,EAAEa,GAAGb,EAAE,iBAAiBjJ,GAAG,MAAMgI,iBAAiB1J,EAAE2C,aAAa1C,GAAGR,KAAK2J,aAAa,aAAa/H,YAAE,CAACwI,YAAE7J,EAAEC,GAAG8E,YAAErD,EAAEiK,KAAK3L,GAAG+E,YAAErD,EAAEkK,QAAQ5L,KAAKP,KAAKoM,YAAYnK,GAAG,oBAAoBA,EAAE,GAAGL,EAAE,IAAI,OAAO5B,KAAK2J,aAAa0C,aAAapK,EAAEL,EAAE0K,QAAQ,wBAAwBrK,EAAE,GAAGL,EAAE,IAAI,OAAO5B,KAAK2J,aAAa4C,qBAAqBtK,EAAEL,EAAE0K,QAAQ,qBAAqBrK,EAAE,GAAGL,EAAE,IAAI,OAAO5B,KAAK2J,aAAa6C,mBAAmBvK,EAAEL,EAAE0K,QAAQ,kBAAkBrK,EAAE,GAAGL,EAAE,IAAI,OAAO5B,KAAK2J,aAAa8C,sBAAsBxK,EAAEL,EAAE0K,QAAQL,qBAAqBhK,EAAEL,GAAG,MAAM+J,aAAapL,EAAE+J,cAAc9J,GAAGR,KAAK2J,aAAaxH,EAAE,GAAG,IAAI,MAAM5B,KAAKqB,EAAE,CAAC,MAAMA,EAAE5B,KAAK+J,2BAA2BjK,EAAEuK,YAAErK,KAAK8J,aAAa9J,KAAK6J,gBAAgBjI,EAAErB,EAAEwB,YAAW,EAAGE,EAAEkJ,UAAUrL,EAAEmC,EAAEmJ,cAAc3J,KAAK3B,IAAIE,KAAK0M,gBAAgB9K,EAAErB,EAAEwB,YAAW,GAAIxB,EAAEwB,WAAWH,EAAErB,EAAEsB,SAASD,EAAEpB,GAAG2B,EAAEV,KAAKlB,IAAI,GAAGA,EAAEsD,QAAQ1B,GAAGF,EAAEoJ,gBAAgBI,OAAOzL,KAAK2J,aAAagD,WAAW1K,EAAEoJ,gBAAgBb,SAAS,CAAC,MAAMoC,MAAMhL,EAAEiL,IAAItM,GAAGP,KAAK2J,aAAamD,WAAW7K,EAAEoJ,gBAAgBb,SAASsC,WAAW,CAAClL,EAAErB,GAAG,OAAO0B,EAAEmK,YAAYnK,GAAG,MAAMiK,KAAKtK,EAAEuK,QAAQ5L,EAAEwM,QAAQvM,GAAGyB,EAAEE,EAAE,CAAC6K,WAAW,GAAGC,cAAc,GAAGC,cAAc,GAAGC,cAAc,IAAI,GAAGvL,GAAGA,EAAEb,QAAQf,KAAKoN,eAAejL,EAAEP,GAAGrB,GAAGA,EAAEQ,QAAQf,KAAKqN,kBAAkBlL,EAAE5B,GAAGC,GAAGA,EAAEO,OAAO,CAAC,IAAI,MAAMkB,KAAKzB,EAAE2B,EAAE8K,cAAcxL,KAAK8I,YAAEtI,IAAIjC,KAAK2J,aAAagC,aAAa3H,eAAexD,GAAG,MAAM,CAACmM,WAAW3M,KAAK2J,aAAagD,WAAWG,WAAW9M,KAAK2J,aAAamD,WAAWQ,mBAAmBnL,GAAGiL,eAAenL,EAAEL,GAAG,MAAMoL,WAAWzM,GAAG0B,GAAGiB,aAAa1C,EAAEiC,KAAK3C,EAAE0C,KAAKd,EAAE4I,cAAc3F,EAAEsF,iBAAiBtE,EAAEgG,aAAalM,GAAGO,KAAK2J,aAAa5D,EAAE,GAAG,IAAI,MAAMjG,KAAK8B,EAAE,CAAC,GAAG9B,EAAEuC,UAAU7B,IAAI2B,YAAErC,EAAEuC,UAAU,CAAC9B,EAAEkB,KAAK+E,YAAE,6BAA6B,SAAS,MAAM5E,EAAE5B,KAAK+J,2BAA2BrI,EAAE2I,YAAErK,KAAK8J,aAAa9J,KAAK6J,gBAAgBjI,EAAE9B,EAAEiC,YAAY,GAAGL,EAAEnB,EAAEkB,KAAKC,OAAO,CAAC,GAAG1B,KAAK0M,gBAAgB9K,EAAE9B,EAAEiC,YAAYjC,EAAEiC,WAAWH,EAAE,MAAM9B,EAAEyN,IAAI,CAAC,MAAM3L,EAAE9B,EAAEiC,WAAW4C,GAAG1C,EAAEkL,cAAcrN,EAAEyN,KAAK3L,EAAE9B,EAAEuC,WAAWvC,EAAEuC,SAAS4D,YAAE6E,YAAEhL,EAAEuC,SAASsD,GAAG7F,EAAEuC,SAAS4H,iBAAiBtE,IAAII,EAAEtE,KAAK3B,GAAGS,EAAEkB,KAAK8I,YAAEzK,EAAEiC,WAAW4C,MAAMlF,EAAEoE,QAAQ6B,YAAE,GAAGK,EAAEvF,EAAEkB,EAAE5B,EAAE6E,IAAI0I,mBAAmBH,cAAcjL,GAAGL,GAAG,MAAMsB,aAAa3C,EAAEkC,KAAKjC,EAAEgC,KAAK1C,EAAEwK,cAAc5I,EAAEuI,iBAAiBtF,EAAEgH,aAAahG,GAAG3F,KAAK2J,aAAa,IAAI,MAAMlK,KAAKmC,EAAE,CAAC,MAAMG,WAAWH,EAAES,SAASqD,GAAGjG,EAAEmG,EAAEhE,GAAGA,EAAEF,GAAG,GAAG,MAAMkE,EAAE,CAAC3D,EAAER,KAAK+E,YAAG,oBAAmB9E,cAAc,SAAS,IAAIiE,EAAE1E,IAAI2E,GAAG,CAAC3D,EAAER,KAAK+E,YAAG,0BAAyBZ,cAAc,SAAS,MAAMN,EAAES,YAAEJ,EAAEzB,WAAW0B,GAAGrF,EAAET,EAAEU,GAAG,GAAGkF,EAAE,CAAC,GAAGnF,IAAI4B,YAAEuD,GAAG,CAACzD,EAAER,KAAK+E,YAAE,6BAA6B,SAASlB,EAAEjD,SAAS4D,YAAE6E,YAAEpF,EAAEf,GAAGe,EAAEuE,iBAAiBtF,GAAG,GAAG/C,EAAE,CAAC,MAAMrB,EAAE8J,YAAErK,KAAK8J,aAAa9J,KAAK6J,gBAAgBvE,EAAEvD,WAAWH,GAAG,GAAGrB,EAAE,CAAC0B,EAAER,KAAKlB,GAAG,UAAUoF,EAAEjC,IAAImC,YAAEP,EAAE/E,EAAET,EAAEU,EAAEkB,IAAIO,EAAER,KAAK8I,YAAE3E,KAAK8G,gBAAgBzK,EAAEL,EAAErB,GAAE,GAAI,MAAMC,EAAER,KAAK2J,aAAaW,cAAc/J,GAAGiN,SAAS5L,EAAEpB,IAAIyB,EAAEzB,GAAGoB,EAAEpB,GAAGyB,EAAEzB,GAAGR,KAAK8L,gBAAgB,uBAAuBlK,GAAG,UAAU0D,YAAE/E,IAAEqB,GAAG,MAAM,MAAM,IAAIK,IAAE,gBAAgB","file":"static/js/66.86dbd2c5.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport s from\"../../../core/has.js\";import{r as i}from\"../../../chunks/rbush.js\";const d={minX:0,minY:0,maxX:0,maxY:0};class n{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=i(9,s(\"csp-restrictions\")?s=>({minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]}):[\"[0]\",\"[1]\",\"[2]\",\"[3]\"]),this._loadIndex=()=>{if(this._indexInvalid){const s=new Array(this._idByBounds.size);let i=0;this._idByBounds.forEach(((d,n)=>{s[i++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(s)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter((s=>this._idByBounds.has(s)))),this._boundsToLoad.length=0)}}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(s){const i=this._boundsById.get(s);this._boundsById.delete(s),i&&(this._idByBounds.delete(i),this._indexInvalid||this._index.remove(i))}forEachInBounds(s,i){this._loadIndex();for(const n of function(s,i){return d.minX=i[0],d.minY=i[1],d.maxX=i[2],d.maxY=i[3],s.search(d)}(this._index,s))i(this._idByBounds.get(n))}get(s){return this._boundsById.get(s)}has(s){return this._boundsById.has(s)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(s,i){if(!this._indexInvalid){const i=this._boundsById.get(s);i&&(this._index.remove(i),this._idByBounds.delete(i))}this._boundsById.set(s,i),i&&(this._idByBounds.set(i,s),this._indexInvalid||(this._boundsToLoad.push(i),this._boundsToLoad.length>5e4&&this._loadIndex()))}}export{n as BoundsStore};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"../OptimizedFeature.js\";import e from\"../OptimizedGeometry.js\";import{getCentroidOptimizedGeometry as r}from\"../centroid.js\";const o={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(e,r)=>new t(r,e.attributes,null,e.objectId),getGeometry:t=>t.geometry,getCentroid:(t,o)=>(t.centroid||(t.centroid=r(new e,t.geometry,o.hasZ,o.hasM)),t.centroid)};export default o;export{o as optimizedFeatureQueryEngineAdapter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import t from\"../../../core/Logger.js\";import r from\"../../../core/Error.js\";import s from\"../../../core/Evented.js\";import{create as o,NEGATIVE_INFINITY as i}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsOptimizedGeometry as a}from\"../featureConversionUtils.js\";import{fromRect as d}from\"../../../geometry/support/aaBoundingBox.js\";import{BoundsStore as n}from\"./BoundsStore.js\";import{optimizedFeatureQueryEngineAdapter as h}from\"./optimizedFeatureQueryEngineAdapter.js\";export default class{constructor(e){this.geometryInfo=e,this._boundsStore=new n,this._featuresById=new Map,this._markedIds=new Set,this.events=new s,this.featureAdapter=h}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){if(!this.numFeatures)return null;const e=o(i);return this._featuresById.forEach((t=>{const r=this._boundsStore.get(t.objectId);r&&(e[0]=Math.min(r[0],e[0]),e[1]=Math.min(r[1],e[1]),e[2]=Math.max(r[2],e[2]),e[3]=Math.max(r[3],e[3]))})),e}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t,r){for(const s of e){const e=this._boundsStore.get(s.objectId);e&&t(d(r,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,r)=>{this._markedIds.has(r)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit(\"changed\",void 0)}_add(s){if(!s)return;const i=s.objectId;if(null==i)return void t.getLogger(\"esri.layers.graphics.data.FeatureStore\").error(new r(\"featurestore:invalid-feature\",\"feature id is missing\",{feature:s}));const d=this._featuresById.get(i);let n;if(this._markedIds.add(i),d?(s.displayId=d.displayId,n=this._boundsStore.get(i),this._boundsStore.delete(i)):e(this.onFeatureAdd)&&this.onFeatureAdd(s),!s.geometry||!s.geometry.coords||!s.geometry.coords.length)return this._boundsStore.set(i,null),void this._featuresById.set(i,s);n=a(n||o(),s.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(i,n),this._featuresById.set(i,s)}_remove(t){return e(this.onFeatureRemove)&&this.onFeatureRemove(t),this._markedIds.delete(t.objectId),this._boundsStore.delete(t.objectId),this._featuresById.delete(t.objectId),t}}\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import t from\"../../OptimizedFeature.js\";import n from\"../../OptimizedGeometry.js\";function o(e){const t=[];return e.forEach((e=>t.push(e))),t}const r={LineString:\"esriGeometryPolyline\",MultiLineString:\"esriGeometryPolyline\",MultiPoint:\"esriGeometryMultipoint\",Point:\"esriGeometryPoint\",Polygon:\"esriGeometryPolygon\",MultiPolygon:\"esriGeometryPolygon\"};function*i(e){switch(e.type){case\"Feature\":yield e;break;case\"FeatureCollection\":for(const t of e.features)t&&(yield t)}}function*s(e){if(!e)return null;switch(e.type){case\"Point\":yield e.coordinates;break;case\"LineString\":case\"MultiPoint\":yield*e.coordinates;break;case\"MultiLineString\":case\"Polygon\":for(const t of e.coordinates)yield*t;break;case\"MultiPolygon\":for(const t of e.coordinates)for(const e of t)yield*e}}function c(e){for(;;){const{value:t,done:n}=e.next();if(n)return!1;if(t.length>2)return!0}}function u(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],r=e[(n+1)%e.length];t+=o[0]*r[1]-r[0]*o[1]}return t<=0}function l(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function f(e,t,n){switch(t.type){case\"LineString\":return function(e,t,n){return d(e,t.coordinates,n),e}(e,t,n);case\"MultiLineString\":return function(e,t,n){for(const o of t.coordinates)d(e,o,n);return e}(e,t,n);case\"MultiPoint\":return function(e,t,n){return d(e,t.coordinates,n),e}(e,t,n);case\"MultiPolygon\":return function(e,t,n){for(const o of t.coordinates){a(e,o[0],n);for(let t=1;t<o.length;t++)y(e,o[t],n)}return e}(e,t,n);case\"Point\":return function(e,t,n){return g(e,t.coordinates,n),e}(e,t,n);case\"Polygon\":return function(e,t,n){const o=t.coordinates;a(e,o[0],n);for(let t=1;t<o.length;t++)y(e,o[t],n);return e}(e,t,n)}}function a(e,t,n){const o=l(t);u(o)?d(e,o,n):p(e,o,n)}function y(e,t,n){const o=l(t);u(o)?p(e,o,n):d(e,o,n)}function d(e,t,n){for(const o of t)g(e,o,n);e.lengths.push(t.length)}function p(e,t,n){for(let o=t.length-1;o>=0;o--)g(e,t[o],n);e.lengths.push(t.length)}function g(e,t,n){const[o,r,i]=t;e.coords.push(o,r),n.hasZ&&e.coords.push(i||0)}function m(e){switch(typeof e){case\"string\":return\"esriFieldTypeString\";case\"number\":return\"esriFieldTypeDouble\";default:return\"unknown\"}}function h(t){if(!t)throw new e(\"geojson-layer:empty\",\"GeoJSON data is empty\");if(\"Feature\"!==t.type&&\"FeatureCollection\"!==t.type)throw new e(\"geojson-layer:unsupported-geojson-object\",\"missing or not supported GeoJSON object type\",{data:t});const{crs:n}=t;if(!n)return;const o=\"string\"==typeof n?n:\"name\"===n.type?n.properties.name:null,r=new RegExp(\".*(CRS84H?|4326)$\",\"i\");if(!o||!r.test(o))throw new e(\"geojson-layer:unsupported-crs\",\"unsupported GeoJSON 'crs' member\",{crs:n})}function w(e,t={}){const n=i(e),u=[],l=new Set,f=new Set;let a=!1,y=Number.NEGATIVE_INFINITY,d=null,p=!1,g=void 0,{geometryType:h=null}=t,w=!1;for(;;){const{value:e,done:t}=n.next();if(t){const e=d&&1===d.length&&d[0]||null;if(e)for(const t of u)t.name===e&&(t.type=\"esriFieldTypeOID\");return{fields:u,geometryType:h,hasZ:a,maxObjectId:Math.max(0,y),objectIdFieldName:e,objectIdFieldType:g,unknownFields:o(f)}}const{geometry:i,properties:b,id:P}=e;if(!i||(h||(h=r[i.type]),r[i.type]===h)){if(!a){a=c(s(i))}if(p||(p=null!=P,p&&(g=typeof P,\"number\"===g&&(d=Object.keys(b).filter((e=>b[e]===P))))),p&&\"number\"===g&&null!=P&&(y=Math.max(y,P),d.length>1?d=d.filter((e=>b[e]===P)):1===d.length&&(d=b[d[0]]===P?d:[])),!w&&b){let e=!0;for(const t in b){if(l.has(t))continue;const n=b[t];if(null==n){e=!1,f.add(t);continue}const o=m(n);\"unknown\"!==o?(f.delete(t),l.add(t),u.push({name:t,alias:t,type:o})):f.add(t)}w=e}}}}function b(e,o){return function(e){const t=[];for(;;){const{value:n,done:o}=e.next();if(o)return t;t.push(n)}}(function*(e,o={}){const{geometryType:i,objectIdFieldName:s}=o;for(;;){const{value:c,done:u}=e.next();if(u)return;const{geometry:l,properties:a,id:y}=c;if(l&&r[l.type]!==i)continue;const d=a||{};s&&null!=y&&!d[s]&&(d[s]=y);const p=new t(l?f(new n,l,o):null,d);yield p}}(i(e),o))}export{b as createOptimizedFeatures,w as inferLayerProperties,h as validateGeoJSON};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isValid as t}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{sanitizeNullFieldValue as e,validateFieldValue as n,validationErrorToString as i,isNumericField as r,isStringField as s}from\"../../../support/fieldUtils.js\";class o{constructor(){this.code=null,this.description=null}}class l{constructor(t){this.error=new o,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}}function u(t){return new l(t)}class a{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function c(t){return new a(t)}const f=new Set;function d(t,e,r,s,o=!1,l){f.clear();for(const e in s){const a=t.get(e);if(!a)continue;const c=s[e],d=m(a,c);if(d!==c&&l&&l.push({name:\"invalid-value-type\",message:\"attribute value was converted to match the field type\",details:{field:a,originalValue:c,sanitizedValue:d}}),f.add(a.name),a&&(o||a.editable)){const t=n(a,d);if(t)return u(i(t,a,d));r[a.name]=d}}for(const t of e)if(!f.has(t.name))return u(`missing required field \"${t.name}\"`);return null}function m(t,n){let i=n;return\"string\"==typeof n&&r(t)?i=parseFloat(n):null!=n&&s(t)&&\"string\"!=typeof n&&(i=String(n)),e(i)}let p;function h(e,n){if(!e||!t(n))return e;if(\"rings\"in e||\"paths\"in e){if(!p)throw new TypeError(\"geometry engine not loaded\");return p.simplify(n,e)}return e}async function g(){return p||(p=await import(\"../../../../geometry/geometryEngineJSON.js\"),p)}async function y(e,n){!t(e)||\"esriGeometryPolygon\"!==n&&\"esriGeometryPolyline\"!==n||await g()}export{u as createFeatureEditErrorResult,c as createFeatureEditSuccessResult,g as loadGeometryEngine,y as loadGeometryEngineForSimplify,d as mixAttributes,h as simplify};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import{all as t}from\"../../../../core/promiseUtils.js\";import{WGS84 as i,equals as s}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{getJsonType as r}from\"../../../../geometry/support/jsonUtils.js\";import{getFieldDefaultValue as n}from\"../../../support/fieldUtils.js\";import o from\"../../../../request.js\";import{kebabDict as a}from\"../../../support/fieldType.js\";import{convertFromGeometry as l,convertToGeometry as d,convertFromFeatures as u,convertToFeature as p,convertFromFeature as y}from\"../../featureConversionUtils.js\";import f from\"../../../support/FieldsIndex.js\";import{project as m,checkProjectionSupport as c}from\"../../data/projectionSupport.js\";import{validateGeoJSON as h,inferLayerProperties as g,createOptimizedFeatures as I}from\"./geojson.js\";import{createDrawingInfo as F,createDefaultTemplate as b,createDefaultAttributesFunction as j}from\"../support/clientSideDefaults.js\";import _ from\"../../data/FeatureStore.js\";import E from\"../../data/QueryEngine.js\";import{loadGeometryEngineForSimplify as T,mixAttributes as q,createFeatureEditSuccessResult as x,createFeatureEditErrorResult as w,simplify as R}from\"../support/sourceUtils.js\";const D={hasAttachments:!1,capabilities:\"query, editing, create, delete, update\",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};export default class{constructor(){this._queryEngine=null}destroy(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null}async load(t){const r=[];await this._checkProjection(t.spatialReference);let u=null;if(t.url){u=(await o(t.url,{responseType:\"json\"})).data,await h(u)}const p=g(u,{geometryType:t.geometryType}),y=t.fields||p.fields||[],c=null!=t.hasZ?t.hasZ:p.hasZ,T=p.geometryType,q=t.objectIdField||(\"number\"===p.objectIdFieldType?p.objectIdFieldName:\"OBJECTID\")||\"OBJECTID\",x=t.spatialReference||i;let w=t.timeInfo;if(!T)throw new e(\"geojson-layer:missing-property\",\"geometryType not set and couldn't be inferred from the provided features\");if(\"string\"===p.objectIdFieldType&&r.push({name:\"geojson-layer:unsupported-id-type\",message:\"Feature ids are of type string and can't be honored.\"}),y===p.fields&&p.unknownFields.length>0&&r.push({name:\"geojson-layer:unknown-field-types\",message:\"Some fields types couldn't be inferred from the features and were dropped\",details:{unknownFields:p.unknownFields}}),q){let e=null;y.some((t=>t.name===q&&(e=t,!0)))?(e.type=\"esriFieldTypeOID\",e.editable=!1,e.nullable=!1):y.unshift({alias:q,name:q,type:\"esriFieldTypeOID\",editable:!1,nullable:!1})}for(const t of y){if(null==t.name&&(t.name=t.alias),null==t.alias&&(t.alias=t.name),!t.name)throw new e(\"geojson-layer:invalid-field-name\",\"field name is missing\",{field:t});if(t.name===q&&(t.type=\"esriFieldTypeOID\"),-1===a.jsonValues.indexOf(t.type))throw new e(\"geojson-layer:invalid-field-type\",`invalid type for field \"${t.name}\"`,{field:t})}const R={};this._requiredFields=[];for(const e of y)if(\"esriFieldTypeOID\"!==e.type&&\"esriFieldTypeGlobalID\"!==e.type){e.editable=null==e.editable||!!e.editable,e.nullable=null==e.nullable||!!e.nullable;const t=n(e);e.nullable||void 0!==t?R[e.name]=t:this._requiredFields.push(e)}if(this._fieldsIndex=new f(y),w){if(w.startTimeField){const e=this._fieldsIndex.get(w.startTimeField);e?(w.startTimeField=e.name,e.type=\"esriFieldTypeDate\"):w.startTimeField=null}if(w.endTimeField){const e=this._fieldsIndex.get(w.endTimeField);e?(w.endTimeField=e.name,e.type=\"esriFieldTypeDate\"):w.endTimeField=null}if(w.trackIdField){const e=this._fieldsIndex.get(w.trackIdField);e?w.trackIdField=e.name:(w.trackIdField=null,r.push({name:\"geojson-layer:invalid-timeInfo-trackIdField\",message:\"trackIdField is missing\",details:{timeInfo:w}}))}w.startTimeField||w.endTimeField||(r.push({name:\"geojson-layer:invalid-timeInfo\",message:\"startTimeField and endTimeField are missing\",details:{timeInfo:w}}),w=null)}const O={warnings:r,featureErrors:[],layerDefinition:{...D,drawingInfo:F(T),templates:b(R),extent:null,geometryType:T,objectIdField:q,fields:y,hasZ:!!c,timeInfo:w}};this._queryEngine=new E({fields:y,geometryType:T,hasM:!1,hasZ:c,objectIdField:q,spatialReference:x,timeInfo:w,featureStore:new _({geometryType:T,hasM:!1,hasZ:c})}),this._createDefaultAttributes=j(R,q),this._nextObjectId=p.maxObjectId+1;const S=I(u,{geometryType:T,hasZ:c,objectIdFieldName:\"number\"===p.objectIdFieldType?q:null});if(!s(x,i))for(const e of S)e.geometry&&(e.geometry=l(m(d(e.geometry,T,c,!1),i,x)));return this._loadInitialFeatures(O,S),O}async applyEdits(e){const{spatialReference:i,geometryType:s}=this._queryEngine;return await t([T(i,s),c(e.adds,i),c(e.updates,i)]),this._applyEdits(e)}async queryFeatures(e={},t={}){return this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return this._queryEngine.executeQueryForExtent(e,t.signal)}_loadInitialFeatures(e,t){const{featureStore:i,objectIdField:s}=this._queryEngine,r=[];for(const i of t){const t=this._createDefaultAttributes(),n=q(this._fieldsIndex,this._requiredFields,t,i.attributes,!0,e.warnings);n?e.featureErrors.push(n):(this._assignObjectId(t,i.attributes,!0),i.attributes=t,i.objectId=t[s],r.push(i))}if(i.addMany(r),e.layerDefinition.extent=this._queryEngine.fullExtent,e.layerDefinition.timeInfo){const{start:t,end:i}=this._queryEngine.timeExtent;e.layerDefinition.timeInfo.timeExtent=[t,i]}return e}_applyEdits(e){const{adds:t,updates:i,deletes:s}=e,r={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t&&t.length&&this._applyAddEdits(r,t),i&&i.length&&this._applyUpdateEdits(r,i),s&&s.length){for(const e of s)r.deleteResults.push(x(e));this._queryEngine.featureStore.removeManyById(s)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:r}}_applyAddEdits(e,t){const{addResults:i}=e,{geometryType:s,hasM:n,hasZ:o,objectIdField:a,spatialReference:l,featureStore:d}=this._queryEngine,p=[];for(const n of t){if(n.geometry&&s!==r(n.geometry)){i.push(w(\"Incorrect geometry type.\"));continue}const t=this._createDefaultAttributes(),o=q(this._fieldsIndex,this._requiredFields,t,n.attributes);if(o)i.push(o);else{if(this._assignObjectId(t,n.attributes),n.attributes=t,null!=n.uid){const t=n.attributes[a];e.uidToObjectId[n.uid]=t}n.geometry&&(n.geometry=m(R(n.geometry,l),n.geometry.spatialReference,l)),p.push(n),i.push(x(n.attributes[a]))}}d.addMany(u([],p,s,o,n,a))}_applyUpdateEdits({updateResults:e},t){const{geometryType:i,hasM:s,hasZ:n,objectIdField:o,spatialReference:a,featureStore:l}=this._queryEngine;for(const d of t){const{attributes:t,geometry:u}=d,f=t&&t[o];if(null==f){e.push(w(`Identifier field ${o} missing`));continue}if(!l.has(f)){e.push(w(`Feature with object id ${f} missing`));continue}const c=p(l.getFeature(f),i,n,s);if(u){if(i!==r(u)){e.push(w(\"Incorrect geometry type.\"));continue}c.geometry=m(R(u,a),u.spatialReference,a)}if(t){const i=q(this._fieldsIndex,this._requiredFields,c.attributes,t);if(i){e.push(i);continue}}l.add(y(c,i,n,s,o)),e.push(x(f))}}_assignObjectId(e,t,i=!1){const s=this._queryEngine.objectIdField;i&&isFinite(t[s])?e[s]=t[s]:e[s]=this._nextObjectId++}async _checkProjection(t){try{await c(i,t)}catch{throw new e(\"geojson-layer\",\"Projection not supported\")}}}\n"],"sourceRoot":""}